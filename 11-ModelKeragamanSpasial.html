<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Pemodelan Statistika pada Data Geospasial - 11&nbsp; Model Keragaman Spasial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ModelEpidemiologi.html" rel="next">
<link href="./10-ModelDependensiSpasial.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-4.html">Spatial Filtering</a></li><li class="breadcrumb-item"><a href="./11-ModelKeragamanSpasial.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pemodelan Statistika pada Data Geospasial</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/statistika-spasial/book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kata Pengantar</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pendahuluan</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Dependensi Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-SpasialAutoRegresifModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-SpasialDurbinModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spasial Durbin Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-SpasialAutoRegresifBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Keragaman Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-RegresiTerbobotiGeografis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-RegresiTerbobotiGeografisCampuran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Campuran</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-RegresiTerbobotiGeografisBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed SAR-GWR</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-MetodeAnalisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Metode Analisis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-TahapanR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tahapan Analisis dengan R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Filtering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-ModelDependensiSpasial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-ModelKeragamanSpasial.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ModelEpidemiologi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Epidemiologi</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Lampiran</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referensi</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Daftar isi</h2>
   
  <ul>
<li>
<a href="#deskripsi" id="toc-deskripsi" class="nav-link active" data-scroll-target="#deskripsi"><span class="header-section-number">11.1</span> Deskripsi</a>
  <ul class="collapse">
<li><a href="#regresi-terboboti-geografis" id="toc-regresi-terboboti-geografis" class="nav-link" data-scroll-target="#regresi-terboboti-geografis"><span class="header-section-number">11.1.1</span> Regresi Terboboti Geografis</a></li>
  <li><a href="#moran-eigenvectors" id="toc-moran-eigenvectors" class="nav-link" data-scroll-target="#moran-eigenvectors"><span class="header-section-number">11.1.2</span> Moran Eigenvectors</a></li>
  <li><a href="#pendekatan-regresi-terboboti-geografis-menggunakan-eigenvector-spatial-filtering-esf" id="toc-pendekatan-regresi-terboboti-geografis-menggunakan-eigenvector-spatial-filtering-esf" class="nav-link" data-scroll-target="#pendekatan-regresi-terboboti-geografis-menggunakan-eigenvector-spatial-filtering-esf"><span class="header-section-number">11.1.3</span> Pendekatan Regresi Terboboti Geografis Menggunakan Eigenvector Spatial Filtering (ESF)</a></li>
  <li><a href="#random-effect-eigenvector-spatial-filtering-varying-coefficient-re-esf-vc" id="toc-random-effect-eigenvector-spatial-filtering-varying-coefficient-re-esf-vc" class="nav-link" data-scroll-target="#random-effect-eigenvector-spatial-filtering-varying-coefficient-re-esf-vc"><span class="header-section-number">11.1.4</span> Random Effect Eigenvector Spatial Filtering Varying Coefficient (RE-ESF VC)</a></li>
  <li><a href="#transformasi-box-cox" id="toc-transformasi-box-cox" class="nav-link" data-scroll-target="#transformasi-box-cox"><span class="header-section-number">11.1.5</span> Transformasi Box-Cox</a></li>
  <li><a href="#transformasi-sal" id="toc-transformasi-sal" class="nav-link" data-scroll-target="#transformasi-sal"><span class="header-section-number">11.1.6</span> Transformasi SAL</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">11.1.7</span> Data</a></li>
  </ul>
</li>
  <li><a href="#tahapan-analisis-data" id="toc-tahapan-analisis-data" class="nav-link" data-scroll-target="#tahapan-analisis-data"><span class="header-section-number">11.2</span> Tahapan Analisis Data</a></li>
  <li>
<a href="#tahapan-analisis-data-dengan-r" id="toc-tahapan-analisis-data-dengan-r" class="nav-link" data-scroll-target="#tahapan-analisis-data-dengan-r"><span class="header-section-number">11.3</span> Tahapan Analisis Data dengan R</a>
  <ul class="collapse">
<li><a href="#package" id="toc-package" class="nav-link" data-scroll-target="#package"><span class="header-section-number">11.3.1</span> Package</a></li>
  <li><a href="#data-dan-peta" id="toc-data-dan-peta" class="nav-link" data-scroll-target="#data-dan-peta"><span class="header-section-number">11.3.2</span> Data dan Peta</a></li>
  <li><a href="#modifikasi-data" id="toc-modifikasi-data" class="nav-link" data-scroll-target="#modifikasi-data"><span class="header-section-number">11.3.3</span> Modifikasi Data</a></li>
  <li><a href="#plot-spasial" id="toc-plot-spasial" class="nav-link" data-scroll-target="#plot-spasial"><span class="header-section-number">11.3.4</span> Plot Spasial</a></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot"><span class="header-section-number">11.3.5</span> Boxplot</a></li>
  <li><a href="#bobot-spasial" id="toc-bobot-spasial" class="nav-link" data-scroll-target="#bobot-spasial"><span class="header-section-number">11.3.6</span> Bobot Spasial</a></li>
  <li><a href="#uji-asumsi" id="toc-uji-asumsi" class="nav-link" data-scroll-target="#uji-asumsi"><span class="header-section-number">11.3.7</span> Uji Asumsi</a></li>
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram"><span class="header-section-number">11.3.8</span> Histogram</a></li>
  <li><a href="#identifikasi-model-spasial-dan-sebaran" id="toc-identifikasi-model-spasial-dan-sebaran" class="nav-link" data-scroll-target="#identifikasi-model-spasial-dan-sebaran"><span class="header-section-number">11.3.9</span> Identifikasi Model Spasial dan Sebaran</a></li>
  <li><a href="#transformasi-dan-pemodelan" id="toc-transformasi-dan-pemodelan" class="nav-link" data-scroll-target="#transformasi-dan-pemodelan"><span class="header-section-number">11.3.10</span> Transformasi dan Pemodelan</a></li>
  <li><a href="#model-esf-vc" id="toc-model-esf-vc" class="nav-link" data-scroll-target="#model-esf-vc"><span class="header-section-number">11.3.11</span> Model ESF-VC</a></li>
  <li><a href="#hitogram-setelah-transformasi" id="toc-hitogram-setelah-transformasi" class="nav-link" data-scroll-target="#hitogram-setelah-transformasi"><span class="header-section-number">11.3.12</span> Hitogram Setelah Transformasi</a></li>
  <li><a href="#peta-signifikansi-peubah-varying-coefficient" id="toc-peta-signifikansi-peubah-varying-coefficient" class="nav-link" data-scroll-target="#peta-signifikansi-peubah-varying-coefficient"><span class="header-section-number">11.3.13</span> Peta Signifikansi Peubah Varying Coefficient</a></li>
  <li><a href="#peta-koefisien" id="toc-peta-koefisien" class="nav-link" data-scroll-target="#peta-koefisien"><span class="header-section-number">11.3.14</span> Peta Koefisien</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-4.html">Spatial Filtering</a></li><li class="breadcrumb-item"><a href="./11-ModelKeragamanSpasial.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-keragaman-spasial" class="quarto-section-identifier"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="deskripsi" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="deskripsi">
<span class="header-section-number">11.1</span> Deskripsi</h2>
<section id="regresi-terboboti-geografis" class="level3" data-number="11.1.1"><h3 data-number="11.1.1" class="anchored" data-anchor-id="regresi-terboboti-geografis">
<span class="header-section-number">11.1.1</span> Regresi Terboboti Geografis</h3>
<p>Regresi Terboboti Geografis (RTG) merupakan pengembangan dari kerangka model regresi klasik yang menghasilkan penduga koefisien regresi yang bervariasi untuk setiap lokasi. Semakin jauh suatu lokasi dari lokasi yang diduga model regresinya, semakin rendah bobot untuk data pada lokasi tersebut <span class="citation" data-cites="djuraidah2020">(<a href="references.html#ref-djuraidah2020" role="doc-biblioref">Djuraidah 2020</a>)</span>. Model RTG dituliskan sebagai berikut <span class="citation" data-cites="huang2010">(<a href="references.html#ref-huang2010" role="doc-biblioref">Huang, Wu, and Barry 2010</a>)</span>:</p>
<p><span id="eq-1101"><span class="math display">\[
y_i = \beta_0 (u_i v_i) + \sum_{k=1}^{p} \beta_k (u_i v_i) x_{ik} + \epsilon_i
\tag{11.1}\]</span></span></p>
<p>dimana:</p>
<p><span class="math display">\[\begin{align*}

y_i &amp;: \text{nilai pengamatan peubah respon untuk lokasi ke-i} \\
(u_i v_i) &amp;: \text{identifikasi lokasi dari titik ke-i pada suatu lokasi geografis} \\
\beta_0 (u_i v_i) &amp;: \text{intersep pada lokasi pengamatan ke-i} \\
\beta_k (u_i v_i) &amp;: \text{koefisien regresi peubah penjelas ke-k pada lokasi ke-i} \\
x_{ik} &amp;: \text{nilai pengamatan peubah penjelas ke-k pada lokasi ke-i} \\
\epsilon_i &amp;: \text{nilai galat regresi antara peubah penjelas dengan peubah respon di lokasi ke-i}
  
\end{align*}\]</span></p>
<p><span class="citation" data-cites="djuraidah2020">Djuraidah (<a href="references.html#ref-djuraidah2020" role="doc-biblioref">2020</a>)</span> menyatakan parameter koefisien regresi <span class="math inline">\(\beta_k (u_i v_i)\)</span> diduga dengan menggunakan metode Kuadrat Terkecil Terboboti, sehingga pendugaan koefisien regresi <span class="math inline">\(\hat{\beta}(u_i v_i)\)</span> dituliskan sebagai berikut:</p>
<p><span id="eq-1102"><span class="math display">\[
\hat{\beta}(u_i v_i) = [X'W(u_i v_i)X]^{-1} X' W(u_i v_i) y
\tag{11.2}\]</span></span></p>
<p>dimana <span class="math inline">\(W(u_i v_i)\)</span> adalah matriks <span class="math inline">\(n \times n\)</span> yang merupakan matriks pembobot spasial lokasi ke-<span class="math inline">\(i\)</span> dengan nilai unsur-unsur diagonalnya ditentukan oleh jarak antar lokasi pengamatan ke-<span class="math inline">\(i\)</span> dengan lokasi lainnya.</p>
</section><section id="moran-eigenvectors" class="level3" data-number="11.1.2"><h3 data-number="11.1.2" class="anchored" data-anchor-id="moran-eigenvectors">
<span class="header-section-number">11.1.2</span> Moran Eigenvectors</h3>
<p>Vektor eigen moral (MEs) <span class="math inline">\(\{e_1,…,e_L\}\)</span> adalah vektor eigen yang diekstraksi dari dua kali lipat matriks kedekatan spasial terpusat di mana <span class="math inline">\(e_1\)</span> adalah ME yang sesuai dengan nilai eigen terbesar <span class="math inline">\(\lambda_1\)</span>, <span class="math inline">\(e_2\)</span> adalah ME yang sesuai dengan nilai eigen terbesar kedua <span class="math inline">\(\lambda_2\)</span>, dan seterusnya. MEs dapat diinterpretasikan dalam bentuk koefisien moran (MC; atau Moran I), yang merupakan statistik diagnostik ketergantungan spasial yang menunjukkan nilai positif yang lebih besar dengan adanya ketergantungan spasial positif yang lebih kuat.</p>
<p>Moran Coefficienct (MC) mengkuantifikasi ketergantungan spasial dalam <span class="math inline">\(y\)</span>, yaitu <span class="math inline">\(n \times 1\)</span> vektor variabel respon menggunakan persamaan berikut:</p>
<p><span id="eq-1103"><span class="math display">\[
MC[y] = \frac{n}{1' C1} \frac{(y' MCMy)}{(y' My)}
\tag{11.3}\]</span></span></p>
<p>Di mana “<span class="math inline">\('\)</span>” menunjukan matrix transpose, 1 adalah <span class="math inline">\(n \times 1\)</span> vektor satuan. <span class="math inline">\(M = I-11'/n\)</span> adalah <span class="math inline">\(n \times n\)</span> matriks pemusatan, di mana <span class="math inline">\(I\)</span> adalah matriks identitas, dan <span class="math inline">\(C\)</span> adalah konektivitas simetris <span class="math inline">\(n \times n\)</span> matriks yang entri diagonalnya 0 <span class="citation" data-cites="dray2006">(<a href="references.html#ref-dray2006" role="doc-biblioref">Dray, Legendre, and Peres-Neto 2006</a>)</span>.</p>
<p>Akan dilakukan dekomposisi eigen matriks MCM menjadi <span class="math inline">\(E_{\text{full}} \Lambda_{\text{full}} E_{\text{full}}'\)</span>, di mana <span class="math inline">\(E_{\text{full}}\)</span> adalah <span class="math inline">\(n \times n\)</span> matriks yang kolom ke-<span class="math inline">\(l\)</span>, sama dengan vektor eigen ke-<span class="math inline">\(l\)</span>. MC ditunjukkan sebagai berikut:</p>
<p><span id="eq-1104"><span class="math display">\[
MC[e_l] = \frac{n}{1' C1} \frac{(e_l' MCMe_l)}{(e_l' Me_l)} = \frac{n}{1' C1} \frac{(e_l' E_{\text{full}} \Lambda_{\text{full}} E_{\text{full}}')}{(e_l' e_l)} = \frac{n}{1' C1} \lambda_l
\tag{11.4}\]</span></span></p>
<p>Persamaan di atas menunjukkan bahwa vektor eigen dapat diinterpretasikan dalam bentuk MC. Secara khusus, vektor eigen ke-1, <span class="math inline">\(e_1\)</span> adalah himpunan bilangan real yang mempunyai nilai MC terbesar yang dapat dicapai dengan himpunan bilangan real apa pun untuk struktur spasial yang ditentukan oleh <span class="math inline">\(C\)</span>; <span class="math inline">\(e_2\)</span> adalah himpunan bilangan real yang mempunyai nilai MC terbesar yang dapat dicapai oleh himpunan mana pun yang ortogonal dan tidak berkolerasi dengan <span class="math inline">\(e_1\)</span>, dan seterusnya hingga vektor eigen ke-<span class="math inline">\(l\)</span>. Jadi, <span class="math inline">\(E_{\text{full}}=\{e_1,…,e_n\}\)</span> menyediakan semua kemungkinan perbedaan deskripsi pola peta ketergantungan spasial laten dengan setiap besaran indeks melalui nilai yang sesuai di <span class="math inline">\(\{\lambda_1,…,\lambda_n\}\)</span> <span class="citation" data-cites="griffith2003">(<a href="references.html#ref-griffith2003" role="doc-biblioref">Griffith 2003</a>)</span>.</p>
</section><section id="pendekatan-regresi-terboboti-geografis-menggunakan-eigenvector-spatial-filtering-esf" class="level3" data-number="11.1.3"><h3 data-number="11.1.3" class="anchored" data-anchor-id="pendekatan-regresi-terboboti-geografis-menggunakan-eigenvector-spatial-filtering-esf">
<span class="header-section-number">11.1.3</span> Pendekatan Regresi Terboboti Geografis Menggunakan Eigenvector Spatial Filtering (ESF)</h3>
<p>Pendekatan RTG dapat ditingkatkan dengan memasukkan penyaringan spasial berbasis eigenvector. Ini melibatkan penggunaan kombinasi linear dari eigenvector untuk menangkap asosiasi spasial lokal dan menjelaskan autokorelasi spasial dalam <span class="math inline">\(y_i\)</span> (Griffith, 2008). Salah satu pendekatan yang sering digunakan dalam konteks ini adalah Eigenvector Spatial Filtering (ESF), yang juga disebut koordinat utama matriks ketetanggaan <span class="citation" data-cites="dray2006">(<a href="references.html#ref-dray2006" role="doc-biblioref">Dray, Legendre, and Peres-Neto 2006</a>)</span>.</p>
<p>ESF didasarkan pada koefisien Moran (MC) dan mampu memetakan vektor ciri spasial untuk mengidentifikasi dan mengukur struktur spasial dalam data. Dengan mengintegrasikan konsep ESF ke dalam pendekatan RTG, model tersebut menjadi lebih efektif dalam memahami dan menggambarkan pola hubungan spasial antar peubah yang diamati. Model ESF Varying Coefficient (VC) dikembangkan berdasarkan model GWR dan Fixed Effect ESF:</p>
<p><span id="eq-1105"><span class="math display">\[
y_i = (\beta_0 + \sum_{k_0=1}^{K_0} E_{ik_0} \gamma_{k_0}) + \sum_{p=1}^{P} (\beta_p + \sum_{k_p=1}^{K_p} E_{ik_p} \gamma_{k_p}) X_{ip} + \epsilon_i
\tag{11.5}\]</span></span></p>
<p>yang juga dapat ditulis sebagai:</p>
<p><span id="eq-1106"><span class="math display">\[
y = \sum_{p=1}^{P} x_p \odot \beta_p^{ESF} + \epsilon
\tag{11.6}\]</span></span></p>
<p>dimana:</p>
<p><span class="math inline">\(\beta_p^{ESF} = \beta_p + E_p \gamma_p\)</span> dengan <span class="math inline">\(\epsilon \sim N(0, \sigma^2 I)\)</span></p>
</section><section id="random-effect-eigenvector-spatial-filtering-varying-coefficient-re-esf-vc" class="level3" data-number="11.1.4"><h3 data-number="11.1.4" class="anchored" data-anchor-id="random-effect-eigenvector-spatial-filtering-varying-coefficient-re-esf-vc">
<span class="header-section-number">11.1.4</span> Random Effect Eigenvector Spatial Filtering Varying Coefficient (RE-ESF VC)</h3>
<p>Model Fixed Effect ESF-VC pada awalnya fokus pada penggunaan eigenvector spatial filtering untuk mengendalikan dan mengeksplorasi efek tetap yang terkait dengan variabilitas spasial dalam data. Namun, perkembangan terbaru telah melihat konsep ini dikembangkan menjadi model Random Effect ESF-VC, di mana pendekatan ini tidak hanya mempertimbangkan efek tetap, tetapi juga mampu menangkap variasi acak yang mungkin ada dalam struktur spasial data tersebut. Model RE ESF-VC menurut <span class="citation" data-cites="murakami2017">(<a href="references.html#ref-murakami2017" role="doc-biblioref">Murakami 2017</a>)</span> sebagai berikut:</p>
<p><span id="eq-1107"><span class="math display">\[
y = \sum_{k=1}^{K} x_k \beta_K^{(RE-ESF)} + \epsilon, \quad \epsilon \sim N(0,\sigma^2 I)
\tag{11.7}\]</span></span></p>
<p><span class="math display">\[
\beta_K^{(RE-ESF)} = \beta_k 1 + E_k \gamma_k, \quad \gamma_k \sim N(0_L,\sigma_{(\gamma,k)}^2 \Lambda_{(\alpha k)})
\]</span></p>
<p>Di mana <span class="math inline">\(0_L\)</span> adalah vektor nol berukuran <span class="math inline">\(L \times 1\)</span>, sedangkan <span class="math inline">\(E\)</span> adalah matriks vektor eigen sepanjang <span class="math inline">\(L\)</span> yang sesuai dengan eigenvalues positif. Dari persamaan sebelumnya, dibuat model lanjutan seperti berikut:</p>
<p><span id="eq-1108"><span class="math display">\[
y = X\beta + \tilde{E} \tilde{\Lambda}(\theta) \tilde{u} + \epsilon, \quad \epsilon \sim N(0,\sigma^2 I)
\tag{11.8}\]</span></span></p>
<p><span class="math inline">\(\tilde{E} = [x_1 \quad E \ldots X_K \quad E]\)</span></p>
<p>Persamaan di atas menunjukkan bahwa model RE-ESF adalah model dengan efek campuran linier. Selain itu, <span class="math inline">\(\beta\)</span> dan <span class="math inline">\(\tilde{u}\)</span> memiliki estimasi linier terbaik tanpa bias sebagai berikut:</p>
<p><span class="math display">\[
\begin{bmatrix} \hat{\beta} \\ \hat{u} \end{bmatrix} = \left[ \begin{array}{cc} X'X &amp; X'\tilde{E}\tilde{\Lambda}(\theta) \\ \tilde{\Lambda}(\theta)(\tilde{E'})X &amp; \tilde{\Lambda}(\theta)(\tilde{E'})\tilde{E}\tilde{\Lambda}(\theta) + I_{KL} \end{array} \right]^{-1} \begin{bmatrix} Xy' \\ \tilde{\Lambda}(\theta) \tilde{E}y' \end{bmatrix}
\]</span></p>
<p>Ketika <span class="math inline">\(\theta\)</span> diestimasi secara numerik dengan maksimisasi.</p>
</section><section id="transformasi-box-cox" class="level3" data-number="11.1.5"><h3 data-number="11.1.5" class="anchored" data-anchor-id="transformasi-box-cox">
<span class="header-section-number">11.1.5</span> Transformasi Box-Cox</h3>
<p>Draper &amp; Smith (1992) menyatakan bahwa transformasi Box-Cox adalah transformasi pangkat pada variabel respons yang dikembangkan oleh Box dan Cox. Transformasi ini bertujuan memenuhi ketiga asumsi model linier, yaitu keheterogenan ragam, ketaknormalan galat, dan keaditifan/ketaklinieran pengaruh sistematik. Box-Cox menggunakan kriteria yang menggabungkan tujuan memperoleh model yang sederhana dan ragam yang homogen pada satu sisi serta tujuan kenormalan data pada sisi lain.</p>
<p>Transformasi Box-Cox hanya diberlakukan pada variabel respons <span class="math inline">\(Y\)</span> yang bernilai positif. Prosedur utama yang dilakukan pada Transformasi Box-Cox adalah menduga parameter <span class="math inline">\(\lambda\)</span>. Dengan mengetahui nilai <span class="math inline">\(\lambda\)</span> pada pengolahan data, kita dapat mengetahui nilai dari transformasi yang digunakan pada model. Pada Tabel, disajikan nilai <span class="math inline">\(\lambda\)</span> dan transformasinya.</p>
<table class="table">
<thead><tr class="header">
<th style="text-align: center;"><span class="math inline">\(\lambda\)</span></th>
<th style="text-align: center;">Transformasi</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(Y^2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(Y^1\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">0.5</td>
<td style="text-align: center;"><span class="math inline">\(\sqrt{Y}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;"><span class="math inline">\(\ln(Y)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">-0.5</td>
<td style="text-align: center;"><span class="math inline">\(\frac{1}{\sqrt{Y}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">-1</td>
<td style="text-align: center;"><span class="math inline">\(\frac{1}{Y}\)</span></td>
</tr>
</tbody>
</table>
<p>Dengan menggunakan transformasi Box-Cox akan diperoleh sebaran yang simetrik mendekati Normal. Ketakhomogenan ragam pun dapat dikurangi dengan transformasi ini <span class="citation" data-cites="hadi2007">(<a href="references.html#ref-hadi2007" role="doc-biblioref">Hadi, Sa’diyah, and Sumertajaya 2007</a>)</span>.</p>
</section><section id="transformasi-sal" class="level3" data-number="11.1.6"><h3 data-number="11.1.6" class="anchored" data-anchor-id="transformasi-sal">
<span class="header-section-number">11.1.6</span> Transformasi SAL</h3>
<p>Transformasi SAL (SinhArcsinh dan Affine Linear) adalah teknik yang digunakan dalam statistika untuk memodifikasi distribusi data sehingga lebih mendekati distribusi normal atau Gaussian. Transformasi ini berguna ketika data tidak memenuhi asumsi kenormalan yang diperlukan dalam banyak analisis statistik. Rois dan Tober (2019) menjelaskan iterasi transformasi SAL mendekati berbagai macam distribusi non-Gaussian tanpa mengasumsikan distribusi data secara eksplisit.</p>
<p>Lebih lanjut, persamaan SinhArcsinh disajikan sebagai berikut:</p>
<p><span id="eq-sinharcsinh"><span class="math display">\[
\varphi_{\text{arcsinh}}(y) = a + b \text{arcsinh} \left( \frac{y-c}{d} \right)
\tag{11.9}\]</span></span></p>
<p>Di mana <span class="math inline">\(a, c \in \mathbb{R}^+\)</span> dan <span class="math inline">\(b, d \in \mathbb{R}^+\)</span>, biasa disebut dengan distribusi Johnson <span class="citation" data-cites="johnsonNL1949">(<a href="references.html#ref-johnsonNL1949" role="doc-biblioref">NL 1949</a>)</span>. Adapun untuk persamaan Affine sebagai berikut:</p>
<p><span id="eq-affine"><span class="math display">\[
\varphi_{\text{affine}}(y) = a + by, \quad a, b \in \mathbb{R}
\tag{11.10}\]</span></span></p>
<p>Sehingga persamaan transformasi SAL adalah:</p>
<p><span id="eq-sal"><span class="math display">\[
l(y) = a + b \sinh(c \text{arsinh}(y) - d)
\tag{11.11}\]</span></span></p>
<p>Di mana <span class="math inline">\(a, b, c, d \in \mathbb{R}\)</span>.</p>
<p>Melalui penerapan transformasi SAL yang mengombinasikan metode SinhArcsinh dan Affine Linear, dapat membantu mengubah distribusi data yang awalnya tidak normal menjadi lebih mendekati distribusi normal.</p>
</section><section id="data" class="level3" data-number="11.1.7"><h3 data-number="11.1.7" class="anchored" data-anchor-id="data">
<span class="header-section-number">11.1.7</span> Data</h3>
<p>Data yang digunakan berasal dari Badan Pusat Statistik (BPS) pada tahun 2021 dengan observasi sebanyak 514 kabupaten/kota di Indonesia. Tabel berikut menunjukkan deskripsi peubah yang akan digunakan.</p>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 55%">
<col style="width: 28%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th>Peubah</th>
<th>Deskripsi</th>
<th>Satuan</th>
<th>Tipe</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Y</td>
<td>Indeks Ketahanan Pangan</td>
<td>-</td>
<td>Numerik</td>
</tr>
<tr class="even">
<td>X1</td>
<td>Persentase penduduk miskin (P0) menurut kabupaten/kota</td>
<td>Persen</td>
<td>Numerik</td>
</tr>
<tr class="odd">
<td>X2</td>
<td>Pengeluaran per kapita disesuaikan</td>
<td>Ribu Rupiah/Orang/Tahun</td>
<td>Numerik</td>
</tr>
<tr class="even">
<td>X3</td>
<td>Umur harapan hidup</td>
<td>Tahun</td>
<td>Numerik</td>
</tr>
<tr class="odd">
<td>X4</td>
<td>Rata-rata lama sekolah penduduk umur 15 tahun ke atas</td>
<td>Tahun</td>
<td>Numerik</td>
</tr>
<tr class="even">
<td>X5</td>
<td>Persentase rumah tangga yang memiliki akses terhadap sanitasi layak</td>
<td>Persen</td>
<td>Numerik</td>
</tr>
<tr class="odd">
<td>X6</td>
<td>Persentase rumah tangga yang memiliki akses terhadap air minum</td>
<td>Persen</td>
<td>Numerik</td>
</tr>
</tbody>
</table></section></section><section id="tahapan-analisis-data" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="tahapan-analisis-data">
<span class="header-section-number">11.2</span> Tahapan Analisis Data</h2>
<p>Berikut adalah langkah prosedur analisis yang dilakukan:</p>
<ol type="1">
<li><p>Eksplorasi data berupa interpretasi pola persebaran Indeks Ketahanan Pangan di Indonesia dan boxplot dari peubah yang digunakan.</p></li>
<li><p>Pemodelan regresi antara Indeks Ketahanan Pangan terhadap enam peubah penjelas.</p></li>
<li>
<p>Pengujian asumsi, yaitu:</p>
<ul>
<li>Uji normalitas sisaan regresi dengan Uji Liliefors,</li>
<li>Uji heterogenitas regresi dengan Uji Breusch-Pagan,</li>
<li>Uji multikolinearitas antar peubah penjelas dengan nilai VIF,</li>
<li>Uji autokorelasi spasial data dengan Indeks Moran, serta</li>
<li>Uji autokorelasi spasial sisaan regresi dengan Global Moran.</li>
</ul>
</li>
<li><p>Penerapan transformasi Box-Cox dan SAL transformation dengan iterasi sebanyak D kali.</p></li>
<li><p>Pemodelan dengan <strong>Random Effect Eigenvector Spatial Filtering Varying Coefficient</strong> (RE-ESF VC).</p></li>
<li><p>Interpretasi hasil analisis model RE-ESF VC dengan melihat pola persebaran masing-masing peubah penjelas di Indonesia dan melihat peubah yang signifikan pada kabupaten/kota di Indonesia.</p></li>
<li><p>Interpretasi hasil estimasi efek marginal dan efek spasial dari model RE-ESF VC.</p></li>
<li><p>Membandingkan kinerja hasil dari model regresi dan RE-ESF VC dengan nilai residual SE, AIC, BIC, dan adjusted <span class="math inline">\(R^2\)</span>.</p></li>
</ol></section><section id="tahapan-analisis-data-dengan-r" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="tahapan-analisis-data-dengan-r">
<span class="header-section-number">11.3</span> Tahapan Analisis Data dengan R</h2>
<section id="package" class="level3" data-number="11.3.1"><h3 data-number="11.3.1" class="anchored" data-anchor-id="package">
<span class="header-section-number">11.3.1</span> Package</h3>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span> <span class="co"># Untuk pemodelan dependensi spasial </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spatialreg/">spatialreg</a></span><span class="op">)</span> <span class="co"># Untuk pemodelan dependensi spasial </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span> <span class="co"># Untuk operasi matematis </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span> <span class="co"># Untuk menghitung VIF </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span> <span class="co"># Untuk uji kenormalan </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span> <span class="co"># Untuk menginput peta </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span> <span class="co"># Untuk visualisasi data </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span> <span class="co"># Untuk mengolah dataframe </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span> <span class="co"># Untuk mengolah dataframe </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># Struktur matriks </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span> <span class="co"># Uji model linier </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">spmoran</span><span class="op">)</span> <span class="co"># ESF </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape">ape</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus">fitdistrplus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="data-dan-peta" class="level3" data-number="11.3.2"><h3 data-number="11.3.2" class="anchored" data-anchor-id="data-dan-peta">
<span class="header-section-number">11.3.2</span> Data dan Peta</h3>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hasil2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"data/hasil.RDS"</span><span class="op">)</span></span>
<span><span class="co">#Input Data </span></span>
<span><span class="va">ikp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/IKP2022.xlsx"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># #Import peta SHP </span></span>
<span><span class="va">peta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"data/shp/BATAS KABUPATEN KOTA DESEMBER 2019 DUKCAPIL.shp"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="modifikasi-data" class="level3" data-number="11.3.3"><h3 data-number="11.3.3" class="anchored" data-anchor-id="modifikasi-data">
<span class="header-section-number">11.3.3</span> Modifikasi Data</h3>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ikp</span><span class="op">$</span><span class="va">KAB_KOTA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">ikp</span><span class="op">$</span><span class="va">KAB_KOTA</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#join data to peta</span></span>
<span><span class="va">dfix</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">peta</span>, <span class="va">ikp</span>, by <span class="op">=</span> <span class="st">"KAB_KOTA"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spherical geometry (s2) switched off</span></span>
<span><span class="va">longlat</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_centroid.sfc(dfix$geometry): st_centroid does not</span></span>
<span><span class="co">#&gt; give correct centroids for longitude/latitude data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="plot-spasial" class="level3" data-number="11.3.4"><h3 data-number="11.3.4" class="anchored" data-anchor-id="plot-spasial">
<span class="header-section-number">11.3.4</span> Plot Spasial</h3>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#peta ikp</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Indeks Ketahanan Pangan"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, palette <span class="op">=</span> <span class="st">"Emrld"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Nilai"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                  <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                 <span class="fl">13</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.32</span>, <span class="st">'npc'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="boxplot" class="level3" data-number="11.3.5"><h3 data-number="11.3.5" class="anchored" data-anchor-id="boxplot">
<span class="header-section-number">11.3.5</span> Boxplot</h3>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Boxplot</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">X1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">dfix</span><span class="op">$</span><span class="va">X1</span>,</span>
<span>  <span class="va">dfix</span><span class="op">$</span><span class="va">X3</span>,</span>
<span>  <span class="va">dfix</span><span class="op">$</span><span class="va">X5</span>,</span>
<span>  <span class="va">dfix</span><span class="op">$</span><span class="va">X6</span>,</span>
<span>  <span class="va">dfix</span><span class="op">$</span><span class="va">X7</span>,</span>
<span>  <span class="va">dfix</span><span class="op">$</span><span class="va">X8</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id   X1    X2   X3     X4   X5    X6</span></span>
<span><span class="co">#&gt; 1  1 72.3  9.87 1.12  15793 17.9  9775</span></span>
<span><span class="co">#&gt; 2  2 67.4  8.68 1.54   3568 15.4  8651</span></span>
<span><span class="co">#&gt; 3  3 74.0 10.35 1.20 233594 13.4  9894</span></span>
<span><span class="co">#&gt; 4  4 70.4  8.72 1.67  23214 12.5 10041</span></span>
<span><span class="co">#&gt; 5  5 67.9  8.89 1.16  14534 12.4  8353</span></span>
<span><span class="co">#&gt; 6  6 69.6  8.69 1.84  10444 19.2  8994</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">X</span>,</span>
<span>               cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">'Variable'</span>,</span>
<span>               values_to <span class="op">=</span> <span class="st">'Value'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;      id Variable    Value</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1 X1          72.3 </span></span>
<span><span class="co">#&gt; 2     1 X2           9.87</span></span>
<span><span class="co">#&gt; 3     1 X3           1.12</span></span>
<span><span class="co">#&gt; 4     1 X4       15793   </span></span>
<span><span class="co">#&gt; 5     1 X5          17.9 </span></span>
<span><span class="co">#&gt; 6     1 X6        9775</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span></span>
<span>    <span class="co"># custom boxes</span></span>
<span>    color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    <span class="co"># Notch?</span></span>
<span>    notch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    notchwidth <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>    <span class="co"># custom outliers</span></span>
<span>    outlier.colour <span class="op">=</span> <span class="st">"firebrick2"</span>,</span>
<span>    outlier.fill <span class="op">=</span> <span class="st">"firebrick2"</span>,</span>
<span>    outlier.size <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">Variable</span>,</span>
<span>                  scales <span class="op">=</span> <span class="st">"free"</span>,</span>
<span>                  nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                  ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="bobot-spasial" class="level3" data-number="11.3.6"><h3 data-number="11.3.6" class="anchored" data-anchor-id="bobot-spasial">
<span class="header-section-number">11.3.6</span> Bobot Spasial</h3>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Bobot Spasial</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">longlat</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#inverse weight matrix</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">D</span></span>
<span><span class="co"># inverse weight matrix - row-normalized</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">wmoran</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">w</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span>
<span><span class="co">#Uji Moran Indeks (Autokorelasi)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">Y</span>, <span class="va">wmoran</span>, zero.policy <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Moran I test under randomisation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dfix$Y  </span></span>
<span><span class="co">#&gt; weights: wmoran    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Moran I statistic standard deviate = 44, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: greater</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; Moran I statistic       Expectation          Variance </span></span>
<span><span class="co">#&gt;          2.76e-01         -1.95e-03          3.96e-05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="uji-asumsi" class="level3" data-number="11.3.7"><h3 data-number="11.3.7" class="anchored" data-anchor-id="uji-asumsi">
<span class="header-section-number">11.3.7</span> Uji Asumsi</h3>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Uji asumsi</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X5</span> <span class="op">+</span> <span class="va">X6</span> <span class="op">+</span> <span class="va">X7</span> <span class="op">+</span> <span class="va">X8</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    X1    X3    X5    X6    X7    X8 </span></span>
<span><span class="co">#&gt; 14.10  5.39  1.20  1.06  2.14  4.83</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Lilliefors (Kolmogorov-Smirnov) normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  residuals(lm(formula, data = dfix))</span></span>
<span><span class="co">#&gt; D = 0.08, p-value = 4e-09</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  lm(formula, data = dfix)</span></span>
<span><span class="co">#&gt; BP = 33, df = 6, p-value = 1e-05</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.morantest.html">lm.morantest</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">wmoran</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, zero.policy <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Global Moran I for regression residuals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = formula, data = dfix)</span></span>
<span><span class="co">#&gt; weights: wmoran</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Moran I statistic standard deviate = 9, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: two.sided</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; Observed Moran I      Expectation         Variance </span></span>
<span><span class="co">#&gt;         5.26e-02        -3.53e-03         3.65e-05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="histogram" class="level3" data-number="11.3.8"><h3 data-number="11.3.8" class="anchored" data-anchor-id="histogram">
<span class="header-section-number">11.3.8</span> Histogram</h3>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Histogram Normalitas Sebelum Transformasi</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">dfix</span><span class="op">$</span><span class="va">Y</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Histogram"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Y"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Histogram"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Residuals"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="identifikasi-model-spasial-dan-sebaran" class="level3" data-number="11.3.9"><h3 data-number="11.3.9" class="anchored" data-anchor-id="identifikasi-model-spasial-dan-sebaran">
<span class="header-section-number">11.3.9</span> Identifikasi Model Spasial dan Sebaran</h3>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#LM Test (Model Spasial)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.morantest.html">lm.morantest</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">wmoran</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span>, zero.policy <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Global Moran I for regression residuals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = formula, data = dfix)</span></span>
<span><span class="co">#&gt; weights: wmoran</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Moran I statistic standard deviate = 9, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: two.sided</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; Observed Moran I      Expectation         Variance </span></span>
<span><span class="co">#&gt;         5.26e-02        -3.53e-03         3.65e-05</span></span>
<span><span class="co">#Deteksi Sebaran</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/descdist.html">descdist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span><span class="op">)</span>, boot <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co">#&gt; summary statistics</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; min:  -35   max:  18.5 </span></span>
<span><span class="co">#&gt; median:  1.59 </span></span>
<span><span class="co">#&gt; mean:  5.22e-16 </span></span>
<span><span class="co">#&gt; estimated sd:  8.68 </span></span>
<span><span class="co">#&gt; estimated skewness:  -0.732 </span></span>
<span><span class="co">#&gt; estimated kurtosis:  3.51</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/fitdistrplus/man/descdist.html">descdist</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">Y</span>, boot <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span><span class="co">#&gt; summary statistics</span></span>
<span><span class="co">#&gt; ------</span></span>
<span><span class="co">#&gt; min:  15.7   max:  92.2 </span></span>
<span><span class="co">#&gt; median:  75.9 </span></span>
<span><span class="co">#&gt; mean:  71.8 </span></span>
<span><span class="co">#&gt; estimated sd:  14.5 </span></span>
<span><span class="co">#&gt; estimated skewness:  -1.75 </span></span>
<span><span class="co">#&gt; estimated kurtosis:  6.19</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="transformasi-dan-pemodelan" class="level3" data-number="11.3.10"><h3 data-number="11.3.10" class="anchored" data-anchor-id="transformasi-dan-pemodelan">
<span class="header-section-number">11.3.10</span> Transformasi dan Pemodelan</h3>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Find transformation D in SAL</span></span>
<span><span class="va">hasil2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  resid_ad <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  resid_ll <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  y_ad <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  y_ll <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ng2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/nongauss_y.html">nongauss_y</a></span><span class="op">(</span>y_nonneg <span class="op">=</span> <span class="cn">T</span>, tr_num <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span>  <span class="co">#ESF VC</span></span>
<span>  <span class="va">Y</span> <span class="op">=</span> <span class="va">dfix</span><span class="op">$</span><span class="va">Y</span></span>
<span>  <span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">X1</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X3</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X5</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X6</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X7</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">X</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">meig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/meigen.html">meigen</a></span><span class="op">(</span>cmat <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span>  <span class="va">resf_vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/resf_vc.html">resf_vc</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>    x <span class="op">=</span> <span class="va">X</span>,</span>
<span>    meig <span class="op">=</span> <span class="va">meig</span>,</span>
<span>    x_sel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    nongauss <span class="op">=</span> <span class="va">ng2</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">hasil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>      resid_ad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nortest/man/ad.test.html">ad.test</a></span><span class="op">(</span><span class="va">resf_vc</span><span class="op">$</span><span class="va">resid</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      resid_ll <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="va">resf_vc</span><span class="op">$</span><span class="va">resid</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      y_ad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nortest/man/ad.test.html">ad.test</a></span><span class="op">(</span><span class="va">resf_vc</span><span class="op">$</span><span class="va">tr_y</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      y_ll <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="va">resf_vc</span><span class="op">$</span><span class="va">tr_y</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">hasil2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">hasil2</span>, <span class="va">hasil</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hasil2</span></span>
<span><span class="co">#&gt;    resid_ad resid_ll     y_ad     y_ll</span></span>
<span><span class="co">#&gt; 1  0.00e+00 0.00e+00 0.00e+00 0.00e+00</span></span>
<span><span class="co">#&gt; 2  1.17e-01 4.07e-02 1.65e-11 1.97e-05</span></span>
<span><span class="co">#&gt; 3  2.75e-02 3.08e-02 3.05e-09 5.21e-04</span></span>
<span><span class="co">#&gt; 4  1.79e-02 4.23e-02 5.72e-09 1.06e-04</span></span>
<span><span class="co">#&gt; 5  5.03e-02 1.76e-02 5.94e-10 3.63e-04</span></span>
<span><span class="co">#&gt; 6  3.77e-02 1.80e-02 4.40e-11 8.89e-05</span></span>
<span><span class="co">#&gt; 7  7.44e-02 2.14e-02 3.63e-10 6.33e-04</span></span>
<span><span class="co">#&gt; 8  7.56e-02 2.44e-02 7.95e-11 9.45e-05</span></span>
<span><span class="co">#&gt; 9  1.44e-01 6.20e-02 1.47e-10 5.14e-05</span></span>
<span><span class="co">#&gt; 10 8.02e-02 2.70e-02 2.06e-10 5.48e-05</span></span>
<span><span class="co">#&gt; 11 9.49e-02 2.99e-02 8.77e-11 3.02e-05</span></span>
<span><span class="co">#&gt; 12 1.48e-01 8.63e-02 3.21e-10 4.73e-05</span></span>
<span><span class="co">#&gt; 13 7.06e-02 2.57e-02 2.11e-09 2.61e-04</span></span>
<span><span class="co">#&gt; 14 5.65e-02 2.81e-02 1.57e-08 1.08e-03</span></span>
<span><span class="co">#&gt; 15 9.54e-02 2.74e-02 1.66e-09 2.15e-04</span></span>
<span><span class="co">#&gt; 16 1.62e-02 4.77e-03 3.66e-12 1.69e-05</span></span>
<span><span class="co">#&gt; 17 1.57e-02 4.89e-03 1.67e-10 2.00e-04</span></span>
<span><span class="co">#&gt; 18 1.04e-02 5.44e-03 3.56e-13 5.39e-06</span></span>
<span><span class="co">#&gt; 19 1.98e-03 1.26e-03 3.32e-15 3.33e-06</span></span>
<span><span class="co">#&gt; 20 7.61e-05 1.44e-03 7.41e-16 9.10e-07</span></span>
<span><span class="co">#&gt; 21 3.80e-05 3.47e-05 1.00e-15 1.03e-06</span></span>
<span><span class="co">#&gt; 22 4.13e-05 3.73e-05 1.36e-15 1.22e-06</span></span>
<span><span class="co">#&gt; 23 6.01e-06 2.44e-04 3.70e-24 5.66e-11</span></span>
<span><span class="co">#&gt; 24 1.22e-06 5.01e-05 3.70e-24 1.72e-11</span></span>
<span><span class="co">#&gt; 25 1.36e-06 9.09e-05 3.70e-24 1.09e-11</span></span>
<span><span class="co">#&gt; 26 1.08e-06 4.51e-05 3.70e-24 1.23e-11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="model-esf-vc" class="level3" data-number="11.3.11"><h3 data-number="11.3.11" class="anchored" data-anchor-id="model-esf-vc">
<span class="header-section-number">11.3.11</span> Model ESF-VC</h3>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#RESF VC</span></span>
<span><span class="va">ng2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/nongauss_y.html">nongauss_y</a></span><span class="op">(</span>y_nonneg <span class="op">=</span> <span class="cn">T</span>, tr_num <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="va">dfix</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">X1</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X3</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X5</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X6</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X7</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">X</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">meig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/meigen.html">meigen</a></span><span class="op">(</span>cmat <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span><span class="co">#&gt;  149/513 eigen-pairs are extracted</span></span>
<span><span class="va">resf_vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/resf_vc.html">resf_vc</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  x <span class="op">=</span> <span class="va">X</span>,</span>
<span>  meig <span class="op">=</span> <span class="va">meig</span>,</span>
<span>  x_sel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nongauss <span class="op">=</span> <span class="va">ng2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 1  -------"</span></span>
<span><span class="co">#&gt; [1] "1/7"</span></span>
<span><span class="co">#&gt; [1] "2/7"</span></span>
<span><span class="co">#&gt; [1] "3/7"</span></span>
<span><span class="co">#&gt; [1] "4/7"</span></span>
<span><span class="co">#&gt; [1] "5/7"</span></span>
<span><span class="co">#&gt; [1] "6/7"</span></span>
<span><span class="co">#&gt; [1] "7/7"</span></span>
<span><span class="co">#&gt; [1] "BIC: 4300.264"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 2  -------"</span></span>
<span><span class="co">#&gt; [1] "1/7"</span></span>
<span><span class="co">#&gt; [1] "2/7"</span></span>
<span><span class="co">#&gt; [1] "3/7"</span></span>
<span><span class="co">#&gt; [1] "4/7"</span></span>
<span><span class="co">#&gt; [1] "5/7"</span></span>
<span><span class="co">#&gt; [1] "6/7"</span></span>
<span><span class="co">#&gt; [1] "7/7"</span></span>
<span><span class="co">#&gt; [1] "BIC: 4081.957"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 3  -------"</span></span>
<span><span class="co">#&gt; [1] "1/7"</span></span>
<span><span class="co">#&gt; [1] "2/7"</span></span>
<span><span class="co">#&gt; [1] "3/7"</span></span>
<span><span class="co">#&gt; [1] "4/7"</span></span>
<span><span class="co">#&gt; [1] "5/7"</span></span>
<span><span class="co">#&gt; [1] "6/7"</span></span>
<span><span class="co">#&gt; [1] "7/7"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3951.818"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 4  -------"</span></span>
<span><span class="co">#&gt; [1] "1/7"</span></span>
<span><span class="co">#&gt; [1] "2/7"</span></span>
<span><span class="co">#&gt; [1] "3/7"</span></span>
<span><span class="co">#&gt; [1] "4/7"</span></span>
<span><span class="co">#&gt; [1] "5/7"</span></span>
<span><span class="co">#&gt; [1] "6/7"</span></span>
<span><span class="co">#&gt; [1] "7/7"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3951.497"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 5  -------"</span></span>
<span><span class="co">#&gt; [1] "1/7"</span></span>
<span><span class="co">#&gt; [1] "2/7"</span></span>
<span><span class="co">#&gt; [1] "3/7"</span></span>
<span><span class="co">#&gt; [1] "4/7"</span></span>
<span><span class="co">#&gt; [1] "5/7"</span></span>
<span><span class="co">#&gt; [1] "6/7"</span></span>
<span><span class="co">#&gt; [1] "7/7"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3951.496"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 6  -------"</span></span>
<span><span class="co">#&gt; [1] "1/7"</span></span>
<span><span class="co">#&gt; [1] "2/7"</span></span>
<span><span class="co">#&gt; [1] "3/7"</span></span>
<span><span class="co">#&gt; [1] "4/7"</span></span>
<span><span class="co">#&gt; [1] "5/7"</span></span>
<span><span class="co">#&gt; [1] "6/7"</span></span>
<span><span class="co">#&gt; [1] "7/7"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3951.496"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Hasil RESF-VC</span></span>
<span><span class="va">resf_vc</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; resf_vc(y = Y, x = X, x_sel = FALSE, meig = meig, nongauss = ng2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Spatially varying coefficients on x (summary)----</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficient estimates:</span></span>
<span><span class="co">#&gt;   (Intercept)          V1              V2               V3        </span></span>
<span><span class="co">#&gt;  Min.   :-6.05   Min.   :0.132   Min.   :-0.314   Min.   :-0.161  </span></span>
<span><span class="co">#&gt;  1st Qu.:-6.05   1st Qu.:0.139   1st Qu.:-0.314   1st Qu.:-0.161  </span></span>
<span><span class="co">#&gt;  Median :-6.05   Median :0.140   Median :-0.314   Median :-0.161  </span></span>
<span><span class="co">#&gt;  Mean   :-6.05   Mean   :0.141   Mean   :-0.314   Mean   :-0.161  </span></span>
<span><span class="co">#&gt;  3rd Qu.:-6.05   3rd Qu.:0.143   3rd Qu.:-0.314   3rd Qu.:-0.161  </span></span>
<span><span class="co">#&gt;  Max.   :-6.05   Max.   :0.154   Max.   :-0.314   Max.   :-0.161  </span></span>
<span><span class="co">#&gt;        V4                 V5                V6           </span></span>
<span><span class="co">#&gt;  Min.   :2.54e-08   Min.   :-0.1004   Min.   :-5.87e-05  </span></span>
<span><span class="co">#&gt;  1st Qu.:2.54e-08   1st Qu.:-0.0343   1st Qu.:-5.87e-05  </span></span>
<span><span class="co">#&gt;  Median :2.54e-08   Median :-0.0293   Median :-5.87e-05  </span></span>
<span><span class="co">#&gt;  Mean   :2.54e-08   Mean   :-0.0288   Mean   :-5.87e-05  </span></span>
<span><span class="co">#&gt;  3rd Qu.:2.54e-08   3rd Qu.:-0.0227   3rd Qu.:-5.87e-05  </span></span>
<span><span class="co">#&gt;  Max.   :2.54e-08   Max.   : 0.0081   Max.   :-5.87e-05  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistical significance:</span></span>
<span><span class="co">#&gt;                         Intercept  V1  V2  V3  V4  V5  V6</span></span>
<span><span class="co">#&gt; Not significant                 0   0   0   0 513 161   0</span></span>
<span><span class="co">#&gt; Significant (10% level)         0   0   0   0   0  46   0</span></span>
<span><span class="co">#&gt; Significant ( 5% level)         0   0   0   0   0  88 513</span></span>
<span><span class="co">#&gt; Significant ( 1% level)       513 513 513 513   0 218   0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Variance parameters----------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spatial effects (coefficients on x):</span></span>
<span><span class="co">#&gt;                      (Intercept)      V1       V2       V3       V4</span></span>
<span><span class="co">#&gt; random_SD               1.77e-06 0.00251 3.20e-06 8.48e-05 3.91e-10</span></span>
<span><span class="co">#&gt; Moran.I/max(Moran.I)    4.80e-02 0.12381 9.92e-01 8.26e-01 9.96e-01</span></span>
<span><span class="co">#&gt;                          V5       V6</span></span>
<span><span class="co">#&gt; random_SD            0.0131 2.54e-08</span></span>
<span><span class="co">#&gt; Moran.I/max(Moran.I) 0.2718 9.99e-01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Estimated probability distribution of y--------------</span></span>
<span><span class="co">#&gt;                 Estimates</span></span>
<span><span class="co">#&gt; skewness           -1.080</span></span>
<span><span class="co">#&gt; excess kurtosis     0.638</span></span>
<span><span class="co">#&gt; (Box-Cox parameter: 1.013173)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Error statistics-------------------------------------</span></span>
<span><span class="co">#&gt;                      stat</span></span>
<span><span class="co">#&gt; resid_SE(trans)     0.506</span></span>
<span><span class="co">#&gt; adjR2(cond)         0.701</span></span>
<span><span class="co">#&gt; rlogLik         -1732.377</span></span>
<span><span class="co">#&gt; AIC              3620.755</span></span>
<span><span class="co">#&gt; BIC              3951.496</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; NULL model: lm( y ~ x )</span></span>
<span><span class="co">#&gt;    (r)loglik: -1836.147 ( AIC: 3688.294,  BIC: 3722.216 )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note: AIC and BIC are based on the restricted/marginal likelihood.</span></span>
<span><span class="co">#&gt;       Use method="ml" for comparison of models with different fixed effects (x and xconst)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="hitogram-setelah-transformasi" class="level3" data-number="11.3.12"><h3 data-number="11.3.12" class="anchored" data-anchor-id="hitogram-setelah-transformasi">
<span class="header-section-number">11.3.12</span> Hitogram Setelah Transformasi</h3>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Histogram sesudah transformasi</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">resf_vc</span><span class="op">$</span><span class="va">tr_y</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Histogram"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Y"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="va">resf_vc</span><span class="op">$</span><span class="va">tr_y</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Lilliefors (Kolmogorov-Smirnov) normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  resf_vc$tr_y</span></span>
<span><span class="co">#&gt; D = 0.05, p-value = 0.001</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">resf_vc</span><span class="op">$</span><span class="va">resid</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Histogram"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Residuals"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/nortest/man/lillie.test.html">lillie.test</a></span><span class="op">(</span><span class="va">resf_vc</span><span class="op">$</span><span class="va">resid</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Lilliefors (Kolmogorov-Smirnov) normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  resf_vc$resid</span></span>
<span><span class="co">#&gt; D = 0.04, p-value = 0.02</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="peta-signifikansi-peubah-varying-coefficient" class="level3" data-number="11.3.13"><h3 data-number="11.3.13" class="anchored" data-anchor-id="peta-signifikansi-peubah-varying-coefficient">
<span class="header-section-number">11.3.13</span> Peta Signifikansi Peubah Varying Coefficient</h3>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Peta Signifikansi Variabel</span></span>
<span><span class="va">data_p</span> <span class="op">&lt;-</span> <span class="va">resf_vc</span><span class="op">$</span><span class="va">p_vc</span></span>
<span><span class="va">data_p</span><span class="op">$</span><span class="va">kX1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_p</span><span class="op">$</span><span class="va">V1</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X1"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">data_p</span><span class="op">$</span><span class="va">kX2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_p</span><span class="op">$</span><span class="va">V2</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X2"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">data_p</span><span class="op">$</span><span class="va">kX3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_p</span><span class="op">$</span><span class="va">V3</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X3"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">data_p</span><span class="op">$</span><span class="va">kX4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_p</span><span class="op">$</span><span class="va">V4</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X4"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">data_p</span><span class="op">$</span><span class="va">kX5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_p</span><span class="op">$</span><span class="va">V5</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X5"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">data_p</span><span class="op">$</span><span class="va">kX6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">data_p</span><span class="op">$</span><span class="va">V6</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X6"</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">data_p2</span> <span class="op">&lt;-</span> <span class="va">data_p</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"kX1"</span>, <span class="st">"kX2"</span>, <span class="st">"kX3"</span>, <span class="st">"kX4"</span>, <span class="st">"kX5"</span>, <span class="st">"kX6"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data_p</span><span class="op">$</span><span class="va">Sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">data_p2</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">data_p2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">filtered_values</span> <span class="op">&lt;-</span> <span class="va">data_p2</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">data_p2</span><span class="op">)</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">filtered_values</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data_p</span><span class="op">$</span><span class="va">Sig</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; X1, X2, X3, X5, X6     X1, X2, X3, X6 </span></span>
<span><span class="co">#&gt;                306                207</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dfix</span><span class="op">$</span><span class="va">Signifikansi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">data_p</span><span class="op">$</span><span class="va">Sig</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Signifikansi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Signifikansi Peubah Model RE-ESF VC"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Variabel"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                  <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                 <span class="fl">12</span><span class="op">)</span>,</span>
<span>    legend.key.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="st">'npc'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="peta-koefisien" class="level3" data-number="11.3.14"><h3 data-number="11.3.14" class="anchored" data-anchor-id="peta-koefisien">
<span class="header-section-number">11.3.14</span> Peta Koefisien</h3>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Peta Koefisien Beta</span></span>
<span><span class="va">data_b</span><span class="op">&lt;-</span><span class="va">resf_vc</span><span class="op">$</span><span class="va">b_vc</span></span>
<span><span class="va">dfix</span><span class="op">$</span><span class="va">bX1</span><span class="op">&lt;-</span><span class="va">data_b</span><span class="op">$</span><span class="va">V1</span></span>
<span><span class="va">dfix</span><span class="op">$</span><span class="va">bX2</span><span class="op">&lt;-</span><span class="va">data_b</span><span class="op">$</span><span class="va">V2</span></span>
<span><span class="va">dfix</span><span class="op">$</span><span class="va">bX3</span><span class="op">&lt;-</span><span class="va">data_b</span><span class="op">$</span><span class="va">V3</span></span>
<span><span class="va">dfix</span><span class="op">$</span><span class="va">bX4</span><span class="op">&lt;-</span><span class="va">data_b</span><span class="op">$</span><span class="va">V4</span></span>
<span><span class="va">dfix</span><span class="op">$</span><span class="va">bX5</span><span class="op">&lt;-</span><span class="va">data_b</span><span class="op">$</span><span class="va">V5</span></span>
<span><span class="va">dfix</span><span class="op">$</span><span class="va">bX6</span><span class="op">&lt;-</span><span class="va">data_b</span><span class="op">$</span><span class="va">V6</span></span>
<span></span>
<span><span class="co"># X1</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">bX1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">bold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Koefisien "</span>,  <span class="op">~</span> <span class="va">beta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">" (Persentase Penduduk Miskin)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, palette <span class="op">=</span> <span class="st">"Emrld"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Nilai"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                  <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                 <span class="fl">16</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.32</span>, <span class="st">'npc'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># X2</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">bX2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">bold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Koefisien "</span>, <span class="va">beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">" (Pengeluaran Per Kapita)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, palette <span class="op">=</span> <span class="st">"Emrld"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Nilai"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                  <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                 <span class="fl">16</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="st">'npc'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># X3</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">bX3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">bold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Koefisien "</span>, <span class="va">beta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="st">" (Umur Harapan Hidup)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, palette <span class="op">=</span> <span class="st">"Emrld"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Nilai"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                  <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                 <span class="fl">16</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="st">'npc'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># X4</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">bX4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">bold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span></span>
<span>      <span class="st">"Koefisien "</span>,</span>
<span>      <span class="va">beta</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>      <span class="st">" (Rata - Rata Lama Sekolah Penduduk 15 Tahun Keatas)"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, palette <span class="op">=</span> <span class="st">"Emrld"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Nilai"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                  <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                 <span class="fl">16</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="st">'npc'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># X5</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">bX5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">bold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Koefisien "</span>, <span class="va">beta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="st">" (Persentase Akses Sanitasi Layak)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, palette <span class="op">=</span> <span class="st">"Emrld"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Nilai"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                  <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                 <span class="fl">16</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="st">'npc'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># X6</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">bX6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu">bold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Koefisien "</span>, <span class="va">beta</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="st">" (Akses Terhadap Air Minum)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.colors</a></span><span class="op">(</span><span class="fl">5</span>, palette <span class="op">=</span> <span class="st">"Emrld"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">bX6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Nilai"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                  <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span></span>
<span>                                 <span class="fl">16</span><span class="op">)</span>,</span>
<span>    legend.key.height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="st">'npc'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="11-ModelKeragamanSpasial_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Koefisien Marginal</span></span>
<span><span class="va">me</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/coef_marginal_vc.html">coef_marginal_vc</a></span><span class="op">(</span><span class="va">resf_vc</span><span class="op">)</span></span>
<span><span class="va">me</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; coef_marginal_vc(mod = resf_vc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Marginal effects from x (dy_i/dx_i) (summary)----</span></span>
<span><span class="co">#&gt;  (Intercept)          V1             V2              V3       </span></span>
<span><span class="co">#&gt;  Mode:logical   Min.   :0.68   Min.   :-7.85   Min.   :-4.02  </span></span>
<span><span class="co">#&gt;  NA's:513       1st Qu.:1.05   1st Qu.:-5.42   1st Qu.:-2.78  </span></span>
<span><span class="co">#&gt;                 Median :1.50   Median :-3.36   Median :-1.72  </span></span>
<span><span class="co">#&gt;                 Mean   :1.77   Mean   :-3.97   Mean   :-2.03  </span></span>
<span><span class="co">#&gt;                 3rd Qu.:2.42   3rd Qu.:-2.31   3rd Qu.:-1.18  </span></span>
<span><span class="co">#&gt;                 Max.   :3.57   Max.   :-1.44   Max.   :-0.74  </span></span>
<span><span class="co">#&gt;        V4                 V5               V6           </span></span>
<span><span class="co">#&gt;  Min.   :1.16e-07   Min.   :-1.266   Min.   :-0.001468  </span></span>
<span><span class="co">#&gt;  1st Qu.:1.87e-07   1st Qu.:-0.610   1st Qu.:-0.001014  </span></span>
<span><span class="co">#&gt;  Median :2.71e-07   Median :-0.307   Median :-0.000628  </span></span>
<span><span class="co">#&gt;  Mean   :3.21e-07   Mean   :-0.388   Mean   :-0.000743  </span></span>
<span><span class="co">#&gt;  3rd Qu.:4.38e-07   3rd Qu.:-0.173   3rd Qu.:-0.000433  </span></span>
<span><span class="co">#&gt;  Max.   :6.34e-07   Max.   : 0.136   Max.   :-0.000269  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Note: Medians are recommended summary statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-djuraidah2020" class="csl-entry" role="listitem">
Djuraidah, Anik. 2020. <em>Monograph Penerapan Dan Pengembangan Regresi Spasial Dengan Studi Kasus Pada Kesehatan and Sosial Dan Ekonomi</em>. Ed ke-1. Bogor, Jawa Barat: IPB Press.
</div>
<div id="ref-dray2006" class="csl-entry" role="listitem">
Dray, Stéphane, Pierre Legendre, and Pedro R Peres-Neto. 2006. <span>“Spatial Modelling: A Comprehensive Framework for Principal Coordinate Analysis of Neighbour Matrices (PCNM).”</span> <em>Ecological Modelling</em> 196 (3-4): 483–93.
</div>
<div id="ref-griffith2003" class="csl-entry" role="listitem">
Griffith, Daniel A. 2003. <em>Spatial Autocorrelation and Spatial Filtering: Gaining Understanding Through Theory and Scientific Visualization</em>. Berlin: Springer.
</div>
<div id="ref-hadi2007" class="csl-entry" role="listitem">
Hadi, Alfian Futuhul, Halimatus Sa’diyah, and I Sumertajaya. 2007. <span>“Penanganan Ketaknormalan Data Pada Model AMMI Dengan Transformasi Box-Cox (Data Non-Normality on AMMI Models: Box-Cox Transformations).”</span> <em>J ILMU DASAR</em> 8 (2): 165–74.
</div>
<div id="ref-huang2010" class="csl-entry" role="listitem">
Huang, Bo, Bo Wu, and Michael Barry. 2010. <span>“Geographically and Temporally Weighted Regression for Modeling Spatio-Temporal Variation in House Prices.”</span> <em>International Journal of Geographical Information Science</em> 24 (3): 383–401. <a href="https://doi.org/10.1080/13658810802672469">https://doi.org/10.1080/13658810802672469</a>.
</div>
<div id="ref-murakami2017" class="csl-entry" role="listitem">
Murakami, Daisuke. 2017. <span>“Spmoran: An r Package for Moran’s Eigenvector-Based Spatial Regression Analysis.”</span> <em>arXiv Preprint arXiv:1703.04467</em>.
</div>
<div id="ref-johnsonNL1949" class="csl-entry" role="listitem">
NL, Johnson. 1949. <span>“Systems of Frequency Curves Generated by Methods of Translation.”</span> <em>Biometrika</em> 36 (1/2): 149–76.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/statistika-spasial\.github\.io\/book");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./10-ModelDependensiSpasial.html" class="pagination-link" aria-label="Model Dependensi Spasial">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ModelEpidemiologi.html" class="pagination-link" aria-label="Model Epidemiologi">
        <span class="nav-page-text">Model Epidemiologi</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb26" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model Keragaman Spasial  {#sec-keragaman-spasial}</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deskripsi</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regresi Terboboti Geografis</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>Regresi Terboboti Geografis (RTG) merupakan pengembangan dari kerangka model regresi klasik yang menghasilkan penduga koefisien regresi yang bervariasi untuk setiap lokasi. Semakin jauh suatu lokasi dari lokasi yang diduga model regresinya, semakin rendah bobot untuk data pada lokasi tersebut <span class="co">[</span><span class="ot">@djuraidah2020</span><span class="co">]</span>. Model RTG dituliskan sebagai berikut <span class="co">[</span><span class="ot">@huang2010</span><span class="co">]</span>:</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>y_i = \beta_0 (u_i v_i) + \sum_{k=1}^{p} \beta_k (u_i v_i) x_{ik} + \epsilon_i</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1101}</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>dimana:</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>y_i &amp;: \text{nilai pengamatan peubah respon untuk lokasi ke-i} <span class="sc">\\</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>(u_i v_i) &amp;: \text{identifikasi lokasi dari titik ke-i pada suatu lokasi geografis} <span class="sc">\\</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>\beta_0 (u_i v_i) &amp;: \text{intersep pada lokasi pengamatan ke-i} <span class="sc">\\</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>\beta_k (u_i v_i) &amp;: \text{koefisien regresi peubah penjelas ke-k pada lokasi ke-i} <span class="sc">\\</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>x_{ik} &amp;: \text{nilai pengamatan peubah penjelas ke-k pada lokasi ke-i} <span class="sc">\\</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>\epsilon_i &amp;: \text{nilai galat regresi antara peubah penjelas dengan peubah respon di lokasi ke-i} </span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>@djuraidah2020 menyatakan parameter koefisien regresi $\beta_k (u_i v_i)$ diduga dengan menggunakan metode Kuadrat Terkecil Terboboti, sehingga pendugaan koefisien regresi $\hat{\beta}(u_i v_i)$ dituliskan sebagai berikut:</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>\hat{\beta}(u_i v_i) = <span class="co">[</span><span class="ot">X'W(u_i v_i)X</span><span class="co">]</span>^{-1} X' W(u_i v_i) y</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1102}</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>dimana $W(u_i v_i)$ adalah matriks $n \times n$ yang merupakan matriks pembobot spasial lokasi ke-$i$ dengan nilai unsur-unsur diagonalnya ditentukan oleh jarak antar lokasi pengamatan ke-$i$ dengan lokasi lainnya.</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="fu">### Moran Eigenvectors</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>Vektor eigen moral (MEs) $<span class="sc">\{</span>e_1,…,e_L<span class="sc">\}</span>$ adalah vektor eigen yang diekstraksi dari dua kali lipat matriks kedekatan spasial terpusat di mana $e_1$ adalah ME yang sesuai dengan nilai eigen terbesar $\lambda_1$, $e_2$ adalah ME yang sesuai dengan nilai eigen terbesar kedua $\lambda_2$, dan seterusnya. MEs dapat diinterpretasikan dalam bentuk koefisien moran (MC; atau Moran I), yang merupakan statistik diagnostik ketergantungan spasial yang menunjukkan nilai positif yang lebih besar dengan adanya ketergantungan spasial positif yang lebih kuat.</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>Moran Coefficienct (MC) mengkuantifikasi ketergantungan spasial dalam $y$, yaitu $n \times 1$ vektor variabel respon menggunakan persamaan berikut:</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>MC<span class="co">[</span><span class="ot">y</span><span class="co">]</span> = \frac{n}{1' C1} \frac{(y' MCMy)}{(y' My)} </span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1103}</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>Di mana “$'$” menunjukan matrix transpose, 1 adalah $n \times 1$ vektor satuan. $M = I-11'/n$ adalah $n \times n$ matriks pemusatan, di mana $I$ adalah matriks identitas, dan $C$ adalah konektivitas simetris $n \times n$ matriks yang entri diagonalnya 0 <span class="co">[</span><span class="ot">@dray2006</span><span class="co">]</span>.</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>Akan dilakukan dekomposisi eigen matriks MCM menjadi $E_{\text{full}} \Lambda_{\text{full}} E_{\text{full}}'$, di mana $E_{\text{full}}$ adalah $n \times n$ matriks yang kolom ke-$l$, sama dengan vektor eigen ke-$l$. MC ditunjukkan sebagai berikut:</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>MC<span class="co">[</span><span class="ot">e_l</span><span class="co">]</span> = \frac{n}{1' C1} \frac{(e_l' MCMe_l)}{(e_l' Me_l)} = \frac{n}{1' C1} \frac{(e_l' E_{\text{full}} \Lambda_{\text{full}} E_{\text{full}}')}{(e_l' e_l)} = \frac{n}{1' C1} \lambda_l</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1104}</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>Persamaan di atas menunjukkan bahwa vektor eigen dapat diinterpretasikan dalam bentuk MC. Secara khusus, vektor eigen ke-1, $e_1$ adalah himpunan bilangan real yang mempunyai nilai MC terbesar yang dapat dicapai dengan himpunan bilangan real apa pun untuk struktur spasial yang ditentukan oleh $C$; $e_2$ adalah himpunan bilangan real yang mempunyai nilai MC terbesar yang dapat dicapai oleh himpunan mana pun yang ortogonal dan tidak berkolerasi dengan $e_1$, dan seterusnya hingga vektor eigen ke-$l$. Jadi, $E_{\text{full}}=<span class="sc">\{</span>e_1,…,e_n<span class="sc">\}</span>$ menyediakan semua kemungkinan perbedaan deskripsi pola peta ketergantungan spasial laten dengan setiap besaran indeks melalui nilai yang sesuai di $<span class="sc">\{</span>\lambda_1,…,\lambda_n<span class="sc">\}</span>$ <span class="co">[</span><span class="ot">@griffith2003</span><span class="co">]</span>.</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pendekatan Regresi Terboboti Geografis Menggunakan Eigenvector Spatial Filtering (ESF)</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>Pendekatan RTG dapat ditingkatkan dengan memasukkan penyaringan spasial berbasis eigenvector. Ini melibatkan penggunaan kombinasi linear dari eigenvector untuk menangkap asosiasi spasial lokal dan menjelaskan autokorelasi spasial dalam $y_i$ (Griffith, 2008). Salah satu pendekatan yang sering digunakan dalam konteks ini adalah Eigenvector Spatial Filtering (ESF), yang juga disebut koordinat utama matriks ketetanggaan <span class="co">[</span><span class="ot">@dray2006</span><span class="co">]</span>.</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>ESF didasarkan pada koefisien Moran (MC) dan mampu memetakan vektor ciri spasial untuk mengidentifikasi dan mengukur struktur spasial dalam data. Dengan mengintegrasikan konsep ESF ke dalam pendekatan RTG, model tersebut menjadi lebih efektif dalam memahami dan menggambarkan pola hubungan spasial antar peubah yang diamati. Model ESF Varying Coefficient (VC) dikembangkan berdasarkan model GWR dan Fixed Effect ESF:</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>y_i = (\beta_0 + \sum_{k_0=1}^{K_0} E_{ik_0} \gamma_{k_0}) + \sum_{p=1}^{P} (\beta_p + \sum_{k_p=1}^{K_p} E_{ik_p} \gamma_{k_p}) X_{ip} + \epsilon_i</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1105}</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>yang juga dapat ditulis sebagai:</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>y = \sum_{p=1}^{P} x_p \odot \beta_p^{ESF} + \epsilon</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1106}</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>dimana:</span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>$\beta_p^{ESF} = \beta_p + E_p \gamma_p$ dengan $\epsilon \sim N(0, \sigma^2 I)$</span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Effect Eigenvector Spatial Filtering Varying Coefficient (RE-ESF VC)</span></span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>Model Fixed Effect ESF-VC pada awalnya fokus pada penggunaan eigenvector spatial filtering untuk mengendalikan dan mengeksplorasi efek tetap yang terkait dengan variabilitas spasial dalam data. Namun, perkembangan terbaru telah melihat konsep ini dikembangkan menjadi model Random Effect ESF-VC, di mana pendekatan ini tidak hanya mempertimbangkan efek tetap, tetapi juga mampu menangkap variasi acak yang mungkin ada dalam struktur spasial data tersebut. Model RE ESF-VC menurut <span class="co">[</span><span class="ot">@murakami2017</span><span class="co">]</span> sebagai berikut:</span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>y = \sum_{k=1}^{K} x_k \beta_K^{(RE-ESF)} + \epsilon, \quad \epsilon \sim N(0,\sigma^2 I)</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1107}</span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>\beta_K^{(RE-ESF)} = \beta_k 1 + E_k \gamma_k, \quad \gamma_k \sim N(0_L,\sigma_{(\gamma,k)}^2 \Lambda_{(\alpha k)})</span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>Di mana $0_L$ adalah vektor nol berukuran $L \times 1$, sedangkan $E$ adalah matriks vektor eigen sepanjang $L$ yang sesuai dengan eigenvalues positif. Dari persamaan sebelumnya, dibuat model lanjutan seperti berikut:</span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>y = X\beta + \tilde{E} \tilde{\Lambda}(\theta) \tilde{u} + \epsilon, \quad \epsilon \sim N(0,\sigma^2 I)</span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1108}</span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>$\tilde{E} = <span class="co">[</span><span class="ot">x_1 \quad E \ldots X_K \quad E</span><span class="co">]</span>$</span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a>Persamaan di atas menunjukkan bahwa model RE-ESF adalah model dengan efek campuran linier. Selain itu, $\beta$ dan $\tilde{u}$ memiliki estimasi linier terbaik tanpa bias sebagai berikut:</span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix} \hat{\beta} <span class="sc">\\</span> \hat{u} \end{bmatrix} = \left<span class="co">[</span><span class="ot"> \begin{array}{cc} X'X &amp; X'\tilde{E}\tilde{\Lambda}(\theta) \\ \tilde{\Lambda}(\theta)(\tilde{E'})X &amp; \tilde{\Lambda}(\theta)(\tilde{E'})\tilde{E}\tilde{\Lambda}(\theta) + I_{KL} \end{array} \right</span><span class="co">]</span>^{-1} \begin{bmatrix} Xy' <span class="sc">\\</span> \tilde{\Lambda}(\theta) \tilde{E}y' \end{bmatrix} </span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a>Ketika $\theta$ diestimasi secara numerik dengan maksimisasi.</span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transformasi Box-Cox</span></span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a>Draper &amp; Smith (1992) menyatakan bahwa transformasi Box-Cox adalah transformasi pangkat pada variabel respons yang dikembangkan oleh Box dan Cox. Transformasi ini bertujuan memenuhi ketiga asumsi model linier, yaitu keheterogenan ragam, ketaknormalan galat, dan keaditifan/ketaklinieran pengaruh sistematik. Box-Cox menggunakan kriteria yang menggabungkan tujuan memperoleh model yang sederhana dan ragam yang homogen pada satu sisi serta tujuan kenormalan data pada sisi lain.</span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a>Transformasi Box-Cox hanya diberlakukan pada variabel respons $Y$ yang bernilai positif. Prosedur utama yang dilakukan pada Transformasi Box-Cox adalah menduga parameter $\lambda$. Dengan mengetahui nilai $\lambda$ pada pengolahan data, kita dapat mengetahui nilai dari transformasi yang digunakan pada model. Pada Tabel, disajikan nilai $\lambda$ dan transformasinya.</span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a>| $\lambda$ | Transformasi |</span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a>|:-----------:|:------------:|</span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>|     2       |     $Y^2$      |</span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>|     1       |     $Y^1$      |</span>
<span id="cb26-121"><a href="#cb26-121" aria-hidden="true" tabindex="-1"></a>|    0.5      |   $\sqrt{Y}$  |</span>
<span id="cb26-122"><a href="#cb26-122" aria-hidden="true" tabindex="-1"></a>|     0       |    $\ln(Y)$   |</span>
<span id="cb26-123"><a href="#cb26-123" aria-hidden="true" tabindex="-1"></a>|    -0.5     |   $\frac{1}{\sqrt{Y}}$  |</span>
<span id="cb26-124"><a href="#cb26-124" aria-hidden="true" tabindex="-1"></a>|    -1       |   $\frac{1}{Y}$  |</span>
<span id="cb26-125"><a href="#cb26-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-126"><a href="#cb26-126" aria-hidden="true" tabindex="-1"></a>Dengan menggunakan transformasi Box-Cox akan diperoleh sebaran yang simetrik mendekati Normal. Ketakhomogenan ragam pun dapat dikurangi dengan transformasi ini <span class="co">[</span><span class="ot">@hadi2007</span><span class="co">]</span>.</span>
<span id="cb26-127"><a href="#cb26-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-128"><a href="#cb26-128" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transformasi SAL</span></span>
<span id="cb26-129"><a href="#cb26-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-130"><a href="#cb26-130" aria-hidden="true" tabindex="-1"></a>Transformasi SAL (SinhArcsinh dan Affine Linear) adalah teknik yang digunakan dalam statistika untuk memodifikasi distribusi data sehingga lebih mendekati distribusi normal atau Gaussian. Transformasi ini berguna ketika data tidak memenuhi asumsi kenormalan yang diperlukan dalam banyak analisis statistik. Rois dan Tober (2019) menjelaskan iterasi transformasi SAL mendekati berbagai macam distribusi non-Gaussian tanpa mengasumsikan distribusi data secara eksplisit.</span>
<span id="cb26-131"><a href="#cb26-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-132"><a href="#cb26-132" aria-hidden="true" tabindex="-1"></a>Lebih lanjut, persamaan SinhArcsinh disajikan sebagai berikut:</span>
<span id="cb26-133"><a href="#cb26-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-134"><a href="#cb26-134" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-135"><a href="#cb26-135" aria-hidden="true" tabindex="-1"></a>\varphi_{\text{arcsinh}}(y) = a + b \text{arcsinh} \left( \frac{y-c}{d} \right) </span>
<span id="cb26-136"><a href="#cb26-136" aria-hidden="true" tabindex="-1"></a>$$ {#eq-sinharcsinh}</span>
<span id="cb26-137"><a href="#cb26-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-138"><a href="#cb26-138" aria-hidden="true" tabindex="-1"></a>Di mana $a, c \in \mathbb{R}^+$ dan $b, d \in \mathbb{R}^+$, biasa disebut dengan distribusi Johnson <span class="co">[</span><span class="ot">@johnsonNL1949</span><span class="co">]</span>. Adapun untuk persamaan Affine sebagai berikut:</span>
<span id="cb26-139"><a href="#cb26-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-140"><a href="#cb26-140" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-141"><a href="#cb26-141" aria-hidden="true" tabindex="-1"></a>\varphi_{\text{affine}}(y) = a + by, \quad a, b \in \mathbb{R}</span>
<span id="cb26-142"><a href="#cb26-142" aria-hidden="true" tabindex="-1"></a>$$ {#eq-affine}</span>
<span id="cb26-143"><a href="#cb26-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-144"><a href="#cb26-144" aria-hidden="true" tabindex="-1"></a>Sehingga persamaan transformasi SAL adalah:</span>
<span id="cb26-145"><a href="#cb26-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-146"><a href="#cb26-146" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb26-147"><a href="#cb26-147" aria-hidden="true" tabindex="-1"></a>l(y) = a + b \sinh(c \text{arsinh}(y) - d)</span>
<span id="cb26-148"><a href="#cb26-148" aria-hidden="true" tabindex="-1"></a>$$ {#eq-sal}</span>
<span id="cb26-149"><a href="#cb26-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-150"><a href="#cb26-150" aria-hidden="true" tabindex="-1"></a>Di mana $a, b, c, d \in \mathbb{R}$.</span>
<span id="cb26-151"><a href="#cb26-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-152"><a href="#cb26-152" aria-hidden="true" tabindex="-1"></a>Melalui penerapan transformasi SAL yang mengombinasikan metode SinhArcsinh dan Affine Linear, dapat membantu mengubah distribusi data yang awalnya tidak normal menjadi lebih mendekati distribusi normal.</span>
<span id="cb26-153"><a href="#cb26-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-154"><a href="#cb26-154" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data</span></span>
<span id="cb26-155"><a href="#cb26-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-156"><a href="#cb26-156" aria-hidden="true" tabindex="-1"></a>Data yang digunakan berasal dari Badan Pusat Statistik (BPS) pada tahun 2021 dengan observasi sebanyak 514 kabupaten/kota di Indonesia. Tabel berikut menunjukkan deskripsi peubah yang akan digunakan.</span>
<span id="cb26-157"><a href="#cb26-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-158"><a href="#cb26-158" aria-hidden="true" tabindex="-1"></a>| Peubah | Deskripsi                                                  | Satuan                        | Tipe    |</span>
<span id="cb26-159"><a href="#cb26-159" aria-hidden="true" tabindex="-1"></a>|--------|------------------------------------------------------------|-------------------------------|---------|</span>
<span id="cb26-160"><a href="#cb26-160" aria-hidden="true" tabindex="-1"></a>| Y      | Indeks Ketahanan Pangan                                    | -                             | Numerik |</span>
<span id="cb26-161"><a href="#cb26-161" aria-hidden="true" tabindex="-1"></a>| X1     | Persentase penduduk miskin (P0) menurut kabupaten/kota    | Persen                        | Numerik |</span>
<span id="cb26-162"><a href="#cb26-162" aria-hidden="true" tabindex="-1"></a>| X2     | Pengeluaran per kapita disesuaikan                         | Ribu Rupiah/Orang/Tahun      | Numerik |</span>
<span id="cb26-163"><a href="#cb26-163" aria-hidden="true" tabindex="-1"></a>| X3     | Umur harapan hidup                                         | Tahun                         | Numerik |</span>
<span id="cb26-164"><a href="#cb26-164" aria-hidden="true" tabindex="-1"></a>| X4     | Rata-rata lama sekolah penduduk umur 15 tahun ke atas     | Tahun                         | Numerik |</span>
<span id="cb26-165"><a href="#cb26-165" aria-hidden="true" tabindex="-1"></a>| X5     | Persentase rumah tangga yang memiliki akses terhadap sanitasi layak | Persen             | Numerik |</span>
<span id="cb26-166"><a href="#cb26-166" aria-hidden="true" tabindex="-1"></a>| X6     | Persentase rumah tangga yang memiliki akses terhadap air minum | Persen                   | Numerik |</span>
<span id="cb26-167"><a href="#cb26-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-168"><a href="#cb26-168" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tahapan Analisis Data</span></span>
<span id="cb26-169"><a href="#cb26-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-170"><a href="#cb26-170" aria-hidden="true" tabindex="-1"></a>Berikut adalah langkah prosedur analisis yang dilakukan:</span>
<span id="cb26-171"><a href="#cb26-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-172"><a href="#cb26-172" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Eksplorasi data berupa interpretasi pola persebaran Indeks Ketahanan Pangan di Indonesia dan boxplot dari peubah yang digunakan.</span>
<span id="cb26-173"><a href="#cb26-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-174"><a href="#cb26-174" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Pemodelan regresi antara Indeks Ketahanan Pangan terhadap enam peubah penjelas.</span>
<span id="cb26-175"><a href="#cb26-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-176"><a href="#cb26-176" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Pengujian asumsi, yaitu: </span>
<span id="cb26-177"><a href="#cb26-177" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Uji normalitas sisaan regresi dengan Uji Liliefors,</span>
<span id="cb26-178"><a href="#cb26-178" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Uji heterogenitas regresi dengan Uji Breusch-Pagan,</span>
<span id="cb26-179"><a href="#cb26-179" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Uji multikolinearitas antar peubah penjelas dengan nilai VIF,</span>
<span id="cb26-180"><a href="#cb26-180" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Uji autokorelasi spasial data dengan Indeks Moran, serta</span>
<span id="cb26-181"><a href="#cb26-181" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Uji autokorelasi spasial sisaan regresi dengan Global Moran.</span>
<span id="cb26-182"><a href="#cb26-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-183"><a href="#cb26-183" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Penerapan transformasi Box-Cox dan SAL transformation dengan iterasi sebanyak D kali.</span>
<span id="cb26-184"><a href="#cb26-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-185"><a href="#cb26-185" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Pemodelan dengan **Random Effect Eigenvector Spatial Filtering Varying Coefficient** (RE-ESF VC).</span>
<span id="cb26-186"><a href="#cb26-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-187"><a href="#cb26-187" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Interpretasi hasil analisis model RE-ESF VC dengan melihat pola persebaran masing-masing peubah penjelas di Indonesia dan melihat peubah yang signifikan pada kabupaten/kota di Indonesia.</span>
<span id="cb26-188"><a href="#cb26-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-189"><a href="#cb26-189" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Interpretasi hasil estimasi efek marginal dan efek spasial dari model RE-ESF VC.</span>
<span id="cb26-190"><a href="#cb26-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-191"><a href="#cb26-191" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Membandingkan kinerja hasil dari model regresi dan RE-ESF VC dengan nilai residual SE, AIC, BIC, dan adjusted $R^2$.</span>
<span id="cb26-192"><a href="#cb26-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-193"><a href="#cb26-193" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tahapan Analisis Data dengan R</span></span>
<span id="cb26-194"><a href="#cb26-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-195"><a href="#cb26-195" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package</span></span>
<span id="cb26-196"><a href="#cb26-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-197"><a href="#cb26-197" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cache=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb26-198"><a href="#cb26-198" aria-hidden="true" tabindex="-1"></a><span class="in">library(spdep) # Untuk pemodelan dependensi spasial </span></span>
<span id="cb26-199"><a href="#cb26-199" aria-hidden="true" tabindex="-1"></a><span class="in">library(spatialreg) # Untuk pemodelan dependensi spasial </span></span>
<span id="cb26-200"><a href="#cb26-200" aria-hidden="true" tabindex="-1"></a><span class="in">library(stats) # Untuk operasi matematis </span></span>
<span id="cb26-201"><a href="#cb26-201" aria-hidden="true" tabindex="-1"></a><span class="in">library(car) # Untuk menghitung VIF </span></span>
<span id="cb26-202"><a href="#cb26-202" aria-hidden="true" tabindex="-1"></a><span class="in">library(nortest) # Untuk uji kenormalan </span></span>
<span id="cb26-203"><a href="#cb26-203" aria-hidden="true" tabindex="-1"></a><span class="in">library(sf) # Untuk menginput peta </span></span>
<span id="cb26-204"><a href="#cb26-204" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2) # Untuk visualisasi data </span></span>
<span id="cb26-205"><a href="#cb26-205" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr) # Untuk mengolah dataframe </span></span>
<span id="cb26-206"><a href="#cb26-206" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr) # Untuk mengolah dataframe </span></span>
<span id="cb26-207"><a href="#cb26-207" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse) # Struktur matriks </span></span>
<span id="cb26-208"><a href="#cb26-208" aria-hidden="true" tabindex="-1"></a><span class="in">library(lmtest) # Uji model linier </span></span>
<span id="cb26-209"><a href="#cb26-209" aria-hidden="true" tabindex="-1"></a><span class="in">library(spmoran) # ESF </span></span>
<span id="cb26-210"><a href="#cb26-210" aria-hidden="true" tabindex="-1"></a><span class="in">library(ape) </span></span>
<span id="cb26-211"><a href="#cb26-211" aria-hidden="true" tabindex="-1"></a><span class="in">library(fitdistrplus)</span></span>
<span id="cb26-212"><a href="#cb26-212" aria-hidden="true" tabindex="-1"></a><span class="in">library(readxl) </span></span>
<span id="cb26-213"><a href="#cb26-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-214"><a href="#cb26-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-215"><a href="#cb26-215" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data dan Peta</span></span>
<span id="cb26-216"><a href="#cb26-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-219"><a href="#cb26-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-220"><a href="#cb26-220" aria-hidden="true" tabindex="-1"></a>hasil2 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/hasil.RDS"</span>)</span>
<span id="cb26-221"><a href="#cb26-221" aria-hidden="true" tabindex="-1"></a><span class="co">#Input Data </span></span>
<span id="cb26-222"><a href="#cb26-222" aria-hidden="true" tabindex="-1"></a>ikp <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/IKP2022.xlsx"</span>) </span>
<span id="cb26-223"><a href="#cb26-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-224"><a href="#cb26-224" aria-hidden="true" tabindex="-1"></a><span class="co"># #Import peta SHP </span></span>
<span id="cb26-225"><a href="#cb26-225" aria-hidden="true" tabindex="-1"></a>peta <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"data/shp/BATAS KABUPATEN KOTA DESEMBER 2019 DUKCAPIL.shp"</span>)</span>
<span id="cb26-226"><a href="#cb26-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-227"><a href="#cb26-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-228"><a href="#cb26-228" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modifikasi Data</span></span>
<span id="cb26-229"><a href="#cb26-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-232"><a href="#cb26-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-233"><a href="#cb26-233" aria-hidden="true" tabindex="-1"></a>ikp<span class="sc">$</span>KAB_KOTA <span class="ot">=</span> <span class="fu">toupper</span>(ikp<span class="sc">$</span>KAB_KOTA)</span>
<span id="cb26-234"><a href="#cb26-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-235"><a href="#cb26-235" aria-hidden="true" tabindex="-1"></a><span class="co">#join data to peta</span></span>
<span id="cb26-236"><a href="#cb26-236" aria-hidden="true" tabindex="-1"></a>dfix <span class="ot">=</span> <span class="fu">left_join</span>(peta, ikp, <span class="at">by =</span> <span class="st">"KAB_KOTA"</span>)</span>
<span id="cb26-237"><a href="#cb26-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-238"><a href="#cb26-238" aria-hidden="true" tabindex="-1"></a>dfix <span class="ot">=</span> <span class="fu">na.omit</span>(dfix)</span>
<span id="cb26-239"><a href="#cb26-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-240"><a href="#cb26-240" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb26-241"><a href="#cb26-241" aria-hidden="true" tabindex="-1"></a>longlat <span class="ot">=</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(dfix<span class="sc">$</span>geometry))</span>
<span id="cb26-242"><a href="#cb26-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-243"><a href="#cb26-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-244"><a href="#cb26-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot Spasial</span></span>
<span id="cb26-245"><a href="#cb26-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-248"><a href="#cb26-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-249"><a href="#cb26-249" aria-hidden="true" tabindex="-1"></a><span class="co">#peta ikp</span></span>
<span id="cb26-250"><a href="#cb26-250" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb26-251"><a href="#cb26-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Y)) <span class="sc">+</span></span>
<span id="cb26-252"><a href="#cb26-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Indeks Ketahanan Pangan"</span>) <span class="sc">+</span></span>
<span id="cb26-253"><a href="#cb26-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="dv">5</span>, <span class="at">palette =</span> <span class="st">"Emrld"</span>)),</span>
<span id="cb26-254"><a href="#cb26-254" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(dfix<span class="sc">$</span>Y) <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-255"><a href="#cb26-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-256"><a href="#cb26-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-257"><a href="#cb26-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Nilai"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb26-258"><a href="#cb26-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-259"><a href="#cb26-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-260"><a href="#cb26-260" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-261"><a href="#cb26-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-262"><a href="#cb26-262" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">13</span>),</span>
<span id="cb26-263"><a href="#cb26-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.32</span>, <span class="st">'npc'</span>)</span>
<span id="cb26-264"><a href="#cb26-264" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-265"><a href="#cb26-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-266"><a href="#cb26-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-267"><a href="#cb26-267" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplot</span></span>
<span id="cb26-268"><a href="#cb26-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-271"><a href="#cb26-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-272"><a href="#cb26-272" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb26-273"><a href="#cb26-273" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(</span>
<span id="cb26-274"><a href="#cb26-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(dfix<span class="sc">$</span>X1)),</span>
<span id="cb26-275"><a href="#cb26-275" aria-hidden="true" tabindex="-1"></a>  dfix<span class="sc">$</span>X1,</span>
<span id="cb26-276"><a href="#cb26-276" aria-hidden="true" tabindex="-1"></a>  dfix<span class="sc">$</span>X3,</span>
<span id="cb26-277"><a href="#cb26-277" aria-hidden="true" tabindex="-1"></a>  dfix<span class="sc">$</span>X5,</span>
<span id="cb26-278"><a href="#cb26-278" aria-hidden="true" tabindex="-1"></a>  dfix<span class="sc">$</span>X6,</span>
<span id="cb26-279"><a href="#cb26-279" aria-hidden="true" tabindex="-1"></a>  dfix<span class="sc">$</span>X7,</span>
<span id="cb26-280"><a href="#cb26-280" aria-hidden="true" tabindex="-1"></a>  dfix<span class="sc">$</span>X8</span>
<span id="cb26-281"><a href="#cb26-281" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb26-282"><a href="#cb26-282" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="fu">paste0</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb26-283"><a href="#cb26-283" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span>
<span id="cb26-284"><a href="#cb26-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-285"><a href="#cb26-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-286"><a href="#cb26-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-289"><a href="#cb26-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-290"><a href="#cb26-290" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(X,</span>
<span id="cb26-291"><a href="#cb26-291" aria-hidden="true" tabindex="-1"></a>               <span class="at">cols =</span> <span class="fu">colnames</span>(X)[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb26-292"><a href="#cb26-292" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">'Variable'</span>,</span>
<span id="cb26-293"><a href="#cb26-293" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">'Value'</span>)</span>
<span id="cb26-294"><a href="#cb26-294" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span>
<span id="cb26-295"><a href="#cb26-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-296"><a href="#cb26-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-297"><a href="#cb26-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-300"><a href="#cb26-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-301"><a href="#cb26-301" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(X, <span class="fu">aes</span>(<span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb26-302"><a href="#cb26-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb26-303"><a href="#cb26-303" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom boxes</span></span>
<span id="cb26-304"><a href="#cb26-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb26-305"><a href="#cb26-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb26-306"><a href="#cb26-306" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb26-307"><a href="#cb26-307" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Notch?</span></span>
<span id="cb26-308"><a href="#cb26-308" aria-hidden="true" tabindex="-1"></a>    <span class="at">notch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-309"><a href="#cb26-309" aria-hidden="true" tabindex="-1"></a>    <span class="at">notchwidth =</span> <span class="fl">0.8</span>,</span>
<span id="cb26-310"><a href="#cb26-310" aria-hidden="true" tabindex="-1"></a>    <span class="co"># custom outliers</span></span>
<span id="cb26-311"><a href="#cb26-311" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.colour =</span> <span class="st">"firebrick2"</span>,</span>
<span id="cb26-312"><a href="#cb26-312" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.fill =</span> <span class="st">"firebrick2"</span>,</span>
<span id="cb26-313"><a href="#cb26-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">outlier.size =</span> <span class="dv">3</span></span>
<span id="cb26-314"><a href="#cb26-314" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="fu">facet_wrap</span>( <span class="sc">~</span> Variable,</span>
<span id="cb26-315"><a href="#cb26-315" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scales =</span> <span class="st">"free"</span>,</span>
<span id="cb26-316"><a href="#cb26-316" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb26-317"><a href="#cb26-317" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ncol =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb26-318"><a href="#cb26-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-319"><a href="#cb26-319" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-320"><a href="#cb26-320" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb26-321"><a href="#cb26-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb26-322"><a href="#cb26-322" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-323"><a href="#cb26-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb26-324"><a href="#cb26-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-325"><a href="#cb26-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-326"><a href="#cb26-326" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bobot Spasial</span></span>
<span id="cb26-327"><a href="#cb26-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-330"><a href="#cb26-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-331"><a href="#cb26-331" aria-hidden="true" tabindex="-1"></a><span class="co">#Bobot Spasial</span></span>
<span id="cb26-332"><a href="#cb26-332" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(longlat, <span class="at">method =</span> <span class="st">"euclidean"</span>))</span>
<span id="cb26-333"><a href="#cb26-333" aria-hidden="true" tabindex="-1"></a><span class="co">#inverse weight matrix</span></span>
<span id="cb26-334"><a href="#cb26-334" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> D</span>
<span id="cb26-335"><a href="#cb26-335" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse weight matrix - row-normalized</span></span>
<span id="cb26-336"><a href="#cb26-336" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(w) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-337"><a href="#cb26-337" aria-hidden="true" tabindex="-1"></a>wmoran <span class="ot">=</span> <span class="fu">mat2listw</span>(w, <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb26-338"><a href="#cb26-338" aria-hidden="true" tabindex="-1"></a><span class="co">#Uji Moran Indeks (Autokorelasi)</span></span>
<span id="cb26-339"><a href="#cb26-339" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(dfix<span class="sc">$</span>Y, wmoran, <span class="at">zero.policy =</span> T)</span>
<span id="cb26-340"><a href="#cb26-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-341"><a href="#cb26-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-342"><a href="#cb26-342" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uji Asumsi</span></span>
<span id="cb26-343"><a href="#cb26-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-346"><a href="#cb26-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-347"><a href="#cb26-347" aria-hidden="true" tabindex="-1"></a><span class="co">#Uji asumsi</span></span>
<span id="cb26-348"><a href="#cb26-348" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> Y <span class="sc">~</span> X1 <span class="sc">+</span> X3 <span class="sc">+</span> X5 <span class="sc">+</span> X6 <span class="sc">+</span> X7 <span class="sc">+</span> X8</span>
<span id="cb26-349"><a href="#cb26-349" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">lm</span>(formula, <span class="at">data =</span> dfix))</span>
<span id="cb26-350"><a href="#cb26-350" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(<span class="fu">residuals</span>(<span class="fu">lm</span>(formula, <span class="at">data =</span> dfix)))</span>
<span id="cb26-351"><a href="#cb26-351" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">lm</span>(formula, <span class="at">data =</span> dfix))</span>
<span id="cb26-352"><a href="#cb26-352" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> dfix)</span>
<span id="cb26-353"><a href="#cb26-353" aria-hidden="true" tabindex="-1"></a><span class="fu">lm.morantest</span>(model, wmoran, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">zero.policy =</span> T)</span>
<span id="cb26-354"><a href="#cb26-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-355"><a href="#cb26-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-356"><a href="#cb26-356" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histogram</span></span>
<span id="cb26-357"><a href="#cb26-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-360"><a href="#cb26-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-361"><a href="#cb26-361" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram Normalitas Sebelum Transformasi</span></span>
<span id="cb26-362"><a href="#cb26-362" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb26-363"><a href="#cb26-363" aria-hidden="true" tabindex="-1"></a>  dfix<span class="sc">$</span>Y,</span>
<span id="cb26-364"><a href="#cb26-364" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Histogram"</span>,</span>
<span id="cb26-365"><a href="#cb26-365" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb26-366"><a href="#cb26-366" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="st">"black"</span>,</span>
<span id="cb26-367"><a href="#cb26-367" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Y"</span></span>
<span id="cb26-368"><a href="#cb26-368" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-369"><a href="#cb26-369" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb26-370"><a href="#cb26-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(<span class="fu">lm</span>(formula, <span class="at">data =</span> dfix)),</span>
<span id="cb26-371"><a href="#cb26-371" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Histogram"</span>,</span>
<span id="cb26-372"><a href="#cb26-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb26-373"><a href="#cb26-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="st">"black"</span>,</span>
<span id="cb26-374"><a href="#cb26-374" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Residuals"</span></span>
<span id="cb26-375"><a href="#cb26-375" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-376"><a href="#cb26-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-377"><a href="#cb26-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-378"><a href="#cb26-378" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identifikasi Model Spasial dan Sebaran</span></span>
<span id="cb26-379"><a href="#cb26-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-382"><a href="#cb26-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-383"><a href="#cb26-383" aria-hidden="true" tabindex="-1"></a><span class="co">#LM Test (Model Spasial)</span></span>
<span id="cb26-384"><a href="#cb26-384" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, <span class="at">data =</span> dfix)</span>
<span id="cb26-385"><a href="#cb26-385" aria-hidden="true" tabindex="-1"></a><span class="fu">lm.morantest</span>(model, wmoran, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">zero.policy =</span> T)</span>
<span id="cb26-386"><a href="#cb26-386" aria-hidden="true" tabindex="-1"></a><span class="co">#Deteksi Sebaran</span></span>
<span id="cb26-387"><a href="#cb26-387" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(<span class="fu">residuals</span>(<span class="fu">lm</span>(formula, <span class="at">data =</span> dfix)), <span class="at">boot =</span> <span class="dv">500</span>)</span>
<span id="cb26-388"><a href="#cb26-388" aria-hidden="true" tabindex="-1"></a><span class="fu">descdist</span>(dfix<span class="sc">$</span>Y, <span class="at">boot =</span> <span class="dv">500</span>)</span>
<span id="cb26-389"><a href="#cb26-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-390"><a href="#cb26-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-391"><a href="#cb26-391" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transformasi dan Pemodelan</span></span>
<span id="cb26-392"><a href="#cb26-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-395"><a href="#cb26-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-396"><a href="#cb26-396" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb26-397"><a href="#cb26-397" aria-hidden="true" tabindex="-1"></a><span class="co"># Find transformation D in SAL</span></span>
<span id="cb26-398"><a href="#cb26-398" aria-hidden="true" tabindex="-1"></a>hasil2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-399"><a href="#cb26-399" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_ad =</span> <span class="dv">0</span>,</span>
<span id="cb26-400"><a href="#cb26-400" aria-hidden="true" tabindex="-1"></a>  <span class="at">resid_ll =</span> <span class="dv">0</span>,</span>
<span id="cb26-401"><a href="#cb26-401" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_ad =</span> <span class="dv">0</span>,</span>
<span id="cb26-402"><a href="#cb26-402" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_ll =</span> <span class="dv">0</span></span>
<span id="cb26-403"><a href="#cb26-403" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-404"><a href="#cb26-404" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>) {</span>
<span id="cb26-405"><a href="#cb26-405" aria-hidden="true" tabindex="-1"></a>  ng2 <span class="ot">&lt;-</span> <span class="fu">nongauss_y</span>(<span class="at">y_nonneg =</span> T, <span class="at">tr_num =</span> i)</span>
<span id="cb26-406"><a href="#cb26-406" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ESF VC</span></span>
<span id="cb26-407"><a href="#cb26-407" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> dfix<span class="sc">$</span>Y</span>
<span id="cb26-408"><a href="#cb26-408" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">cbind</span>(dfix<span class="sc">$</span>X1, dfix<span class="sc">$</span>X3, dfix<span class="sc">$</span>X5, dfix<span class="sc">$</span>X6, dfix<span class="sc">$</span>X7, dfix<span class="sc">$</span>X8)</span>
<span id="cb26-409"><a href="#cb26-409" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(X, <span class="at">ncol =</span> <span class="fu">ncol</span>(X), <span class="at">nrow =</span> <span class="fu">nrow</span>(X))</span>
<span id="cb26-410"><a href="#cb26-410" aria-hidden="true" tabindex="-1"></a>  meig <span class="ot">&lt;-</span> <span class="fu">meigen</span>(<span class="at">cmat =</span> w)</span>
<span id="cb26-411"><a href="#cb26-411" aria-hidden="true" tabindex="-1"></a>  resf_vc <span class="ot">&lt;-</span> <span class="fu">resf_vc</span>(</span>
<span id="cb26-412"><a href="#cb26-412" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> Y,</span>
<span id="cb26-413"><a href="#cb26-413" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> X,</span>
<span id="cb26-414"><a href="#cb26-414" aria-hidden="true" tabindex="-1"></a>    <span class="at">meig =</span> meig,</span>
<span id="cb26-415"><a href="#cb26-415" aria-hidden="true" tabindex="-1"></a>    <span class="at">x_sel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-416"><a href="#cb26-416" aria-hidden="true" tabindex="-1"></a>    <span class="at">nongauss =</span> ng2</span>
<span id="cb26-417"><a href="#cb26-417" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-418"><a href="#cb26-418" aria-hidden="true" tabindex="-1"></a>  hasil <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-419"><a href="#cb26-419" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_ad =</span> <span class="fu">ad.test</span>(resf_vc<span class="sc">$</span>resid)<span class="sc">$</span>p.value,</span>
<span id="cb26-420"><a href="#cb26-420" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_ll =</span> <span class="fu">lillie.test</span>(resf_vc<span class="sc">$</span>resid)<span class="sc">$</span>p.value,</span>
<span id="cb26-421"><a href="#cb26-421" aria-hidden="true" tabindex="-1"></a>      <span class="at">y_ad =</span> <span class="fu">ad.test</span>(resf_vc<span class="sc">$</span>tr_y)<span class="sc">$</span>p.value,</span>
<span id="cb26-422"><a href="#cb26-422" aria-hidden="true" tabindex="-1"></a>      <span class="at">y_ll =</span> <span class="fu">lillie.test</span>(resf_vc<span class="sc">$</span>tr_y)<span class="sc">$</span>p.value</span>
<span id="cb26-423"><a href="#cb26-423" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-424"><a href="#cb26-424" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-425"><a href="#cb26-425" aria-hidden="true" tabindex="-1"></a>  hasil2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(hasil2, hasil)</span>
<span id="cb26-426"><a href="#cb26-426" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-427"><a href="#cb26-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-428"><a href="#cb26-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-429"><a href="#cb26-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-432"><a href="#cb26-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-433"><a href="#cb26-433" aria-hidden="true" tabindex="-1"></a>hasil2</span>
<span id="cb26-434"><a href="#cb26-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-435"><a href="#cb26-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-436"><a href="#cb26-436" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model ESF-VC</span></span>
<span id="cb26-437"><a href="#cb26-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-440"><a href="#cb26-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-441"><a href="#cb26-441" aria-hidden="true" tabindex="-1"></a><span class="co">#RESF VC</span></span>
<span id="cb26-442"><a href="#cb26-442" aria-hidden="true" tabindex="-1"></a>ng2 <span class="ot">&lt;-</span> <span class="fu">nongauss_y</span>(<span class="at">y_nonneg =</span> T, <span class="at">tr_num =</span> <span class="dv">14</span>)</span>
<span id="cb26-443"><a href="#cb26-443" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> dfix<span class="sc">$</span>Y</span>
<span id="cb26-444"><a href="#cb26-444" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>(dfix<span class="sc">$</span>X1, dfix<span class="sc">$</span>X3, dfix<span class="sc">$</span>X5, dfix<span class="sc">$</span>X6, dfix<span class="sc">$</span>X7, dfix<span class="sc">$</span>X8)</span>
<span id="cb26-445"><a href="#cb26-445" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(X, <span class="at">ncol =</span> <span class="fu">ncol</span>(X), <span class="at">nrow =</span> <span class="fu">nrow</span>(X))</span>
<span id="cb26-446"><a href="#cb26-446" aria-hidden="true" tabindex="-1"></a>meig <span class="ot">&lt;-</span> <span class="fu">meigen</span>(<span class="at">cmat =</span> w)</span>
<span id="cb26-447"><a href="#cb26-447" aria-hidden="true" tabindex="-1"></a>resf_vc <span class="ot">&lt;-</span> <span class="fu">resf_vc</span>(</span>
<span id="cb26-448"><a href="#cb26-448" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> Y,</span>
<span id="cb26-449"><a href="#cb26-449" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> X,</span>
<span id="cb26-450"><a href="#cb26-450" aria-hidden="true" tabindex="-1"></a>  <span class="at">meig =</span> meig,</span>
<span id="cb26-451"><a href="#cb26-451" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_sel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-452"><a href="#cb26-452" aria-hidden="true" tabindex="-1"></a>  <span class="at">nongauss =</span> ng2</span>
<span id="cb26-453"><a href="#cb26-453" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-454"><a href="#cb26-454" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-455"><a href="#cb26-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-456"><a href="#cb26-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-459"><a href="#cb26-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-460"><a href="#cb26-460" aria-hidden="true" tabindex="-1"></a><span class="co"># Hasil RESF-VC</span></span>
<span id="cb26-461"><a href="#cb26-461" aria-hidden="true" tabindex="-1"></a>resf_vc</span>
<span id="cb26-462"><a href="#cb26-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-463"><a href="#cb26-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-464"><a href="#cb26-464" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hitogram Setelah Transformasi</span></span>
<span id="cb26-465"><a href="#cb26-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-468"><a href="#cb26-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-469"><a href="#cb26-469" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram sesudah transformasi</span></span>
<span id="cb26-470"><a href="#cb26-470" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb26-471"><a href="#cb26-471" aria-hidden="true" tabindex="-1"></a>  resf_vc<span class="sc">$</span>tr_y,</span>
<span id="cb26-472"><a href="#cb26-472" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Histogram"</span>,</span>
<span id="cb26-473"><a href="#cb26-473" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb26-474"><a href="#cb26-474" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="st">"black"</span>,</span>
<span id="cb26-475"><a href="#cb26-475" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Y"</span></span>
<span id="cb26-476"><a href="#cb26-476" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-477"><a href="#cb26-477" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(resf_vc<span class="sc">$</span>tr_y)</span>
<span id="cb26-478"><a href="#cb26-478" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb26-479"><a href="#cb26-479" aria-hidden="true" tabindex="-1"></a>  resf_vc<span class="sc">$</span>resid,</span>
<span id="cb26-480"><a href="#cb26-480" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Histogram"</span>,</span>
<span id="cb26-481"><a href="#cb26-481" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb26-482"><a href="#cb26-482" aria-hidden="true" tabindex="-1"></a>  <span class="at">border =</span> <span class="st">"black"</span>,</span>
<span id="cb26-483"><a href="#cb26-483" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Residuals"</span></span>
<span id="cb26-484"><a href="#cb26-484" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-485"><a href="#cb26-485" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(resf_vc<span class="sc">$</span>resid)</span>
<span id="cb26-486"><a href="#cb26-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-487"><a href="#cb26-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-488"><a href="#cb26-488" aria-hidden="true" tabindex="-1"></a><span class="fu">### Peta Signifikansi Peubah Varying Coefficient</span></span>
<span id="cb26-489"><a href="#cb26-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-492"><a href="#cb26-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-493"><a href="#cb26-493" aria-hidden="true" tabindex="-1"></a><span class="co"># Peta Signifikansi Variabel</span></span>
<span id="cb26-494"><a href="#cb26-494" aria-hidden="true" tabindex="-1"></a>data_p <span class="ot">&lt;-</span> resf_vc<span class="sc">$</span>p_vc</span>
<span id="cb26-495"><a href="#cb26-495" aria-hidden="true" tabindex="-1"></a>data_p<span class="sc">$</span>kX1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_p<span class="sc">$</span>V1 <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X1"</span>, <span class="cn">NA</span>)</span>
<span id="cb26-496"><a href="#cb26-496" aria-hidden="true" tabindex="-1"></a>data_p<span class="sc">$</span>kX2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_p<span class="sc">$</span>V2 <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X2"</span>, <span class="cn">NA</span>)</span>
<span id="cb26-497"><a href="#cb26-497" aria-hidden="true" tabindex="-1"></a>data_p<span class="sc">$</span>kX3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_p<span class="sc">$</span>V3 <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X3"</span>, <span class="cn">NA</span>)</span>
<span id="cb26-498"><a href="#cb26-498" aria-hidden="true" tabindex="-1"></a>data_p<span class="sc">$</span>kX4 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_p<span class="sc">$</span>V4 <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X4"</span>, <span class="cn">NA</span>)</span>
<span id="cb26-499"><a href="#cb26-499" aria-hidden="true" tabindex="-1"></a>data_p<span class="sc">$</span>kX5 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_p<span class="sc">$</span>V5 <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X5"</span>, <span class="cn">NA</span>)</span>
<span id="cb26-500"><a href="#cb26-500" aria-hidden="true" tabindex="-1"></a>data_p<span class="sc">$</span>kX6 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_p<span class="sc">$</span>V6 <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"X6"</span>, <span class="cn">NA</span>)</span>
<span id="cb26-501"><a href="#cb26-501" aria-hidden="true" tabindex="-1"></a>data_p2 <span class="ot">&lt;-</span> data_p[, <span class="fu">c</span>(<span class="st">"kX1"</span>, <span class="st">"kX2"</span>, <span class="st">"kX3"</span>, <span class="st">"kX4"</span>, <span class="st">"kX5"</span>, <span class="st">"kX6"</span>)]</span>
<span id="cb26-502"><a href="#cb26-502" aria-hidden="true" tabindex="-1"></a>data_p<span class="sc">$</span>Sig <span class="ot">&lt;-</span> <span class="fu">apply</span>(data_p2, <span class="dv">1</span>, <span class="cf">function</span>(data_p2) {</span>
<span id="cb26-503"><a href="#cb26-503" aria-hidden="true" tabindex="-1"></a>  filtered_values <span class="ot">&lt;-</span> data_p2[<span class="fu">is.na</span>(data_p2) <span class="sc">==</span> <span class="cn">FALSE</span>]</span>
<span id="cb26-504"><a href="#cb26-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(filtered_values, <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb26-505"><a href="#cb26-505" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb26-506"><a href="#cb26-506" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_p<span class="sc">$</span>Sig)</span>
<span id="cb26-507"><a href="#cb26-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-508"><a href="#cb26-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-509"><a href="#cb26-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-512"><a href="#cb26-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-513"><a href="#cb26-513" aria-hidden="true" tabindex="-1"></a>dfix<span class="sc">$</span>Signifikansi <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data_p<span class="sc">$</span>Sig)</span>
<span id="cb26-514"><a href="#cb26-514" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb26-515"><a href="#cb26-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Signifikansi)) <span class="sc">+</span></span>
<span id="cb26-516"><a href="#cb26-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Signifikansi Peubah Model RE-ESF VC"</span>) <span class="sc">+</span></span>
<span id="cb26-517"><a href="#cb26-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-518"><a href="#cb26-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-519"><a href="#cb26-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Variabel"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb26-520"><a href="#cb26-520" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-521"><a href="#cb26-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-522"><a href="#cb26-522" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-523"><a href="#cb26-523" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-524"><a href="#cb26-524" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">12</span>),</span>
<span id="cb26-525"><a href="#cb26-525" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">0.10</span>, <span class="st">'npc'</span>)</span>
<span id="cb26-526"><a href="#cb26-526" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-527"><a href="#cb26-527" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-528"><a href="#cb26-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-529"><a href="#cb26-529" aria-hidden="true" tabindex="-1"></a><span class="fu">### Peta Koefisien</span></span>
<span id="cb26-530"><a href="#cb26-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-533"><a href="#cb26-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-534"><a href="#cb26-534" aria-hidden="true" tabindex="-1"></a><span class="co"># Peta Koefisien Beta</span></span>
<span id="cb26-535"><a href="#cb26-535" aria-hidden="true" tabindex="-1"></a>data_b<span class="ot">&lt;-</span>resf_vc<span class="sc">$</span>b_vc</span>
<span id="cb26-536"><a href="#cb26-536" aria-hidden="true" tabindex="-1"></a>dfix<span class="sc">$</span>bX1<span class="ot">&lt;-</span>data_b<span class="sc">$</span>V1</span>
<span id="cb26-537"><a href="#cb26-537" aria-hidden="true" tabindex="-1"></a>dfix<span class="sc">$</span>bX2<span class="ot">&lt;-</span>data_b<span class="sc">$</span>V2</span>
<span id="cb26-538"><a href="#cb26-538" aria-hidden="true" tabindex="-1"></a>dfix<span class="sc">$</span>bX3<span class="ot">&lt;-</span>data_b<span class="sc">$</span>V3</span>
<span id="cb26-539"><a href="#cb26-539" aria-hidden="true" tabindex="-1"></a>dfix<span class="sc">$</span>bX4<span class="ot">&lt;-</span>data_b<span class="sc">$</span>V4</span>
<span id="cb26-540"><a href="#cb26-540" aria-hidden="true" tabindex="-1"></a>dfix<span class="sc">$</span>bX5<span class="ot">&lt;-</span>data_b<span class="sc">$</span>V5</span>
<span id="cb26-541"><a href="#cb26-541" aria-hidden="true" tabindex="-1"></a>dfix<span class="sc">$</span>bX6<span class="ot">&lt;-</span>data_b<span class="sc">$</span>V6</span>
<span id="cb26-542"><a href="#cb26-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-543"><a href="#cb26-543" aria-hidden="true" tabindex="-1"></a><span class="co"># X1</span></span>
<span id="cb26-544"><a href="#cb26-544" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb26-545"><a href="#cb26-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> bX1)) <span class="sc">+</span></span>
<span id="cb26-546"><a href="#cb26-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(</span>
<span id="cb26-547"><a href="#cb26-547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">"Koefisien "</span>,  <span class="sc">~</span> beta[<span class="dv">1</span>], <span class="st">" (Persentase Penduduk Miskin)"</span>)</span>
<span id="cb26-548"><a href="#cb26-548" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">+</span></span>
<span id="cb26-549"><a href="#cb26-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="dv">5</span>, <span class="at">palette =</span> <span class="st">"Emrld"</span>)),</span>
<span id="cb26-550"><a href="#cb26-550" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(dfix<span class="sc">$</span>bX1), <span class="fu">max</span>(dfix<span class="sc">$</span>bX1))) <span class="sc">+</span></span>
<span id="cb26-551"><a href="#cb26-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-552"><a href="#cb26-552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-553"><a href="#cb26-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Nilai"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb26-554"><a href="#cb26-554" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-555"><a href="#cb26-555" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-556"><a href="#cb26-556" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-557"><a href="#cb26-557" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-558"><a href="#cb26-558" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">16</span>),</span>
<span id="cb26-559"><a href="#cb26-559" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.32</span>, <span class="st">'npc'</span>)</span>
<span id="cb26-560"><a href="#cb26-560" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-561"><a href="#cb26-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-562"><a href="#cb26-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-563"><a href="#cb26-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-566"><a href="#cb26-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-567"><a href="#cb26-567" aria-hidden="true" tabindex="-1"></a><span class="co"># X2</span></span>
<span id="cb26-568"><a href="#cb26-568" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb26-569"><a href="#cb26-569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> bX2)) <span class="sc">+</span></span>
<span id="cb26-570"><a href="#cb26-570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(</span>
<span id="cb26-571"><a href="#cb26-571" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">"Koefisien "</span>, beta[<span class="dv">2</span>], <span class="st">" (Pengeluaran Per Kapita)"</span>)</span>
<span id="cb26-572"><a href="#cb26-572" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">+</span></span>
<span id="cb26-573"><a href="#cb26-573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="dv">5</span>, <span class="at">palette =</span> <span class="st">"Emrld"</span>)),</span>
<span id="cb26-574"><a href="#cb26-574" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(dfix<span class="sc">$</span>bX2), <span class="fu">max</span>(dfix<span class="sc">$</span>bX2))) <span class="sc">+</span></span>
<span id="cb26-575"><a href="#cb26-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-576"><a href="#cb26-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-577"><a href="#cb26-577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Nilai"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb26-578"><a href="#cb26-578" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-579"><a href="#cb26-579" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-580"><a href="#cb26-580" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-581"><a href="#cb26-581" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-582"><a href="#cb26-582" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">16</span>),</span>
<span id="cb26-583"><a href="#cb26-583" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.30</span>, <span class="st">'npc'</span>)</span>
<span id="cb26-584"><a href="#cb26-584" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-585"><a href="#cb26-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-586"><a href="#cb26-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-587"><a href="#cb26-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-590"><a href="#cb26-590" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-591"><a href="#cb26-591" aria-hidden="true" tabindex="-1"></a><span class="co"># X3</span></span>
<span id="cb26-592"><a href="#cb26-592" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb26-593"><a href="#cb26-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> bX3)) <span class="sc">+</span></span>
<span id="cb26-594"><a href="#cb26-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(</span>
<span id="cb26-595"><a href="#cb26-595" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">"Koefisien "</span>, beta[<span class="dv">3</span>], <span class="st">" (Umur Harapan Hidup)"</span>)</span>
<span id="cb26-596"><a href="#cb26-596" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">+</span></span>
<span id="cb26-597"><a href="#cb26-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="dv">5</span>, <span class="at">palette =</span> <span class="st">"Emrld"</span>)),</span>
<span id="cb26-598"><a href="#cb26-598" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(dfix<span class="sc">$</span>bX3), <span class="fu">max</span>(dfix<span class="sc">$</span>bX3))) <span class="sc">+</span></span>
<span id="cb26-599"><a href="#cb26-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-600"><a href="#cb26-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-601"><a href="#cb26-601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Nilai"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb26-602"><a href="#cb26-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-603"><a href="#cb26-603" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-604"><a href="#cb26-604" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-605"><a href="#cb26-605" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-606"><a href="#cb26-606" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">16</span>),</span>
<span id="cb26-607"><a href="#cb26-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.30</span>, <span class="st">'npc'</span>)</span>
<span id="cb26-608"><a href="#cb26-608" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-609"><a href="#cb26-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-610"><a href="#cb26-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-611"><a href="#cb26-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-614"><a href="#cb26-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-615"><a href="#cb26-615" aria-hidden="true" tabindex="-1"></a><span class="co"># X4</span></span>
<span id="cb26-616"><a href="#cb26-616" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb26-617"><a href="#cb26-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> bX4)) <span class="sc">+</span></span>
<span id="cb26-618"><a href="#cb26-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(</span>
<span id="cb26-619"><a href="#cb26-619" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(</span>
<span id="cb26-620"><a href="#cb26-620" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Koefisien "</span>,</span>
<span id="cb26-621"><a href="#cb26-621" aria-hidden="true" tabindex="-1"></a>      beta[<span class="dv">4</span>],</span>
<span id="cb26-622"><a href="#cb26-622" aria-hidden="true" tabindex="-1"></a>      <span class="st">" (Rata - Rata Lama Sekolah Penduduk 15 Tahun Keatas)"</span></span>
<span id="cb26-623"><a href="#cb26-623" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-624"><a href="#cb26-624" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">+</span></span>
<span id="cb26-625"><a href="#cb26-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="dv">5</span>, <span class="at">palette =</span> <span class="st">"Emrld"</span>)),</span>
<span id="cb26-626"><a href="#cb26-626" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(dfix<span class="sc">$</span>bX4), <span class="fu">max</span>(dfix<span class="sc">$</span>bX4))) <span class="sc">+</span></span>
<span id="cb26-627"><a href="#cb26-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-628"><a href="#cb26-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-629"><a href="#cb26-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Nilai"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb26-630"><a href="#cb26-630" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-631"><a href="#cb26-631" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-632"><a href="#cb26-632" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-633"><a href="#cb26-633" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-634"><a href="#cb26-634" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">16</span>),</span>
<span id="cb26-635"><a href="#cb26-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.30</span>, <span class="st">'npc'</span>)</span>
<span id="cb26-636"><a href="#cb26-636" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-637"><a href="#cb26-637" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-638"><a href="#cb26-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-639"><a href="#cb26-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-642"><a href="#cb26-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-643"><a href="#cb26-643" aria-hidden="true" tabindex="-1"></a><span class="co"># X5</span></span>
<span id="cb26-644"><a href="#cb26-644" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb26-645"><a href="#cb26-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> bX5)) <span class="sc">+</span></span>
<span id="cb26-646"><a href="#cb26-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(</span>
<span id="cb26-647"><a href="#cb26-647" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">"Koefisien "</span>, beta[<span class="dv">5</span>], <span class="st">" (Persentase Akses Sanitasi Layak)"</span>)</span>
<span id="cb26-648"><a href="#cb26-648" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">+</span></span>
<span id="cb26-649"><a href="#cb26-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="dv">5</span>, <span class="at">palette =</span> <span class="st">"Emrld"</span>)),</span>
<span id="cb26-650"><a href="#cb26-650" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(dfix<span class="sc">$</span>bX5), <span class="fu">max</span>(dfix<span class="sc">$</span>bX5))) <span class="sc">+</span></span>
<span id="cb26-651"><a href="#cb26-651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-652"><a href="#cb26-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-653"><a href="#cb26-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Nilai"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb26-654"><a href="#cb26-654" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-655"><a href="#cb26-655" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-656"><a href="#cb26-656" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-657"><a href="#cb26-657" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-658"><a href="#cb26-658" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">16</span>),</span>
<span id="cb26-659"><a href="#cb26-659" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.30</span>, <span class="st">'npc'</span>)</span>
<span id="cb26-660"><a href="#cb26-660" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-661"><a href="#cb26-661" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-662"><a href="#cb26-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-663"><a href="#cb26-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-666"><a href="#cb26-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-667"><a href="#cb26-667" aria-hidden="true" tabindex="-1"></a><span class="co"># X6</span></span>
<span id="cb26-668"><a href="#cb26-668" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb26-669"><a href="#cb26-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> bX6)) <span class="sc">+</span></span>
<span id="cb26-670"><a href="#cb26-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="fu">expression</span>(<span class="fu">bold</span>(</span>
<span id="cb26-671"><a href="#cb26-671" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">"Koefisien "</span>, beta[<span class="dv">6</span>], <span class="st">" (Akses Terhadap Air Minum)"</span>)</span>
<span id="cb26-672"><a href="#cb26-672" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">+</span></span>
<span id="cb26-673"><a href="#cb26-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">hcl.colors</span>(<span class="dv">5</span>, <span class="at">palette =</span> <span class="st">"Emrld"</span>)),</span>
<span id="cb26-674"><a href="#cb26-674" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">min</span>(dfix<span class="sc">$</span>bX6), <span class="fu">max</span>(dfix<span class="sc">$</span>bX6))) <span class="sc">+</span></span>
<span id="cb26-675"><a href="#cb26-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-676"><a href="#cb26-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb26-677"><a href="#cb26-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Nilai"</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb26-678"><a href="#cb26-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-679"><a href="#cb26-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-680"><a href="#cb26-680" aria-hidden="true" tabindex="-1"></a>                                  <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-681"><a href="#cb26-681" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span></span>
<span id="cb26-682"><a href="#cb26-682" aria-hidden="true" tabindex="-1"></a>                                 <span class="dv">16</span>),</span>
<span id="cb26-683"><a href="#cb26-683" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="fl">0.30</span>, <span class="st">'npc'</span>)</span>
<span id="cb26-684"><a href="#cb26-684" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-685"><a href="#cb26-685" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb26-686"><a href="#cb26-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-687"><a href="#cb26-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-690"><a href="#cb26-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb26-691"><a href="#cb26-691" aria-hidden="true" tabindex="-1"></a><span class="co"># Koefisien Marginal</span></span>
<span id="cb26-692"><a href="#cb26-692" aria-hidden="true" tabindex="-1"></a>me<span class="ot">&lt;-</span><span class="fu">coef_marginal_vc</span>(resf_vc)</span>
<span id="cb26-693"><a href="#cb26-693" aria-hidden="true" tabindex="-1"></a>me</span>
<span id="cb26-694"><a href="#cb26-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>