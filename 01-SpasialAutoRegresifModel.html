<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>PEMODELAN STATISTIKA PADA DATA GEOSPASIAL - 1&nbsp; Spasial Autoregresif Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-SpasialDurbinModel.html" rel="next">
<link href="./part-1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-1.html">Model Dependensi Spasial</a></li><li class="breadcrumb-item"><a href="./01-SpasialAutoRegresifModel.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Model</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">PEMODELAN STATISTIKA PADA DATA GEOSPASIAL</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kata Pengantar</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pendahuluan</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Dependensi Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-SpasialAutoRegresifModel.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-SpasialDurbinModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spasial Durbin Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-SpasialAutoRegresifBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Keragaman Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-RegresiTerbobotiGeografis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-RegresiTerbobotiGeografisCampuran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Campuran</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-RegresiTerbobotiGeografisBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed SAR-GWR</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-MetodeAnalisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Metode Analisis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-TahapanR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tahapan Analisis dengan R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Filtering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-ModelDependensiSpasial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-ModelKeragamanSpasial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ModelEpidemiologi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model Epidemiologi</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#deskripsi" id="toc-deskripsi" class="nav-link active" data-scroll-target="#deskripsi"><span class="header-section-number">1.1</span> Deskripsi</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">1.2</span> Data</a></li>
  <li><a href="#prosedur-analisis-data" id="toc-prosedur-analisis-data" class="nav-link" data-scroll-target="#prosedur-analisis-data"><span class="header-section-number">1.3</span> Prosedur Analisis Data</a></li>
  <li>
<a href="#tahapan-analisis-r" id="toc-tahapan-analisis-r" class="nav-link" data-scroll-target="#tahapan-analisis-r"><span class="header-section-number">1.4</span> Tahapan Analisis R</a>
  <ul class="collapse">
<li><a href="#package" id="toc-package" class="nav-link" data-scroll-target="#package">Package</a></li>
  <li><a href="#input-data" id="toc-input-data" class="nav-link" data-scroll-target="#input-data">Input Data</a></li>
  <li><a href="#input-peta-pulau-jawa" id="toc-input-peta-pulau-jawa" class="nav-link" data-scroll-target="#input-peta-pulau-jawa">Input Peta Pulau Jawa</a></li>
  <li><a href="#eksplorasi-data" id="toc-eksplorasi-data" class="nav-link" data-scroll-target="#eksplorasi-data">Eksplorasi Data</a></li>
  <li><a href="#pemeriksaan-multikolinearitas" id="toc-pemeriksaan-multikolinearitas" class="nav-link" data-scroll-target="#pemeriksaan-multikolinearitas">Pemeriksaan Multikolinearitas</a></li>
  <li><a href="#transformasi-peubah" id="toc-transformasi-peubah" class="nav-link" data-scroll-target="#transformasi-peubah">Transformasi Peubah</a></li>
  <li><a href="#pengujian-efek-spasial" id="toc-pengujian-efek-spasial" class="nav-link" data-scroll-target="#pengujian-efek-spasial">Pengujian Efek Spasial</a></li>
  <li><a href="#pemodelan-regresi-spasial" id="toc-pemodelan-regresi-spasial" class="nav-link" data-scroll-target="#pemodelan-regresi-spasial">Pemodelan Regresi Spasial</a></li>
  <li><a href="#pemilihan-model-terbaik" id="toc-pemilihan-model-terbaik" class="nav-link" data-scroll-target="#pemilihan-model-terbaik">Pemilihan Model Terbaik</a></li>
  <li><a href="#interpretasi-model" id="toc-interpretasi-model" class="nav-link" data-scroll-target="#interpretasi-model">Interpretasi Model</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-1.html">Model Dependensi Spasial</a></li><li class="breadcrumb-item"><a href="./01-SpasialAutoRegresifModel.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Model</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Model</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="deskripsi" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="deskripsi">
<span class="header-section-number">1.1</span> Deskripsi</h2>
<p>Model regresi spasial digunakan untuk mengetahui hubungan antara satu peubah dengan satu atau lebih peubah dengan memperhatikan adanya efek spasial (Cahyati et al., 2018). Persamaan umum untuk model regresi spasial dapat dirumuskan sebagai berikut (Griffith, 1988):</p>
<p><span class="math inline">\(y = \rho W_1 y + X\beta + \gamma W_2 X\beta + u\)</span></p>
<p><span class="math inline">\(u = \lambda W u + \epsilon\)</span></p>
<p>Dengan asumsi bahwa <span class="math inline">\(\epsilon \sim N(0, \sigma^2 I)\)</span>, dengan:</p>
<p><span class="math display">\[\begin{align*}
y &amp; : \text{vektor peubah respon berukuran } n \times 1, \\
\rho &amp; : \text{koefisien autoregresi lag spasial pada peubah respon}, \\
W_1 &amp; : \text{matriks pembobot spasial bagi peubah respon berukuran } n \times n, \\
W_2 &amp; : \text{matriks pembobot spasial bagi peubah penjelas berukuran } n \times n, \\
\gamma &amp; : \text{koefisien autoregresi lag spasial pada peubah penjelas}, \\
X &amp; : \text{matriks peubah bebas dengan ukuran } n \times (k + 1), \\
\beta &amp; : \text{vektor koefisien parameter regresi berukuran } (k + 1) \times 1, \\
u &amp; : \text{vektor galat yang diasumsikan mengandung autokorelasi berukuran } n \times 1, \\
\lambda &amp; : \text{koefisien autoregresi galat spasial}, \\
\epsilon &amp; : \text{vektor galat yang bebas autokorelasi berukuran } n \times 1.
\end{align*}\]</span></p>
<p>Jika pada persamaan nilai koefisien <span class="math inline">\(\gamma = 0\)</span> dan <span class="math inline">\(\lambda = 0\)</span>, maka model yang digunakan akan menjadi model SAR. SAR merupakan pemodelan pada data dengan menambahkan pengaruh spasial pada peubah respon. Persamaan untuk model SAR adalah sebagai berikut (LeSage dan Pace, 2009):</p>
<p><span class="math inline">\(y = \rho W y + X\beta + \epsilon\)</span></p>
<p>Dengan <span class="math inline">\(y\)</span> merupakan peubah respon, <span class="math inline">\(W\)</span> merupakan matriks pembobot spasial, <span class="math inline">\(\beta\)</span> adalah koefisien parameter regresi, <span class="math inline">\(\epsilon\)</span> merupakan sisaan, dan <span class="math inline">\(\rho\)</span> merupakan koefisien autoregressive lag spasial. Jika tidak terdapat ketergantungan spasial antara wilayah ke-<span class="math inline">\(i\)</span> dan wilayah ke-<span class="math inline">\(j\)</span>, <span class="math inline">\(\rho\)</span> bernilai 0.</p>
<p>Saat nilai koefisien <span class="math inline">\(\rho\)</span> dan <span class="math inline">\(\lambda\)</span> pada persamaan bernilai nol, maka model yang digunakan adalah model SLX. SLX adalah model regresi spasial dengan dependensi spasial hanya pada peubah penjelas (Vega dan Elhorst, 2015). Persamaan untuk SLX sebagai berikut (LeSage dan Pace, 2009):</p>
<p><span class="math inline">\(y = X\beta + \gamma WX + \epsilon\)</span></p>
<p>Dengan <span class="math inline">\(y\)</span> merupakan peubah respon, <span class="math inline">\(W\)</span> merupakan matriks pembobot spasial, <span class="math inline">\(\beta\)</span> adalah koefisien parameter regresi, <span class="math inline">\(\epsilon\)</span> merupakan sisaan, dan <span class="math inline">\(\gamma\)</span> merupakan koefisien lag spasial pada peubah penjelas.</p>
<p>Jika nilai koefisien <span class="math inline">\(\lambda\)</span> pada persamaan bernilai nol, maka model yang digunakan adalah SDM. SDM merupakan model regresi spasial yang digunakan ketika data memiliki dependensi spasial pada peubah respon dan peubah penjelas sehingga pembobotan spasial dilakukan pada peubah respon dan peubah penjelas. Persamaan untuk SDM sebagai berikut (LeSage dan Pace, 2009):</p>
<p><span class="math inline">\(y = \rho W_1 y + X\beta + \gamma W_2 X + \epsilon\)</span></p>
<p>Dengan:</p>
<p><span class="math display">\[\begin{align*}
y &amp; : \text{vektor peubah respon}, \\
W_1 &amp; : \text{matriks pembobot spasial bagi peubah respon berukuran } n \times n, \\
W_2 &amp; : \text{matriks pembobot spasial bagi peubah penjelas berukuran } n \times n, \\
\beta &amp; : \text{vektor koefisien parameter regresi}, \\
\epsilon &amp; : \text{vektor sisaan}, \\
\rho &amp; : \text{koefisien lag spasial pada peubah respon}, \\
\gamma &amp; : \text{koefisien lag spasial pada peubah penjelas}.
\end{align*}\]</span></p>
</section><section id="data" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="data">
<span class="header-section-number">1.2</span> Data</h2>
<p>Data yang digunakan pada penelitian ini merupakan data sekunder yang diambil dari situs <a href="https://opendata.jabarprov.go.id/id">Open Data Jabar</a>. Unit amatan pada penelitian ini adalah 27 kabupaten/kota di Jawa Barat. Peubah yang digunakan dapat dilihat pada tabel berikut.</p>
<table class="table-striped table-hover table">
<caption>Peubah yang Digunakan</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 61%">
<col style="width: 28%">
</colgroup>
<thead><tr class="header">
<th>Kode</th>
<th>Peubah</th>
<th>Sumber Pustaka</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(Y\)</span></td>
<td>Total produksi sampah dalam ton/jiwa/km2</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X1\)</span></td>
<td>PDRB tahun 2021</td>
<td>Prajati et al.&nbsp;(2015)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X2\)</span></td>
<td>Jumlah pengeluaran per kapita dalam ribu rupiah</td>
<td>Prajati et al.&nbsp;(2015)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X3\)</span></td>
<td>Rata-rata lama sekolah</td>
<td>Prajati et al.&nbsp;(2015)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X4\)</span></td>
<td>Angka melek huruf</td>
<td>Prajati et al.&nbsp;(2015)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X5\)</span></td>
<td>Jumlah UMKM &amp; Demirbas</td>
<td>Demirbas (2011)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X6\)</span></td>
<td>Jumlah tempat rekreasi dan pariwisata</td>
<td>Karim et al.&nbsp;(2022)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X7\)</span></td>
<td>Jumlah pasar rakyat</td>
<td>Persen</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X8\)</span></td>
<td>Jumlah restoran &amp; Demirbas</td>
<td>Demirbas (2011)</td>
</tr>
</tbody>
</table></section><section id="prosedur-analisis-data" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="prosedur-analisis-data">
<span class="header-section-number">1.3</span> Prosedur Analisis Data</h2>
<p>Analisis data dilakukan dengan menggunakan perangkat lunak R, dengan tahapan analisis data sebagai berikut:</p>
<ol type="1">
<li>
<strong>Eksplorasi Data:</strong>
<ul>
<li>Melakukan eksplorasi data untuk mengetahui karakteristik data.</li>
</ul>
</li>
<li>
<strong>Deteksi Multikolinieritas:</strong>
<ul>
<li><p>Mendeteksi multikolinieritas antar peubah penjelas dengan melihat nilai <em>Variance Inflation Factor</em> (VIF).</p></li>
<li>
<p>VIF dihitung menggunakan persamaan berikut:</p>
<p><span class="math inline">\(VIF = \frac{1}{1 - R_i^2}\)</span></p>
<p>dengan (R_i^2) adalah koefisien determinasi antara (X_i) dengan peubah penjelas lainnya.</p>
</li>
<li><p>Menurut Akinwande et al.&nbsp;(2015), nilai VIF yang lebih dari lima menunjukkan adanya multikolinieritas, menjadi acuan untuk mengeluarkan peubah penjelas dari model.</p></li>
</ul>
</li>
<li>
<strong>Transformasi Peubah:</strong>
<ul>
<li>Melakukan transformasi pada peubah (Y).</li>
<li>Melakukan transformasi pada peubah (X) yang memiliki nilai keragaman yang tinggi.</li>
</ul>
</li>
<li>
<strong>Uji Efek Spasial:</strong>
<ul>
<li>Keragaman Spasial menggunakan uji Breusch-Pagan berdasarkan persamaan.</li>
<li>Dependensi Spasial berdasarkan persamaan sampai persamaan.</li>
</ul>
</li>
<li>
<strong>Pendugaan Parameter Model SAR, SLX, dan SDM:</strong>
<ul>
<li>Menggunakan metode Maximum Likelihood.</li>
</ul>
</li>
<li>
<strong>Evaluasi Model:</strong>
<ul>
<li><p>Evaluasi model terbaik berdasarkan nilai Bayesian Information Criterion (BIC) terkecil dan Nagelkerke pseudo R-Squared terbesar.</p></li>
<li>
<p>Melakukan uji asumsi.</p>
<p><strong>BIC:</strong></p>
<p><span class="math inline">\(BIC = -2 \log(\hat{L}) + \log(N)K\)</span> dengan (<span class="math inline">\(\hat{L}\)</span>) adalah nilai maximum likelihood, (<span class="math inline">\(K\)</span>) adalah jumlah parameter yang diestimasi dalam model, dan (<span class="math inline">\(N\)</span>) adalah jumlah sampel (Li dan Nyholt, 2001).</p>
<p><strong>Nagelkerke Pseudo R-Squared:</strong></p>
<p><span class="math inline">\(\text{pseudo R}^2 = \frac{\left(1 - \frac{LL_0}{LL_F}\right)^{2/N}}{1 - \left(\frac{LL_0}{LL_F}\right)^{2/N}}\)</span> dengan (<span class="math inline">\(LL_0\)</span>) adalah nilai log likelihood dari model tanpa peubah penjelas, (<span class="math inline">\(LL_F\)</span>) adalah nilai log likelihood dari model dengan peubah penjelas, dan (<span class="math inline">\(N\)</span>) adalah jumlah sampel (Walker dan Smith, 2016).</p>
</li>
</ul>
</li>
<li>
<strong>Interpretasi dan Kesimpulan:</strong>
<ul>
<li>Melakukan interpretasi dari model yang terpilih dan menarik kesimpulan.</li>
</ul>
</li>
</ol></section><section id="tahapan-analisis-r" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="tahapan-analisis-r">
<span class="header-section-number">1.4</span> Tahapan Analisis R</h2>
<p>Tahap awal dalam pemodelan menggunakan R Studio adalah melakukan input data dan install package sesuai kebutuhan dalam analisis. Package yang perlu diinstall adalah sebagai berikut:</p>
<section id="package" class="level3"><h3 class="anchored" data-anchor-id="package">Package</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://rgdal.r-forge.r-project.org">rgdal</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'spdep' was built under R version 4.2.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'raster' was built under R version 4.2.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=rcompanion">rcompanion</a></span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'rcompanion' was built under R version 4.2.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'MASS' was built under R version 4.2.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'knitr' was built under R version 4.2.2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'zoo' was built under R version 4.2.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spatialreg/">spatialreg</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/">DescTools</a></span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'DescTools' was built under R version 4.2.2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://reporter.r-sassy.org">reporter</a></span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'reporter' was built under R version 4.2.3</span></span>
<span><span class="co"># Warning: package 'common' was built under R version 4.2.3</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co"># Warning: package 'ggplot2' was built under R version 4.2.2</span></span>
<span><span class="co"># Warning: package 'tidyr' was built under R version 4.2.3</span></span>
<span><span class="co"># Warning: package 'purrr' was built under R version 4.2.3</span></span>
<span><span class="co"># Warning: package 'stringr' was built under R version 4.2.3</span></span>
<span><span class="co"># Warning: package 'forcats' was built under R version 4.2.2</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="input-data" class="level3"><h3 class="anchored" data-anchor-id="input-data">Input Data</h3>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Data</span> <span class="op">&lt;-</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/produksi_sampah_jabar_2021.xlsx"</span><span class="op">)</span></span>
<span><span class="va">Y</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">7</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">13</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">9</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">16</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">11</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">14</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">15</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">X8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">Data</span><span class="op">[</span>,<span class="fl">12</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y2</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">/</span><span class="va">X</span></span>
<span><span class="va">Data</span><span class="op">$</span><span class="va">produksi_sampah_per_kepadatan</span><span class="op">&lt;-</span><span class="va">Y2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="input-peta-pulau-jawa" class="level3"><h3 class="anchored" data-anchor-id="input-peta-pulau-jawa">Input Peta Pulau Jawa</h3>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Spherical geometry (s2) switched off</span></span>
<span><span class="va">petajawa</span><span class="op">&lt;-</span> <span class="fu"><a href="http://rgdal.r-forge.r-project.org/reference/readOGR.html">readOGR</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/shp/jawa.shp"</span>, layer<span class="op">=</span><span class="st">"jawa"</span><span class="op">)</span></span>
<span><span class="co"># OGR data source with driver: ESRI Shapefile </span></span>
<span><span class="co"># Source: "E:\Materi_Orasi\bookdown\data\shp\jawa.shp", layer: "jawa"</span></span>
<span><span class="co"># with 119 features</span></span>
<span><span class="co"># It has 5 fields</span></span>
<span><span class="co"># subset peta pulau jawa menjadi jawa barat</span></span>
<span><span class="va">petajabar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">petajawa</span>,<span class="va">PROVINSI</span><span class="op">==</span><span class="st">"JAWA BARAT"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Menambahkan kolom variabel dalam file shp</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">sampah</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">jumlah_produksi_sampah</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">PDRB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">RLS</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">RLS</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">kepadatan</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">Kepadatan</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">umkm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Data</span><span class="op">$</span><span class="va">jumlah_umkm</span><span class="op">)</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">pengeluaran</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">jumlah_pengeluaran_per_kapita</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">restoran</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">jumlah_restoran</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">AMH</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">Angka_melek_huruf</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">pasar</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">Jumlah_pasar_rakyat</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">rekreasi</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">Jumlah_tempat_rekreasi_dan_pariwisata</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">daerah</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">nama_kabupaten_kota</span></span>
<span><span class="va">petajabar</span><span class="op">$</span><span class="va">prod_sampah</span> <span class="op">&lt;-</span> <span class="va">Data</span><span class="op">$</span><span class="va">produksi_sampah_per_kepadatan</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="eksplorasi-data" class="level3"><h3 class="anchored" data-anchor-id="eksplorasi-data">Eksplorasi Data</h3>
<p>Peta sebaran produksi sampah per kepadatan penduduk dapat dihasilkan dengan syntax berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Peta Produksi Sampah per Kepadatan Penduduk</span></span>
<span><span class="co"># Create list object for sp.layout</span></span>
<span><span class="va">sp.label</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">label</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"sp.text"</span>, <span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html">coordinates</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">label</span>, cex <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">NUMB.sp.label</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu">sp.label</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">daerah</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">make.NUMB.sp.label</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="st">"list"</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">colfunc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>,<span class="st">"orange"</span>,<span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">color</span><span class="op">&lt;-</span><span class="fu">colfunc</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://edzer.github.io/sp/reference/spplot.html">spplot</a></span><span class="op">(</span><span class="va">petajabar</span>, <span class="st">"prod_sampah"</span>, col.regions<span class="op">=</span><span class="va">color</span>, </span>
<span>       cex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>       bg <span class="op">=</span> <span class="st">"white"</span>, border<span class="op">=</span><span class="st">"light grey"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Diagram kotak garis dari produksi sampah per kepadatan penduduk dapat dihasilkan menggunakan syntax</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Y2</span>, xlab <span class="op">=</span> <span class="st">"Produksi sampah per kepadatan penduduk"</span>, horizontal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Berdasarkan diagram kotak garis, dapat dilihat bahwa garis di bagian kanan diagram kotak garis lebih panjang. Hal tersebut menunjukkan bahwa data produksi sampah per kepadatan penduduk cenderung menjulur ke kanan.</p>
<p>Nilai deskriptif merupakan gambaran dari data yang akan digunakan dalam penelitian dan nilai deskriptif dari seluruh peubah yang digunakan pada penelitian ini ditampilkan pada Tabel 2. Peubah penjelas yang memiliki nilai minimum paling kecil adalah peubah X8 dengan nilai 0. Wilayah yang memiliki peubah X8 atau jumlah restoran sama dengan 0 adalah Kabupaten Kuningan. Wilayah yang memiliki jumlah restoran terbanyak adalah Kota Bekasi dengan jumlah sebanyak 1024 restoran. Peubah penjelas dengan nilai rataan tertinggi yaitu peubah X5 atau jumlah UMKM. Sedangkan peubah penjelas dengan rataan terkecil dibandingkan peubah lainnya adalah X3 atau rata-rata lama sekolah. Peubah penjelas dengan nilai standar deviasi yang tinggi adalah peubah X1 dan X5.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tabel_deskriptif</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">X4</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">X6</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">X7</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">X8</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">X4</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">X6</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">X7</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">X8</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">X4</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">X6</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">X7</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">X8</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X4</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X6</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X7</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X8</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X4</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X6</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X7</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X8</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">9</span>,</span>
<span>    byrow <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">tabel_deskriptif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabel_deskriptif</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tabel_deskriptif</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Minimum"</span>, <span class="st">"Maksimum"</span>, <span class="st">"Median"</span>, <span class="st">"Rataan"</span>, <span class="st">"Standar Deviasi"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tabel_deskriptif</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span>, <span class="st">"X5"</span>, <span class="st">"X6"</span>, <span class="st">"X7"</span>, <span class="st">"X8"</span><span class="op">)</span></span>
<span><span class="va">tabel_deskriptif</span></span>
<span><span class="co">#                    Y     X1    X2    X3     X4     X5    X6   X7</span></span>
<span><span class="co"># Minimum         0.01   3364  7829  6.52  93.76  34962   7.0  4.0</span></span>
<span><span class="co"># Maksimum        0.92 251829 16996 11.46  99.95 506347 300.0 95.0</span></span>
<span><span class="co"># Median          0.20  32898 10368  8.20  99.38 219238  63.0 33.0</span></span>
<span><span class="co"># Rataan          0.32  56562 10781  8.66  98.70 231755  95.7 36.3</span></span>
<span><span class="co"># Standar Deviasi 0.28  63129  2279  1.47   1.52 133919  81.5 24.7</span></span>
<span><span class="co">#                   X8</span></span>
<span><span class="co"># Minimum            0</span></span>
<span><span class="co"># Maksimum        1024</span></span>
<span><span class="co"># Median            47</span></span>
<span><span class="co"># Rataan           176</span></span>
<span><span class="co"># Standar Deviasi  295</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pemeriksaan-multikolinearitas" class="level3"><h3 class="anchored" data-anchor-id="pemeriksaan-multikolinearitas">Pemeriksaan Multikolinearitas</h3>
<p>Pemeriksaan multikolinearitas menggunakan syntax sebagai berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reglin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">reglin</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#    [,1]</span></span>
<span><span class="co"># X1 2.79</span></span>
<span><span class="co"># X2 4.75</span></span>
<span><span class="co"># X3 9.26</span></span>
<span><span class="co"># X4 2.88</span></span>
<span><span class="co"># X5 3.64</span></span>
<span><span class="co"># X6 1.57</span></span>
<span><span class="co"># X7 4.04</span></span>
<span><span class="co"># X8 2.75</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Berdasarkan output di atas, terlihat bahwa nilai VIF dari peubah X3 lebih dari lima sehingga peubah X3 tidak akan disertakan dalam model.</p>
</section><section id="transformasi-peubah" class="level3"><h3 class="anchored" data-anchor-id="transformasi-peubah">Transformasi Peubah</h3>
<p>Berdasarkan hasil eksplorasi data, diketahui bahwa peubah respon menjulur ke kanan. Selain itu, peubah penjelas X1 dan X5 memiliki nilai standar deviasi yang tinggi. Hal tersebut mengindikasikan bahwa perlu dilakukan penanganan berupa transformasi pada peubah respon dan peubah penjelas. Transformasi logaritma natural merupakan transformasi yang umum dilakukan untuk peubah respon yang menjulur ke kanan (Gujarati dan Porter 2009). Penerapan transformasi pada peubah dilakukan menggunakan syntax berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Transformasi peubah respon</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">normalitas_Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">statistic</span>,<span class="va">x</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">normalitas_Y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Nilai statistik"</span>, <span class="st">"p-value"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">normalitas_Y</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Uji Normalitas Y"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">as.table</a></span><span class="op">(</span><span class="va">normalitas_Y</span><span class="op">)</span></span>
<span><span class="co">#                  Nilai statistik p-value</span></span>
<span><span class="co"># Uji Normalitas Y           0.942   0.138</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Berdasarkan hasil Uji normalitas Shapiro Wilk, didapatkan nilai nilai-p sebesar 0.14 sehingga dapat disimpulkan bahwa transformasi terhadap peubah respon telah membuat peubah menyebar mengikuti sebaran normal</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Transformasi peubah penjelas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">~</span><span class="va">X1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">~</span><span class="va">X5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Berdasarkan gambar di atas, dapat dilihat bahwa nilai 0 berada pada selang nilai λ dari peubah respon X1 dan X5, sehingga transformasi yang akan digunakan adalah transformasi logaritma natural.</p>
</section><section id="pengujian-efek-spasial" class="level3"><h3 class="anchored" data-anchor-id="pengujian-efek-spasial">Pengujian Efek Spasial</h3>
<ol type="a">
<li>
<p>Uji Breusch-Pagan</p>
<p>Uji Breusch-Pagan dilakukan menggunakan syntax berikut:</p>
</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reglin2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span><span class="op">+</span><span class="va">X6</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">reglin2</span><span class="op">)</span></span>
<span><span class="co"># </span></span>
<span><span class="co">#   studentized Breusch-Pagan test</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># data:  reglin2</span></span>
<span><span class="co"># BP = 2, df = 8, p-value = 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hasil uji menunjukkan nilai-p &gt; 0.05, sehingga dapat disimpulkan tidak terdapat heterogenitas spasial</p>
<ol start="2" type="a">
<li>
<p>Uji LM dan indeks Moran</p>
<p>untuk melakukan uji LM dan indeks Moran, perlu ditentukan terlebih dahulu matriks pembobot yang akan digunakan. Pada penelitian ini akan menggunakan matriks bobot ketetanggaan Queen, ketetanggaan rook, jarak eksponensial negatif, dan invers jarak. Berikut merupakan syntax yang digunakan untuk membuat matriks bobot:</p>
</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Matriks queen ####</span></span>
<span><span class="va">queen.nb</span><span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="va">petajabar</span>, queen <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#Pembobot queen</span></span>
<span><span class="co"># although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></span>
<span><span class="va">queen.listw</span><span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">queen.nb</span><span class="op">)</span> <span class="co">#convert nb to listw type</span></span>
<span><span class="va">queen.jabar</span><span class="op">=</span> <span class="va">queen.listw</span></span>
<span><span class="va">mat.queen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">listw2mat</a></span><span class="op">(</span><span class="va">queen.listw</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### Matriks rook ####</span></span>
<span><span class="va">rook.nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="va">petajabar</span>,queen <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co"># although coordinates are longitude/latitude, st_intersects assumes that they are planar</span></span>
<span><span class="va">rook.listw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">rook.nb</span><span class="op">)</span></span>
<span><span class="va">rook.jabar</span> <span class="op">&lt;-</span> <span class="va">rook.listw</span></span>
<span><span class="va">mat.rook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">listw2mat</a></span><span class="op">(</span><span class="va">rook.listw</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### inverse distance ####</span></span>
<span><span class="va">coor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/coordinates.html">coordinates</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">)</span></span>
<span><span class="va">D</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">coor</span>,method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># inverse weight matrix</span></span>
<span><span class="va">w</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">D</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span><span class="va">rtot</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">w</span>, na.rm <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">w_std</span><span class="op">&lt;-</span><span class="va">w</span><span class="op">/</span><span class="va">rtot</span></span>
<span><span class="va">invers.w</span><span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">w_std</span>, style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span>
<span><span class="va">mat.inv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">listw2mat</a></span><span class="op">(</span><span class="va">invers.w</span><span class="op">)</span></span>
<span></span>
<span><span class="va">w2</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">D</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">w2</span><span class="op">)</span><span class="op">&lt;-</span><span class="fl">0</span></span>
<span><span class="va">rtot</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">w2</span>, na.rm <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">w_std2</span><span class="op">&lt;-</span><span class="va">w2</span><span class="op">/</span><span class="va">rtot</span></span>
<span><span class="va">invers.w2</span><span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">w_std2</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span>
<span><span class="va">mat.inv2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">listw2mat</a></span><span class="op">(</span><span class="va">invers.w2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### Exponential distance ####</span></span>
<span><span class="va">alpha1</span><span class="op">=</span><span class="fl">1</span></span>
<span><span class="va">W.eksp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">(</span><span class="op">-</span><span class="va">alpha1</span><span class="op">)</span><span class="op">*</span><span class="va">D</span><span class="op">)</span> </span>
<span><span class="co">#dinormalisasi </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W.eksp1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rtot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">W.eksp1</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">W.eksp.sd1</span> <span class="op">&lt;-</span> <span class="va">W.eksp1</span><span class="op">/</span><span class="va">rtot3</span> <span class="co">#row-normalized </span></span>
<span><span class="va">W.eksp.s1</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">W.eksp.sd1</span>, style<span class="op">=</span><span class="st">'W'</span><span class="op">)</span> </span>
<span><span class="va">mat.eksp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">listw2mat</a></span><span class="op">(</span><span class="va">W.eksp.s1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alpha2</span><span class="op">=</span><span class="fl">2</span></span>
<span><span class="va">W.eksp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">(</span><span class="op">-</span><span class="va">alpha2</span><span class="op">)</span><span class="op">*</span><span class="va">D</span><span class="op">)</span> </span>
<span><span class="co">#dinormalisasi </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W.eksp2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rtot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">W.eksp2</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">W.eksp.sd2</span> <span class="op">&lt;-</span> <span class="va">W.eksp2</span><span class="op">/</span><span class="va">rtot3</span> <span class="co">#row-normalized </span></span>
<span><span class="va">W.eksp.s2</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">W.eksp.sd2</span>, style<span class="op">=</span><span class="st">'W'</span><span class="op">)</span> </span>
<span><span class="va">mat.eksp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">listw2mat</a></span><span class="op">(</span><span class="va">W.eksp.s2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Setelah dibuat matriks pembobot, maka akan dilakukan pengujian LM dengan semua matriks pembobot.</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### LM Test Model 1 ####</span></span>
<span><span class="va">reglin2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span> <span class="op">+</span> <span class="va">X6</span> <span class="op">+</span> <span class="va">X7</span> <span class="op">+</span> <span class="va">X8</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#LM dengan queen</span></span>
<span><span class="va">LM_Queen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.RStests</a></span><span class="op">(</span><span class="va">reglin2</span>,</span>
<span>                       <span class="va">queen.jabar</span>,</span>
<span>                       test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#LM rook</span></span>
<span><span class="va">LM_rook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.RStests</a></span><span class="op">(</span><span class="va">reglin2</span>,</span>
<span>                      <span class="va">rook.jabar</span>,</span>
<span>                      test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#LM Inverse</span></span>
<span><span class="va">LM_inv_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.RStests</a></span><span class="op">(</span><span class="va">reglin2</span>,</span>
<span>                       <span class="va">invers.w</span>,</span>
<span>                       test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LM_inv_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.RStests</a></span><span class="op">(</span><span class="va">reglin2</span>,</span>
<span>                       <span class="va">invers.w2</span>,</span>
<span>                       test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#LM Exponential</span></span>
<span><span class="va">LM_exp_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.RStests</a></span><span class="op">(</span><span class="va">reglin2</span>,</span>
<span>                       <span class="va">W.eksp.s1</span>,</span>
<span>                       test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LM_exp_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.RStests</a></span><span class="op">(</span><span class="va">reglin2</span>,</span>
<span>                       <span class="va">W.eksp.s2</span>,</span>
<span>                       test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tabel_uji_LM</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>      <span class="va">LM_Queen</span><span class="op">$</span><span class="va">RSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_Queen</span><span class="op">$</span><span class="va">RSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_Queen</span><span class="op">$</span><span class="va">adjRSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_Queen</span><span class="op">$</span><span class="va">adjRSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_Queen</span><span class="op">$</span><span class="va">SARMA</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_rook</span><span class="op">$</span><span class="va">RSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_rook</span><span class="op">$</span><span class="va">RSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_rook</span><span class="op">$</span><span class="va">adjRSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_rook</span><span class="op">$</span><span class="va">adjRSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_rook</span><span class="op">$</span><span class="va">SARMA</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_1</span><span class="op">$</span><span class="va">RSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_1</span><span class="op">$</span><span class="va">RSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_1</span><span class="op">$</span><span class="va">adjRSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_1</span><span class="op">$</span><span class="va">adjRSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_1</span><span class="op">$</span><span class="va">SARMA</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_2</span><span class="op">$</span><span class="va">RSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_2</span><span class="op">$</span><span class="va">RSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_2</span><span class="op">$</span><span class="va">adjRSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_2</span><span class="op">$</span><span class="va">adjRSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_inv_2</span><span class="op">$</span><span class="va">SARMA</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_1</span><span class="op">$</span><span class="va">RSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_1</span><span class="op">$</span><span class="va">RSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_1</span><span class="op">$</span><span class="va">adjRSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_1</span><span class="op">$</span><span class="va">adjRSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_1</span><span class="op">$</span><span class="va">SARMA</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_2</span><span class="op">$</span><span class="va">RSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_2</span><span class="op">$</span><span class="va">RSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_2</span><span class="op">$</span><span class="va">adjRSerr</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_2</span><span class="op">$</span><span class="va">adjRSlag</span><span class="op">$</span><span class="va">p.value</span>,</span>
<span>      <span class="va">LM_exp_2</span><span class="op">$</span><span class="va">SARMA</span><span class="op">$</span><span class="va">p.value</span></span>
<span>    <span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">6</span>,</span>
<span>    byrow <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">tabel_uji_LM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabel_uji_LM</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tabel_uji_LM</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LMlag"</span>, <span class="st">"LMerr"</span>, <span class="st">"RLMlag"</span>, <span class="st">"RLMerr"</span>, <span class="st">"SARMA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tabel_uji_LM</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Queen"</span>,</span>
<span>  <span class="st">"Rook"</span>,</span>
<span>  <span class="st">"Jarak Inverse-1"</span>,</span>
<span>  <span class="st">"Jarak Inverse-2"</span>,</span>
<span>  <span class="st">"Negatif Eksponensial-1"</span>,</span>
<span>  <span class="st">"Negatif Eksponensial-2"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">tabel_uji_LM</span><span class="op">)</span></span>
<span><span class="co">#                        LMlag LMerr RLMlag RLMerr SARMA</span></span>
<span><span class="co"># Queen                  0.388 0.098  0.397  0.100 0.178</span></span>
<span><span class="co"># Rook                   0.388 0.098  0.397  0.100 0.178</span></span>
<span><span class="co"># Jarak Inverse-1        0.159 0.010  0.279  0.016 0.021</span></span>
<span><span class="co"># Jarak Inverse-2        0.175 0.011  0.461  0.023 0.030</span></span>
<span><span class="co"># Negatif Eksponensial-1 0.458 0.679  0.052  0.065 0.139</span></span>
<span><span class="co"># Negatif Eksponensial-2 0.574 0.951  0.066  0.080 0.184</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Berdasarkan hasil Uji LM, diketahui bahwa matriks jarak invers 1 memberikan nilai LMlag, RLMlag, dan SARMA yang signifikan pada taraf nyata α = 0,05 dan paling kecil jika dibandingkan dengan matriks pembobot yang lainnya.</p>
<p>Selanjutnya akan dilakukan pengujian indeks Moran dari setiap peubah penjelas dengan syntax berikut</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Moran Test: Queen Contiguity</span></span>
<span><span class="va">q_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span>,<span class="va">queen.jabar</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X1</span></span>
<span><span class="va">q_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pengeluaran</span>,<span class="va">queen.jabar</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X2</span></span>
<span><span class="va">q_x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">AMH</span>,<span class="va">queen.jabar</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X4</span></span>
<span><span class="va">q_x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">umkm</span><span class="op">)</span>,<span class="va">queen.jabar</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X5</span></span>
<span><span class="va">q_x6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">rekreasi</span>,<span class="va">queen.jabar</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X6</span></span>
<span><span class="va">q_x7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pasar</span>,<span class="va">queen.jabar</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X7</span></span>
<span><span class="va">q_x8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">restoran</span>,<span class="va">queen.jabar</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X8</span></span>
<span></span>
<span><span class="co">#Moran Test: Rook Contiguity</span></span>
<span><span class="va">r_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span>,<span class="va">rook.jabar</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X1</span></span>
<span><span class="va">r_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pengeluaran</span>,<span class="va">rook.jabar</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X2</span></span>
<span><span class="va">r_x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">AMH</span>,<span class="va">rook.jabar</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X4</span></span>
<span><span class="va">r_x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">umkm</span><span class="op">)</span>,<span class="va">rook.jabar</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X5</span></span>
<span><span class="va">r_x6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">rekreasi</span>,<span class="va">rook.jabar</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X6</span></span>
<span><span class="va">r_x7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pasar</span>,<span class="va">rook.jabar</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X7</span></span>
<span><span class="va">r_x8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">restoran</span>,<span class="va">rook.jabar</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X8</span></span>
<span></span>
<span><span class="co">#Moran Test: Inverse Distance 1</span></span>
<span><span class="va">idw_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span>,<span class="va">invers.w</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X1</span></span>
<span><span class="va">idw_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pengeluaran</span>,<span class="va">invers.w</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X2</span></span>
<span><span class="va">idw_x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">AMH</span>,<span class="va">invers.w</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X4</span></span>
<span><span class="va">idw_x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">umkm</span><span class="op">)</span>,<span class="va">invers.w</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X5</span></span>
<span><span class="va">idw_x6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">rekreasi</span>,<span class="va">invers.w</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X6</span></span>
<span><span class="va">idw_x7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pasar</span>,<span class="va">invers.w</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X7</span></span>
<span><span class="va">idw_x8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">restoran</span>,<span class="va">invers.w</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X8</span></span>
<span></span>
<span><span class="co">#Moran Test: Inverse Distance 2</span></span>
<span><span class="va">idw2_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span>,<span class="va">invers.w2</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X1</span></span>
<span><span class="va">idw2_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pengeluaran</span>,<span class="va">invers.w2</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X2</span></span>
<span><span class="va">idw2_x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">AMH</span>,<span class="va">invers.w2</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X4</span></span>
<span><span class="va">idw2_x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">umkm</span><span class="op">)</span>,<span class="va">invers.w2</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X5</span></span>
<span><span class="va">idw2_x6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">rekreasi</span>,<span class="va">invers.w2</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X6</span></span>
<span><span class="va">idw2_x7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pasar</span>,<span class="va">invers.w2</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X7</span></span>
<span><span class="va">idw2_x8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">restoran</span>,<span class="va">invers.w2</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X8</span></span>
<span></span>
<span><span class="co">#Moran Test: Exponential Distance 1</span></span>
<span><span class="va">exp1_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span>,<span class="va">W.eksp.s1</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X1</span></span>
<span><span class="va">exp1_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pengeluaran</span>,<span class="va">W.eksp.s1</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X2</span></span>
<span><span class="va">exp1_x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">AMH</span>,<span class="va">W.eksp.s1</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X4</span></span>
<span><span class="va">exp1_x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">umkm</span><span class="op">)</span>,<span class="va">W.eksp.s1</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X5</span></span>
<span><span class="va">exp1_x6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">rekreasi</span>,<span class="va">W.eksp.s1</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X6</span></span>
<span><span class="va">exp1_x7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pasar</span>,<span class="va">W.eksp.s1</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X7</span></span>
<span><span class="va">exp1_x8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">restoran</span>,<span class="va">W.eksp.s1</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X8</span></span>
<span></span>
<span><span class="co">#Moran Test: Exponential Distance 2</span></span>
<span><span class="va">exp2_x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">PDRB</span><span class="op">)</span>,<span class="va">W.eksp.s2</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X1</span></span>
<span><span class="va">exp2_x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pengeluaran</span>,<span class="va">W.eksp.s2</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X2</span></span>
<span><span class="va">exp2_x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">AMH</span>,<span class="va">W.eksp.s2</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X4</span></span>
<span><span class="va">exp2_x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">umkm</span><span class="op">)</span>,<span class="va">W.eksp.s2</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X5</span></span>
<span><span class="va">exp2_x6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">rekreasi</span>,<span class="va">W.eksp.s2</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X6</span></span>
<span><span class="va">exp2_x7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">pasar</span>,<span class="va">W.eksp.s2</span>,randomisation <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#X7</span></span>
<span><span class="va">exp2_x8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">restoran</span>,<span class="va">W.eksp.s2</span>,randomisation<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co">#X8</span></span>
<span></span>
<span><span class="va">tabel_moran</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">q_x1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">q_x2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">q_x4</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">q_x5</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">q_x6</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">q_x7</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">q_x8</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">r_x1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">r_x2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">r_x4</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">r_x5</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">r_x6</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">r_x7</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">r_x8</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw_x1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw_x2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw_x4</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw_x5</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw_x6</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw_x7</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw_x8</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw2_x1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw2_x2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw2_x4</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw2_x5</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw2_x6</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw2_x7</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">idw2_x8</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp1_x1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp1_x2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp1_x4</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp1_x5</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp1_x6</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp1_x7</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp1_x8</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp2_x1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp2_x2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp2_x4</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp2_x5</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp2_x6</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp2_x7</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">exp2_x8</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">7</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">tabel_moran</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabel_moran</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tabel_moran</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Queen"</span>, <span class="st">"Rook"</span>, <span class="st">"Jarak Inverse-1"</span>, <span class="st">"Jarak Inverse-2"</span>, <span class="st">"Negatif Eksponensial-1"</span>, <span class="st">"Negatif Eksponensial-2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tabel_moran</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>,<span class="st">"X4"</span>, <span class="st">"X5"</span>, <span class="st">"X6"</span>, <span class="st">"X7"</span>, <span class="st">"X8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">tabel_moran</span><span class="op">)</span></span>
<span><span class="co">#    Queen  Rook Jarak Inverse-1 Jarak Inverse-2</span></span>
<span><span class="co"># X1 0.005 0.007           0.000           0.690</span></span>
<span><span class="co"># X2 0.000 0.005           0.007           0.000</span></span>
<span><span class="co"># X4 0.672 0.000           0.017           0.114</span></span>
<span><span class="co"># X5 0.386 0.797           0.000           0.009</span></span>
<span><span class="co"># X6 0.876 0.500           0.932           0.000</span></span>
<span><span class="co"># X7 0.001 0.200           0.747           0.807</span></span>
<span><span class="co"># X8 0.006 0.000           0.293           0.751</span></span>
<span><span class="co">#    Negatif Eksponensial-1 Negatif Eksponensial-2</span></span>
<span><span class="co"># X1                  0.373                  0.672</span></span>
<span><span class="co"># X2                  0.690                  0.373</span></span>
<span><span class="co"># X4                  0.059                  0.888</span></span>
<span><span class="co"># X5                  0.060                  0.025</span></span>
<span><span class="co"># X6                  0.000                  0.004</span></span>
<span><span class="co"># X7                  0.000                  0.000</span></span>
<span><span class="co"># X8                  0.854                  0.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Berdasarkan hasil uji indeks Moran, dapat dilihat bahwa peubah X1, X2, X4, dan X8 memiliki dependensi spasial. Pada penelitian ini akan digunakan matriks pembobot jarak eksponensial negatif (s = 1) sebagai matriks pembobot bagi peubah X1, X2, X4, dan X8. &nbsp;<br></p>
</section><section id="pemodelan-regresi-spasial" class="level3"><h3 class="anchored" data-anchor-id="pemodelan-regresi-spasial">Pemodelan Regresi Spasial</h3>
<p>Model yang akan dibangun adalah model SAR, model SLX, dan model SDM dengan syntax berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WX1</span> <span class="op">&lt;-</span> <span class="va">mat.eksp1</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span></span>
<span><span class="va">WX2</span> <span class="op">&lt;-</span> <span class="va">mat.eksp1</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">X2</span></span>
<span><span class="va">WX4</span> <span class="op">&lt;-</span> <span class="va">mat.eksp1</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">X4</span></span>
<span><span class="va">WX8</span> <span class="op">&lt;-</span> <span class="va">mat.eksp1</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">X8</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span><span class="op">+</span><span class="va">X6</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X8</span></span>
<span><span class="va">W.model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span><span class="op">+</span><span class="va">X6</span><span class="op">+</span><span class="va">X7</span><span class="op">+</span><span class="va">X8</span><span class="op">+</span><span class="va">WX1</span><span class="op">+</span><span class="va">WX2</span><span class="op">+</span><span class="va">WX4</span><span class="op">+</span><span class="va">WX8</span></span>
<span><span class="co">#SAR</span></span>
<span><span class="va">mod.sar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/ML_models.html">lagsarlm</a></span><span class="op">(</span><span class="va">model1</span>, listw <span class="op">=</span> <span class="va">invers.w2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod.sar</span>, Nagelkerke <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Call:lagsarlm(formula = model1, listw = invers.w2)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Residuals:</span></span>
<span><span class="co">#       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co"># -0.977977 -0.280736 -0.072287  0.265184  1.528045 </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Type: lag </span></span>
<span><span class="co"># Coefficients: (asymptotic standard errors) </span></span>
<span><span class="co">#                Estimate  Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co"># (Intercept)  1.4894e+01  8.1550e+00  1.8263 0.067804</span></span>
<span><span class="co"># log(X1)     -4.9444e-02  2.2834e-01 -0.2165 0.828572</span></span>
<span><span class="co"># X2          -4.9239e-05  7.4524e-05 -0.6607 0.508795</span></span>
<span><span class="co"># X4          -2.4275e-01  7.1549e-02 -3.3927 0.000692</span></span>
<span><span class="co"># log(X5)      7.0580e-01  3.4319e-01  2.0566 0.039725</span></span>
<span><span class="co"># X6           3.8718e-03  1.4658e-03  2.6414 0.008256</span></span>
<span><span class="co"># X7           1.4585e-02  6.7606e-03  2.1573 0.030979</span></span>
<span><span class="co"># X8          -5.6650e-06  4.9770e-04 -0.0114 0.990918</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Rho: 0.521, LR test value: 7.86, p-value: 0.0050615</span></span>
<span><span class="co"># Asymptotic standard error: 0.149</span></span>
<span><span class="co">#     z-value: 3.51, p-value: 0.00045492</span></span>
<span><span class="co"># Wald statistic: 12.3, p-value: 0.00045492</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Log likelihood: -20.7 for lag model</span></span>
<span><span class="co"># ML residual variance (sigma squared): 0.252, (sigma: 0.502)</span></span>
<span><span class="co"># Nagelkerke pseudo-R-squared: 0.793 </span></span>
<span><span class="co"># Number of observations: 27 </span></span>
<span><span class="co"># Number of parameters estimated: 10 </span></span>
<span><span class="co"># AIC: 61.5, (AIC for lm: 67.3)</span></span>
<span><span class="co"># LM test for residual autocorrelation</span></span>
<span><span class="co"># test value: 0.00113, p-value: 0.97315</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hasil di atas menunjukkan peubah penjelas yang berpengaruh signifikan terhadap total produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 yaitu X4 (angka melek huruf), X5 (jumlah UMKM), X6 (jumlah tempat rekreasi dan pariwisata), dan X7 (jumlah pasar rakyat). Koefisien lag spasial (ρ) juga berpengaruh terhadap model SAR pada taraf nyata α = 0,05</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod.slx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">W.model1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod.slx</span><span class="op">)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Call:</span></span>
<span><span class="co"># lm(formula = W.model1)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Residuals:</span></span>
<span><span class="co">#     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co"># -1.1161 -0.2879 -0.0812  0.4076  1.2618 </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Coefficients:</span></span>
<span><span class="co">#              Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co"># (Intercept)  2.35e+02   1.84e+02    1.27    0.222  </span></span>
<span><span class="co"># log(X1)     -7.44e-02   5.35e-01   -0.14    0.891  </span></span>
<span><span class="co"># X2          -1.50e-04   2.84e-04   -0.53    0.605  </span></span>
<span><span class="co"># X4          -2.03e-01   1.36e-01   -1.50    0.155  </span></span>
<span><span class="co"># log(X5)      6.88e-01   5.45e-01    1.26    0.226  </span></span>
<span><span class="co"># X6           4.32e-03   2.17e-03    1.99    0.065 .</span></span>
<span><span class="co"># X7           1.76e-02   1.03e-02    1.71    0.107  </span></span>
<span><span class="co"># X8           8.53e-05   1.03e-03    0.08    0.935  </span></span>
<span><span class="co"># WX1          2.55e+00   4.11e+00    0.62    0.545  </span></span>
<span><span class="co"># WX2         -8.69e-04   4.20e-03   -0.21    0.839  </span></span>
<span><span class="co"># WX4         -2.44e+00   1.84e+00   -1.33    0.205  </span></span>
<span><span class="co"># WX8          3.80e-03   1.52e-02    0.25    0.806  </span></span>
<span><span class="co"># ---</span></span>
<span><span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Residual standard error: 0.733 on 15 degrees of freedom</span></span>
<span><span class="co"># Multiple R-squared:  0.773,   Adjusted R-squared:  0.607 </span></span>
<span><span class="co"># F-statistic: 4.66 on 11 and 15 DF,  p-value: 0.00351</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hasil di atas menunjukkan tidak ada peubah penjelas yang berpengaruh terhadap produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 pada taraf nyata α = 0,05.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod.sdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/ML_models.html">lagsarlm</a></span><span class="op">(</span><span class="va">W.model1</span>, listw <span class="op">=</span> <span class="va">invers.w2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod.sdm</span>, Nagelkerke <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Call:lagsarlm(formula = W.model1, listw = invers.w2)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Residuals:</span></span>
<span><span class="co">#       Min        1Q    Median        3Q       Max </span></span>
<span><span class="co"># -1.039830 -0.281965 -0.019636  0.316451  0.927201 </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Type: lag </span></span>
<span><span class="co"># Coefficients: (asymptotic standard errors) </span></span>
<span><span class="co">#                Estimate  Std. Error z value  Pr(&gt;|z|)</span></span>
<span><span class="co"># (Intercept)  1.5492e+02  1.1710e+02  1.3229 0.1858694</span></span>
<span><span class="co"># log(X1)     -4.9455e-01  3.2901e-01 -1.5031 0.1328066</span></span>
<span><span class="co"># X2           1.2615e-04  1.7741e-04  0.7110 0.4770697</span></span>
<span><span class="co"># X4          -1.1749e-01  8.3108e-02 -1.4137 0.1574386</span></span>
<span><span class="co"># log(X5)      1.1034e+00  3.3289e-01  3.3146 0.0009178</span></span>
<span><span class="co"># X6           3.3092e-03  1.3100e-03  2.5262 0.0115317</span></span>
<span><span class="co"># X7           1.5955e-02  6.1723e-03  2.5850 0.0097381</span></span>
<span><span class="co"># X8          -6.3528e-04  6.2430e-04 -1.0176 0.3088765</span></span>
<span><span class="co"># WX1         -1.8403e+00  2.5883e+00 -0.7110 0.4770779</span></span>
<span><span class="co"># WX2          3.4793e-03  2.6296e-03  1.3231 0.1857951</span></span>
<span><span class="co"># WX4         -1.7319e+00  1.1696e+00 -1.4807 0.1386765</span></span>
<span><span class="co"># WX8         -8.7316e-03  9.4836e-03 -0.9207 0.3572017</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Rho: 0.62, LR test value: 8.37, p-value: 0.0038193</span></span>
<span><span class="co"># Asymptotic standard error: 0.142</span></span>
<span><span class="co">#     z-value: 4.36, p-value: 1.2842e-05</span></span>
<span><span class="co"># Wald statistic: 19, p-value: 1.2842e-05</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Log likelihood: -17.8 for lag model</span></span>
<span><span class="co"># ML residual variance (sigma squared): 0.195, (sigma: 0.441)</span></span>
<span><span class="co"># Nagelkerke pseudo-R-squared: 0.834 </span></span>
<span><span class="co"># Number of observations: 27 </span></span>
<span><span class="co"># Number of parameters estimated: 14 </span></span>
<span><span class="co"># AIC: 63.6, (AIC for lm: 70)</span></span>
<span><span class="co"># LM test for residual autocorrelation</span></span>
<span><span class="co"># test value: 0.681, p-value: 0.40907</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hasil di atas menunjukkan peubah penjelas yang berpengaruh signifikan terhadap total produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 yaitu X5(jumlah UMKM), X6(jumlah tempat rekreasi dan pariwisata), dan X7(jumlah pasar rakyat). Koefisien lag spasial (ρ) juga berpengaruh terhadap model SDM pada taraf nyata α = 0,05. Hanya koefisien lag spasial peubah penjelas X4 yang berpengaruh nyata terhadap model SDM pada taraf nyata α = 0,05. Hal tersebut mengindikasikan bahwa penambahan lag spasial peubah penjelas dalam model tidak berpengaruh terhadap model.</p>
</section><section id="pemilihan-model-terbaik" class="level3"><h3 class="anchored" data-anchor-id="pemilihan-model-terbaik">Pemilihan Model Terbaik</h3>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pseudo_sar</span> <span class="op">&lt;-</span> <span class="fl">0.7934</span></span>
<span><span class="va">pseudo_slx</span> <span class="op">&lt;-</span> <span class="fl">0.6074</span></span>
<span><span class="va">pseudo_sdm</span> <span class="op">&lt;-</span> <span class="fl">0.8338</span></span>
<span><span class="va">bic_sar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">BIC</a></span><span class="op">(</span><span class="va">mod.sar</span><span class="op">)</span></span>
<span><span class="va">bic_slx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">BIC</a></span><span class="op">(</span><span class="va">mod.slx</span><span class="op">)</span></span>
<span><span class="va">bic_sdm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">BIC</a></span><span class="op">(</span><span class="va">mod.sdm</span><span class="op">)</span></span>
<span><span class="va">tabel_bic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bic_sar</span>, <span class="va">bic_slx</span>, <span class="va">bic_sdm</span>, <span class="va">pseudo_sar</span>, <span class="va">pseudo_slx</span>, <span class="va">pseudo_sdm</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">tabel_bic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabel_bic</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tabel_bic</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'SAR'</span>, <span class="st">'SLX'</span>, <span class="st">'SDM'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tabel_bic</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'BIC'</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Pseudo R"</span>,<span class="fu"><a href="https://common.r-sassy.org/reference/supsc.html">supsc</a></span><span class="op">(</span><span class="st">'2'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tabel_bic</span></span>
<span><span class="co">#      BIC Pseudo R ²</span></span>
<span><span class="co"># SAR 74.4      0.793</span></span>
<span><span class="co"># SLX 86.8      0.607</span></span>
<span><span class="co"># SDM 81.7      0.834</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model SAR merupakan model yang memiliki nilai BIC terkecil dibandingkan dua model lainnya. Model SAR memiliki nilai pseudo R-Squared yang tidak berbeda jauh dengan model SDM, tetapi nilai BIC model SAR lebih kecil dibandingkan model SDM. Selain itu, hanya satu koefisien lag spasial peubah penjelas pada model SDM yang signifikan. Hal tersebut menunjukkan bahwa penambahan lag spasial pada peubah penjelas tidak memberikan pengaruh pada model sehingga model SAR adalah model yang akan dipilih sebagai model terbaik untuk memodelkan produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021. Selanjutnya akan dilakukan pengecekan asumsi normalitas sisaan, kehomogenan ragam sisaan dan kebebasan ragam sisaaan pada model SAR.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## Asumsi</span></span>
<span><span class="va">asumsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Normalitas"</span>, <span class="st">"Heterogenitas"</span>, <span class="st">"Autokorelasi"</span><span class="op">)</span></span>
<span><span class="va">normalitas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">mod.sar</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span></span>
<span><span class="va">heterogenitas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/sarlm_tests.html">bptest.Sarlm</a></span><span class="op">(</span><span class="va">mod.sar</span><span class="op">)</span></span>
<span><span class="va">autokorelasi.stat</span> <span class="op">&lt;-</span> <span class="fl">0.00313</span></span>
<span><span class="va">autokorelasi</span> <span class="op">&lt;-</span> <span class="fl">0.9553</span></span>
<span><span class="va">tabel_asumsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">normalitas</span><span class="op">$</span><span class="va">statistic</span>, <span class="va">heterogenitas</span><span class="op">$</span><span class="va">statistic</span>, <span class="va">autokorelasi.stat</span>, <span class="va">normalitas</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">heterogenitas</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">autokorelasi</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">tabel_asumsi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">asumsi</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">tabel_asumsi</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tabel_asumsi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Asumsi"</span>, <span class="st">"Statistik Uji"</span>, <span class="st">"Nilai-P"</span><span class="op">)</span></span>
<span><span class="va">tabel_asumsi</span></span>
<span><span class="co">#      Asumsi          Statistik Uji Nilai-P</span></span>
<span><span class="co"># [1,] "Normalitas"    "0.955"       "0.288"</span></span>
<span><span class="co"># [2,] "Heterogenitas" "2.526"       "0.925"</span></span>
<span><span class="co"># [3,] "Autokorelasi"  "0.003"       "0.955"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="interpretasi-model" class="level3"><h3 class="anchored" data-anchor-id="interpretasi-model">Interpretasi Model</h3>
<p>Interpretasi pada koefisien regresi spasial dilakukan dengan melihat nilai efek langsung (direct effect), efek tidak langsung (indirect effect), dan efek total (total effect). Efek langsung merupakan nilai harapan perubahan rataan semua amatan untuk peubah respon di suatu wilayah karena peningkatan satu unit untuk peubah penjelas tertentu di wilayah tersebut. Efek tidak langsung merupakan perubahan pada peubah respon di suatu wilayah yang timbul dari kenaikan satu unit pada peubah penjelas di wilayah lain. Efek langsung dan tidak langsung dihitung menggunakan syntax berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Spill-Over Effect ####</span></span>
<span><span class="va">mod.sar.fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spatialreg/reference/ML_models.html">lagsarlm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y2</span><span class="op">)</span><span class="op">~</span><span class="va">X4</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">X5</span><span class="op">)</span><span class="op">+</span><span class="va">X6</span><span class="op">+</span><span class="va">X7</span>, listw <span class="op">=</span> <span class="va">invers.w</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Membuat matriks identitas</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">27</span>, <span class="fl">27</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">I</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">It</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">27</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">It_transpose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">It</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Matriks Pembobot</span></span>
<span><span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">w_std</span><span class="op">)</span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.52112</span></span>
<span><span class="va">rhow</span> <span class="op">&lt;-</span> <span class="va">rho</span><span class="op">*</span><span class="va">W</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="va">I</span> <span class="op">-</span> <span class="va">rhow</span></span>
<span><span class="va">invers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#X4</span></span>
<span><span class="va">beta3</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">0.2983842</span></span>
<span><span class="va">b3</span> <span class="op">&lt;-</span> <span class="va">beta3</span><span class="op">*</span><span class="va">invers</span> <span class="co">#matriks untuk direct effect</span></span>
<span><span class="va">direct_b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">b3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">direct_b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">KABKOT</span>, <span class="va">direct_b3</span><span class="op">)</span></span>
<span><span class="va">b3.2</span> <span class="op">&lt;-</span> <span class="va">b3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">b3.2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">#matriks untuk indirect effect</span></span>
<span><span class="va">indirect_b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">b3.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">total_b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">direct_b3</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">indirect_b3</span><span class="op">)</span></span>
<span><span class="co"># Warning in mean.default(direct_b3): argument is not numeric or</span></span>
<span><span class="co"># logical: returning NA</span></span>
<span></span>
<span><span class="co">#X5</span></span>
<span><span class="va">beta4</span> <span class="op">&lt;-</span> <span class="fl">0.4934092</span></span>
<span><span class="va">b4</span> <span class="op">&lt;-</span> <span class="va">beta4</span><span class="op">*</span><span class="va">invers</span> <span class="co">#matriks untuk direct effect</span></span>
<span><span class="va">direct_b4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">b4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">direct_b4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">KABKOT</span>, <span class="va">direct_b4</span><span class="op">)</span></span>
<span><span class="va">b4.2</span> <span class="op">&lt;-</span> <span class="va">b4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">b4.2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">#matriks untuk indirect effect</span></span>
<span><span class="va">indirect_b4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">b4.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">total_b4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">direct_b4</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">indirect_b4</span><span class="op">)</span></span>
<span><span class="co"># Warning in mean.default(direct_b4): argument is not numeric or</span></span>
<span><span class="co"># logical: returning NA</span></span>
<span></span>
<span><span class="co">#X6</span></span>
<span><span class="va">beta5</span> <span class="op">&lt;-</span> <span class="fl">0.0043757</span></span>
<span><span class="va">b5</span> <span class="op">&lt;-</span> <span class="va">beta5</span><span class="op">*</span><span class="va">invers</span></span>
<span><span class="va">direct_b5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">b5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">direct_b5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">KABKOT</span>, <span class="va">direct_b5</span><span class="op">)</span></span>
<span><span class="va">b5.2</span> <span class="op">&lt;-</span> <span class="va">b5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">b5.2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">#matriks untuk indirect effect</span></span>
<span><span class="va">indirect_b5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">b5.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">total_b5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">direct_b5</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">indirect_b5</span><span class="op">)</span></span>
<span><span class="co"># Warning in mean.default(direct_b5): argument is not numeric or</span></span>
<span><span class="co"># logical: returning NA</span></span>
<span></span>
<span><span class="co">#X7</span></span>
<span><span class="va">beta6</span> <span class="op">&lt;-</span> <span class="fl">0.0043757</span></span>
<span><span class="va">b6</span> <span class="op">&lt;-</span> <span class="va">beta6</span><span class="op">*</span><span class="va">invers</span></span>
<span><span class="va">direct_b6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">b6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">direct_b6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">KABKOT</span>, <span class="va">direct_b6</span><span class="op">)</span></span>
<span><span class="va">b6.2</span> <span class="op">&lt;-</span> <span class="va">b6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">b6.2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">#matriks untuk indirect effect</span></span>
<span><span class="va">indirect_b6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">b6.2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">total_b6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">direct_b6</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">indirect_b6</span><span class="op">)</span></span>
<span><span class="co"># Warning in mean.default(direct_b6): argument is not numeric or</span></span>
<span><span class="co"># logical: returning NA</span></span>
<span><span class="va">tabel_efek</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">direct_b3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">indirect_b3</span><span class="op">)</span>, <span class="va">total_b3</span>,<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">direct_b4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">indirect_b4</span><span class="op">)</span>, <span class="va">total_b4</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">direct_b5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">indirect_b5</span><span class="op">)</span>, <span class="va">total_b5</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">direct_b6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">indirect_b6</span><span class="op">)</span>, <span class="va">total_b6</span><span class="op">)</span>, ncol<span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># Warning in mean.default(direct_b3): argument is not numeric or</span></span>
<span><span class="co"># logical: returning NA</span></span>
<span><span class="co"># Warning in mean.default(direct_b4): argument is not numeric or</span></span>
<span><span class="co"># logical: returning NA</span></span>
<span><span class="co"># Warning in mean.default(direct_b5): argument is not numeric or</span></span>
<span><span class="co"># logical: returning NA</span></span>
<span><span class="co"># Warning in mean.default(direct_b6): argument is not numeric or</span></span>
<span><span class="co"># logical: returning NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">tabel_efek</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Direct"</span>, <span class="st">"Indirect"</span>, <span class="st">"Total"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">tabel_efek</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X4"</span>, <span class="st">"X5"</span>, <span class="st">"X6"</span>, <span class="st">"X7"</span><span class="op">)</span></span>
<span><span class="va">tabel_efek</span></span>
<span><span class="co">#    Direct Indirect Total</span></span>
<span><span class="co"># X4     NA -0.31077    NA</span></span>
<span><span class="co"># X5     NA  0.51389    NA</span></span>
<span><span class="co"># X6     NA  0.00456    NA</span></span>
<span><span class="co"># X7     NA  0.00456    NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">indirect_b3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">KABKOT</span>, <span class="va">indirect_b3</span><span class="op">)</span></span>
<span><span class="va">indirect_b4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">KABKOT</span>, <span class="va">indirect_b4</span><span class="op">)</span></span>
<span><span class="va">indirect_b5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">KABKOT</span>, <span class="va">indirect_b5</span><span class="op">)</span></span>
<span><span class="va">indirect_b6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">petajabar</span><span class="op">$</span><span class="va">KABKOT</span>, <span class="va">indirect_b6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat.map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/shp/jawa.shp"</span><span class="op">)</span></span>
<span><span class="co"># Reading layer `jawa' from data source </span></span>
<span><span class="co">#   `E:\Materi_Orasi\bookdown\data\shp\jawa.shp' using driver `ESRI Shapefile'</span></span>
<span><span class="co"># Simple feature collection with 119 features and 5 fields</span></span>
<span><span class="co"># Geometry type: MULTIPOLYGON</span></span>
<span><span class="co"># Dimension:     XY</span></span>
<span><span class="co"># Bounding box:  xmin: 105 ymin: -8.78 xmax: 116 ymax: -5.05</span></span>
<span><span class="co"># Geodetic CRS:  WGS 84</span></span>
<span><span class="va">dat.map</span> <span class="op">&lt;-</span> <span class="va">dat.map</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">PROVNO</span> <span class="op">==</span> <span class="st">"32"</span><span class="op">)</span></span>
<span><span class="va">dat.map</span><span class="op">$</span><span class="va">de_x4</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">direct_b3</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat.map</span><span class="op">$</span><span class="va">de_x5</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">direct_b4</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat.map</span><span class="op">$</span><span class="va">de_x6</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">direct_b5</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat.map</span><span class="op">$</span><span class="va">de_x7</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">direct_b6</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat.map</span><span class="op">$</span><span class="va">ie_x4</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">indirect_b3</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat.map</span><span class="op">$</span><span class="va">ie_x5</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">indirect_b4</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat.map</span><span class="op">$</span><span class="va">ie_x6</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">indirect_b5</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dat.map</span><span class="op">$</span><span class="va">ie_x7</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">indirect_b6</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Direct Effect Map ####</span></span>
<span></span>
<span><span class="va">mycol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span>, <span class="st">"red4"</span><span class="op">)</span></span>
<span><span class="va">map.de.x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat.map</span>, mapping <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">de_x4</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">mycol</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Direct Effect X4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map.de.x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat.map</span>, mapping <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">de_x5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">mycol</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Direct Effect X5"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map.de.x6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat.map</span>, mapping <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">de_x6</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">mycol</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Direct Effect X6"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map.de.x7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat.map</span>, mapping <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">de_x7</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">mycol</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Direct Effect X7"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Indirect Effect Map ####</span></span>
<span><span class="va">map.ie.x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat.map</span>, mapping <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">ie_x4</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">mycol</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Indirect Effect X4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map.ie.x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat.map</span>, mapping <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">ie_x5</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">mycol</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Indirect Effect X5"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map.ie.x6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat.map</span>, mapping <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">ie_x6</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">mycol</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Indirect Effect X6"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map.ie.x7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dat.map</span>, mapping <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="va">geometry</span>, fill <span class="op">=</span> <span class="va">ie_x7</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="va">mycol</span>, name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span> <span class="st">"Indirect Effect X7"</span><span class="op">)</span></span>
<span><span class="va">map.de.x4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map.ie.x4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map.de.x5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-22-3.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map.ie.x5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-22-4.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map.de.x6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-22-5.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map.ie.x6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-22-6.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map.de.x7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-22-7.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">map.ie.x7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="01-SpasialAutoRegresifModel_files/figure-html/unnamed-chunk-22-8.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./part-1.html" class="pagination-link" aria-label="Model Dependensi Spasial">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Model Dependensi Spasial</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-SpasialDurbinModel.html" class="pagination-link" aria-label="Spasial Durbin Model">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spasial Durbin Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb30" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Spasial Autoregresif Model </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deskripsi</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>Model regresi spasial digunakan untuk mengetahui hubungan antara satu peubah dengan satu atau lebih peubah dengan memperhatikan adanya efek spasial (Cahyati et al., 2018). Persamaan umum untuk model regresi spasial dapat dirumuskan sebagai berikut (Griffith, 1988):</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>$y = \rho W_1 y + X\beta + \gamma W_2 X\beta + u$</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>$u = \lambda W u + \epsilon$</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>Dengan asumsi bahwa $\epsilon \sim N(0, \sigma^2 I)$, dengan:</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>y &amp; : \text{vektor peubah respon berukuran } n \times 1, <span class="sc">\\</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>\rho &amp; : \text{koefisien autoregresi lag spasial pada peubah respon}, <span class="sc">\\</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>W_1 &amp; : \text{matriks pembobot spasial bagi peubah respon berukuran } n \times n, <span class="sc">\\</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>W_2 &amp; : \text{matriks pembobot spasial bagi peubah penjelas berukuran } n \times n, <span class="sc">\\</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>\gamma &amp; : \text{koefisien autoregresi lag spasial pada peubah penjelas}, <span class="sc">\\</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>X &amp; : \text{matriks peubah bebas dengan ukuran } n \times (k + 1), <span class="sc">\\</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>\beta &amp; : \text{vektor koefisien parameter regresi berukuran } (k + 1) \times 1, <span class="sc">\\</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>u &amp; : \text{vektor galat yang diasumsikan mengandung autokorelasi berukuran } n \times 1, <span class="sc">\\</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>\lambda &amp; : \text{koefisien autoregresi galat spasial}, <span class="sc">\\</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>\epsilon &amp; : \text{vektor galat yang bebas autokorelasi berukuran } n \times 1.</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>Jika pada persamaan nilai koefisien $\gamma = 0$ dan $\lambda = 0$, maka model yang digunakan akan menjadi model SAR. SAR merupakan pemodelan pada data dengan menambahkan pengaruh spasial pada peubah respon. Persamaan untuk model SAR adalah sebagai berikut (LeSage dan Pace, 2009):</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>$y = \rho W y + X\beta + \epsilon$</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>Dengan $y$ merupakan peubah respon, $W$ merupakan matriks pembobot spasial, $\beta$ adalah koefisien parameter regresi, $\epsilon$ merupakan sisaan, dan $\rho$ merupakan koefisien autoregressive lag spasial. Jika tidak terdapat ketergantungan spasial antara wilayah ke-$i$ dan wilayah ke-$j$, $\rho$ bernilai 0.</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>Saat nilai koefisien $\rho$ dan $\lambda$ pada persamaan bernilai nol, maka model yang digunakan adalah model SLX. SLX adalah model regresi spasial dengan dependensi spasial hanya pada peubah penjelas (Vega dan Elhorst, 2015). Persamaan untuk SLX sebagai berikut (LeSage dan Pace, 2009):</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>$y = X\beta + \gamma WX + \epsilon$</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>Dengan $y$ merupakan peubah respon, $W$ merupakan matriks pembobot spasial, $\beta$ adalah koefisien parameter regresi, $\epsilon$ merupakan sisaan, dan $\gamma$ merupakan koefisien lag spasial pada peubah penjelas.</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>Jika nilai koefisien $\lambda$ pada persamaan bernilai nol, maka model yang digunakan adalah SDM. SDM merupakan model regresi spasial yang digunakan ketika data memiliki dependensi spasial pada peubah respon dan peubah penjelas sehingga pembobotan spasial dilakukan pada peubah respon dan peubah penjelas. Persamaan untuk SDM sebagai berikut (LeSage dan Pace, 2009):</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>$y = \rho W_1 y + X\beta + \gamma W_2 X + \epsilon$</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>Dengan: </span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>y &amp; : \text{vektor peubah respon}, <span class="sc">\\</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>W_1 &amp; : \text{matriks pembobot spasial bagi peubah respon berukuran } n \times n, <span class="sc">\\</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>W_2 &amp; : \text{matriks pembobot spasial bagi peubah penjelas berukuran } n \times n, <span class="sc">\\</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>\beta &amp; : \text{vektor koefisien parameter regresi}, <span class="sc">\\</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>\epsilon &amp; : \text{vektor sisaan}, <span class="sc">\\</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>\rho &amp; : \text{koefisien lag spasial pada peubah respon}, <span class="sc">\\</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>\gamma &amp; : \text{koefisien lag spasial pada peubah penjelas}.</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>Data yang digunakan pada penelitian ini merupakan data sekunder yang diambil dari situs <span class="co">[</span><span class="ot">Open Data Jabar</span><span class="co">](https://opendata.jabarprov.go.id/id)</span>. Unit amatan pada penelitian ini adalah 27 kabupaten/kota di Jawa Barat. Peubah yang digunakan dapat dilihat pada tabel berikut.</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>| Kode   | Peubah                                          | Sumber Pustaka        |</span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>|--------|-------------------------------------------------|-----------------------|</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>| $Y$    | Total produksi sampah dalam ton/jiwa/km2        | -                     |</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>| $X1$   | PDRB tahun 2021                                 | Prajati et al. (2015) |</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>| $X2$   | Jumlah pengeluaran per kapita dalam ribu rupiah | Prajati et al. (2015) |</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>| $X3$   | Rata-rata lama sekolah                          | Prajati et al. (2015) |</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>| $X4$   | Angka melek huruf                               | Prajati et al. (2015) |</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>| $X5$   | Jumlah UMKM &amp; Demirbas                          | Demirbas (2011)       |</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>| $X6$   | Jumlah tempat rekreasi dan pariwisata           | Karim et al. (2022)   |</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>| $X7$   | Jumlah pasar rakyat | Persen                    | Fatimah et al. (2020) |</span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>| $X8$   | Jumlah restoran &amp; Demirbas                      | Demirbas (2011)       |</span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>: Peubah yang Digunakan {.striped .hover}</span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prosedur Analisis Data</span></span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>Analisis data dilakukan dengan menggunakan perangkat lunak R, dengan tahapan analisis data sebagai berikut:</span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Eksplorasi Data:**</span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Melakukan eksplorasi data untuk mengetahui karakteristik data.</span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Deteksi Multikolinieritas:**</span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Mendeteksi multikolinieritas antar peubah penjelas dengan melihat nilai _Variance Inflation Factor_ (VIF).</span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>VIF dihitung menggunakan persamaan berikut:</span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>     $VIF = \frac{1}{1 - R_i^2}$</span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>     dengan <span class="sc">\(</span>R_i^2<span class="sc">\)</span> adalah koefisien determinasi antara <span class="sc">\(</span>X_i<span class="sc">\)</span> dengan peubah penjelas lainnya.</span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Menurut Akinwande et al. (2015), nilai VIF yang lebih dari lima menunjukkan adanya multikolinieritas, menjadi acuan untuk mengeluarkan peubah penjelas dari model.</span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Transformasi Peubah:**</span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Melakukan transformasi pada peubah <span class="sc">\(</span>Y<span class="sc">\)</span>.</span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Melakukan transformasi pada peubah <span class="sc">\(</span>X<span class="sc">\)</span> yang memiliki nilai keragaman yang tinggi.</span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Uji Efek Spasial:**</span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Keragaman Spasial menggunakan uji Breusch-Pagan berdasarkan persamaan.</span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Dependensi Spasial berdasarkan persamaan sampai persamaan.</span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Pendugaan Parameter Model SAR, SLX, dan SDM:**</span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Menggunakan metode Maximum Likelihood.</span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Evaluasi Model:**</span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Evaluasi model terbaik berdasarkan nilai Bayesian Information Criterion (BIC) terkecil dan Nagelkerke pseudo R-Squared terbesar.</span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Melakukan uji asumsi.</span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>     **BIC:**</span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a>     $BIC = -2 \log(\hat{L}) + \log(N)K$ dengan ($\hat{L}$) adalah nilai maximum likelihood, ($K$) adalah jumlah parameter yang diestimasi dalam model, dan ($N$) adalah jumlah sampel (Li dan Nyholt, 2001).</span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a>     **Nagelkerke Pseudo R-Squared:**</span>
<span id="cb30-109"><a href="#cb30-109" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb30-110"><a href="#cb30-110" aria-hidden="true" tabindex="-1"></a>     $\text{pseudo R}^2 = \frac{\left(1 - \frac{LL_0}{LL_F}\right)^{2/N}}{1 - \left(\frac{LL_0}{LL_F}\right)^{2/N}}$ dengan ($LL_0$) adalah nilai log likelihood dari model tanpa peubah penjelas, ($LL_F$) adalah nilai log likelihood dari model dengan peubah penjelas, dan ($N$) adalah jumlah sampel (Walker dan Smith, 2016).</span>
<span id="cb30-111"><a href="#cb30-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-112"><a href="#cb30-112" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Interpretasi dan Kesimpulan:**</span>
<span id="cb30-113"><a href="#cb30-113" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Melakukan interpretasi dari model yang terpilih dan menarik kesimpulan.</span>
<span id="cb30-114"><a href="#cb30-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-115"><a href="#cb30-115" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tahapan Analisis R</span></span>
<span id="cb30-116"><a href="#cb30-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-117"><a href="#cb30-117" aria-hidden="true" tabindex="-1"></a>Tahap awal dalam pemodelan menggunakan R Studio adalah melakukan input data dan install package sesuai kebutuhan dalam analisis. Package yang perlu diinstall adalah sebagai berikut:</span>
<span id="cb30-118"><a href="#cb30-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-119"><a href="#cb30-119" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package</span></span>
<span id="cb30-120"><a href="#cb30-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-121"><a href="#cb30-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cache=FALSE, message=FALSE}</span></span>
<span id="cb30-122"><a href="#cb30-122" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb30-123"><a href="#cb30-123" aria-hidden="true" tabindex="-1"></a><span class="in">library(readxl)</span></span>
<span id="cb30-124"><a href="#cb30-124" aria-hidden="true" tabindex="-1"></a><span class="in">library(rgdal)</span></span>
<span id="cb30-125"><a href="#cb30-125" aria-hidden="true" tabindex="-1"></a><span class="in">library(spdep)</span></span>
<span id="cb30-126"><a href="#cb30-126" aria-hidden="true" tabindex="-1"></a><span class="in">library(raster)</span></span>
<span id="cb30-127"><a href="#cb30-127" aria-hidden="true" tabindex="-1"></a><span class="in">library(rcompanion)</span></span>
<span id="cb30-128"><a href="#cb30-128" aria-hidden="true" tabindex="-1"></a><span class="in">library(MASS)</span></span>
<span id="cb30-129"><a href="#cb30-129" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb30-130"><a href="#cb30-130" aria-hidden="true" tabindex="-1"></a><span class="in">library(kableExtra)</span></span>
<span id="cb30-131"><a href="#cb30-131" aria-hidden="true" tabindex="-1"></a><span class="in">library(lmtest)</span></span>
<span id="cb30-132"><a href="#cb30-132" aria-hidden="true" tabindex="-1"></a><span class="in">library(spatialreg)</span></span>
<span id="cb30-133"><a href="#cb30-133" aria-hidden="true" tabindex="-1"></a><span class="in">library(DescTools)</span></span>
<span id="cb30-134"><a href="#cb30-134" aria-hidden="true" tabindex="-1"></a><span class="in">library(sf)</span></span>
<span id="cb30-135"><a href="#cb30-135" aria-hidden="true" tabindex="-1"></a><span class="in">library(reporter)</span></span>
<span id="cb30-136"><a href="#cb30-136" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb30-137"><a href="#cb30-137" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb30-138"><a href="#cb30-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-139"><a href="#cb30-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-140"><a href="#cb30-140" aria-hidden="true" tabindex="-1"></a><span class="fu">### Input Data</span></span>
<span id="cb30-141"><a href="#cb30-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-144"><a href="#cb30-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-145"><a href="#cb30-145" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">"data/produksi_sampah_jabar_2021.xlsx"</span>)</span>
<span id="cb30-146"><a href="#cb30-146" aria-hidden="true" tabindex="-1"></a>Y  <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">7</span>]))</span>
<span id="cb30-147"><a href="#cb30-147" aria-hidden="true" tabindex="-1"></a>X  <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">10</span>]))</span>
<span id="cb30-148"><a href="#cb30-148" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">8</span>]))</span>
<span id="cb30-149"><a href="#cb30-149" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">13</span>]))</span>
<span id="cb30-150"><a href="#cb30-150" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">9</span>]))</span>
<span id="cb30-151"><a href="#cb30-151" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">16</span>]))</span>
<span id="cb30-152"><a href="#cb30-152" aria-hidden="true" tabindex="-1"></a>X5 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">11</span>]))</span>
<span id="cb30-153"><a href="#cb30-153" aria-hidden="true" tabindex="-1"></a>X6 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">14</span>]))</span>
<span id="cb30-154"><a href="#cb30-154" aria-hidden="true" tabindex="-1"></a>X7 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">15</span>]))</span>
<span id="cb30-155"><a href="#cb30-155" aria-hidden="true" tabindex="-1"></a>X8 <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">unlist</span>(Data[,<span class="dv">12</span>]))</span>
<span id="cb30-156"><a href="#cb30-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-157"><a href="#cb30-157" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> Y<span class="sc">/</span>X</span>
<span id="cb30-158"><a href="#cb30-158" aria-hidden="true" tabindex="-1"></a>Data<span class="sc">$</span>produksi_sampah_per_kepadatan<span class="ot">&lt;-</span>Y2</span>
<span id="cb30-159"><a href="#cb30-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-160"><a href="#cb30-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-161"><a href="#cb30-161" aria-hidden="true" tabindex="-1"></a><span class="fu">### Input Peta Pulau Jawa</span></span>
<span id="cb30-162"><a href="#cb30-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-165"><a href="#cb30-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-166"><a href="#cb30-166" aria-hidden="true" tabindex="-1"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb30-167"><a href="#cb30-167" aria-hidden="true" tabindex="-1"></a>petajawa<span class="ot">&lt;-</span> <span class="fu">readOGR</span>(<span class="at">dsn =</span> <span class="st">"data/shp/jawa.shp"</span>, <span class="at">layer=</span><span class="st">"jawa"</span>)</span>
<span id="cb30-168"><a href="#cb30-168" aria-hidden="true" tabindex="-1"></a><span class="co"># subset peta pulau jawa menjadi jawa barat</span></span>
<span id="cb30-169"><a href="#cb30-169" aria-hidden="true" tabindex="-1"></a>petajabar <span class="ot">&lt;-</span> <span class="fu">subset</span>(petajawa,PROVINSI<span class="sc">==</span><span class="st">"JAWA BARAT"</span>)</span>
<span id="cb30-170"><a href="#cb30-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-171"><a href="#cb30-171" aria-hidden="true" tabindex="-1"></a><span class="co">#Menambahkan kolom variabel dalam file shp</span></span>
<span id="cb30-172"><a href="#cb30-172" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>sampah <span class="ot">&lt;-</span> Data<span class="sc">$</span>jumlah_produksi_sampah</span>
<span id="cb30-173"><a href="#cb30-173" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>PDRB <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(Data<span class="sc">$</span>PDRB)</span>
<span id="cb30-174"><a href="#cb30-174" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>RLS <span class="ot">&lt;-</span> Data<span class="sc">$</span>RLS</span>
<span id="cb30-175"><a href="#cb30-175" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>kepadatan <span class="ot">&lt;-</span> Data<span class="sc">$</span>Kepadatan</span>
<span id="cb30-176"><a href="#cb30-176" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>umkm <span class="ot">&lt;-</span> <span class="fu">log</span>(Data<span class="sc">$</span>jumlah_umkm)</span>
<span id="cb30-177"><a href="#cb30-177" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>pengeluaran <span class="ot">&lt;-</span> Data<span class="sc">$</span>jumlah_pengeluaran_per_kapita</span>
<span id="cb30-178"><a href="#cb30-178" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>restoran <span class="ot">&lt;-</span> Data<span class="sc">$</span>jumlah_restoran</span>
<span id="cb30-179"><a href="#cb30-179" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>AMH <span class="ot">&lt;-</span> Data<span class="sc">$</span>Angka_melek_huruf</span>
<span id="cb30-180"><a href="#cb30-180" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>pasar <span class="ot">&lt;-</span> Data<span class="sc">$</span>Jumlah_pasar_rakyat</span>
<span id="cb30-181"><a href="#cb30-181" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>rekreasi <span class="ot">&lt;-</span> Data<span class="sc">$</span>Jumlah_tempat_rekreasi_dan_pariwisata</span>
<span id="cb30-182"><a href="#cb30-182" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>daerah <span class="ot">&lt;-</span> Data<span class="sc">$</span>nama_kabupaten_kota</span>
<span id="cb30-183"><a href="#cb30-183" aria-hidden="true" tabindex="-1"></a>petajabar<span class="sc">$</span>prod_sampah <span class="ot">&lt;-</span> Data<span class="sc">$</span>produksi_sampah_per_kepadatan</span>
<span id="cb30-184"><a href="#cb30-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-185"><a href="#cb30-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-186"><a href="#cb30-186" aria-hidden="true" tabindex="-1"></a><span class="fu">### Eksplorasi Data</span></span>
<span id="cb30-187"><a href="#cb30-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-188"><a href="#cb30-188" aria-hidden="true" tabindex="-1"></a>Peta sebaran produksi sampah per kepadatan penduduk dapat dihasilkan dengan syntax berikut:</span>
<span id="cb30-189"><a href="#cb30-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-192"><a href="#cb30-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-193"><a href="#cb30-193" aria-hidden="true" tabindex="-1"></a><span class="do">## Peta Produksi Sampah per Kepadatan Penduduk</span></span>
<span id="cb30-194"><a href="#cb30-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Create list object for sp.layout</span></span>
<span id="cb30-195"><a href="#cb30-195" aria-hidden="true" tabindex="-1"></a>sp.label <span class="ot">&lt;-</span> <span class="cf">function</span>(x, label) {<span class="fu">list</span>(<span class="st">"sp.text"</span>, <span class="fu">coordinates</span>(x), label, <span class="at">cex =</span> <span class="fl">0.4</span>)}</span>
<span id="cb30-196"><a href="#cb30-196" aria-hidden="true" tabindex="-1"></a>NUMB.sp.label <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sp.label</span>(x, <span class="fu">as.vector</span>(petajabar<span class="sc">$</span>daerah))}</span>
<span id="cb30-197"><a href="#cb30-197" aria-hidden="true" tabindex="-1"></a>make.NUMB.sp.label <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">do.call</span>(<span class="st">"list"</span>)}</span>
<span id="cb30-198"><a href="#cb30-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-199"><a href="#cb30-199" aria-hidden="true" tabindex="-1"></a>colfunc<span class="ot">&lt;-</span><span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"green"</span>,<span class="st">"orange"</span>,<span class="st">"red"</span>))</span>
<span id="cb30-200"><a href="#cb30-200" aria-hidden="true" tabindex="-1"></a>color<span class="ot">&lt;-</span><span class="fu">colfunc</span>(<span class="dv">100</span>)</span>
<span id="cb30-201"><a href="#cb30-201" aria-hidden="true" tabindex="-1"></a><span class="fu">spplot</span>(petajabar, <span class="st">"prod_sampah"</span>, <span class="at">col.regions=</span>color, </span>
<span id="cb30-202"><a href="#cb30-202" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.5</span>,</span>
<span id="cb30-203"><a href="#cb30-203" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">border=</span><span class="st">"light grey"</span>)</span>
<span id="cb30-204"><a href="#cb30-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-205"><a href="#cb30-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-206"><a href="#cb30-206" aria-hidden="true" tabindex="-1"></a>Diagram kotak garis dari produksi sampah per kepadatan penduduk dapat dihasilkan menggunakan syntax</span>
<span id="cb30-207"><a href="#cb30-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-210"><a href="#cb30-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-211"><a href="#cb30-211" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Y2, <span class="at">xlab =</span> <span class="st">"Produksi sampah per kepadatan penduduk"</span>, <span class="at">horizontal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-212"><a href="#cb30-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-213"><a href="#cb30-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-214"><a href="#cb30-214" aria-hidden="true" tabindex="-1"></a>Berdasarkan diagram kotak garis, dapat dilihat bahwa garis di bagian kanan diagram kotak garis lebih panjang. Hal tersebut menunjukkan bahwa data produksi sampah per kepadatan penduduk cenderung menjulur ke kanan.</span>
<span id="cb30-215"><a href="#cb30-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-216"><a href="#cb30-216" aria-hidden="true" tabindex="-1"></a>Nilai deskriptif merupakan gambaran dari data yang akan digunakan dalam penelitian dan nilai deskriptif dari seluruh peubah yang digunakan pada penelitian ini ditampilkan pada Tabel 2. Peubah penjelas yang memiliki nilai minimum paling kecil adalah peubah X8 dengan nilai 0. Wilayah yang memiliki peubah X8 atau jumlah restoran sama dengan 0 adalah Kabupaten Kuningan. Wilayah yang memiliki jumlah restoran terbanyak adalah Kota Bekasi dengan jumlah sebanyak 1024 restoran. Peubah penjelas dengan nilai rataan tertinggi yaitu peubah X5 atau jumlah UMKM. Sedangkan peubah penjelas dengan rataan terkecil dibandingkan peubah lainnya adalah X3 atau rata-rata lama sekolah. Peubah penjelas dengan nilai standar deviasi yang tinggi adalah peubah X1 dan X5.</span>
<span id="cb30-217"><a href="#cb30-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-220"><a href="#cb30-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-221"><a href="#cb30-221" aria-hidden="true" tabindex="-1"></a>tabel_deskriptif <span class="ot">&lt;-</span><span class="fu">matrix</span>(</span>
<span id="cb30-222"><a href="#cb30-222" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">min</span>(Y2),</span>
<span id="cb30-223"><a href="#cb30-223" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(X1),</span>
<span id="cb30-224"><a href="#cb30-224" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(X2),</span>
<span id="cb30-225"><a href="#cb30-225" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(X3),</span>
<span id="cb30-226"><a href="#cb30-226" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(X4),</span>
<span id="cb30-227"><a href="#cb30-227" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(X5),</span>
<span id="cb30-228"><a href="#cb30-228" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(X6),</span>
<span id="cb30-229"><a href="#cb30-229" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(X7),</span>
<span id="cb30-230"><a href="#cb30-230" aria-hidden="true" tabindex="-1"></a>      <span class="fu">min</span>(X8),</span>
<span id="cb30-231"><a href="#cb30-231" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(Y2),</span>
<span id="cb30-232"><a href="#cb30-232" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(X1),</span>
<span id="cb30-233"><a href="#cb30-233" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(X2),</span>
<span id="cb30-234"><a href="#cb30-234" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(X3),</span>
<span id="cb30-235"><a href="#cb30-235" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(X4),</span>
<span id="cb30-236"><a href="#cb30-236" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(X5),</span>
<span id="cb30-237"><a href="#cb30-237" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(X6),</span>
<span id="cb30-238"><a href="#cb30-238" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(X7),</span>
<span id="cb30-239"><a href="#cb30-239" aria-hidden="true" tabindex="-1"></a>      <span class="fu">max</span>(X8),</span>
<span id="cb30-240"><a href="#cb30-240" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(Y2),</span>
<span id="cb30-241"><a href="#cb30-241" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(X1),</span>
<span id="cb30-242"><a href="#cb30-242" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(X2),</span>
<span id="cb30-243"><a href="#cb30-243" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(X3),</span>
<span id="cb30-244"><a href="#cb30-244" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(X4),</span>
<span id="cb30-245"><a href="#cb30-245" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(X5),</span>
<span id="cb30-246"><a href="#cb30-246" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(X6),</span>
<span id="cb30-247"><a href="#cb30-247" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(X7),</span>
<span id="cb30-248"><a href="#cb30-248" aria-hidden="true" tabindex="-1"></a>      <span class="fu">median</span>(X8),</span>
<span id="cb30-249"><a href="#cb30-249" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(Y2),</span>
<span id="cb30-250"><a href="#cb30-250" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(X1),</span>
<span id="cb30-251"><a href="#cb30-251" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(X2),</span>
<span id="cb30-252"><a href="#cb30-252" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(X3),</span>
<span id="cb30-253"><a href="#cb30-253" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(X4),</span>
<span id="cb30-254"><a href="#cb30-254" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(X5),</span>
<span id="cb30-255"><a href="#cb30-255" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(X6),</span>
<span id="cb30-256"><a href="#cb30-256" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(X7),</span>
<span id="cb30-257"><a href="#cb30-257" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mean</span>(X8),</span>
<span id="cb30-258"><a href="#cb30-258" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(Y2),</span>
<span id="cb30-259"><a href="#cb30-259" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(X1),</span>
<span id="cb30-260"><a href="#cb30-260" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(X2),</span>
<span id="cb30-261"><a href="#cb30-261" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(X3),</span>
<span id="cb30-262"><a href="#cb30-262" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(X4),</span>
<span id="cb30-263"><a href="#cb30-263" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(X5),</span>
<span id="cb30-264"><a href="#cb30-264" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(X6),</span>
<span id="cb30-265"><a href="#cb30-265" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(X7),</span>
<span id="cb30-266"><a href="#cb30-266" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sd</span>(X8)</span>
<span id="cb30-267"><a href="#cb30-267" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-268"><a href="#cb30-268" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">9</span>,</span>
<span id="cb30-269"><a href="#cb30-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb30-270"><a href="#cb30-270" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-271"><a href="#cb30-271" aria-hidden="true" tabindex="-1"></a>tabel_deskriptif <span class="ot">&lt;-</span> <span class="fu">round</span>(tabel_deskriptif, <span class="dv">2</span>)</span>
<span id="cb30-272"><a href="#cb30-272" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tabel_deskriptif) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Minimum"</span>, <span class="st">"Maksimum"</span>, <span class="st">"Median"</span>, <span class="st">"Rataan"</span>, <span class="st">"Standar Deviasi"</span>)</span>
<span id="cb30-273"><a href="#cb30-273" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabel_deskriptif) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"X4"</span>, <span class="st">"X5"</span>, <span class="st">"X6"</span>, <span class="st">"X7"</span>, <span class="st">"X8"</span>)</span>
<span id="cb30-274"><a href="#cb30-274" aria-hidden="true" tabindex="-1"></a>tabel_deskriptif</span>
<span id="cb30-275"><a href="#cb30-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-276"><a href="#cb30-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-277"><a href="#cb30-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-278"><a href="#cb30-278" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pemeriksaan Multikolinearitas</span></span>
<span id="cb30-279"><a href="#cb30-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-280"><a href="#cb30-280" aria-hidden="true" tabindex="-1"></a>Pemeriksaan multikolinearitas menggunakan syntax sebagai berikut:</span>
<span id="cb30-281"><a href="#cb30-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-284"><a href="#cb30-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-285"><a href="#cb30-285" aria-hidden="true" tabindex="-1"></a>reglin <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y2)<span class="sc">~</span>X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6<span class="sc">+</span>X7<span class="sc">+</span>X8)</span>
<span id="cb30-286"><a href="#cb30-286" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(car<span class="sc">::</span><span class="fu">vif</span>(reglin))</span>
<span id="cb30-287"><a href="#cb30-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-288"><a href="#cb30-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-289"><a href="#cb30-289" aria-hidden="true" tabindex="-1"></a>Berdasarkan output di atas, terlihat bahwa nilai VIF dari peubah X3 lebih dari lima sehingga peubah X3 tidak akan disertakan dalam model.</span>
<span id="cb30-290"><a href="#cb30-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-291"><a href="#cb30-291" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transformasi Peubah</span></span>
<span id="cb30-292"><a href="#cb30-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-293"><a href="#cb30-293" aria-hidden="true" tabindex="-1"></a>Berdasarkan hasil eksplorasi data, diketahui bahwa peubah respon menjulur ke kanan. Selain itu, peubah penjelas X1 dan X5 memiliki nilai standar deviasi yang tinggi. Hal tersebut mengindikasikan bahwa perlu dilakukan penanganan berupa transformasi pada peubah respon dan peubah penjelas. Transformasi logaritma natural merupakan transformasi yang umum dilakukan untuk peubah respon yang menjulur ke kanan (Gujarati dan Porter 2009). Penerapan transformasi pada peubah dilakukan menggunakan syntax berikut:</span>
<span id="cb30-294"><a href="#cb30-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-297"><a href="#cb30-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-298"><a href="#cb30-298" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformasi peubah respon</span></span>
<span id="cb30-299"><a href="#cb30-299" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(<span class="fu">log</span>(Y2))</span>
<span id="cb30-300"><a href="#cb30-300" aria-hidden="true" tabindex="-1"></a>normalitas_Y <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(x<span class="sc">$</span>statistic,x<span class="sc">$</span>p.value)))</span>
<span id="cb30-301"><a href="#cb30-301" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(normalitas_Y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Nilai statistik"</span>, <span class="st">"p-value"</span>)</span>
<span id="cb30-302"><a href="#cb30-302" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(normalitas_Y) <span class="ot">&lt;-</span> <span class="st">"Uji Normalitas Y"</span></span>
<span id="cb30-303"><a href="#cb30-303" aria-hidden="true" tabindex="-1"></a><span class="fu">as.table</span>(normalitas_Y)</span>
<span id="cb30-304"><a href="#cb30-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-305"><a href="#cb30-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-306"><a href="#cb30-306" aria-hidden="true" tabindex="-1"></a>Berdasarkan hasil Uji normalitas Shapiro Wilk, didapatkan nilai nilai-p sebesar 0.14 sehingga dapat disimpulkan bahwa transformasi terhadap peubah respon telah membuat peubah menyebar mengikuti sebaran normal</span>
<span id="cb30-307"><a href="#cb30-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-310"><a href="#cb30-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-311"><a href="#cb30-311" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformasi peubah penjelas</span></span>
<span id="cb30-312"><a href="#cb30-312" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb30-313"><a href="#cb30-313" aria-hidden="true" tabindex="-1"></a><span class="fu">boxcox</span>(Y2<span class="sc">~</span>X1)</span>
<span id="cb30-314"><a href="#cb30-314" aria-hidden="true" tabindex="-1"></a><span class="fu">boxcox</span>(Y2<span class="sc">~</span>X5)</span>
<span id="cb30-315"><a href="#cb30-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-316"><a href="#cb30-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-317"><a href="#cb30-317" aria-hidden="true" tabindex="-1"></a>Berdasarkan gambar di atas, dapat dilihat bahwa nilai 0 berada pada selang nilai λ dari peubah respon X1 dan X5, sehingga transformasi yang akan digunakan adalah transformasi logaritma natural.</span>
<span id="cb30-318"><a href="#cb30-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-319"><a href="#cb30-319" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pengujian Efek Spasial</span></span>
<span id="cb30-320"><a href="#cb30-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-321"><a href="#cb30-321" aria-hidden="true" tabindex="-1"></a>a.  Uji Breusch-Pagan</span>
<span id="cb30-322"><a href="#cb30-322" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-323"><a href="#cb30-323" aria-hidden="true" tabindex="-1"></a><span class="in">    Uji Breusch-Pagan dilakukan menggunakan syntax berikut:</span></span>
<span id="cb30-324"><a href="#cb30-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-327"><a href="#cb30-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-328"><a href="#cb30-328" aria-hidden="true" tabindex="-1"></a>reglin2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y2)<span class="sc">~</span><span class="fu">log</span>(X1)<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span><span class="fu">log</span>(X5)<span class="sc">+</span>X6<span class="sc">+</span>X7<span class="sc">+</span>X8)</span>
<span id="cb30-329"><a href="#cb30-329" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(reglin2)</span>
<span id="cb30-330"><a href="#cb30-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-331"><a href="#cb30-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-332"><a href="#cb30-332" aria-hidden="true" tabindex="-1"></a>Hasil uji menunjukkan nilai-p &gt; 0.05, sehingga dapat disimpulkan tidak terdapat heterogenitas spasial </span>
<span id="cb30-333"><a href="#cb30-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-334"><a href="#cb30-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-335"><a href="#cb30-335" aria-hidden="true" tabindex="-1"></a>b.  Uji LM dan indeks Moran</span>
<span id="cb30-336"><a href="#cb30-336" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-337"><a href="#cb30-337" aria-hidden="true" tabindex="-1"></a><span class="in">    untuk melakukan uji LM dan indeks Moran, perlu ditentukan terlebih dahulu matriks pembobot yang akan digunakan. Pada penelitian ini akan menggunakan matriks bobot ketetanggaan Queen, ketetanggaan rook, jarak eksponensial negatif, dan invers jarak. Berikut merupakan syntax yang digunakan untuk membuat matriks bobot:</span></span>
<span id="cb30-338"><a href="#cb30-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-341"><a href="#cb30-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-342"><a href="#cb30-342" aria-hidden="true" tabindex="-1"></a><span class="do">#### Matriks queen ####</span></span>
<span id="cb30-343"><a href="#cb30-343" aria-hidden="true" tabindex="-1"></a>queen.nb<span class="ot">=</span><span class="fu">poly2nb</span>(petajabar, <span class="at">queen =</span> <span class="cn">TRUE</span>) <span class="co">#Pembobot queen</span></span>
<span id="cb30-344"><a href="#cb30-344" aria-hidden="true" tabindex="-1"></a>queen.listw<span class="ot">=</span><span class="fu">nb2listw</span>(queen.nb) <span class="co">#convert nb to listw type</span></span>
<span id="cb30-345"><a href="#cb30-345" aria-hidden="true" tabindex="-1"></a>queen.jabar<span class="ot">=</span> queen.listw</span>
<span id="cb30-346"><a href="#cb30-346" aria-hidden="true" tabindex="-1"></a>mat.queen <span class="ot">&lt;-</span> <span class="fu">listw2mat</span>(queen.listw)</span>
<span id="cb30-347"><a href="#cb30-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-348"><a href="#cb30-348" aria-hidden="true" tabindex="-1"></a><span class="do">#### Matriks rook ####</span></span>
<span id="cb30-349"><a href="#cb30-349" aria-hidden="true" tabindex="-1"></a>rook.nb <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(petajabar,<span class="at">queen =</span> F)</span>
<span id="cb30-350"><a href="#cb30-350" aria-hidden="true" tabindex="-1"></a>rook.listw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(rook.nb)</span>
<span id="cb30-351"><a href="#cb30-351" aria-hidden="true" tabindex="-1"></a>rook.jabar <span class="ot">&lt;-</span> rook.listw</span>
<span id="cb30-352"><a href="#cb30-352" aria-hidden="true" tabindex="-1"></a>mat.rook <span class="ot">&lt;-</span> <span class="fu">listw2mat</span>(rook.listw)</span>
<span id="cb30-353"><a href="#cb30-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-354"><a href="#cb30-354" aria-hidden="true" tabindex="-1"></a><span class="do">#### inverse distance ####</span></span>
<span id="cb30-355"><a href="#cb30-355" aria-hidden="true" tabindex="-1"></a>coor <span class="ot">&lt;-</span> <span class="fu">coordinates</span>(petajabar)</span>
<span id="cb30-356"><a href="#cb30-356" aria-hidden="true" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(<span class="fu">dist</span>(coor,<span class="at">method =</span> <span class="st">"euclidean"</span>))</span>
<span id="cb30-357"><a href="#cb30-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-358"><a href="#cb30-358" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse weight matrix</span></span>
<span id="cb30-359"><a href="#cb30-359" aria-hidden="true" tabindex="-1"></a>w<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>D</span>
<span id="cb30-360"><a href="#cb30-360" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(w)<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb30-361"><a href="#cb30-361" aria-hidden="true" tabindex="-1"></a>rtot<span class="ot">&lt;-</span><span class="fu">rowSums</span>(w, <span class="at">na.rm =</span>T)</span>
<span id="cb30-362"><a href="#cb30-362" aria-hidden="true" tabindex="-1"></a>w_std<span class="ot">&lt;-</span>w<span class="sc">/</span>rtot</span>
<span id="cb30-363"><a href="#cb30-363" aria-hidden="true" tabindex="-1"></a>invers.w<span class="ot">&lt;-</span><span class="fu">mat2listw</span>(w_std, <span class="at">style=</span><span class="st">"W"</span>)</span>
<span id="cb30-364"><a href="#cb30-364" aria-hidden="true" tabindex="-1"></a>mat.inv <span class="ot">&lt;-</span> <span class="fu">listw2mat</span>(invers.w)</span>
<span id="cb30-365"><a href="#cb30-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-366"><a href="#cb30-366" aria-hidden="true" tabindex="-1"></a>w2<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(D<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb30-367"><a href="#cb30-367" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(w2)<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb30-368"><a href="#cb30-368" aria-hidden="true" tabindex="-1"></a>rtot<span class="ot">&lt;-</span><span class="fu">rowSums</span>(w2, <span class="at">na.rm =</span>T)</span>
<span id="cb30-369"><a href="#cb30-369" aria-hidden="true" tabindex="-1"></a>w_std2<span class="ot">&lt;-</span>w2<span class="sc">/</span>rtot</span>
<span id="cb30-370"><a href="#cb30-370" aria-hidden="true" tabindex="-1"></a>invers.w2<span class="ot">&lt;-</span><span class="fu">mat2listw</span>(w_std2, <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb30-371"><a href="#cb30-371" aria-hidden="true" tabindex="-1"></a>mat.inv2 <span class="ot">&lt;-</span> <span class="fu">listw2mat</span>(invers.w2)</span>
<span id="cb30-372"><a href="#cb30-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-373"><a href="#cb30-373" aria-hidden="true" tabindex="-1"></a><span class="do">#### Exponential distance ####</span></span>
<span id="cb30-374"><a href="#cb30-374" aria-hidden="true" tabindex="-1"></a>alpha1<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb30-375"><a href="#cb30-375" aria-hidden="true" tabindex="-1"></a>W.eksp1 <span class="ot">&lt;-</span> <span class="fu">exp</span>((<span class="sc">-</span>alpha1)<span class="sc">*</span>D) </span>
<span id="cb30-376"><a href="#cb30-376" aria-hidden="true" tabindex="-1"></a><span class="co">#dinormalisasi </span></span>
<span id="cb30-377"><a href="#cb30-377" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(W.eksp1) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-378"><a href="#cb30-378" aria-hidden="true" tabindex="-1"></a>rtot3 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(W.eksp1, <span class="at">na.rm=</span><span class="cn">TRUE</span>) </span>
<span id="cb30-379"><a href="#cb30-379" aria-hidden="true" tabindex="-1"></a>W.eksp.sd1 <span class="ot">&lt;-</span> W.eksp1<span class="sc">/</span>rtot3 <span class="co">#row-normalized </span></span>
<span id="cb30-380"><a href="#cb30-380" aria-hidden="true" tabindex="-1"></a>W.eksp.s1 <span class="ot">=</span> <span class="fu">mat2listw</span>(W.eksp.sd1, <span class="at">style=</span><span class="st">'W'</span>) </span>
<span id="cb30-381"><a href="#cb30-381" aria-hidden="true" tabindex="-1"></a>mat.eksp1 <span class="ot">&lt;-</span> <span class="fu">listw2mat</span>(W.eksp.s1)</span>
<span id="cb30-382"><a href="#cb30-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-383"><a href="#cb30-383" aria-hidden="true" tabindex="-1"></a>alpha2<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb30-384"><a href="#cb30-384" aria-hidden="true" tabindex="-1"></a>W.eksp2 <span class="ot">&lt;-</span> <span class="fu">exp</span>((<span class="sc">-</span>alpha2)<span class="sc">*</span>D) </span>
<span id="cb30-385"><a href="#cb30-385" aria-hidden="true" tabindex="-1"></a><span class="co">#dinormalisasi </span></span>
<span id="cb30-386"><a href="#cb30-386" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(W.eksp2) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-387"><a href="#cb30-387" aria-hidden="true" tabindex="-1"></a>rtot3 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(W.eksp2, <span class="at">na.rm=</span><span class="cn">TRUE</span>) </span>
<span id="cb30-388"><a href="#cb30-388" aria-hidden="true" tabindex="-1"></a>W.eksp.sd2 <span class="ot">&lt;-</span> W.eksp2<span class="sc">/</span>rtot3 <span class="co">#row-normalized </span></span>
<span id="cb30-389"><a href="#cb30-389" aria-hidden="true" tabindex="-1"></a>W.eksp.s2 <span class="ot">=</span> <span class="fu">mat2listw</span>(W.eksp.sd2, <span class="at">style=</span><span class="st">'W'</span>) </span>
<span id="cb30-390"><a href="#cb30-390" aria-hidden="true" tabindex="-1"></a>mat.eksp2 <span class="ot">&lt;-</span> <span class="fu">listw2mat</span>(W.eksp.s2)</span>
<span id="cb30-391"><a href="#cb30-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-392"><a href="#cb30-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-393"><a href="#cb30-393" aria-hidden="true" tabindex="-1"></a>Setelah dibuat matriks pembobot, maka akan dilakukan pengujian LM dengan semua matriks pembobot.</span>
<span id="cb30-394"><a href="#cb30-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-397"><a href="#cb30-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-398"><a href="#cb30-398" aria-hidden="true" tabindex="-1"></a><span class="do">#### LM Test Model 1 ####</span></span>
<span id="cb30-399"><a href="#cb30-399" aria-hidden="true" tabindex="-1"></a>reglin2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y2) <span class="sc">~</span> <span class="fu">log</span>(X1) <span class="sc">+</span> X2 <span class="sc">+</span> X4 <span class="sc">+</span> <span class="fu">log</span>(X5) <span class="sc">+</span> X6 <span class="sc">+</span> X7 <span class="sc">+</span> X8)</span>
<span id="cb30-400"><a href="#cb30-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-401"><a href="#cb30-401" aria-hidden="true" tabindex="-1"></a><span class="co">#LM dengan queen</span></span>
<span id="cb30-402"><a href="#cb30-402" aria-hidden="true" tabindex="-1"></a>LM_Queen <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(reglin2,</span>
<span id="cb30-403"><a href="#cb30-403" aria-hidden="true" tabindex="-1"></a>                       queen.jabar,</span>
<span id="cb30-404"><a href="#cb30-404" aria-hidden="true" tabindex="-1"></a>                       <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span>))</span>
<span id="cb30-405"><a href="#cb30-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-406"><a href="#cb30-406" aria-hidden="true" tabindex="-1"></a><span class="co">#LM rook</span></span>
<span id="cb30-407"><a href="#cb30-407" aria-hidden="true" tabindex="-1"></a>LM_rook <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(reglin2,</span>
<span id="cb30-408"><a href="#cb30-408" aria-hidden="true" tabindex="-1"></a>                      rook.jabar,</span>
<span id="cb30-409"><a href="#cb30-409" aria-hidden="true" tabindex="-1"></a>                      <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span>))</span>
<span id="cb30-410"><a href="#cb30-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-411"><a href="#cb30-411" aria-hidden="true" tabindex="-1"></a><span class="co">#LM Inverse</span></span>
<span id="cb30-412"><a href="#cb30-412" aria-hidden="true" tabindex="-1"></a>LM_inv_1 <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(reglin2,</span>
<span id="cb30-413"><a href="#cb30-413" aria-hidden="true" tabindex="-1"></a>                       invers.w,</span>
<span id="cb30-414"><a href="#cb30-414" aria-hidden="true" tabindex="-1"></a>                       <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span>))</span>
<span id="cb30-415"><a href="#cb30-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-416"><a href="#cb30-416" aria-hidden="true" tabindex="-1"></a>LM_inv_2 <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(reglin2,</span>
<span id="cb30-417"><a href="#cb30-417" aria-hidden="true" tabindex="-1"></a>                       invers.w2,</span>
<span id="cb30-418"><a href="#cb30-418" aria-hidden="true" tabindex="-1"></a>                       <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span>))</span>
<span id="cb30-419"><a href="#cb30-419" aria-hidden="true" tabindex="-1"></a><span class="co">#LM Exponential</span></span>
<span id="cb30-420"><a href="#cb30-420" aria-hidden="true" tabindex="-1"></a>LM_exp_1 <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(reglin2,</span>
<span id="cb30-421"><a href="#cb30-421" aria-hidden="true" tabindex="-1"></a>                       W.eksp.s1,</span>
<span id="cb30-422"><a href="#cb30-422" aria-hidden="true" tabindex="-1"></a>                       <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span>))</span>
<span id="cb30-423"><a href="#cb30-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-424"><a href="#cb30-424" aria-hidden="true" tabindex="-1"></a>LM_exp_2 <span class="ot">&lt;-</span> <span class="fu">lm.RStests</span>(reglin2,</span>
<span id="cb30-425"><a href="#cb30-425" aria-hidden="true" tabindex="-1"></a>                       W.eksp.s2,</span>
<span id="cb30-426"><a href="#cb30-426" aria-hidden="true" tabindex="-1"></a>                       <span class="at">test =</span> <span class="fu">c</span>(<span class="st">"RSerr"</span>, <span class="st">"RSlag"</span>, <span class="st">"adjRSerr"</span>, <span class="st">"adjRSlag"</span>, <span class="st">"SARMA"</span>))</span>
<span id="cb30-427"><a href="#cb30-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-428"><a href="#cb30-428" aria-hidden="true" tabindex="-1"></a>tabel_uji_LM <span class="ot">&lt;-</span></span>
<span id="cb30-429"><a href="#cb30-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb30-430"><a href="#cb30-430" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(</span>
<span id="cb30-431"><a href="#cb30-431" aria-hidden="true" tabindex="-1"></a>      LM_Queen<span class="sc">$</span>RSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-432"><a href="#cb30-432" aria-hidden="true" tabindex="-1"></a>      LM_Queen<span class="sc">$</span>RSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-433"><a href="#cb30-433" aria-hidden="true" tabindex="-1"></a>      LM_Queen<span class="sc">$</span>adjRSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-434"><a href="#cb30-434" aria-hidden="true" tabindex="-1"></a>      LM_Queen<span class="sc">$</span>adjRSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-435"><a href="#cb30-435" aria-hidden="true" tabindex="-1"></a>      LM_Queen<span class="sc">$</span>SARMA<span class="sc">$</span>p.value,</span>
<span id="cb30-436"><a href="#cb30-436" aria-hidden="true" tabindex="-1"></a>      LM_rook<span class="sc">$</span>RSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-437"><a href="#cb30-437" aria-hidden="true" tabindex="-1"></a>      LM_rook<span class="sc">$</span>RSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-438"><a href="#cb30-438" aria-hidden="true" tabindex="-1"></a>      LM_rook<span class="sc">$</span>adjRSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-439"><a href="#cb30-439" aria-hidden="true" tabindex="-1"></a>      LM_rook<span class="sc">$</span>adjRSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-440"><a href="#cb30-440" aria-hidden="true" tabindex="-1"></a>      LM_rook<span class="sc">$</span>SARMA<span class="sc">$</span>p.value,</span>
<span id="cb30-441"><a href="#cb30-441" aria-hidden="true" tabindex="-1"></a>      LM_inv_1<span class="sc">$</span>RSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-442"><a href="#cb30-442" aria-hidden="true" tabindex="-1"></a>      LM_inv_1<span class="sc">$</span>RSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-443"><a href="#cb30-443" aria-hidden="true" tabindex="-1"></a>      LM_inv_1<span class="sc">$</span>adjRSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-444"><a href="#cb30-444" aria-hidden="true" tabindex="-1"></a>      LM_inv_1<span class="sc">$</span>adjRSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-445"><a href="#cb30-445" aria-hidden="true" tabindex="-1"></a>      LM_inv_1<span class="sc">$</span>SARMA<span class="sc">$</span>p.value,</span>
<span id="cb30-446"><a href="#cb30-446" aria-hidden="true" tabindex="-1"></a>      LM_inv_2<span class="sc">$</span>RSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-447"><a href="#cb30-447" aria-hidden="true" tabindex="-1"></a>      LM_inv_2<span class="sc">$</span>RSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-448"><a href="#cb30-448" aria-hidden="true" tabindex="-1"></a>      LM_inv_2<span class="sc">$</span>adjRSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-449"><a href="#cb30-449" aria-hidden="true" tabindex="-1"></a>      LM_inv_2<span class="sc">$</span>adjRSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-450"><a href="#cb30-450" aria-hidden="true" tabindex="-1"></a>      LM_inv_2<span class="sc">$</span>SARMA<span class="sc">$</span>p.value,</span>
<span id="cb30-451"><a href="#cb30-451" aria-hidden="true" tabindex="-1"></a>      LM_exp_1<span class="sc">$</span>RSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-452"><a href="#cb30-452" aria-hidden="true" tabindex="-1"></a>      LM_exp_1<span class="sc">$</span>RSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-453"><a href="#cb30-453" aria-hidden="true" tabindex="-1"></a>      LM_exp_1<span class="sc">$</span>adjRSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-454"><a href="#cb30-454" aria-hidden="true" tabindex="-1"></a>      LM_exp_1<span class="sc">$</span>adjRSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-455"><a href="#cb30-455" aria-hidden="true" tabindex="-1"></a>      LM_exp_1<span class="sc">$</span>SARMA<span class="sc">$</span>p.value,</span>
<span id="cb30-456"><a href="#cb30-456" aria-hidden="true" tabindex="-1"></a>      LM_exp_2<span class="sc">$</span>RSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-457"><a href="#cb30-457" aria-hidden="true" tabindex="-1"></a>      LM_exp_2<span class="sc">$</span>RSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-458"><a href="#cb30-458" aria-hidden="true" tabindex="-1"></a>      LM_exp_2<span class="sc">$</span>adjRSerr<span class="sc">$</span>p.value,</span>
<span id="cb30-459"><a href="#cb30-459" aria-hidden="true" tabindex="-1"></a>      LM_exp_2<span class="sc">$</span>adjRSlag<span class="sc">$</span>p.value,</span>
<span id="cb30-460"><a href="#cb30-460" aria-hidden="true" tabindex="-1"></a>      LM_exp_2<span class="sc">$</span>SARMA<span class="sc">$</span>p.value</span>
<span id="cb30-461"><a href="#cb30-461" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-462"><a href="#cb30-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">6</span>,</span>
<span id="cb30-463"><a href="#cb30-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow =</span> <span class="cn">FALSE</span></span>
<span id="cb30-464"><a href="#cb30-464" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-465"><a href="#cb30-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-466"><a href="#cb30-466" aria-hidden="true" tabindex="-1"></a>tabel_uji_LM <span class="ot">&lt;-</span> <span class="fu">round</span>(tabel_uji_LM, <span class="dv">3</span>)</span>
<span id="cb30-467"><a href="#cb30-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-468"><a href="#cb30-468" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tabel_uji_LM) <span class="ot">&lt;-</span></span>
<span id="cb30-469"><a href="#cb30-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"LMlag"</span>, <span class="st">"LMerr"</span>, <span class="st">"RLMlag"</span>, <span class="st">"RLMerr"</span>, <span class="st">"SARMA"</span>)</span>
<span id="cb30-470"><a href="#cb30-470" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabel_uji_LM) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb30-471"><a href="#cb30-471" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Queen"</span>,</span>
<span id="cb30-472"><a href="#cb30-472" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Rook"</span>,</span>
<span id="cb30-473"><a href="#cb30-473" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jarak Inverse-1"</span>,</span>
<span id="cb30-474"><a href="#cb30-474" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Jarak Inverse-2"</span>,</span>
<span id="cb30-475"><a href="#cb30-475" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Negatif Eksponensial-1"</span>,</span>
<span id="cb30-476"><a href="#cb30-476" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Negatif Eksponensial-2"</span></span>
<span id="cb30-477"><a href="#cb30-477" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-478"><a href="#cb30-478" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(tabel_uji_LM)</span>
<span id="cb30-479"><a href="#cb30-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-480"><a href="#cb30-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-481"><a href="#cb30-481" aria-hidden="true" tabindex="-1"></a>Berdasarkan hasil Uji LM, diketahui bahwa matriks jarak invers 1 memberikan nilai LMlag, RLMlag, dan SARMA yang signifikan pada taraf nyata α = 0,05 dan paling kecil jika dibandingkan dengan matriks pembobot yang lainnya. </span>
<span id="cb30-482"><a href="#cb30-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-483"><a href="#cb30-483" aria-hidden="true" tabindex="-1"></a>Selanjutnya akan dilakukan pengujian indeks Moran dari setiap peubah penjelas dengan syntax berikut</span>
<span id="cb30-484"><a href="#cb30-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-487"><a href="#cb30-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-488"><a href="#cb30-488" aria-hidden="true" tabindex="-1"></a><span class="co">#Moran Test: Queen Contiguity</span></span>
<span id="cb30-489"><a href="#cb30-489" aria-hidden="true" tabindex="-1"></a>q_x1 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>PDRB),queen.jabar,<span class="at">randomisation=</span>T) <span class="co">#X1</span></span>
<span id="cb30-490"><a href="#cb30-490" aria-hidden="true" tabindex="-1"></a>q_x2 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pengeluaran,queen.jabar,<span class="at">randomisation=</span>T) <span class="co">#X2</span></span>
<span id="cb30-491"><a href="#cb30-491" aria-hidden="true" tabindex="-1"></a>q_x4 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>AMH,queen.jabar,<span class="at">randomisation =</span> T) <span class="co">#X4</span></span>
<span id="cb30-492"><a href="#cb30-492" aria-hidden="true" tabindex="-1"></a>q_x5 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>umkm),queen.jabar,<span class="at">randomisation=</span>T) <span class="co">#X5</span></span>
<span id="cb30-493"><a href="#cb30-493" aria-hidden="true" tabindex="-1"></a>q_x6 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>rekreasi,queen.jabar,<span class="at">randomisation =</span> T) <span class="co">#X6</span></span>
<span id="cb30-494"><a href="#cb30-494" aria-hidden="true" tabindex="-1"></a>q_x7 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pasar,queen.jabar,<span class="at">randomisation =</span> T) <span class="co">#X7</span></span>
<span id="cb30-495"><a href="#cb30-495" aria-hidden="true" tabindex="-1"></a>q_x8 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>restoran,queen.jabar,<span class="at">randomisation=</span>T) <span class="co">#X8</span></span>
<span id="cb30-496"><a href="#cb30-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-497"><a href="#cb30-497" aria-hidden="true" tabindex="-1"></a><span class="co">#Moran Test: Rook Contiguity</span></span>
<span id="cb30-498"><a href="#cb30-498" aria-hidden="true" tabindex="-1"></a>r_x1 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>PDRB),rook.jabar,<span class="at">randomisation=</span>T) <span class="co">#X1</span></span>
<span id="cb30-499"><a href="#cb30-499" aria-hidden="true" tabindex="-1"></a>r_x2 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pengeluaran,rook.jabar,<span class="at">randomisation=</span>T) <span class="co">#X2</span></span>
<span id="cb30-500"><a href="#cb30-500" aria-hidden="true" tabindex="-1"></a>r_x4 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>AMH,rook.jabar,<span class="at">randomisation =</span> T) <span class="co">#X4</span></span>
<span id="cb30-501"><a href="#cb30-501" aria-hidden="true" tabindex="-1"></a>r_x5 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>umkm),rook.jabar,<span class="at">randomisation=</span>T) <span class="co">#X5</span></span>
<span id="cb30-502"><a href="#cb30-502" aria-hidden="true" tabindex="-1"></a>r_x6 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>rekreasi,rook.jabar,<span class="at">randomisation =</span> T) <span class="co">#X6</span></span>
<span id="cb30-503"><a href="#cb30-503" aria-hidden="true" tabindex="-1"></a>r_x7 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pasar,rook.jabar,<span class="at">randomisation =</span> T) <span class="co">#X7</span></span>
<span id="cb30-504"><a href="#cb30-504" aria-hidden="true" tabindex="-1"></a>r_x8 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>restoran,rook.jabar,<span class="at">randomisation=</span>T) <span class="co">#X8</span></span>
<span id="cb30-505"><a href="#cb30-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-506"><a href="#cb30-506" aria-hidden="true" tabindex="-1"></a><span class="co">#Moran Test: Inverse Distance 1</span></span>
<span id="cb30-507"><a href="#cb30-507" aria-hidden="true" tabindex="-1"></a>idw_x1 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>PDRB),invers.w,<span class="at">randomisation=</span>T) <span class="co">#X1</span></span>
<span id="cb30-508"><a href="#cb30-508" aria-hidden="true" tabindex="-1"></a>idw_x2 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pengeluaran,invers.w,<span class="at">randomisation=</span>T) <span class="co">#X2</span></span>
<span id="cb30-509"><a href="#cb30-509" aria-hidden="true" tabindex="-1"></a>idw_x4 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>AMH,invers.w,<span class="at">randomisation =</span> T) <span class="co">#X4</span></span>
<span id="cb30-510"><a href="#cb30-510" aria-hidden="true" tabindex="-1"></a>idw_x5 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>umkm),invers.w,<span class="at">randomisation=</span>T) <span class="co">#X5</span></span>
<span id="cb30-511"><a href="#cb30-511" aria-hidden="true" tabindex="-1"></a>idw_x6 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>rekreasi,invers.w,<span class="at">randomisation =</span> T) <span class="co">#X6</span></span>
<span id="cb30-512"><a href="#cb30-512" aria-hidden="true" tabindex="-1"></a>idw_x7 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pasar,invers.w,<span class="at">randomisation =</span> T) <span class="co">#X7</span></span>
<span id="cb30-513"><a href="#cb30-513" aria-hidden="true" tabindex="-1"></a>idw_x8 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>restoran,invers.w,<span class="at">randomisation=</span>T) <span class="co">#X8</span></span>
<span id="cb30-514"><a href="#cb30-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-515"><a href="#cb30-515" aria-hidden="true" tabindex="-1"></a><span class="co">#Moran Test: Inverse Distance 2</span></span>
<span id="cb30-516"><a href="#cb30-516" aria-hidden="true" tabindex="-1"></a>idw2_x1 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>PDRB),invers.w2,<span class="at">randomisation=</span>T) <span class="co">#X1</span></span>
<span id="cb30-517"><a href="#cb30-517" aria-hidden="true" tabindex="-1"></a>idw2_x2 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pengeluaran,invers.w2,<span class="at">randomisation=</span>T) <span class="co">#X2</span></span>
<span id="cb30-518"><a href="#cb30-518" aria-hidden="true" tabindex="-1"></a>idw2_x4 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>AMH,invers.w2,<span class="at">randomisation =</span> T) <span class="co">#X4</span></span>
<span id="cb30-519"><a href="#cb30-519" aria-hidden="true" tabindex="-1"></a>idw2_x5 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>umkm),invers.w2,<span class="at">randomisation=</span>T) <span class="co">#X5</span></span>
<span id="cb30-520"><a href="#cb30-520" aria-hidden="true" tabindex="-1"></a>idw2_x6 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>rekreasi,invers.w2,<span class="at">randomisation =</span> T) <span class="co">#X6</span></span>
<span id="cb30-521"><a href="#cb30-521" aria-hidden="true" tabindex="-1"></a>idw2_x7 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pasar,invers.w2,<span class="at">randomisation =</span> T) <span class="co">#X7</span></span>
<span id="cb30-522"><a href="#cb30-522" aria-hidden="true" tabindex="-1"></a>idw2_x8 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>restoran,invers.w2,<span class="at">randomisation=</span>T) <span class="co">#X8</span></span>
<span id="cb30-523"><a href="#cb30-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-524"><a href="#cb30-524" aria-hidden="true" tabindex="-1"></a><span class="co">#Moran Test: Exponential Distance 1</span></span>
<span id="cb30-525"><a href="#cb30-525" aria-hidden="true" tabindex="-1"></a>exp1_x1 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>PDRB),W.eksp.s1,<span class="at">randomisation=</span>T) <span class="co">#X1</span></span>
<span id="cb30-526"><a href="#cb30-526" aria-hidden="true" tabindex="-1"></a>exp1_x2 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pengeluaran,W.eksp.s1,<span class="at">randomisation=</span>T) <span class="co">#X2</span></span>
<span id="cb30-527"><a href="#cb30-527" aria-hidden="true" tabindex="-1"></a>exp1_x4 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>AMH,W.eksp.s1,<span class="at">randomisation =</span> T) <span class="co">#X4</span></span>
<span id="cb30-528"><a href="#cb30-528" aria-hidden="true" tabindex="-1"></a>exp1_x5 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>umkm),W.eksp.s1,<span class="at">randomisation=</span>T) <span class="co">#X5</span></span>
<span id="cb30-529"><a href="#cb30-529" aria-hidden="true" tabindex="-1"></a>exp1_x6 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>rekreasi,W.eksp.s1,<span class="at">randomisation =</span> T) <span class="co">#X6</span></span>
<span id="cb30-530"><a href="#cb30-530" aria-hidden="true" tabindex="-1"></a>exp1_x7 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pasar,W.eksp.s1,<span class="at">randomisation =</span> T) <span class="co">#X7</span></span>
<span id="cb30-531"><a href="#cb30-531" aria-hidden="true" tabindex="-1"></a>exp1_x8 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>restoran,W.eksp.s1,<span class="at">randomisation=</span>T) <span class="co">#X8</span></span>
<span id="cb30-532"><a href="#cb30-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-533"><a href="#cb30-533" aria-hidden="true" tabindex="-1"></a><span class="co">#Moran Test: Exponential Distance 2</span></span>
<span id="cb30-534"><a href="#cb30-534" aria-hidden="true" tabindex="-1"></a>exp2_x1 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>PDRB),W.eksp.s2,<span class="at">randomisation=</span>T) <span class="co">#X1</span></span>
<span id="cb30-535"><a href="#cb30-535" aria-hidden="true" tabindex="-1"></a>exp2_x2 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pengeluaran,W.eksp.s2,<span class="at">randomisation=</span>T) <span class="co">#X2</span></span>
<span id="cb30-536"><a href="#cb30-536" aria-hidden="true" tabindex="-1"></a>exp2_x4 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>AMH,W.eksp.s2,<span class="at">randomisation =</span> T) <span class="co">#X4</span></span>
<span id="cb30-537"><a href="#cb30-537" aria-hidden="true" tabindex="-1"></a>exp2_x5 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(<span class="fu">log</span>(petajabar<span class="sc">$</span>umkm),W.eksp.s2,<span class="at">randomisation=</span>T) <span class="co">#X5</span></span>
<span id="cb30-538"><a href="#cb30-538" aria-hidden="true" tabindex="-1"></a>exp2_x6 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>rekreasi,W.eksp.s2,<span class="at">randomisation =</span> T) <span class="co">#X6</span></span>
<span id="cb30-539"><a href="#cb30-539" aria-hidden="true" tabindex="-1"></a>exp2_x7 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>pasar,W.eksp.s2,<span class="at">randomisation =</span> T) <span class="co">#X7</span></span>
<span id="cb30-540"><a href="#cb30-540" aria-hidden="true" tabindex="-1"></a>exp2_x8 <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(petajabar<span class="sc">$</span>restoran,W.eksp.s2,<span class="at">randomisation=</span>T) <span class="co">#X8</span></span>
<span id="cb30-541"><a href="#cb30-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-542"><a href="#cb30-542" aria-hidden="true" tabindex="-1"></a>tabel_moran <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(q_x1<span class="sc">$</span>p.value, q_x2<span class="sc">$</span>p.value, q_x4<span class="sc">$</span>p.value, q_x5<span class="sc">$</span>p.value, q_x6<span class="sc">$</span>p.value, q_x7<span class="sc">$</span>p.value, q_x8<span class="sc">$</span>p.value, r_x1<span class="sc">$</span>p.value, r_x2<span class="sc">$</span>p.value, r_x4<span class="sc">$</span>p.value, r_x5<span class="sc">$</span>p.value, r_x6<span class="sc">$</span>p.value, r_x7<span class="sc">$</span>p.value, r_x8<span class="sc">$</span>p.value, idw_x1<span class="sc">$</span>p.value, idw_x2<span class="sc">$</span>p.value, idw_x4<span class="sc">$</span>p.value, idw_x5<span class="sc">$</span>p.value, idw_x6<span class="sc">$</span>p.value, idw_x7<span class="sc">$</span>p.value, idw_x8<span class="sc">$</span>p.value, idw2_x1<span class="sc">$</span>p.value, idw2_x2<span class="sc">$</span>p.value, idw2_x4<span class="sc">$</span>p.value, idw2_x5<span class="sc">$</span>p.value, idw2_x6<span class="sc">$</span>p.value, idw2_x7<span class="sc">$</span>p.value, idw2_x8<span class="sc">$</span>p.value, exp1_x1<span class="sc">$</span>p.value, exp1_x2<span class="sc">$</span>p.value, exp1_x4<span class="sc">$</span>p.value, exp1_x5<span class="sc">$</span>p.value, exp1_x6<span class="sc">$</span>p.value, exp1_x7<span class="sc">$</span>p.value, exp1_x8<span class="sc">$</span>p.value, exp2_x1<span class="sc">$</span>p.value, exp2_x2<span class="sc">$</span>p.value, exp2_x4<span class="sc">$</span>p.value, exp2_x5<span class="sc">$</span>p.value, exp2_x6<span class="sc">$</span>p.value, exp2_x7<span class="sc">$</span>p.value, exp2_x8<span class="sc">$</span>p.value), <span class="at">ncol =</span> <span class="dv">7</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-543"><a href="#cb30-543" aria-hidden="true" tabindex="-1"></a>tabel_moran <span class="ot">&lt;-</span> <span class="fu">round</span>(tabel_moran, <span class="dv">3</span>)</span>
<span id="cb30-544"><a href="#cb30-544" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tabel_moran) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Queen"</span>, <span class="st">"Rook"</span>, <span class="st">"Jarak Inverse-1"</span>, <span class="st">"Jarak Inverse-2"</span>, <span class="st">"Negatif Eksponensial-1"</span>, <span class="st">"Negatif Eksponensial-2"</span>)</span>
<span id="cb30-545"><a href="#cb30-545" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabel_moran) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"X1"</span>, <span class="st">"X2"</span>,<span class="st">"X4"</span>, <span class="st">"X5"</span>, <span class="st">"X6"</span>, <span class="st">"X7"</span>, <span class="st">"X8"</span>)</span>
<span id="cb30-546"><a href="#cb30-546" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(tabel_moran)</span>
<span id="cb30-547"><a href="#cb30-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-548"><a href="#cb30-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-549"><a href="#cb30-549" aria-hidden="true" tabindex="-1"></a>Berdasarkan hasil uji indeks Moran, dapat dilihat bahwa peubah X1, X2, X4, dan X8 memiliki dependensi spasial. Pada penelitian ini akan digunakan matriks pembobot jarak eksponensial negatif (s = 1) sebagai matriks pembobot bagi peubah X1, X2, X4, dan X8. \ \</span>
<span id="cb30-550"><a href="#cb30-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-551"><a href="#cb30-551" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pemodelan Regresi Spasial</span></span>
<span id="cb30-552"><a href="#cb30-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-553"><a href="#cb30-553" aria-hidden="true" tabindex="-1"></a>Model yang akan dibangun adalah model SAR, model SLX, dan model SDM dengan syntax berikut:</span>
<span id="cb30-554"><a href="#cb30-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-557"><a href="#cb30-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-558"><a href="#cb30-558" aria-hidden="true" tabindex="-1"></a>WX1 <span class="ot">&lt;-</span> mat.eksp1<span class="sc">%*%</span><span class="fu">log</span>(X1)</span>
<span id="cb30-559"><a href="#cb30-559" aria-hidden="true" tabindex="-1"></a>WX2 <span class="ot">&lt;-</span> mat.eksp1<span class="sc">%*%</span>X2</span>
<span id="cb30-560"><a href="#cb30-560" aria-hidden="true" tabindex="-1"></a>WX4 <span class="ot">&lt;-</span> mat.eksp1<span class="sc">%*%</span>X4</span>
<span id="cb30-561"><a href="#cb30-561" aria-hidden="true" tabindex="-1"></a>WX8 <span class="ot">&lt;-</span> mat.eksp1<span class="sc">%*%</span>X8</span>
<span id="cb30-562"><a href="#cb30-562" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">log</span>(Y2)<span class="sc">~</span><span class="fu">log</span>(X1)<span class="sc">+</span>X2<span class="sc">+</span>X4<span class="sc">+</span><span class="fu">log</span>(X5)<span class="sc">+</span>X6<span class="sc">+</span>X7<span class="sc">+</span>X8</span>
<span id="cb30-563"><a href="#cb30-563" aria-hidden="true" tabindex="-1"></a>W.model1 <span class="ot">&lt;-</span> <span class="fu">log</span>(Y2)<span class="sc">~</span><span class="fu">log</span>(X1)<span class="sc">+</span>X2<span class="sc">+</span>X4<span class="sc">+</span><span class="fu">log</span>(X5)<span class="sc">+</span>X6<span class="sc">+</span>X7<span class="sc">+</span>X8<span class="sc">+</span>WX1<span class="sc">+</span>WX2<span class="sc">+</span>WX4<span class="sc">+</span>WX8</span>
<span id="cb30-564"><a href="#cb30-564" aria-hidden="true" tabindex="-1"></a><span class="co">#SAR</span></span>
<span id="cb30-565"><a href="#cb30-565" aria-hidden="true" tabindex="-1"></a>mod.sar <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(model1, <span class="at">listw =</span> invers.w2)</span>
<span id="cb30-566"><a href="#cb30-566" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.sar, <span class="at">Nagelkerke =</span> T)</span>
<span id="cb30-567"><a href="#cb30-567" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-568"><a href="#cb30-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-569"><a href="#cb30-569" aria-hidden="true" tabindex="-1"></a>Hasil di atas menunjukkan peubah penjelas yang berpengaruh signifikan terhadap total produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 yaitu X4 (angka melek huruf), X5 (jumlah UMKM), X6 (jumlah tempat rekreasi dan pariwisata), dan X7 (jumlah pasar rakyat). Koefisien lag spasial (ρ) juga berpengaruh terhadap model SAR pada taraf nyata α = 0,05</span>
<span id="cb30-570"><a href="#cb30-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-573"><a href="#cb30-573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-574"><a href="#cb30-574" aria-hidden="true" tabindex="-1"></a>mod.slx <span class="ot">&lt;-</span> <span class="fu">lm</span>(W.model1)</span>
<span id="cb30-575"><a href="#cb30-575" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.slx)</span>
<span id="cb30-576"><a href="#cb30-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-577"><a href="#cb30-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-578"><a href="#cb30-578" aria-hidden="true" tabindex="-1"></a>Hasil di atas menunjukkan tidak ada peubah penjelas yang berpengaruh terhadap produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 pada taraf nyata α = 0,05.</span>
<span id="cb30-579"><a href="#cb30-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-582"><a href="#cb30-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-583"><a href="#cb30-583" aria-hidden="true" tabindex="-1"></a>mod.sdm <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(W.model1, <span class="at">listw =</span> invers.w2)</span>
<span id="cb30-584"><a href="#cb30-584" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.sdm, <span class="at">Nagelkerke =</span> T)</span>
<span id="cb30-585"><a href="#cb30-585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-586"><a href="#cb30-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-587"><a href="#cb30-587" aria-hidden="true" tabindex="-1"></a>Hasil di atas menunjukkan peubah penjelas yang berpengaruh signifikan terhadap total produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 yaitu X5(jumlah UMKM), X6(jumlah tempat rekreasi dan pariwisata), dan X7(jumlah pasar rakyat). Koefisien lag spasial (ρ) juga berpengaruh terhadap model SDM pada taraf nyata α = 0,05. Hanya koefisien lag spasial peubah penjelas X4 yang berpengaruh nyata terhadap model SDM pada taraf nyata α = 0,05. Hal tersebut mengindikasikan bahwa penambahan lag spasial peubah penjelas dalam model tidak berpengaruh terhadap model.</span>
<span id="cb30-588"><a href="#cb30-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-589"><a href="#cb30-589" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pemilihan Model Terbaik</span></span>
<span id="cb30-590"><a href="#cb30-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-593"><a href="#cb30-593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-594"><a href="#cb30-594" aria-hidden="true" tabindex="-1"></a>pseudo_sar <span class="ot">&lt;-</span> <span class="fl">0.7934</span></span>
<span id="cb30-595"><a href="#cb30-595" aria-hidden="true" tabindex="-1"></a>pseudo_slx <span class="ot">&lt;-</span> <span class="fl">0.6074</span></span>
<span id="cb30-596"><a href="#cb30-596" aria-hidden="true" tabindex="-1"></a>pseudo_sdm <span class="ot">&lt;-</span> <span class="fl">0.8338</span></span>
<span id="cb30-597"><a href="#cb30-597" aria-hidden="true" tabindex="-1"></a>bic_sar <span class="ot">&lt;-</span> <span class="fu">BIC</span>(mod.sar)</span>
<span id="cb30-598"><a href="#cb30-598" aria-hidden="true" tabindex="-1"></a>bic_slx <span class="ot">&lt;-</span> <span class="fu">BIC</span>(mod.slx)</span>
<span id="cb30-599"><a href="#cb30-599" aria-hidden="true" tabindex="-1"></a>bic_sdm <span class="ot">&lt;-</span> <span class="fu">BIC</span>(mod.sdm)</span>
<span id="cb30-600"><a href="#cb30-600" aria-hidden="true" tabindex="-1"></a>tabel_bic <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(bic_sar, bic_slx, bic_sdm, pseudo_sar, pseudo_slx, pseudo_sdm), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> F)</span>
<span id="cb30-601"><a href="#cb30-601" aria-hidden="true" tabindex="-1"></a>tabel_bic <span class="ot">&lt;-</span> <span class="fu">round</span>(tabel_bic,<span class="dv">3</span>)</span>
<span id="cb30-602"><a href="#cb30-602" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tabel_bic) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'SAR'</span>, <span class="st">'SLX'</span>, <span class="st">'SDM'</span>)</span>
<span id="cb30-603"><a href="#cb30-603" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabel_bic) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'BIC'</span>, <span class="fu">paste</span>(<span class="st">"Pseudo R"</span>,<span class="fu">supsc</span>(<span class="st">'2'</span>)))</span>
<span id="cb30-604"><a href="#cb30-604" aria-hidden="true" tabindex="-1"></a>tabel_bic</span>
<span id="cb30-605"><a href="#cb30-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-606"><a href="#cb30-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-607"><a href="#cb30-607" aria-hidden="true" tabindex="-1"></a>Model SAR merupakan model yang memiliki nilai BIC terkecil dibandingkan dua model lainnya. Model SAR memiliki nilai pseudo R-Squared yang tidak berbeda jauh dengan model SDM, tetapi nilai BIC model SAR lebih kecil dibandingkan model SDM. Selain itu, hanya satu koefisien lag spasial peubah penjelas pada model SDM yang signifikan. Hal tersebut menunjukkan bahwa penambahan lag spasial pada peubah penjelas tidak memberikan pengaruh pada model sehingga model SAR adalah model yang akan dipilih sebagai model terbaik untuk memodelkan produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021. Selanjutnya akan dilakukan pengecekan asumsi normalitas sisaan, kehomogenan ragam sisaan dan kebebasan ragam sisaaan pada model SAR.</span>
<span id="cb30-608"><a href="#cb30-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-611"><a href="#cb30-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-612"><a href="#cb30-612" aria-hidden="true" tabindex="-1"></a><span class="do">## Asumsi</span></span>
<span id="cb30-613"><a href="#cb30-613" aria-hidden="true" tabindex="-1"></a>asumsi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Normalitas"</span>, <span class="st">"Heterogenitas"</span>, <span class="st">"Autokorelasi"</span>)</span>
<span id="cb30-614"><a href="#cb30-614" aria-hidden="true" tabindex="-1"></a>normalitas <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(mod.sar<span class="sc">$</span>residuals)</span>
<span id="cb30-615"><a href="#cb30-615" aria-hidden="true" tabindex="-1"></a>heterogenitas <span class="ot">&lt;-</span> <span class="fu">bptest.Sarlm</span>(mod.sar)</span>
<span id="cb30-616"><a href="#cb30-616" aria-hidden="true" tabindex="-1"></a>autokorelasi.stat <span class="ot">&lt;-</span> <span class="fl">0.00313</span></span>
<span id="cb30-617"><a href="#cb30-617" aria-hidden="true" tabindex="-1"></a>autokorelasi <span class="ot">&lt;-</span> <span class="fl">0.9553</span></span>
<span id="cb30-618"><a href="#cb30-618" aria-hidden="true" tabindex="-1"></a>tabel_asumsi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(normalitas<span class="sc">$</span>statistic, heterogenitas<span class="sc">$</span>statistic, autokorelasi.stat, normalitas<span class="sc">$</span>p.value, heterogenitas<span class="sc">$</span>p.value, autokorelasi), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> F)</span>
<span id="cb30-619"><a href="#cb30-619" aria-hidden="true" tabindex="-1"></a>tabel_asumsi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(asumsi, <span class="fu">round</span>(tabel_asumsi, <span class="dv">3</span>))</span>
<span id="cb30-620"><a href="#cb30-620" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabel_asumsi) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Asumsi"</span>, <span class="st">"Statistik Uji"</span>, <span class="st">"Nilai-P"</span>)</span>
<span id="cb30-621"><a href="#cb30-621" aria-hidden="true" tabindex="-1"></a>tabel_asumsi</span>
<span id="cb30-622"><a href="#cb30-622" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-623"><a href="#cb30-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-624"><a href="#cb30-624" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretasi Model</span></span>
<span id="cb30-625"><a href="#cb30-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-626"><a href="#cb30-626" aria-hidden="true" tabindex="-1"></a>Interpretasi pada koefisien regresi spasial dilakukan dengan melihat nilai efek langsung (direct effect), efek tidak langsung (indirect effect), dan efek total (total effect). Efek langsung merupakan nilai harapan perubahan rataan semua amatan untuk peubah respon di suatu wilayah karena peningkatan satu unit untuk peubah penjelas tertentu di wilayah tersebut. Efek tidak langsung merupakan perubahan pada peubah respon di suatu wilayah yang timbul dari kenaikan satu unit pada peubah penjelas di wilayah lain. Efek langsung dan tidak langsung dihitung menggunakan syntax berikut:</span>
<span id="cb30-627"><a href="#cb30-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-630"><a href="#cb30-630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-631"><a href="#cb30-631" aria-hidden="true" tabindex="-1"></a><span class="do">#### Spill-Over Effect ####</span></span>
<span id="cb30-632"><a href="#cb30-632" aria-hidden="true" tabindex="-1"></a>mod.sar.fixed <span class="ot">&lt;-</span> <span class="fu">lagsarlm</span>(<span class="fu">log</span>(Y2)<span class="sc">~</span>X4<span class="sc">+</span><span class="fu">log</span>(X5)<span class="sc">+</span>X6<span class="sc">+</span>X7, <span class="at">listw =</span> invers.w)</span>
<span id="cb30-633"><a href="#cb30-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-634"><a href="#cb30-634" aria-hidden="true" tabindex="-1"></a><span class="co">#Membuat matriks identitas</span></span>
<span id="cb30-635"><a href="#cb30-635" aria-hidden="true" tabindex="-1"></a>I <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="dv">27</span>, <span class="dv">27</span>)</span>
<span id="cb30-636"><a href="#cb30-636" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(I) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-637"><a href="#cb30-637" aria-hidden="true" tabindex="-1"></a>It <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, <span class="dv">27</span>, <span class="dv">1</span>)</span>
<span id="cb30-638"><a href="#cb30-638" aria-hidden="true" tabindex="-1"></a>It_transpose <span class="ot">&lt;-</span> <span class="fu">t</span>(It)</span>
<span id="cb30-639"><a href="#cb30-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-640"><a href="#cb30-640" aria-hidden="true" tabindex="-1"></a><span class="co">#Matriks Pembobot</span></span>
<span id="cb30-641"><a href="#cb30-641" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(w_std)</span>
<span id="cb30-642"><a href="#cb30-642" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.52112</span></span>
<span id="cb30-643"><a href="#cb30-643" aria-hidden="true" tabindex="-1"></a>rhow <span class="ot">&lt;-</span> rho<span class="sc">*</span>W</span>
<span id="cb30-644"><a href="#cb30-644" aria-hidden="true" tabindex="-1"></a>op <span class="ot">&lt;-</span> I <span class="sc">-</span> rhow</span>
<span id="cb30-645"><a href="#cb30-645" aria-hidden="true" tabindex="-1"></a>invers <span class="ot">&lt;-</span> <span class="fu">solve</span>(op)</span>
<span id="cb30-646"><a href="#cb30-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-647"><a href="#cb30-647" aria-hidden="true" tabindex="-1"></a><span class="co">#X4</span></span>
<span id="cb30-648"><a href="#cb30-648" aria-hidden="true" tabindex="-1"></a>beta3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.2983842</span></span>
<span id="cb30-649"><a href="#cb30-649" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> beta3<span class="sc">*</span>invers <span class="co">#matriks untuk direct effect</span></span>
<span id="cb30-650"><a href="#cb30-650" aria-hidden="true" tabindex="-1"></a>direct_b3 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">diag</span>(b3))</span>
<span id="cb30-651"><a href="#cb30-651" aria-hidden="true" tabindex="-1"></a>direct_b3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(petajabar<span class="sc">$</span>KABKOT, direct_b3)</span>
<span id="cb30-652"><a href="#cb30-652" aria-hidden="true" tabindex="-1"></a>b3<span class="fl">.2</span> <span class="ot">&lt;-</span> b3</span>
<span id="cb30-653"><a href="#cb30-653" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(b3<span class="fl">.2</span>) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#matriks untuk indirect effect</span></span>
<span id="cb30-654"><a href="#cb30-654" aria-hidden="true" tabindex="-1"></a>indirect_b3 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(b3<span class="fl">.2</span>))</span>
<span id="cb30-655"><a href="#cb30-655" aria-hidden="true" tabindex="-1"></a>total_b3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(direct_b3)<span class="sc">+</span><span class="fu">mean</span>(indirect_b3)</span>
<span id="cb30-656"><a href="#cb30-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-657"><a href="#cb30-657" aria-hidden="true" tabindex="-1"></a><span class="co">#X5</span></span>
<span id="cb30-658"><a href="#cb30-658" aria-hidden="true" tabindex="-1"></a>beta4 <span class="ot">&lt;-</span> <span class="fl">0.4934092</span></span>
<span id="cb30-659"><a href="#cb30-659" aria-hidden="true" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> beta4<span class="sc">*</span>invers <span class="co">#matriks untuk direct effect</span></span>
<span id="cb30-660"><a href="#cb30-660" aria-hidden="true" tabindex="-1"></a>direct_b4 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">diag</span>(b4))</span>
<span id="cb30-661"><a href="#cb30-661" aria-hidden="true" tabindex="-1"></a>direct_b4 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(petajabar<span class="sc">$</span>KABKOT, direct_b4)</span>
<span id="cb30-662"><a href="#cb30-662" aria-hidden="true" tabindex="-1"></a>b4<span class="fl">.2</span> <span class="ot">&lt;-</span> b4</span>
<span id="cb30-663"><a href="#cb30-663" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(b4<span class="fl">.2</span>) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#matriks untuk indirect effect</span></span>
<span id="cb30-664"><a href="#cb30-664" aria-hidden="true" tabindex="-1"></a>indirect_b4 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(b4<span class="fl">.2</span>))</span>
<span id="cb30-665"><a href="#cb30-665" aria-hidden="true" tabindex="-1"></a>total_b4 <span class="ot">&lt;-</span> <span class="fu">mean</span>(direct_b4)<span class="sc">+</span><span class="fu">mean</span>(indirect_b4)</span>
<span id="cb30-666"><a href="#cb30-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-667"><a href="#cb30-667" aria-hidden="true" tabindex="-1"></a><span class="co">#X6</span></span>
<span id="cb30-668"><a href="#cb30-668" aria-hidden="true" tabindex="-1"></a>beta5 <span class="ot">&lt;-</span> <span class="fl">0.0043757</span></span>
<span id="cb30-669"><a href="#cb30-669" aria-hidden="true" tabindex="-1"></a>b5 <span class="ot">&lt;-</span> beta5<span class="sc">*</span>invers</span>
<span id="cb30-670"><a href="#cb30-670" aria-hidden="true" tabindex="-1"></a>direct_b5 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">diag</span>(b5))</span>
<span id="cb30-671"><a href="#cb30-671" aria-hidden="true" tabindex="-1"></a>direct_b5 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(petajabar<span class="sc">$</span>KABKOT, direct_b5)</span>
<span id="cb30-672"><a href="#cb30-672" aria-hidden="true" tabindex="-1"></a>b5<span class="fl">.2</span> <span class="ot">&lt;-</span> b5</span>
<span id="cb30-673"><a href="#cb30-673" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(b5<span class="fl">.2</span>) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#matriks untuk indirect effect</span></span>
<span id="cb30-674"><a href="#cb30-674" aria-hidden="true" tabindex="-1"></a>indirect_b5 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(b5<span class="fl">.2</span>))</span>
<span id="cb30-675"><a href="#cb30-675" aria-hidden="true" tabindex="-1"></a>total_b5 <span class="ot">&lt;-</span> <span class="fu">mean</span>(direct_b5)<span class="sc">+</span><span class="fu">mean</span>(indirect_b5)</span>
<span id="cb30-676"><a href="#cb30-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-677"><a href="#cb30-677" aria-hidden="true" tabindex="-1"></a><span class="co">#X7</span></span>
<span id="cb30-678"><a href="#cb30-678" aria-hidden="true" tabindex="-1"></a>beta6 <span class="ot">&lt;-</span> <span class="fl">0.0043757</span></span>
<span id="cb30-679"><a href="#cb30-679" aria-hidden="true" tabindex="-1"></a>b6 <span class="ot">&lt;-</span> beta6<span class="sc">*</span>invers</span>
<span id="cb30-680"><a href="#cb30-680" aria-hidden="true" tabindex="-1"></a>direct_b6 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">diag</span>(b6))</span>
<span id="cb30-681"><a href="#cb30-681" aria-hidden="true" tabindex="-1"></a>direct_b6 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(petajabar<span class="sc">$</span>KABKOT, direct_b6)</span>
<span id="cb30-682"><a href="#cb30-682" aria-hidden="true" tabindex="-1"></a>b6<span class="fl">.2</span> <span class="ot">&lt;-</span> b6</span>
<span id="cb30-683"><a href="#cb30-683" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(b6<span class="fl">.2</span>) <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#matriks untuk indirect effect</span></span>
<span id="cb30-684"><a href="#cb30-684" aria-hidden="true" tabindex="-1"></a>indirect_b6 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(b6<span class="fl">.2</span>))</span>
<span id="cb30-685"><a href="#cb30-685" aria-hidden="true" tabindex="-1"></a>total_b6 <span class="ot">&lt;-</span> <span class="fu">mean</span>(direct_b6)<span class="sc">+</span><span class="fu">mean</span>(indirect_b6)</span>
<span id="cb30-686"><a href="#cb30-686" aria-hidden="true" tabindex="-1"></a>tabel_efek <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(direct_b3), <span class="fu">mean</span>(indirect_b3), total_b3,<span class="fu">mean</span>(direct_b4), <span class="fu">mean</span>(indirect_b4), total_b4, <span class="fu">mean</span>(direct_b5), <span class="fu">mean</span>(indirect_b5), total_b5, <span class="fu">mean</span>(direct_b6), <span class="fu">mean</span>(indirect_b6), total_b6), <span class="at">ncol=</span> <span class="dv">3</span>, <span class="at">byrow =</span> T)</span>
<span id="cb30-687"><a href="#cb30-687" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabel_efek) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Direct"</span>, <span class="st">"Indirect"</span>, <span class="st">"Total"</span>)</span>
<span id="cb30-688"><a href="#cb30-688" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tabel_efek) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"X4"</span>, <span class="st">"X5"</span>, <span class="st">"X6"</span>, <span class="st">"X7"</span>)</span>
<span id="cb30-689"><a href="#cb30-689" aria-hidden="true" tabindex="-1"></a>tabel_efek</span>
<span id="cb30-690"><a href="#cb30-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-691"><a href="#cb30-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-692"><a href="#cb30-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-695"><a href="#cb30-695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-696"><a href="#cb30-696" aria-hidden="true" tabindex="-1"></a>indirect_b3 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(petajabar<span class="sc">$</span>KABKOT, indirect_b3)</span>
<span id="cb30-697"><a href="#cb30-697" aria-hidden="true" tabindex="-1"></a>indirect_b4 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(petajabar<span class="sc">$</span>KABKOT, indirect_b4)</span>
<span id="cb30-698"><a href="#cb30-698" aria-hidden="true" tabindex="-1"></a>indirect_b5 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(petajabar<span class="sc">$</span>KABKOT, indirect_b5)</span>
<span id="cb30-699"><a href="#cb30-699" aria-hidden="true" tabindex="-1"></a>indirect_b6 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(petajabar<span class="sc">$</span>KABKOT, indirect_b6)</span>
<span id="cb30-700"><a href="#cb30-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-701"><a href="#cb30-701" aria-hidden="true" tabindex="-1"></a>dat.map <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/shp/jawa.shp"</span>)</span>
<span id="cb30-702"><a href="#cb30-702" aria-hidden="true" tabindex="-1"></a>dat.map <span class="ot">&lt;-</span> dat.map <span class="sc">%&gt;%</span> <span class="fu">filter</span>(PROVNO <span class="sc">==</span> <span class="st">"32"</span>)</span>
<span id="cb30-703"><a href="#cb30-703" aria-hidden="true" tabindex="-1"></a>dat.map<span class="sc">$</span>de_x4<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(direct_b3[,<span class="dv">2</span>])</span>
<span id="cb30-704"><a href="#cb30-704" aria-hidden="true" tabindex="-1"></a>dat.map<span class="sc">$</span>de_x5<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(direct_b4[,<span class="dv">2</span>])</span>
<span id="cb30-705"><a href="#cb30-705" aria-hidden="true" tabindex="-1"></a>dat.map<span class="sc">$</span>de_x6<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(direct_b5[,<span class="dv">2</span>])</span>
<span id="cb30-706"><a href="#cb30-706" aria-hidden="true" tabindex="-1"></a>dat.map<span class="sc">$</span>de_x7<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(direct_b6[,<span class="dv">2</span>])</span>
<span id="cb30-707"><a href="#cb30-707" aria-hidden="true" tabindex="-1"></a>dat.map<span class="sc">$</span>ie_x4<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(indirect_b3[,<span class="dv">2</span>])</span>
<span id="cb30-708"><a href="#cb30-708" aria-hidden="true" tabindex="-1"></a>dat.map<span class="sc">$</span>ie_x5<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(indirect_b4[,<span class="dv">2</span>])</span>
<span id="cb30-709"><a href="#cb30-709" aria-hidden="true" tabindex="-1"></a>dat.map<span class="sc">$</span>ie_x6<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(indirect_b5[,<span class="dv">2</span>])</span>
<span id="cb30-710"><a href="#cb30-710" aria-hidden="true" tabindex="-1"></a>dat.map<span class="sc">$</span>ie_x7<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(indirect_b6[,<span class="dv">2</span>])</span>
<span id="cb30-711"><a href="#cb30-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-712"><a href="#cb30-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-715"><a href="#cb30-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-716"><a href="#cb30-716" aria-hidden="true" tabindex="-1"></a><span class="do">#### Direct Effect Map ####</span></span>
<span id="cb30-717"><a href="#cb30-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-718"><a href="#cb30-718" aria-hidden="true" tabindex="-1"></a>mycol <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"red"</span>, <span class="st">"red4"</span>)</span>
<span id="cb30-719"><a href="#cb30-719" aria-hidden="true" tabindex="-1"></a>map.de.x4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-720"><a href="#cb30-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>dat.map, <span class="at">mapping =</span>  <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">fill =</span> de_x4))<span class="sc">+</span></span>
<span id="cb30-721"><a href="#cb30-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> mycol, <span class="at">name =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb30-722"><a href="#cb30-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Direct Effect X4"</span>)</span>
<span id="cb30-723"><a href="#cb30-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-724"><a href="#cb30-724" aria-hidden="true" tabindex="-1"></a>map.de.x5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-725"><a href="#cb30-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>dat.map, <span class="at">mapping =</span>  <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">fill =</span> de_x5))<span class="sc">+</span></span>
<span id="cb30-726"><a href="#cb30-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> mycol, <span class="at">name =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb30-727"><a href="#cb30-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Direct Effect X5"</span>)</span>
<span id="cb30-728"><a href="#cb30-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-729"><a href="#cb30-729" aria-hidden="true" tabindex="-1"></a>map.de.x6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-730"><a href="#cb30-730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>dat.map, <span class="at">mapping =</span>  <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">fill =</span> de_x6))<span class="sc">+</span></span>
<span id="cb30-731"><a href="#cb30-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> mycol, <span class="at">name =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb30-732"><a href="#cb30-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Direct Effect X6"</span>)</span>
<span id="cb30-733"><a href="#cb30-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-734"><a href="#cb30-734" aria-hidden="true" tabindex="-1"></a>map.de.x7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-735"><a href="#cb30-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>dat.map, <span class="at">mapping =</span>  <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">fill =</span> de_x7))<span class="sc">+</span></span>
<span id="cb30-736"><a href="#cb30-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> mycol, <span class="at">name =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb30-737"><a href="#cb30-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Direct Effect X7"</span>)</span>
<span id="cb30-738"><a href="#cb30-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb30-739"><a href="#cb30-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-742"><a href="#cb30-742" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb30-743"><a href="#cb30-743" aria-hidden="true" tabindex="-1"></a><span class="do">#### Indirect Effect Map ####</span></span>
<span id="cb30-744"><a href="#cb30-744" aria-hidden="true" tabindex="-1"></a>map.ie.x4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-745"><a href="#cb30-745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>dat.map, <span class="at">mapping =</span>  <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">fill =</span> ie_x4))<span class="sc">+</span></span>
<span id="cb30-746"><a href="#cb30-746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> mycol, <span class="at">name =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb30-747"><a href="#cb30-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Indirect Effect X4"</span>)</span>
<span id="cb30-748"><a href="#cb30-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-749"><a href="#cb30-749" aria-hidden="true" tabindex="-1"></a>map.ie.x5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-750"><a href="#cb30-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>dat.map, <span class="at">mapping =</span>  <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">fill =</span> ie_x5))<span class="sc">+</span></span>
<span id="cb30-751"><a href="#cb30-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> mycol, <span class="at">name =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb30-752"><a href="#cb30-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Indirect Effect X5"</span>)</span>
<span id="cb30-753"><a href="#cb30-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-754"><a href="#cb30-754" aria-hidden="true" tabindex="-1"></a>map.ie.x6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-755"><a href="#cb30-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>dat.map, <span class="at">mapping =</span>  <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">fill =</span> ie_x6))<span class="sc">+</span></span>
<span id="cb30-756"><a href="#cb30-756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> mycol, <span class="at">name =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb30-757"><a href="#cb30-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Indirect Effect X6"</span>)</span>
<span id="cb30-758"><a href="#cb30-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-759"><a href="#cb30-759" aria-hidden="true" tabindex="-1"></a>map.ie.x7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-760"><a href="#cb30-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>dat.map, <span class="at">mapping =</span>  <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">fill =</span> ie_x7))<span class="sc">+</span></span>
<span id="cb30-761"><a href="#cb30-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> mycol, <span class="at">name =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb30-762"><a href="#cb30-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Indirect Effect X7"</span>)</span>
<span id="cb30-763"><a href="#cb30-763" aria-hidden="true" tabindex="-1"></a>map.de.x4</span>
<span id="cb30-764"><a href="#cb30-764" aria-hidden="true" tabindex="-1"></a>map.ie.x4</span>
<span id="cb30-765"><a href="#cb30-765" aria-hidden="true" tabindex="-1"></a>map.de.x5</span>
<span id="cb30-766"><a href="#cb30-766" aria-hidden="true" tabindex="-1"></a>map.ie.x5</span>
<span id="cb30-767"><a href="#cb30-767" aria-hidden="true" tabindex="-1"></a>map.de.x6</span>
<span id="cb30-768"><a href="#cb30-768" aria-hidden="true" tabindex="-1"></a>map.ie.x6</span>
<span id="cb30-769"><a href="#cb30-769" aria-hidden="true" tabindex="-1"></a>map.de.x7</span>
<span id="cb30-770"><a href="#cb30-770" aria-hidden="true" tabindex="-1"></a>map.ie.x7</span>
<span id="cb30-771"><a href="#cb30-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>