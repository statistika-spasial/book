<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Regresi Spasial Gerombol – Pemodelan Statistika pada Data Geospasial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./ModelEpidemiologi.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./RegresiSpasialGerombol.html">Regresi Spasial Gerombol</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pemodelan Statistika pada Data Geospasial</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/statistika-spasial/book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kata Pengantar</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pendahuluan</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Dependensi Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-SpasialAutoRegresifModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-SpasialDurbinModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spasial Durbin Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-SpasialAutoRegresifBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Keragaman Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-RegresiTerbobotiGeografis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-RegresiTerbobotiGeografisCampuran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Campuran</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-RegresiTerbobotiGeografisBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MGWRSAR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MGWR-SAR</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Filtering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-ModelDependensiSpasial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-ModelKeragamanSpasial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ModelEpidemiologi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Epidemiologi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RegresiSpasialGerombol.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Regresi Spasial Gerombol</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Lampiran</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referensi</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Daftar isi</h2>
   
  <ul>
<li><a href="#deskripsi" id="toc-deskripsi" class="nav-link active" data-scroll-target="#deskripsi">Deskripsi</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#metode-penelitian" id="toc-metode-penelitian" class="nav-link" data-scroll-target="#metode-penelitian">Metode Penelitian</a></li>
  <li>
<a href="#tahapan-analisis-dengan-r" id="toc-tahapan-analisis-dengan-r" class="nav-link" data-scroll-target="#tahapan-analisis-dengan-r">Tahapan Analisis dengan R</a>
  <ul class="collapse">
<li><a href="#package" id="toc-package" class="nav-link" data-scroll-target="#package">Package</a></li>
  <li><a href="#persiapan-data" id="toc-persiapan-data" class="nav-link" data-scroll-target="#persiapan-data">Persiapan Data</a></li>
  <li><a href="#eksplorasi-data" id="toc-eksplorasi-data" class="nav-link" data-scroll-target="#eksplorasi-data">Eksplorasi Data</a></li>
  <li><a href="#pengecekan-asumsi-galat" id="toc-pengecekan-asumsi-galat" class="nav-link" data-scroll-target="#pengecekan-asumsi-galat">Pengecekan asumsi galat</a></li>
  <li><a href="#deteksi-multikolinearitas" id="toc-deteksi-multikolinearitas" class="nav-link" data-scroll-target="#deteksi-multikolinearitas">Deteksi multikolinearitas</a></li>
  <li><a href="#asumsi-efek-spasial" id="toc-asumsi-efek-spasial" class="nav-link" data-scroll-target="#asumsi-efek-spasial">Asumsi efek spasial</a></li>
  <li><a href="#matriks-pembobot-spasial" id="toc-matriks-pembobot-spasial" class="nav-link" data-scroll-target="#matriks-pembobot-spasial">Matriks pembobot spasial</a></li>
  <li><a href="#gerombol-k-means-inisiasi-awal" id="toc-gerombol-k-means-inisiasi-awal" class="nav-link" data-scroll-target="#gerombol-k-means-inisiasi-awal">Gerombol K-Means (inisiasi awal)</a></li>
  </ul>
</li>
  <li>
<a href="#model-regresi-gerombol-spasial-dengan-peubah-y" id="toc-model-regresi-gerombol-spasial-dengan-peubah-y" class="nav-link" data-scroll-target="#model-regresi-gerombol-spasial-dengan-peubah-y">Model Regresi Gerombol Spasial dengan Peubah Y</a>
  <ul class="collapse">
<li><a href="#gerombol-dengan-pembobot-1" id="toc-gerombol-dengan-pembobot-1" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-1">Gerombol dengan pembobot 1</a></li>
  <li><a href="#gerombol-dengan-pembobot-2" id="toc-gerombol-dengan-pembobot-2" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-2">Gerombol dengan pembobot 2</a></li>
  <li><a href="#gerombol-dengan-pembobot-3" id="toc-gerombol-dengan-pembobot-3" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-3">Gerombol dengan pembobot 3</a></li>
  <li><a href="#gerombol-dengan-pembobot-4" id="toc-gerombol-dengan-pembobot-4" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-4">Gerombol dengan pembobot 4</a></li>
  <li><a href="#gerombol-dengan-pembobot-5" id="toc-gerombol-dengan-pembobot-5" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-5">Gerombol dengan pembobot 5</a></li>
  <li><a href="#gerombol-dengan-pembobot-6" id="toc-gerombol-dengan-pembobot-6" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-6">Gerombol dengan pembobot 6</a></li>
  <li><a href="#gerombol-dengan-pembobot-7" id="toc-gerombol-dengan-pembobot-7" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-7">Gerombol dengan pembobot 7</a></li>
  <li><a href="#gerombol-dengan-pembobot-8" id="toc-gerombol-dengan-pembobot-8" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-8">Gerombol dengan pembobot 8</a></li>
  <li><a href="#gerombol-dengan-pembobot-9" id="toc-gerombol-dengan-pembobot-9" class="nav-link" data-scroll-target="#gerombol-dengan-pembobot-9">Gerombol dengan pembobot 9</a></li>
  <li><a href="#peta-gerombol-spasial" id="toc-peta-gerombol-spasial" class="nav-link" data-scroll-target="#peta-gerombol-spasial">Peta Gerombol Spasial</a></li>
  <li><a href="#nilai-uji-kebaikan-model" id="toc-nilai-uji-kebaikan-model" class="nav-link" data-scroll-target="#nilai-uji-kebaikan-model">Nilai uji kebaikan model</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova">ANOVA</a></li>
  <li><a href="#peubah-peubah-berpengaruh" id="toc-peubah-peubah-berpengaruh" class="nav-link" data-scroll-target="#peubah-peubah-berpengaruh">Peubah-Peubah berpengaruh</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-spatclusreg" class="quarto-section-identifier">Regresi Spasial Gerombol</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="deskripsi" class="level2"><h2 class="anchored" data-anchor-id="deskripsi">Deskripsi</h2>
<p>Regresi gerombol spasial (<em>Spatially Clustered Regression</em>) merupakan pengembangan dari metode regresi terboboti geografis (RTGT) yang digabungkan dengan analisis gerombol <span class="citation" data-cites="sugasawa2021">(<a href="references.html#ref-sugasawa2021" role="doc-biblioref">Sugasawa &amp; Murakami, 2021</a>)</span>. Perpaduan antara analisis gerombol dengan regresi spasial memberikan interpretasi yang lebih sederhana pada model lokal <span class="citation" data-cites="li2018">(<a href="references.html#ref-li2018" role="doc-biblioref">Li &amp; Sang, 2018</a>)</span>. Metode ini menghasilkan satu model regresi pada setiap gerombol.</p>
<p>Model regresi gerombol spasial sebagai berikut</p>
<p><span id="eq-1301"><span class="math display">\[
y_i = \beta_0(g_i)  + \sum_k \beta_k (g_i) x_{ik} + \epsilon_i
\tag{1}\]</span></span></p>
<p>dengan:</p>
<p><span class="math display">\[\begin{align*}

  y_i &amp;: \text{nilai amatan peubah respon gerombol ke-i} \\
  
  g_i &amp;: \text{gerombol ke-i} \\
  
  \beta_0 (g_i) &amp;: \text{konstanta/intersep pada gerombol ke-i} \\
  
  \beta_i (g_i) &amp;: \text{koefisien regresi peubah penjelas ke-p pada gerombol ke-i} \\
  
  X_{ip} &amp;: \text{peubah penjelas ke-p pada gerombol ke-i} \\
  
  \epsilon_i &amp;: \text{galat pada gerombol ke-i}
  
\end{align*}\]</span></p>
<p>Sebelum mendapatkan model regresi gerombol spasial, pertama-tama dilakukan inisiasi gerombol awal <span class="math inline">\(g_0\)</span> dan nilai beta awal <span class="math inline">\(\theta_0=(\beta_0 (g_i ), \beta_i (g_i))\)</span>. Gerombol awal didapatkan melalui metode K-means berdasarkan koordinat kabupaten/kota di Indonesia. Nilai beta awal diinisiasi dengan membentuk matriks <strong>0</strong> berukuran <span class="math inline">\(p×G\)</span>, dengan <span class="math inline">\(p\)</span> merupakan banyaknya koefisien beta dan <span class="math inline">\(G\)</span> merupakan banyaknya gerombol yang ingin dibentuk. Ragam dalam gerombol diformulakan sebagai</p>
<p><span id="eq-1302"><span class="math display">\[
W(C_k) = \sum_{x_i\in C_k} (x_i - \mu_k) ^2
\tag{2}\]</span></span></p>
<p>Sehingga total ragam dalam gerombol (TRG), yaitu:</p>
<p><span id="eq-1303"><span class="math display">\[
TRG = \sum_{k=1}^k W(C_k) = \sum_{k=1}^k \sum_{x_i\in C_k} (x_i - \mu_k) ^2
\tag{3}\]</span></span></p>
<p>dengan:</p>
<p><span class="math display">\[\begin{align*}
x_i : &amp; \ \text{amatan dalam klaster }C_k \\
\mu_k : &amp; \ \text{rataan dari amatan pada gerombol }C_k
\end{align*}\]</span></p>
<p>Penentuan amatan dalam gerombol menggunakan fungsi likelihood terpenalti. Nilai parameter pada setiap gerombol bernilai sama. Fungsi penalti likelihood memiliki formula sebagai berikut:</p>
<p><span id="eq-1304"><span class="math display">\[
Q(\theta,g) ≡ \sum_{i=1}^n log f (y_i | x_i;\theta_(g_i)) + \phi \sum_{i&lt;j} w_{ij} I(g_i=g_j)
\tag{4}\]</span></span></p>
<p>dengan:</p>
<p><span class="math display">\[\begin{align*}

  Q(\theta,g) : &amp; \ \text{fungsi objektif likelihood terpenalti nilai peubah penjelas bagi beta pada gerombol g} \\
  
  f (y_i | x_i;\theta_(g_i)) : &amp; \ \text{fungsi likelihood peubah respons dan penjelas saat gerombol ke-i} \\
  
  \phi : &amp; \ \text{kekuatan hubungan spasial yang diberi nilai 1 } \\
  
  w_{ij} : &amp; \ \text{nilai fungsi pembobot} \\
  
  I(g_i=g_j) : &amp; \ \text{matriks indeks dengan unsur bernilai 1 untuk amatan dengan gerombol }g_i=g_j
  
\end{align*}\]</span></p>
<p>Nilai inisiasi gerombol <span class="math inline">\(g_0\)</span> dan nilai beta <span class="math inline">\(\beta_0\)</span> dimasukan ke dalam fungsi likelihood terpenalti (<a href="#eq-1304" class="quarto-xref">Persamaan&nbsp;<span>4</span></a>) untuk menentukan amatan berada pada gerombol. Nilai <span class="math inline">\(g_k\)</span> dan <span class="math inline">\(\beta_k\)</span> diperbaiki pada setiap iterasi-k hingga mendapatkan anggota <span class="math inline">\(g_k\)</span> dan nilai <span class="math inline">\(\beta_k\)</span> yang memaksimumkan fungsi likelihood terpenalti. Konvergensi didapatkan ketika perbedaan nilai saat ini dan nilai hasil pembaharuan lebih kecil dari nilai toleransi <span class="math inline">\(\epsilon\)</span>. Nilai toleransi ditetapkan bernilai <span class="math inline">\(\epsilon=10^{-6}\)</span> <span class="citation" data-cites="sugasawa2021">(<a href="references.html#ref-sugasawa2021" role="doc-biblioref">Sugasawa &amp; Murakami, 2021</a>)</span>.</p>
</section><section id="data" class="level2"><h2 class="anchored" data-anchor-id="data">Data</h2>
<p>Penelitian ini mengacu pada <span class="citation" data-cites="sayidar2024">Sayidar et al. (<a href="references.html#ref-sayidar2024" role="doc-biblioref">2024</a>)</span>. Data yang digunakan dalam penelitian ini merupakan data sekunder yang bersumber dari hasil publikasi Badan Pusat Statistik mengenai indikator kemiskinan di Indonesia tahun 2022. Unit pengamatan berupa 514 kabupaten/kota di Indonesia, satu peubah respons, dan delapan peubah penjelas. Peubah-Peubah yang digunakan dalam penelitian ini tertera pada <a href="#tbl-gerombol" class="quarto-xref">Tabel&nbsp;<span>1</span></a>.</p>
<div id="tbl-gerombol" class="striped hover quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-gerombol-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabel&nbsp;1: Peubah yang digunakan
</figcaption><div aria-describedby="tbl-gerombol-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 51%">
<col style="width: 18%">
<col style="width: 22%">
</colgroup>
<thead><tr class="header">
<th>Peubah</th>
<th>Keterangan</th>
<th>Satuan</th>
<th>Referensi</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\((x,y)\)</span></td>
<td>Koordinat kabupaten/kota</td>
<td>Bujur, lintang</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">\(y\)</span></td>
<td>Persentase penduduk miskin</td>
<td>%</td>
<td>-</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_1\)</span></td>
<td>Banyak sarana kesehatan per jumlah penduduk</td>
<td>%</td>
<td><span class="citation" data-cites="rahmawati2010">Rahmawati &amp; Djuraidah (<a href="references.html#ref-rahmawati2010" role="doc-biblioref">2010</a>)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_2\)</span></td>
<td>Persentase penduduk yang mempunyai pendidikan &lt; SMA</td>
<td>%</td>
<td>-</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_3\)</span></td>
<td>Persentase rumah tangga yang menggunakan air minum layak</td>
<td>%</td>
<td><span class="citation" data-cites="rahmawati2011">Rahmawati &amp; Djuraidah (<a href="references.html#ref-rahmawati2011" role="doc-biblioref">2011</a>)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_4\)</span></td>
<td>Persentase pengeluaran per kapita untuk makanan</td>
<td>%</td>
<td>Damayanti dan Ratnasari (2013)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_5\)</span></td>
<td>Indeks pembangunan manusia</td>
<td>-</td>
<td><span class="citation" data-cites="putri2021">Putri &amp; Hajarisman (<a href="references.html#ref-putri2021" role="doc-biblioref">2021</a>)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_6\)</span></td>
<td>Tingkat pengangguran terbuka</td>
<td>%</td>
<td><span class="citation" data-cites="putri2021">Putri &amp; Hajarisman (<a href="references.html#ref-putri2021" role="doc-biblioref">2021</a>)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x_7\)</span></td>
<td>Upah minimum kerja</td>
<td>Rp</td>
<td><span class="citation" data-cites="agustina2015">Agustina et al. (<a href="references.html#ref-agustina2015" role="doc-biblioref">2015</a>)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(x_8\)</span></td>
<td>Persentase rumah tangga dengan Jamban sendiri</td>
<td>%</td>
<td><span class="citation" data-cites="agustina2015">Agustina et al. (<a href="references.html#ref-agustina2015" role="doc-biblioref">2015</a>)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Peubah yang digunakan pada penelitian ini merupakan referensi dari penelitian-penelitian terdahulu yang menggunakan metode Regresi Terboboti Geografis, di antaranya dilakukan oleh Rahmawati &amp; Djuraidah <span class="citation" data-cites="rahmawati2010 rahmawati2011">(<a href="references.html#ref-rahmawati2010" role="doc-biblioref">2010</a>, <a href="references.html#ref-rahmawati2011" role="doc-biblioref">2011</a>)</span> yang menunjukkan peubah, banyaknya sarana kesehatan dan persentase rumah tangga yang menggunakan air minum layak. Peubah persentase penduduk yang mempunyai pendidikan di bawah SMA merupakan hal baru yang sebelumnya oleh <span class="citation" data-cites="rahmawati2010">Rahmawati &amp; Djuraidah (<a href="references.html#ref-rahmawati2010" role="doc-biblioref">2010</a>)</span> diketahui bahwa persentase penduduk yang mempunyai pendidikan di bawah SD berpengaruh terhadap tingkat kemiskinan. Kemudian, <span class="citation" data-cites="putri2021">Putri &amp; Hajarisman (<a href="references.html#ref-putri2021" role="doc-biblioref">2021</a>)</span> menunjukkan peubah IPM dan TPT berpengaruh terhadap kemiskinan. Terakhir, penelitian <span class="citation" data-cites="agustina2015">Agustina et al. (<a href="references.html#ref-agustina2015" role="doc-biblioref">2015</a>)</span> menunjukkan faktor upah minimum kerja (UMK) dan persentase rumah tangga memiliki jamban sendiri berpengaruh terhadap model. Peubah-Peubah signifikan pada model Regresi Terboboti Geografis tersebut dijadikan acuan peubah-peubah yang digunakan pada model Regresi Gerombol Spasial.</p>
</section><section id="metode-penelitian" class="level2"><h2 class="anchored" data-anchor-id="metode-penelitian">Metode Penelitian</h2>
<p>Analisis pada penelitian ini dilakukan dengan bantuan perangkat lunak RStudio. Tahapan analisis yang dilakukan adalah sebagai berikut:</p>
<ol type="1">
<li><p>Melakukan <em>preprocessing</em> data berupa penyesuaian format data, yaitu bentuk tabel agar sesuai dengan keperluan analisis dan penanganan <em>missing value</em> menggunakan <strong>Group Mean Imputation</strong> di mana provinsi didefinisikan sebagai sebuah grup.</p></li>
<li>
<p>Melakukan eksplorasi data untuk mengetahui karakteristik data tingkat kemiskinan kabupaten/kota di Indonesia secara umum. Eksplorasi data yang dilakukan adalah sebagai berikut:</p>
<ul>
<li>Analisis deskriptif peubah respons dan peubah penjelas. Berupa ringkasan data dan ukuran penyebaran data peubah-peubah.
<ul>
<li>Peta tematik untuk melihat pola sebaran peubah respons di setiap amatan</li>
<li>Boxplot untuk mengetahui pencilan, sebaran, dan karakteristik pada peubah respons. Boxplot dapat digunakan sebagai indikasi awal apakah terdapat efek spasial dalam data, yaitu daerah pencilan yang menunjukkan bahwa nilai dari peubah cukup bervariasi <span class="citation" data-cites="ritonga2022">(<a href="references.html#ref-ritonga2022" role="doc-biblioref">Ritonga et al., 2022</a>)</span>.</li>
<li>Korelasi data antara peubah respons dan peubah penjelas. Korelasi digunakan untuk menggambarkan hubungan linear antarpeubah.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Melakukan pengecekan asumsi galat regresi sebagai berikut:</p>
<ul>
<li>Pengecekan normalitas menggunakan uji Shapiro-Wilk</li>
<li>Pengecekan autokorelasi menggunakan uji Durbin-Watson
<ul>
<li>Pengecekan heteroskedastisitas menggunakan uji Breusch-Pagan</li>
</ul>
</li>
</ul>
</li>
<li><p>Melakukan pengecekan asumsi multikolinearitas pada seluruh peubah penjelas menggunakan nilai <em>variance inflation factor</em> (VIF). Jika terdapat peubah penjelas yang terdeteksi mengandung multikolinearitas, peubah penjelas tersebut dibuang dari model. VIF di atas 5 dianggap mengandung multikolinearitas <span class="citation" data-cites="james2013">(<a href="references.html#ref-james2013" role="doc-biblioref">James et al., 2013</a>)</span></p></li>
<li><p>Melakukan uji efek spasial, yaitu uji asumsi keragaman spasial menggunakan uji Moran dan uji asumsi heterogenitas spasial menggunakan uji Breusch-Pagan. Jika salah satu dari kedua uji tersebut menunjukkan terdapat efek spasial maka dapat dilanjutkan melakukan analisis Regresi Gerombol Spasial.</p></li>
<li><p>Membentuk matriks jarak menggunakan jarak ecludian antar dua kabupaten/kota berdasarkan koordinat amatan dan matriks pembobot spasial menggunakan fungsi pembobot jarak ambang, fungsi pembobot eksponensial, fungsi pembobot <em>3-nearest neighboor</em>, fungsi pembobot <em>4-nearest neighbor</em>, fungsi pembobot <em>5-nearest neighbor</em>, fungsi <em>invers distance weight</em> <span class="math inline">\((\alpha=1)\)</span>, fungsi <em>invers distance weight</em> <span class="math inline">\((\alpha=2)\)</span>, <em>rock contiguity</em>, dan <em>queen contiguity</em>.</p></li>
<li><p>Inisiasi anggota gerombol awal <span class="math inline">\(g_0\)</span> untuk total gerombol <span class="math inline">\(G \in {3,4,5,6,…,15}\)</span> menggunakan algoritma <em>K-means clustering</em>. Klaster atau gerombol dibentuk menggunakan data latitude dan longitude tiap lokasi amatan.</p></li>
<li><p>Inisiasi nilai beta awal <span class="math inline">\(\beta_0\)</span> sesuai banyaknya amatan <span class="math inline">\(n\)</span> dan gerombol <span class="math inline">\(G\)</span>. Di mana <span class="math inline">\(\beta_0\)</span> merupakan matriks berdimensi <span class="math inline">\(n×G\)</span> dengan unsur bernilai 1 pada setiap baris dan kolomnya.</p></li>
<li>
<p>Melakukan <em>penalty likelihood</em> melalui fungsi objektif <a href="#eq-1304" class="quarto-xref">Persamaan&nbsp;<span>4</span></a> untuk menggerombolkan data amatan. <em>Penalty likelihood</em> berfungsi untuk mendapatkan nilai parameter beta duga dan anggota gerombol akhir di mana menggunakan gerombol inisiasi awal <em>K-Means</em> ditambah matriks pembobot spasial sehingga didapatkan model Regresi Gerombol Spasial sebanyak 117 kombinasi. Fungsi objektif <em>penalty likelihood</em> dioptimasi berdasarkan Langkah-langkah berikut:</p>
<ul>
<li>Inisiasi nilai parameter beta awal <span class="math inline">\(\beta_0\)</span> dan anggota gerombol awal <span class="math inline">\(g_0\)</span>
<ul>
<li>Perbaharui nilai parameter ke-k <span class="math inline">\(\beta_k\)</span> untuk setiap gerombol <span class="math inline">\(g=1,2,3,…,G\)</span>
</li>
<li>Perbaharui anggota gerombol ke-k <span class="math inline">\(g_k\)</span> untuk setiap gerombol <span class="math inline">\(g=1,2,3,…,G\)</span>
</li>
<li>Ulangi langkah hingga konvergen</li>
</ul>
</li>
</ul>
</li>
<li><p>Menentukan model terbaik dari masing-masing pembobot spasial sekaligus mendapatkan <span class="math inline">\(G\)</span> gerombol optimum menggunakan <em>information criterion</em>.</p></li>
<li><p>Melakukan uji kebaikan model menggunakan mean absolute error (MAE), mean absolute percentage error (MAPE) dan root mean square error (RMSE) untuk model terbaik berdasarkan masing-masing fungsi pembobot pada Langkah 10.</p></li>
<li><p>Melakukan analisis sidik ragam atau ANOVA pada model terbaik hasil uji kebaikan model untuk mengetahui perbedaan gerombol pada tingkat kemiskinan. Kemudian, dilanjutkan melakukan uji lanjut Tukey model.</p></li>
<li><p>Uji peubah berpengaruh tiap gerombol spasial menggunakan uji parsial atau uji t.</p></li>
<li><p>Penarikan interpretasi dan kesimpulan.</p></li>
</ol></section><section id="tahapan-analisis-dengan-r" class="level2"><h2 class="anchored" data-anchor-id="tahapan-analisis-dengan-r">Tahapan Analisis dengan R</h2>
<section id="package" class="level3"><h3 class="anchored" data-anchor-id="package">Package</h3>
<p>Pertama-tama perlu memanggil fungsi untuk memodelkan Regresi Gerombol Spasial menggunanakan fungsi <code>SCR()</code> dan fungsi untuk mendapatkan gerombol optimum menggunakan fungsi <code>SCR.select()</code>. Metode Regresi Gerombol Spasial dapat diimplementasikan ke dalam beragam jenis data, yaitu <em>family gaussian</em>, <em>family poisson</em>, dan <em>family binomial negative</em>. Selanjutnya, metode Regresi Gerombol Spasial memiliki dua opsi jenis penggerombolan, yaitu opsi <em>K-means</em> dan opsi <em>Fuzzy</em>, tetapi secara umum opsi <em>K-means</em> sudah cukup memberikan gerombol dengan pola yang cukup baik. Di mana langkah-langkah singkat penggunaan metode ini ialah sebagai berikut:</p>
<ol type="1">
<li>Eksplorasi data</li>
<li>uji asumsi galat</li>
<li>deteksi multikolinearitas</li>
<li>deteksi efek spasial</li>
<li>membentuk matriks pembobot spasial</li>
<li>membentuk inisiasi gerombol awal menggunakan k-means</li>
<li>Memodelkan Regresi Gerombol Spasial dengan fungsi objektif <em>penalty likelihood</em> untuk mengoptimumkan jumlah amatan di tiap gerombol dan nilai parameter beta duga. Model dengan gerombol optimum untuk masing-masing pembobot spasial dilihat melalui nilai <em>information criterion</em> pada fungsi <code>SCR.select()</code>
</li>
<li>Membandingkan model terbaik pada pembobot yang berbeda menggunakan dua kriteria, yaitu:
<ul>
<li>Uji kebaikan model (MAE, MAPE, dan RMSE) serta,</li>
<li>Pola gerombol pada peta yang berpola atau tidak acak (subjektif)</li>
</ul>
</li>
<li>Melakukan analisis sidik ragam mengetahui perbedaan peubah <span class="math inline">\(Y\)</span> di tiap gerombol yang terbentuk dari model terbaik</li>
<li>Uji peubah berpengaruh di setiap gerombol</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.econ.uiuc.edu/~roger/research/sparse/sparse.html">SparseM</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">###  Spatially clustered regression (with LASSO)   ###</span></span>
<span><span class="co">## Input</span></span>
<span><span class="co"># Y: n-dimensional response vector </span></span>
<span><span class="co"># X: (n,p)-matrix of covariates (p: number of covariates)</span></span>
<span><span class="co"># W: (n,n)-matrix of spatial weight</span></span>
<span><span class="co"># Sp: (n,2)-matrix of location information </span></span>
<span><span class="co"># G: number of groups </span></span>
<span><span class="co"># Phi: tuning parameter for spatial similarity </span></span>
<span><span class="co"># offset: n-dimensional vector of offset term (applicable only to "poisson" and "NB")</span></span>
<span><span class="co"># fuzzy: if True, SFCR is applied</span></span>
<span><span class="co"># maxitr: maximum number of iterations</span></span>
<span><span class="co"># family: distribution family ("gaussian", "poisson" or "NB)</span></span>
<span></span>
<span><span class="co">## Output</span></span>
<span><span class="co"># Beta: (G,p)-matrix of group-wise regression coefficients</span></span>
<span><span class="co"># Sig: G-dimensional vector of group-wise standard deviations (only for "gaussian" and "NB")</span></span>
<span><span class="co"># group: n-dimensional vector of group assignment </span></span>
<span><span class="co"># sBeta: (n,p)-matrix of location-wise regression coefficients</span></span>
<span><span class="co"># sSig: n-dimensional vector of location-wise standard deviations (only for "gaussian")</span></span>
<span><span class="co"># s: n-dimensional vector of location-wise standard deviations (only for "gaussian")</span></span>
<span><span class="co"># ML: maximum log-likelihood</span></span>
<span><span class="co"># itr: number of iterations </span></span>
<span></span>
<span><span class="co">## Remark</span></span>
<span><span class="co"># matrix X should not include an intercept term</span></span>
<span><span class="co"># initial grouping is determined by K-means of spatial locations</span></span>
<span></span>
<span></span>
<span><span class="co">## Main function </span></span>
<span><span class="va">SCR</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W</span>, <span class="va">Sp</span>, <span class="va">G</span><span class="op">=</span><span class="fl">5</span>, <span class="va">Phi</span><span class="op">=</span><span class="fl">1</span>, <span class="va">offset</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">fuzzy</span><span class="op">=</span><span class="cn">F</span>, <span class="va">maxitr</span><span class="op">=</span><span class="fl">100</span>, <span class="va">delta</span><span class="op">=</span><span class="fl">1</span>, <span class="va">family</span><span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co">## Preparations</span></span>
<span>  <span class="va">ep</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span>      <span class="co"># convergence criterion </span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SparseM/man/SparseM.ontology.html">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>     <span class="co"># number of samples</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span>   <span class="co"># number of regression coefficients</span></span>
<span>  <span class="va">XX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SparseM/man/SparseM.ontology.html">as.matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">X</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">W</span>, <span class="st">"sparseMatrix"</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">offset</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="va">offset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span> <span class="op">}</span></span>
<span>  <span class="va">nmax</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span>   <span class="co"># new max function </span></span>
<span>  </span>
<span>  <span class="co">## Initial values</span></span>
<span>  <span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">20</span>  <span class="co"># the number of initial values of k-means</span></span>
<span>  <span class="va">WSS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">CL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span>    <span class="va">CL</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="va">G</span><span class="op">)</span></span>
<span>    <span class="va">WSS</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">CL</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">tot.withinss</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">Ind</span> <span class="op">&lt;-</span> <span class="va">CL</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">WSS</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cluster</span></span>
<span>  <span class="va">Pen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">G</span><span class="op">)</span></span>
<span>  <span class="va">Beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">G</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">Beta</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"G="</span>,<span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span></span>
<span>  <span class="va">Sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">G</span><span class="op">)</span>    <span class="co"># not needed under non-Gaussian case</span></span>
<span>  <span class="va">Nu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">G</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="co">## iterative algorithm </span></span>
<span>  <span class="va">val</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">mval</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">maxitr</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">cval</span> <span class="op">&lt;-</span> <span class="va">val</span></span>
<span>    <span class="co">#print(paste("Sekarang adalah k ke-", k))</span></span>
<span>    <span class="co">## penalty term</span></span>
<span>    <span class="va">Ind.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="va">G</span><span class="op">)</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">Ind.mat</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span>, <span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">Ind.mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">Ind.mat</span>, <span class="st">"sparseMatrix"</span><span class="op">)</span></span>
<span>    <span class="va">Pen</span> <span class="op">&lt;-</span> <span class="va">W</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Ind.mat</span>     <span class="co"># penalty term</span></span>
<span>    </span>
<span>    <span class="co">## model parameters (clustered case)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">fuzzy</span><span class="op">==</span><span class="cn">F</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co">#print(paste("length sepanjang", length(Ind[Ind==g]), "dan p + 1 sebesar", p+1))</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Ind</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span><span class="op">]</span><span class="op">)</span><span class="op">&gt;</span><span class="va">p</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="co"># gaussian</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"gaussian"</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span><span class="op">]</span><span class="op">~</span><span class="va">X</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span>,<span class="op">]</span><span class="op">)</span></span>
<span>            <span class="co">#print(paste("Sekarang adalah gerombol ke-", g))</span></span>
<span>            <span class="co">#print(summary(fit)) #Jika ingin melihat peubah berpengaruh maka hilangkan tanda pagar</span></span>
<span>            <span class="va">Beta</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">)</span></span>
<span>            <span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="va">Sig</span><span class="op">[</span><span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">resid</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="va">Sig</span><span class="op">[</span><span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Sig</span><span class="op">[</span><span class="va">g</span><span class="op">]</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>          <span class="co"># poisson</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"poisson"</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span>,<span class="op">]</span></span>
<span>            <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span><span class="op">]</span></span>
<span>            <span class="va">off</span> <span class="op">&lt;-</span> <span class="va">offset</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span><span class="op">]</span></span>
<span>            <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, offset<span class="op">=</span><span class="va">off</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span>
<span>            <span class="va">Beta</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>          <span class="co"># NB</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"NB"</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span>,<span class="op">]</span></span>
<span>            <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span><span class="op">]</span></span>
<span>            <span class="va">off</span> <span class="op">&lt;-</span> <span class="va">offset</span><span class="op">[</span><span class="va">Ind</span><span class="op">==</span><span class="va">g</span><span class="op">]</span></span>
<span>            <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/offset.html">offset</a></span><span class="op">(</span><span class="va">off</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="va">Beta</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span> <span class="va">fit</span> <span class="op">)</span> <span class="op">)</span></span>
<span>            <span class="va">Nu</span><span class="op">[</span><span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">theta</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co">## model parameters (fuzzy case)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">fuzzy</span><span class="op">==</span><span class="cn">T</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="co"># Gaussian</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"gaussian"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span>      <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">ESig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">Sig</span>,<span class="va">n</span><span class="op">)</span>, <span class="va">G</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>    <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">log.dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">Mu</span>,<span class="va">ESig</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span></span>
<span>        <span class="va">mval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">log.dens</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>        <span class="va">log.denom</span> <span class="op">&lt;-</span> <span class="va">mval</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">log.dens</span><span class="op">-</span><span class="va">mval</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">log.dens</span><span class="op">-</span><span class="va">log.denom</span><span class="op">)</span>     <span class="co"># weight</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span><span class="op">{</span> </span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PP</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0.1</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X</span>, weights<span class="op">=</span><span class="va">PP</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">)</span></span>
<span>            </span>
<span>            <span class="va">Beta</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">)</span></span>
<span>            <span class="va">resid</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="va">Sig</span><span class="op">[</span><span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PP</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">*</span><span class="va">resid</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PP</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span></span>
<span>            <span class="va">Sig</span><span class="op">[</span><span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Sig</span><span class="op">[</span><span class="va">g</span><span class="op">]</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      </span>
<span>      <span class="co"># Poisson</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"poisson"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span><span class="op">)</span>    <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">log.dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">Mu</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span> </span>
<span>        <span class="va">mval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">log.dens</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>        <span class="va">log.denom</span> <span class="op">&lt;-</span> <span class="va">mval</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">log.dens</span><span class="op">-</span><span class="va">mval</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">log.dens</span><span class="op">-</span><span class="va">log.denom</span><span class="op">)</span>     <span class="co"># weight</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PP</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0.1</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X</span>, offset<span class="op">=</span><span class="va">offset</span>, weights<span class="op">=</span><span class="va">PP</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span></span>
<span>            <span class="va">Beta</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="co"># NB</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"NB"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span><span class="op">)</span>    <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">log.dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="va">Y</span>, size<span class="op">=</span><span class="va">Nu</span>, prob<span class="op">=</span><span class="va">Nu</span><span class="op">/</span><span class="op">(</span><span class="va">Nu</span><span class="op">+</span><span class="va">Mu</span><span class="op">)</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span> </span>
<span>        <span class="va">mval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">log.dens</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>        <span class="va">log.denom</span> <span class="op">&lt;-</span> <span class="va">mval</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">log.dens</span><span class="op">-</span><span class="va">mval</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">log.dens</span><span class="op">-</span><span class="va">log.denom</span><span class="op">)</span>     <span class="co"># weight</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">g</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">G</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">PP</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">0.1</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/offset.html">offset</a></span><span class="op">(</span><span class="va">offset</span><span class="op">)</span>, weights<span class="op">=</span><span class="va">PP</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="va">Beta</span><span class="op">[</span>,<span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">)</span></span>
<span>            <span class="va">Nu</span><span class="op">[</span><span class="va">g</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">theta</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co">## Grouping (clustered case)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">fuzzy</span><span class="op">==</span><span class="cn">F</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"gaussian"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span>      <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">ESig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">Sig</span>,<span class="va">n</span><span class="op">)</span>, <span class="va">G</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>    <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">Mu</span>, <span class="va">ESig</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span>     <span class="co"># penalized likelihood</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"poisson"</span><span class="op">)</span><span class="op">{</span> </span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span><span class="op">)</span> </span>
<span>        <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">Mu</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span>  <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span>    <span class="co"># penalized likelihood</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"NB"</span><span class="op">)</span><span class="op">{</span> </span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span><span class="op">)</span> </span>
<span>        <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="va">Y</span>, size<span class="op">=</span><span class="va">Nu</span>, prob<span class="op">=</span><span class="va">Nu</span><span class="op">/</span><span class="op">(</span><span class="va">Nu</span><span class="op">+</span><span class="va">Mu</span><span class="op">)</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span>  <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span>    <span class="co"># penalized likelihood</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="va">Ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Q</span>, <span class="fl">1</span>, <span class="va">which.max</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co">## Grouping (fuzzy case)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">fuzzy</span><span class="op">==</span><span class="cn">T</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"gaussian"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span>      <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">ESig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">Sig</span>,<span class="va">n</span><span class="op">)</span>, <span class="va">G</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>    <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">delta</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">Mu</span>, <span class="va">ESig</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span><span class="op">)</span>   <span class="co"># penalized likelihood</span></span>
<span>        <span class="va">mval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Q</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>        <span class="va">log.denom</span> <span class="op">&lt;-</span> <span class="va">mval</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Q</span><span class="op">-</span><span class="va">mval</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Q</span><span class="op">-</span><span class="va">log.denom</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"poisson"</span><span class="op">)</span><span class="op">{</span> </span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span><span class="op">)</span>    <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">delta</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">Mu</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span>  <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span><span class="op">)</span>   <span class="co"># penalized likelihood</span></span>
<span>        <span class="va">mval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Q</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>        <span class="va">log.denom</span> <span class="op">&lt;-</span> <span class="va">mval</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Q</span><span class="op">-</span><span class="va">mval</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Q</span><span class="op">-</span><span class="va">log.denom</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"NB"</span><span class="op">)</span><span class="op">{</span> </span>
<span>        <span class="va">Mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="va">XX</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">Beta</span><span class="op">)</span>    <span class="co"># (n,G)-matrix</span></span>
<span>        <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">delta</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="va">Y</span>, size<span class="op">=</span><span class="va">Nu</span>, prob<span class="op">=</span><span class="va">Nu</span><span class="op">/</span><span class="op">(</span><span class="va">Nu</span><span class="op">+</span><span class="va">Mu</span><span class="op">)</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">+</span> <span class="va">Phi</span><span class="op">*</span><span class="va">Pen</span><span class="op">)</span>   <span class="co"># penalized likelihood</span></span>
<span>        <span class="va">mval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Q</span>, <span class="fl">1</span>, <span class="va">max</span><span class="op">)</span></span>
<span>        <span class="va">log.denom</span> <span class="op">&lt;-</span> <span class="va">mval</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Q</span><span class="op">-</span><span class="va">mval</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">PP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">Q</span><span class="op">-</span><span class="va">log.denom</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="va">Ind</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">PP</span>, <span class="fl">1</span>, <span class="va">which.max</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co">## Value of objective function</span></span>
<span>    <span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Q</span>, <span class="fl">1</span>, <span class="va">nmax</span><span class="op">)</span> <span class="op">)</span> </span>
<span>    <span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">cval</span><span class="op">-</span><span class="va">val</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span>    <span class="va">mval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mval</span>, <span class="va">cval</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span> <span class="va">dd</span><span class="op">&lt;</span><span class="va">ep</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mval</span><span class="op">-</span><span class="va">val</span><span class="op">)</span><span class="op">&lt;</span><span class="va">ep</span> <span class="op">)</span><span class="op">{</span> <span class="kw">break</span> <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co">## varying parameters</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">fuzzy</span><span class="op">==</span><span class="cn">F</span><span class="op">)</span><span class="op">{</span>  <span class="va">sBeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Beta</span><span class="op">[</span>,<span class="va">Ind</span><span class="op">]</span><span class="op">)</span> <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">fuzzy</span><span class="op">==</span><span class="cn">T</span><span class="op">)</span><span class="op">{</span>  <span class="va">sBeta</span> <span class="op">&lt;-</span> <span class="va">PP</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Beta</span><span class="op">)</span> <span class="op">}</span></span>
<span>  <span class="va">sSig</span> <span class="op">&lt;-</span> <span class="va">Sig</span><span class="op">[</span><span class="va">Ind</span><span class="op">]</span>     <span class="co"># location-wise error variance</span></span>
<span>  </span>
<span></span>
<span>  <span class="co">## maximum likelihood </span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"gaussian"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">hmu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">XX</span><span class="op">*</span><span class="va">sBeta</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span></span>
<span>    <span class="va">ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">hmu</span>, <span class="va">sSig</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">)</span> </span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"poisson"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">hmu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">XX</span><span class="op">*</span><span class="va">sBeta</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">hmu</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">)</span> </span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"NB"</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">sNu</span> <span class="op">&lt;-</span> <span class="va">Nu</span><span class="op">[</span><span class="va">Ind</span><span class="op">]</span></span>
<span>    <span class="va">hmu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">offset</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">XX</span><span class="op">*</span><span class="va">sBeta</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html">dnbinom</a></span><span class="op">(</span><span class="va">Y</span>, size<span class="op">=</span><span class="va">sNu</span>, prob<span class="op">=</span><span class="va">sNu</span><span class="op">/</span><span class="op">(</span><span class="va">sNu</span><span class="op">+</span><span class="va">hmu</span><span class="op">)</span>, log<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">)</span> </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co">## Results</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Beta<span class="op">=</span><span class="va">Beta</span>, Sig<span class="op">=</span><span class="va">Sig</span>, Nu<span class="op">=</span><span class="va">Nu</span>, group<span class="op">=</span><span class="va">Ind</span>, sBeta<span class="op">=</span><span class="va">sBeta</span>, sSig<span class="op">=</span><span class="va">sSig</span>, ML<span class="op">=</span><span class="va">ML</span>, itr<span class="op">=</span><span class="va">k</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">###  Selection of tuning parameters  ###</span></span>
<span><span class="co">## Imput</span></span>
<span><span class="co"># most of inputs are the same as 'SCR' </span></span>
<span><span class="co"># G.set: vector of candidates for G</span></span>
<span><span class="co"># print: if True, interim progress is reported </span></span>
<span></span>
<span><span class="co">## Output</span></span>
<span><span class="co"># BIC: BIC-type criteria</span></span>
<span><span class="co"># select: selection results </span></span>
<span></span>
<span><span class="co">## Main function </span></span>
<span><span class="va">SCR.select</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W</span>, <span class="va">Sp</span>, <span class="va">G.set</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">Phi</span><span class="op">=</span><span class="fl">1</span>, <span class="va">offset</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">maxitr</span><span class="op">=</span><span class="fl">50</span>, <span class="va">print</span><span class="op">=</span><span class="cn">T</span>, <span class="va">family</span><span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co">## Preparations</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">G.set</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">40</span>, by<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">}</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SparseM/man/SparseM.ontology.html">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span></span>
<span>  <span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">G.set</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## computing information criteria</span></span>
<span>  <span class="va">BIC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">l</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">L</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W</span>, <span class="va">Sp</span>, offset<span class="op">=</span><span class="va">offset</span>, G<span class="op">=</span><span class="va">G.set</span><span class="op">[</span><span class="va">l</span><span class="op">]</span>, Phi<span class="op">=</span><span class="va">Phi</span>, maxitr<span class="op">=</span><span class="va">maxitr</span>, family<span class="op">=</span><span class="va">family</span><span class="op">)</span></span>
<span>    <span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">Beta</span><span class="op">)</span> </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"gaussian"</span><span class="op">|</span> <span class="va">family</span><span class="op">==</span><span class="st">"NB"</span><span class="op">)</span><span class="op">{</span> <span class="va">pp</span> <span class="op">&lt;-</span> <span class="va">pp</span> <span class="op">+</span> <span class="va">G.set</span><span class="op">[</span><span class="va">l</span><span class="op">]</span> <span class="op">}</span></span>
<span>    <span class="va">BIC</span><span class="op">[</span><span class="va">l</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">fit</span><span class="op">$</span><span class="va">ML</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="va">pp</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">print</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"G="</span>,<span class="va">G.set</span><span class="op">[</span><span class="va">l</span><span class="op">]</span>, <span class="st">", iteration="</span>, <span class="va">fit</span><span class="op">$</span><span class="va">itr</span><span class="op">)</span> <span class="op">)</span> <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">BIC</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"G="</span>, <span class="va">G.set</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## selection</span></span>
<span>  <span class="va">hG</span> <span class="op">&lt;-</span> <span class="va">G.set</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co">## result</span></span>
<span>  <span class="va">Result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>BIC<span class="op">=</span><span class="va">BIC</span>, G<span class="op">=</span><span class="va">hG</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/taiyun/corrplot">corrplot</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=rcompanion">rcompanion</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FastKNN</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/">devtools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://people.eng.unimelb.edu.au/aturpin/opi/index.html">binovisualfields</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="persiapan-data" class="level3"><h3 class="anchored" data-anchor-id="persiapan-data">Persiapan Data</h3>
<p>Data excel kemiskinan dipanggil dengan mendefinisikan <em>dataframe</em> “kemiskinan”</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kemiskinan</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="st">"data/kemiskinan_2022.xlsx"</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Melihat <em>summary</em> dari data kemiskinan sebagai berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">kemiskinan</span><span class="op">)</span></span>
<span><span class="co">#&gt;        No        Provinsi         Kabupaten/kota           Y       </span></span>
<span><span class="co">#&gt;  Min.   :  1   Length:514         Length:514         Min.   : 2.3  </span></span>
<span><span class="co">#&gt;  1st Qu.:129   Class :character   Class :character   1st Qu.: 6.6  </span></span>
<span><span class="co">#&gt;  Median :258   Mode  :character   Mode  :character   Median : 9.8  </span></span>
<span><span class="co">#&gt;  Mean   :258                                         Mean   :11.7  </span></span>
<span><span class="co">#&gt;  3rd Qu.:386                                         3rd Qu.:14.1  </span></span>
<span><span class="co">#&gt;  Max.   :514                                         Max.   :42.0  </span></span>
<span><span class="co">#&gt;                                                                    </span></span>
<span><span class="co">#&gt;        X1             &lt; SD        Ijazah SD      Ijazah SMP  </span></span>
<span><span class="co">#&gt;  Min.   :0.001   Min.   : 1.3   Min.   : 3.6   Min.   : 5.6  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.038   1st Qu.: 7.9   1st Qu.:19.3   1st Qu.:19.9  </span></span>
<span><span class="co">#&gt;  Median :0.106   Median :12.2   Median :24.7   Median :22.5  </span></span>
<span><span class="co">#&gt;  Mean   :0.103   Mean   :14.0   Mean   :24.3   Mean   :22.3  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.144   3rd Qu.:17.2   3rd Qu.:29.1   3rd Qu.:24.6  </span></span>
<span><span class="co">#&gt;  Max.   :0.440   Max.   :80.8   Max.   :53.5   Max.   :37.0  </span></span>
<span><span class="co">#&gt;                                                              </span></span>
<span><span class="co">#&gt;        X3              X4             X5             X6       </span></span>
<span><span class="co">#&gt;  Min.   :  0.0   Min.   :32.1   Min.   :34.1   Min.   : 0.12  </span></span>
<span><span class="co">#&gt;  1st Qu.: 60.0   1st Qu.:50.2   1st Qu.:67.4   1st Qu.: 2.92  </span></span>
<span><span class="co">#&gt;  Median : 79.1   Median :54.0   Median :70.3   Median : 4.34  </span></span>
<span><span class="co">#&gt;  Mean   : 73.1   Mean   :53.5   Mean   :70.6   Mean   : 4.66  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 92.5   3rd Qu.:57.1   3rd Qu.:73.8   3rd Qu.: 6.11  </span></span>
<span><span class="co">#&gt;  Max.   :104.3   Max.   :74.8   Max.   :87.7   Max.   :11.82  </span></span>
<span><span class="co">#&gt;                                                NA's   :9      </span></span>
<span><span class="co">#&gt;        X7                X8             x               y         </span></span>
<span><span class="co">#&gt;  Min.   :1819835   Min.   : 6.7   Min.   : 95.3   Min.   :-10.72  </span></span>
<span><span class="co">#&gt;  1st Qu.:2490592   1st Qu.:77.8   1st Qu.:104.6   1st Qu.: -6.90  </span></span>
<span><span class="co">#&gt;  Median :2801753   Median :86.3   Median :111.8   Median : -3.36  </span></span>
<span><span class="co">#&gt;  Mean   :2834567   Mean   :82.6   Mean   :113.3   Mean   : -3.20  </span></span>
<span><span class="co">#&gt;  3rd Qu.:3200000   3rd Qu.:91.2   3rd Qu.:120.4   3rd Qu.: -0.21  </span></span>
<span><span class="co">#&gt;  Max.   :4816921   Max.   :99.9   Max.   :140.8   Max.   :  5.84  </span></span>
<span><span class="co">#&gt; </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Melihat missing value pada <em>dataframe</em></p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">kemiskinan</span><span class="op">$</span><span class="va">X6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  38  39  48 493 497 507 509 510 512</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Diketahui terdapat <em>missing value</em> di peubah Tingkat Pengangguran Terbuka (TPT) dengan rincian: 1. Sumatera Utara: 3 2. Papua: 6</p>
<section id="data-hasil-imputasi" class="level4"><h4 class="anchored" data-anchor-id="data-hasil-imputasi">Data hasil imputasi</h4>
<p><em>Missing value</em> tersebut diatasi menggunakan <em>Group Mean Imputation</em> di mana provinsi dianggap sebagai grup (imputasi dilakukan menggunakan ms excel dan hasilnya langsung dipanggil sebagai <em>dataframe</em> “imputasi”)</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">imputasi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="st">"data/kemiskinan_2022.xlsx"</span>, sheet <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Melihat <em>summary</em> dari data hasil imputasi</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">)</span></span>
<span><span class="co">#&gt;        No        Provinsi           ADM2_EN                Y       </span></span>
<span><span class="co">#&gt;  Min.   :  1   Length:514         Length:514         Min.   : 2.3  </span></span>
<span><span class="co">#&gt;  1st Qu.:129   Class :character   Class :character   1st Qu.: 6.6  </span></span>
<span><span class="co">#&gt;  Median :258   Mode  :character   Mode  :character   Median : 9.8  </span></span>
<span><span class="co">#&gt;  Mean   :258                                         Mean   :11.7  </span></span>
<span><span class="co">#&gt;  3rd Qu.:386                                         3rd Qu.:14.1  </span></span>
<span><span class="co">#&gt;  Max.   :514                                         Max.   :42.0  </span></span>
<span><span class="co">#&gt;        X1             &lt; SD        Ijazah SD      Ijazah SMP  </span></span>
<span><span class="co">#&gt;  Min.   :0.001   Min.   : 1.3   Min.   : 3.6   Min.   : 5.6  </span></span>
<span><span class="co">#&gt;  1st Qu.:0.038   1st Qu.: 7.9   1st Qu.:19.3   1st Qu.:19.9  </span></span>
<span><span class="co">#&gt;  Median :0.106   Median :12.2   Median :24.7   Median :22.5  </span></span>
<span><span class="co">#&gt;  Mean   :0.103   Mean   :14.0   Mean   :24.3   Mean   :22.3  </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.144   3rd Qu.:17.2   3rd Qu.:29.1   3rd Qu.:24.6  </span></span>
<span><span class="co">#&gt;  Max.   :0.440   Max.   :80.8   Max.   :53.5   Max.   :37.0  </span></span>
<span><span class="co">#&gt;        X2             X3              X4             X5      </span></span>
<span><span class="co">#&gt;  Min.   :24.2   Min.   :  0.0   Min.   :32.1   Min.   :34.1  </span></span>
<span><span class="co">#&gt;  1st Qu.:53.8   1st Qu.: 60.0   1st Qu.:50.2   1st Qu.:67.4  </span></span>
<span><span class="co">#&gt;  Median :63.3   Median : 79.1   Median :54.0   Median :70.3  </span></span>
<span><span class="co">#&gt;  Mean   :60.6   Mean   : 73.1   Mean   :53.5   Mean   :70.6  </span></span>
<span><span class="co">#&gt;  3rd Qu.:69.5   3rd Qu.: 92.5   3rd Qu.:57.1   3rd Qu.:73.8  </span></span>
<span><span class="co">#&gt;  Max.   :93.8   Max.   :104.3   Max.   :74.8   Max.   :87.7  </span></span>
<span><span class="co">#&gt;        X6              X7                X8             x        </span></span>
<span><span class="co">#&gt;  Min.   : 0.12   Min.   :1819835   Min.   : 6.7   Min.   : 95.3  </span></span>
<span><span class="co">#&gt;  1st Qu.: 2.95   1st Qu.:2490592   1st Qu.:77.8   1st Qu.:104.6  </span></span>
<span><span class="co">#&gt;  Median : 4.33   Median :2801753   Median :86.3   Median :111.8  </span></span>
<span><span class="co">#&gt;  Mean   : 4.65   Mean   :2834567   Mean   :82.6   Mean   :113.3  </span></span>
<span><span class="co">#&gt;  3rd Qu.: 6.08   3rd Qu.:3200000   3rd Qu.:91.2   3rd Qu.:120.4  </span></span>
<span><span class="co">#&gt;  Max.   :11.82   Max.   :4816921   Max.   :99.9   Max.   :140.8  </span></span>
<span><span class="co">#&gt;        y         </span></span>
<span><span class="co">#&gt;  Min.   :-10.72  </span></span>
<span><span class="co">#&gt;  1st Qu.: -6.90  </span></span>
<span><span class="co">#&gt;  Median : -3.36  </span></span>
<span><span class="co">#&gt;  Mean   : -3.20  </span></span>
<span><span class="co">#&gt;  3rd Qu.: -0.21  </span></span>
<span><span class="co">#&gt;  Max.   :  5.84</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="eksplorasi-data" class="level3"><h3 class="anchored" data-anchor-id="eksplorasi-data">Eksplorasi Data</h3>
<section id="boxplot-sebaran" class="level4"><h4 class="anchored" data-anchor-id="boxplot-sebaran">Boxplot sebaran</h4>
<p>fungsi untuk melihat amatan yang termasuk ke dalam pencilan</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">findoutlier</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">.25</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">|</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">.75</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Y = Tingkat Kemiskinan</span></span>
<span><span class="va">imputasi</span> <span class="op">&lt;-</span> <span class="va">imputasi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>outlier.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu">findoutlier</span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, <span class="va">`ADM2_EN`</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nama-Nama Daerah pencilan tingkat kemiskinan (35 Kabupaten)</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">imputasi</span><span class="op">$</span><span class="va">outlier.y</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">outlier.y</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "Lombok Utara"         "Sumba Barat"         </span></span>
<span><span class="co">#&gt;  [3] "Sumba Timur"          "Timor Tengah Selatan"</span></span>
<span><span class="co">#&gt;  [5] "Rote Ndao"            "Sumba Tengah"        </span></span>
<span><span class="co">#&gt;  [7] "Sumba Barat Daya"     "Sabu Raijua"         </span></span>
<span><span class="co">#&gt;  [9] "Maluku Barat Daya"    "Teluk Wondama"       </span></span>
<span><span class="co">#&gt; [11] "Teluk Bintuni"        "Sorong"              </span></span>
<span><span class="co">#&gt; [13] "Tambrauw"             "Maybrat"             </span></span>
<span><span class="co">#&gt; [15] "Manokwari Selatan"    "Pegunungan Arfak"    </span></span>
<span><span class="co">#&gt; [17] "Jayawijaya"           "Kepulauan Yapen"     </span></span>
<span><span class="co">#&gt; [19] "Paniai"               "Puncak Jaya"         </span></span>
<span><span class="co">#&gt; [21] "Mappi"                "Yahukimo"            </span></span>
<span><span class="co">#&gt; [23] "Pegunungan Bintang"   "Tolikara"            </span></span>
<span><span class="co">#&gt; [25] "Waropen"              "Supiori"             </span></span>
<span><span class="co">#&gt; [27] "Mamberamo Raya"       "Nduga"               </span></span>
<span><span class="co">#&gt; [29] "Lanny Jaya"           "Mamberamo Tengah"    </span></span>
<span><span class="co">#&gt; [31] "Yalimo"               "Puncak"              </span></span>
<span><span class="co">#&gt; [33] "Dogiyai"              "Intan Jaya"          </span></span>
<span><span class="co">#&gt; [35] "Deiyai"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Grafik boxplot tingkat kemiskinan kabupaten/kota di Indonesia (%)</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">imputasi</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="st">""</span>,y <span class="op">=</span> <span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/boxplot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="eksplorasi-spasial" class="level4"><h4 class="anchored" data-anchor-id="eksplorasi-spasial">Eksplorasi Spasial</h4>
<p>Membaca peta Indonesia</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">id.map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">st_read</a></span><span class="op">(</span><span class="st">"data/shp/idn_admbnda_adm2_bps_20200401.shp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Reading layer `idn_admbnda_adm2_bps_20200401' from data source </span></span>
<span><span class="co">#&gt;   `C:\Users\anugraha\Documents\Materi_Orasi\book\data\shp\idn_admbnda_adm2_bps_20200401.shp' </span></span>
<span><span class="co">#&gt;   using driver `ESRI Shapefile'</span></span>
<span><span class="co">#&gt; Simple feature collection with 522 features and 14 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 95 ymin: -11 xmax: 141 ymax: 6.08</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">indonesia.map</span> <span class="op">&lt;-</span> <span class="va">id.map</span></span>
<span><span class="va">indonesia.map</span> <span class="op">&lt;-</span> <span class="va">indonesia.map</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">91</span>,<span class="op">-</span><span class="fl">92</span>,<span class="op">-</span><span class="fl">93</span>,<span class="op">-</span><span class="fl">94</span>,<span class="op">-</span><span class="fl">95</span>,<span class="op">-</span><span class="fl">127</span>,<span class="op">-</span><span class="fl">513</span>,<span class="op">-</span><span class="fl">514</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">indonesia.2</span> <span class="op">&lt;-</span> <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/geo_join.html">geo_join</a></span><span class="op">(</span>spatial_data<span class="op">=</span><span class="va">indonesia.map</span>, data_frame <span class="op">=</span> <span class="va">imputasi</span>, by_df <span class="op">=</span> <span class="st">"ADM2_EN"</span>,by_sp <span class="op">=</span><span class="st">"ADM2_EN"</span>, how <span class="op">=</span> <span class="st">"inner"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in tigris::geo_join(spatial_data = indonesia.map,</span></span>
<span><span class="co">#&gt; data_frame = imputasi, : We recommend using the dplyr::*_join()</span></span>
<span><span class="co">#&gt; family of functions instead.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Peta tematik tingkat kemiskinan di Indonesia</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Y = Tingkat kemiskinan (persen)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">indonesia.2</span><span class="op">[</span><span class="st">"Y"</span><span class="op">]</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Tingkat Kemiskinan"</span>,</span>
<span>     breaks <span class="op">=</span> <span class="st">"quantile"</span>, nbreaks <span class="op">=</span> <span class="fl">7</span>,</span>
<span>     pal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">7</span>, <span class="st">"Blues"</span><span class="op">)</span>,</span>
<span>     graticule <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html">st_crs</a></span><span class="op">(</span><span class="fl">4326</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/plot map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="korelasi" class="level4"><h4 class="anchored" data-anchor-id="korelasi">Korelasi</h4>
<p>Melihat korelasi antar peubah</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">korelasi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span><span class="op">(</span><span class="va">korelasi</span>, method <span class="op">=</span> <span class="st">"number"</span>, type <span class="op">=</span> <span class="st">"upper"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/corr-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="scatter-plot" class="level4"><h4 class="anchored" data-anchor-id="scatter-plot">Scatter plot</h4>
<p>Membuat plot tebaran antara peubah respons dan peubah penjelas</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">X1</span> , <span class="va">data</span><span class="op">$</span><span class="va">Y</span>, ylab <span class="op">=</span> <span class="st">"penduduk miskin (%)"</span>, xlab <span class="op">=</span> <span class="st">"X1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">X2</span> , <span class="va">data</span><span class="op">$</span><span class="va">Y</span>, ylab <span class="op">=</span> <span class="st">"penduduk miskin (%)"</span>, xlab <span class="op">=</span> <span class="st">"X2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">X3</span> , <span class="va">data</span><span class="op">$</span><span class="va">Y</span>, ylab <span class="op">=</span> <span class="st">"penduduk miskin (%)"</span>, xlab <span class="op">=</span> <span class="st">"X3"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">X4</span> , <span class="va">data</span><span class="op">$</span><span class="va">Y</span>, ylab <span class="op">=</span> <span class="st">"penduduk miskin (%)"</span>, xlab <span class="op">=</span> <span class="st">"X4"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">X5</span> , <span class="va">data</span><span class="op">$</span><span class="va">Y</span>, ylab <span class="op">=</span> <span class="st">"penduduk miskin (%)"</span>, xlab <span class="op">=</span> <span class="st">"X5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">X6</span> , <span class="va">data</span><span class="op">$</span><span class="va">Y</span>, ylab <span class="op">=</span> <span class="st">"penduduk miskin (%)"</span>, xlab <span class="op">=</span> <span class="st">"X6"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">X7</span> , <span class="va">data</span><span class="op">$</span><span class="va">Y</span>, ylab <span class="op">=</span> <span class="st">"penduduk miskin (%)"</span>, xlab <span class="op">=</span> <span class="st">"X7"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">X8</span> , <span class="va">data</span><span class="op">$</span><span class="va">Y</span>, ylab <span class="op">=</span> <span class="st">"penduduk miskin (%)"</span>, xlab <span class="op">=</span> <span class="st">"X8"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/scatter plot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="pengecekan-asumsi-galat" class="level3"><h3 class="anchored" data-anchor-id="pengecekan-asumsi-galat">Pengecekan asumsi galat</h3>
<p>Membentuk regresi linear berganda terlebih dahulu</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">regresi.klasik</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">X5</span> <span class="op">+</span> <span class="va">X6</span> <span class="op">+</span> <span class="va">X7</span> <span class="op">+</span> <span class="va">X8</span>, data <span class="op">=</span> <span class="va">imputasi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">regresi.klasik</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8, data = imputasi)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -12.721  -2.954  -0.218   2.671  16.658 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.18e+02   7.87e+00   15.01  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; X1           1.23e+01   3.01e+00    4.10  4.9e-05 ***</span></span>
<span><span class="co">#&gt; X2          -2.67e-01   2.98e-02   -8.95  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; X3          -3.20e-02   1.19e-02   -2.68   0.0077 ** </span></span>
<span><span class="co">#&gt; X4          -6.91e-02   5.10e-02   -1.36   0.1755    </span></span>
<span><span class="co">#&gt; X5          -1.16e+00   8.22e-02  -14.11  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; X6           8.42e-02   1.07e-01    0.79   0.4305    </span></span>
<span><span class="co">#&gt; X7          -9.91e-07   3.86e-07   -2.57   0.0105 *  </span></span>
<span><span class="co">#&gt; X8          -1.36e-02   2.03e-02   -0.67   0.5020    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.59 on 505 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.608,  Adjusted R-squared:  0.602 </span></span>
<span><span class="co">#&gt; F-statistic: 97.9 on 8 and 505 DF,  p-value: &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>terdapat lima peubah yang signifikan.</p>
<p>Dilanjutkan menguji asumsi galat/sisaan yang terdiri dari uji normalitas, homoskedastisitas, dan autokorelasi</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/dwtest.html">dwtest</a></span><span class="op">(</span><span class="va">regresi.klasik</span><span class="op">)</span> <span class="co">#autokorelasi</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Durbin-Watson test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  regresi.klasik</span></span>
<span><span class="co">#&gt; DW = 1, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: true autocorrelation is greater than 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">regresi.klasik</span><span class="op">)</span> <span class="co">#homoskedastisitas</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  regresi.klasik</span></span>
<span><span class="co">#&gt; BP = 99, df = 8, p-value &lt;2e-16</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">regresi.klasik</span><span class="op">$</span><span class="va">residuals</span><span class="op">)</span> <span class="co">#normalitas</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  regresi.klasik$residuals</span></span>
<span><span class="co">#&gt; W = 1, p-value = 0.01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Seluruh asumsi tidak terpenuhi karena <code>p-value &lt; 0.05</code></p>
</section><section id="deteksi-multikolinearitas" class="level3"><h3 class="anchored" data-anchor-id="deteksi-multikolinearitas">Deteksi multikolinearitas</h3>
<p>Sebuah peubah penjelas dikatakan mengandung multikolinearitas ketika memiliki VIF di atas 5 <span class="citation" data-cites="james2013">(<a href="references.html#ref-james2013" role="doc-biblioref">James et al., 2013</a>)</span></p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">regresi.klasik</span><span class="op">)</span> <span class="co">#Multikolinearitas</span></span>
<span><span class="co">#&gt;   X1   X2   X3   X4   X5   X6   X7   X8 </span></span>
<span><span class="co">#&gt; 1.13 3.32 2.11 2.49 6.80 1.46 1.31 1.84</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Terlihat peubah <span class="math inline">\(X_5\)</span> (IPM) memiliki VIF &gt; 5 sehingga dikeluarkan dari model</p>
<section id="deteksi-multikolinearitas-tanpa-peubah-x5" class="level4"><h4 class="anchored" data-anchor-id="deteksi-multikolinearitas-tanpa-peubah-x5">deteksi multikolinearitas tanpa peubah X5</h4>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">regresi.klasik.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">X6</span> <span class="op">+</span> <span class="va">X7</span> <span class="op">+</span> <span class="va">X8</span>, data <span class="op">=</span> <span class="va">imputasi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">regresi.klasik.2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y ~ X1 + X2 + X3 + X4 + X6 + X7 + X8, data = imputasi)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.359  -3.550  -0.329   2.955  20.174 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.82e+01   4.06e+00    4.50  8.5e-06 ***</span></span>
<span><span class="co">#&gt; X1           7.47e+00   3.53e+00    2.12    0.035 *  </span></span>
<span><span class="co">#&gt; X2          -1.55e-02   2.82e-02   -0.55    0.582    </span></span>
<span><span class="co">#&gt; X3          -1.02e-01   1.28e-02   -8.00  8.5e-15 ***</span></span>
<span><span class="co">#&gt; X4           2.26e-01   5.48e-02    4.12  4.5e-05 ***</span></span>
<span><span class="co">#&gt; X6          -2.12e-01   1.23e-01   -1.72    0.087 .  </span></span>
<span><span class="co">#&gt; X7           2.23e-07   4.44e-07    0.50    0.616    </span></span>
<span><span class="co">#&gt; X8          -1.29e-01   2.19e-02   -5.88  7.6e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.41 on 506 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.454,  Adjusted R-squared:  0.446 </span></span>
<span><span class="co">#&gt; F-statistic:   60 on 7 and 506 DF,  p-value: &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>terdapat empat peubah penjelas yang signifikan</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">regresi.klasik.2</span><span class="op">)</span></span>
<span><span class="co">#&gt;   X1   X2   X3   X4   X6   X7   X8 </span></span>
<span><span class="co">#&gt; 1.11 2.13 1.74 2.07 1.41 1.25 1.54</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>sudah tidak ada peubah dengan nilai <code>VIF &gt; 5</code> sehingga aman dari multikolinearitas</p>
</section></section><section id="asumsi-efek-spasial" class="level3"><h3 class="anchored" data-anchor-id="asumsi-efek-spasial">Asumsi efek spasial</h3>
<section id="heteroskedastisitas-spasial" class="level4"><h4 class="anchored" data-anchor-id="heteroskedastisitas-spasial">Heteroskedastisitas spasial</h4>
<p>Menggunakan uji Breusch-Pagan untuk mengecek heteroskedastisitas spasial dengan hipotesis</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_0\)</span>: Tidak terdapat heteroskedastisitas spasial <span class="math inline">\(H_1\)</span>: Terdapat heteroskedastisitas spasial</p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#heteroskedastisitas spasial</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">regresi.klasik.2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  regresi.klasik.2</span></span>
<span><span class="co">#&gt; BP = 118, df = 7, p-value &lt;2e-16</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tolak <span class="math inline">\(H_0\)</span> sehingga dapat dikatakan terdapat heteroskedastisitas spasial</p>
</section><section id="autokorelasi-spasial" class="level4"><h4 class="anchored" data-anchor-id="autokorelasi-spasial">Autokorelasi spasial</h4>
<p>Menggunakan uji Moran untuk mengecek autokorelasi spasial dengan hipotesis</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_0\)</span>: tidak terdapat autokorelasi spasial <span class="math inline">\(H_1\)</span>: terdapat autokorelasi spasial</p>
</blockquote>
<p>digunakan beragam pembobot spasial untuk mendapatkan nilai indeks Moran membentuk matrik jarak</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">koordinat</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">koordinat</span><span class="op">)</span></span>
<span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">Sp</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="knn" class="level5"><h5 class="anchored" data-anchor-id="knn">KNN</h5>
<p>K-Nearest Neighbor Weight (k = 5)</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">W.knn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html">knn2nb</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html">knearneigh</a></span><span class="op">(</span><span class="va">koordinat</span>,k<span class="op">=</span><span class="fl">5</span>,longlat<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in knn2nb(knearneigh(koordinat, k = 5, longlat = TRUE)):</span></span>
<span><span class="co">#&gt; neighbour object has 3 sub-graphs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">W.knn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">W.knn</span>, style <span class="op">=</span> <span class="st">'W'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="invers-distance-weight" class="level5"><h5 class="anchored" data-anchor-id="invers-distance-weight">Invers Distance Weight</h5>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">alpha1</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">W.idw</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">DD</span><span class="op">^</span><span class="va">alpha1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W.idw</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rtot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">W.idw</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">W.idw.sd</span> <span class="op">&lt;-</span> <span class="va">W.idw</span><span class="op">/</span><span class="va">rtot</span></span>
<span></span>
<span><span class="va">W.idw.1</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">W.idw.sd</span>,style <span class="op">=</span> <span class="st">'W'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alpha2</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="va">W.idw2</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">DD</span><span class="op">^</span><span class="va">alpha2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W.idw2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rtot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">W.idw2</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">W.idw.sd2</span> <span class="op">&lt;-</span> <span class="va">W.idw2</span><span class="op">/</span><span class="va">rtot</span></span>
<span></span>
<span><span class="va">W.idw.22</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">W.idw.sd2</span>,style<span class="op">=</span><span class="st">'W'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="eksponensial-distance-weight" class="level5"><h5 class="anchored" data-anchor-id="eksponensial-distance-weight">Eksponensial Distance Weight</h5>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">W.e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">DD</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2.65</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W.e</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rtot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/rowSums.html">rowSums</a></span><span class="op">(</span><span class="va">W.e</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">W.e.sd</span> <span class="op">&lt;-</span> <span class="va">W.e</span><span class="op">/</span><span class="va">rtot</span></span>
<span></span>
<span><span class="va">W.ed1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">W.e.sd</span>,style <span class="op">=</span> <span class="st">'W'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="rook-contiguity" class="level5"><h5 class="anchored" data-anchor-id="rook-contiguity">Rook Contiguity</h5>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spherical geometry (s2) switched off</span></span>
<span><span class="va">W.rook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">indonesia.map</span>, <span class="st">"Spatial"</span><span class="op">)</span>,queen <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes</span></span>
<span><span class="co">#&gt; that they are planar</span></span>
<span><span class="co">#&gt; Warning in poly2nb(as(indonesia.map, "Spatial"), queen = F): some observations have no neighbours;</span></span>
<span><span class="co">#&gt; if this seems unexpected, try increasing the snap argument.</span></span>
<span><span class="co">#&gt; Warning in poly2nb(as(indonesia.map, "Spatial"), queen = F): neighbour object has 52 sub-graphs;</span></span>
<span><span class="co">#&gt; if this sub-graph count seems unexpected, try increasing the snap argument.</span></span>
<span></span>
<span><span class="va">W.rook.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">W.rook</span>,style<span class="op">=</span><span class="st">'W'</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="queen-contiguity" class="level5"><h5 class="anchored" data-anchor-id="queen-contiguity">Queen Contiguity</h5>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">W.queen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">indonesia.map</span>, <span class="st">"Spatial"</span><span class="op">)</span>,queen <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes</span></span>
<span><span class="co">#&gt; that they are planar</span></span>
<span><span class="co">#&gt; Warning in poly2nb(as(indonesia.map, "Spatial"), queen = T): some observations have no neighbours;</span></span>
<span><span class="co">#&gt; if this seems unexpected, try increasing the snap argument.</span></span>
<span><span class="co">#&gt; Warning in poly2nb(as(indonesia.map, "Spatial"), queen = T): neighbour object has 52 sub-graphs;</span></span>
<span><span class="co">#&gt; if this sub-graph count seems unexpected, try increasing the snap argument.</span></span>
<span></span>
<span><span class="va">W.queen.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">W.queen</span>,style<span class="op">=</span><span class="st">'W'</span>, zero.policy <span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pemilihan-matriks-bobot" class="level5"><h5 class="anchored" data-anchor-id="pemilihan-matriks-bobot">Pemilihan matriks bobot</h5>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MI.knn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.html">moran</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span>, <span class="va">W.knn1</span>, n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">W.knn1</span><span class="op">$</span><span class="va">neighbours</span><span class="op">)</span>, S0<span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/spweights.constants.html">Szero</a></span><span class="op">(</span><span class="va">W.knn1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MI.power1</span> <span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.html">moran</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span>,<span class="va">W.idw.1</span>, n <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">W.idw.1</span><span class="op">$</span><span class="va">neighbours</span><span class="op">)</span>, S0<span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/spweights.constants.html">Szero</a></span><span class="op">(</span><span class="va">W.idw.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MI.power2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.html">moran</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span>, <span class="va">W.idw.22</span>, n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">W.idw.22</span><span class="op">$</span><span class="va">neighbours</span><span class="op">)</span>,S0<span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/spweights.constants.html">Szero</a></span><span class="op">(</span><span class="va">W.idw.22</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MI.exp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.html">moran</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span>, <span class="va">W.ed1</span>, n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">W.ed1</span><span class="op">$</span><span class="va">neighbours</span><span class="op">)</span>, S0<span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/spweights.constants.html">Szero</a></span><span class="op">(</span><span class="va">W.ed1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MI.rook</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span>, <span class="va">W.rook.s</span>, randomisation<span class="op">=</span><span class="cn">TRUE</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">MI.queen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span>, <span class="va">W.queen.s</span>,randomisation <span class="op">=</span> <span class="cn">TRUE</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">moranindeks</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"Matriks Bobot"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"KNN (k=5)"</span>, <span class="st">"Power distance weight (alpha=1)"</span>, <span class="st">"Power distance weight (alpha=2)"</span>, <span class="st">"Exponential distance weight (alpha=1)"</span>, <span class="st">"Rook Contiguity"</span>, <span class="st">"Queen Contiguity"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Nilai Indeks Moran"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MI.knn</span><span class="op">$</span><span class="va">I</span>, <span class="va">MI.power1</span><span class="op">$</span><span class="va">I</span>, <span class="va">MI.power2</span><span class="op">$</span><span class="va">I</span>, <span class="va">MI.exp1</span><span class="op">$</span><span class="va">I</span>, <span class="fl">0.087286515</span>, <span class="fl">0.085003993</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">moranindeks</span></span>
<span><span class="co">#&gt;                           Matriks.Bobot Nilai.Indeks.Moran</span></span>
<span><span class="co">#&gt; 1                             KNN (k=5)             0.7509</span></span>
<span><span class="co">#&gt; 2       Power distance weight (alpha=1)             0.2755</span></span>
<span><span class="co">#&gt; 3       Power distance weight (alpha=2)             0.6419</span></span>
<span><span class="co">#&gt; 4 Exponential distance weight (alpha=1)             0.6066</span></span>
<span><span class="co">#&gt; 5                       Rook Contiguity             0.0873</span></span>
<span><span class="co">#&gt; 6                      Queen Contiguity             0.0850</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Matrik bobot yang menghasilkan nilai Indeks Moran terbesar adalah matriks bobot KNN (k = 5)</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Autokorelasi spasial</span></span>
<span><span class="va">Woptimum</span> <span class="op">&lt;-</span> <span class="va">W.knn1</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span>,<span class="va">Woptimum</span>, randomisation<span class="op">=</span><span class="cn">TRUE</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Moran I test under randomisation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  imputasi$Y  </span></span>
<span><span class="co">#&gt; weights: Woptimum    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Moran I statistic standard deviate = 29, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: greater</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; Moran I statistic       Expectation          Variance </span></span>
<span><span class="co">#&gt;           0.75091          -0.00195           0.00068</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tolak <span class="math inline">\(H_0\)</span> sehingga dapat dikatakan terdapat autokorelasi spasial.</p>
</section></section></section><section id="matriks-pembobot-spasial" class="level3"><h3 class="anchored" data-anchor-id="matriks-pembobot-spasial">Matriks pembobot spasial</h3>
<p>Karena syarat adanya efek spasial terpenuhi maka dapat dilanjutkan analisis menggunakan Regresi Gerombol Spasial. Pertama-tama perlu mendefinisikan matriks pembobot spasial dalam studi kasus ini menggunakan 9 kombinasi pembobot spasial sebagai berikut:</p>
<section id="pembentukan-pembobot-1-1-atau-0-jarak-ambang" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-1-1-atau-0-jarak-ambang">Pembentukan pembobot 1 (1 atau 0) Jarak Ambang</h4>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">koordinat</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">batas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knn2nb.html">knn2nb</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/knearneigh.html">knearneigh</a></span><span class="op">(</span><span class="va">koordinat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in knn2nb(knearneigh(koordinat)): neighbour object has 149</span></span>
<span><span class="co">#&gt; sub-graphs</span></span>
<span><span class="va">batas.maks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nbdists.html">nbdists</a></span><span class="op">(</span><span class="va">batas</span>, <span class="va">koordinat</span>, longlat <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">batas.maks</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   0.004   0.224   0.312   0.404   0.503   2.641</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>batas dmaks agar seluruh amatan setidaknya memiliki satu tetangga ialah 2,65 km</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">koordinat</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">koordinat</span><span class="op">)</span></span>
<span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">Sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">th</span> <span class="op">&lt;-</span> <span class="fl">2.65</span></span>
<span><span class="va">W1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">514</span>, <span class="fl">514</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">514</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">W1</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">DD</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">&lt;</span><span class="va">th</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pembentukan-pembobot-2-eksponensial" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-2-eksponensial">Pembentukan pembobot 2 (eksponensial)</h4>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">koordinat</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">koordinat</span><span class="op">)</span></span>
<span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">Sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">th</span> <span class="op">&lt;-</span> <span class="fl">2.65</span></span>
<span><span class="va">W2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">514</span>, <span class="fl">514</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">514</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">W2</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">DD</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="va">th</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pembentukan-pembobot-3-knn-k-3" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-3-knn-k-3">Pembentukan pembobot 3 (KNN) k = 3</h4>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nrst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/FastKNN/man/k.nearest.neighbors.html">k.nearest.neighbors</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">DD</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Build w</span></span>
<span><span class="va">W3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span><span class="op">)</span> <span class="co">## all NA right now</span></span>
<span><span class="va">W3</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">W3</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">## populate with 0</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nrst</span><span class="op">)</span><span class="op">)</span> <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">nrst</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="va">W3</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pembentukan-pembobot-4-knn-k-4" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-4-knn-k-4">Pembentukan pembobot 4 (KNN) k = 4</h4>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nrst.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/FastKNN/man/k.nearest.neighbors.html">k.nearest.neighbors</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">DD</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Build w</span></span>
<span><span class="va">W4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span><span class="op">)</span> <span class="co">## all NA right now</span></span>
<span><span class="va">W4</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">W4</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">## populate with 0</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nrst.2</span><span class="op">)</span><span class="op">)</span> <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">nrst.2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="va">W4</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pembentukan-pembobot-5-knn-k-5" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-5-knn-k-5">Pembentukan pembobot 5 (KNN) k = 5</h4>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nrst.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/FastKNN/man/k.nearest.neighbors.html">k.nearest.neighbors</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">DD</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Build w</span></span>
<span><span class="va">W5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">DD</span><span class="op">)</span><span class="op">)</span> <span class="co">## all NA right now</span></span>
<span><span class="va">W5</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">W5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co">## populate with 0</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nrst.3</span><span class="op">)</span><span class="op">)</span> <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">nrst.3</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="va">W5</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pembentukan-pembobot-6-invers-distance-weight" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-6-invers-distance-weight">Pembentukan pembobot 6 (Invers Distance Weight)</h4>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">koordinat</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">koordinat</span><span class="op">)</span></span>
<span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">Sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Alpha = 1 </span></span>
<span><span class="va">alpha1</span><span class="op">=</span><span class="fl">1</span> </span>
<span><span class="va">W.idw</span> <span class="op">&lt;-</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">DD</span><span class="op">^</span><span class="va">alpha1</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">W.idw</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "matrix" "array"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W.idw</span><span class="op">)</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="va">W6</span> <span class="op">&lt;-</span> <span class="va">W.idw</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pembentukan-pembobot-7-invers-distance-weight-alpha-2" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-7-invers-distance-weight-alpha-2">Pembentukan pembobot 7 (Invers Distance Weight: Alpha 2)</h4>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">koordinat</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">koordinat</span><span class="op">)</span></span>
<span><span class="va">DD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">Sp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Alpha = 2</span></span>
<span><span class="va">alpha2</span><span class="op">=</span><span class="fl">2</span>  </span>
<span><span class="va">W.idw2</span> <span class="op">&lt;-</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">DD</span><span class="op">^</span><span class="va">alpha2</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">W.idw2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "matrix" "array"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">W.idw2</span><span class="op">)</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="va">W7</span> <span class="op">&lt;-</span> <span class="va">W.idw2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pembentukan-pembobot-8-queen-contiguity" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-8-queen-contiguity">Pembentukan Pembobot 8 (Queen Contiguity)</h4>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">queen.w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">indonesia.map</span>, <span class="st">"Spatial"</span><span class="op">)</span>,queen <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes</span></span>
<span><span class="co">#&gt; that they are planar</span></span>
<span><span class="co">#&gt; Warning in poly2nb(as(indonesia.map, "Spatial"), queen = T): some observations have no neighbours;</span></span>
<span><span class="co">#&gt; if this seems unexpected, try increasing the snap argument.</span></span>
<span><span class="co">#&gt; Warning in poly2nb(as(indonesia.map, "Spatial"), queen = T): neighbour object has 52 sub-graphs;</span></span>
<span><span class="co">#&gt; if this sub-graph count seems unexpected, try increasing the snap argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">queen.w</span><span class="op">)</span></span>
<span><span class="co">#&gt; Neighbour list object:</span></span>
<span><span class="co">#&gt; Number of regions: 514 </span></span>
<span><span class="co">#&gt; Number of nonzero links: 1990 </span></span>
<span><span class="co">#&gt; Percentage nonzero weights: 0.753 </span></span>
<span><span class="co">#&gt; Average number of links: 3.87 </span></span>
<span><span class="co">#&gt; 32 regions with no links:</span></span>
<span><span class="co">#&gt; 13, 21, 22, 146, 156, 157, 158, 159, 160, 161, 162, 163,</span></span>
<span><span class="co">#&gt; 164, 165, 174, 186, 248, 267, 271, 274, 303, 323, 325, 326,</span></span>
<span><span class="co">#&gt; 367, 418, 419, 430, 431, 447, 454, 516</span></span>
<span><span class="co">#&gt; 52 disjoint connected subgraphs</span></span>
<span><span class="co">#&gt; Link number distribution:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  0  1  2  3  4  5  6  7  8  9 10 11 </span></span>
<span><span class="co">#&gt; 32 56 64 74 88 70 66 40 15  6  1  2 </span></span>
<span><span class="co">#&gt; 56 least connected regions:</span></span>
<span><span class="co">#&gt; 24 25 27 45 46 55 57 80 81 107 177 179 191 193 194 195 197 198 200 211 213 216 218 221 223 225 226 228 230 231 239 240 241 244 247 249 250 253 254 257 259 265 266 269 273 305 335 359 425 441 442 470 472 474 476 477 with 1 link</span></span>
<span><span class="co">#&gt; 2 most connected regions:</span></span>
<span><span class="co">#&gt; 62 355 with 11 links</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Untuk melihat bentuk matriks bobot</span></span>
<span><span class="va">queen.w1</span><span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">nb2mat</a></span><span class="op">(</span><span class="va">queen.w</span>,style <span class="op">=</span> <span class="st">"B"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">W8</span> <span class="op">&lt;-</span> <span class="va">queen.w1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pembentukan-pembobot-9-rook-contiguity" class="level4"><h4 class="anchored" data-anchor-id="pembentukan-pembobot-9-rook-contiguity">Pembentukan Pembobot 9 (Rook Contiguity)</h4>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">rook.w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html">as</a></span><span class="op">(</span><span class="va">indonesia.map</span>, <span class="st">"Spatial"</span><span class="op">)</span>,queen <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes</span></span>
<span><span class="co">#&gt; that they are planar</span></span>
<span><span class="co">#&gt; Warning in poly2nb(as(indonesia.map, "Spatial"), queen = F): some observations have no neighbours;</span></span>
<span><span class="co">#&gt; if this seems unexpected, try increasing the snap argument.</span></span>
<span><span class="co">#&gt; Warning in poly2nb(as(indonesia.map, "Spatial"), queen = F): neighbour object has 52 sub-graphs;</span></span>
<span><span class="co">#&gt; if this sub-graph count seems unexpected, try increasing the snap argument.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">rook.w</span><span class="op">)</span></span>
<span><span class="co">#&gt; Neighbour list object:</span></span>
<span><span class="co">#&gt; Number of regions: 514 </span></span>
<span><span class="co">#&gt; Number of nonzero links: 1978 </span></span>
<span><span class="co">#&gt; Percentage nonzero weights: 0.749 </span></span>
<span><span class="co">#&gt; Average number of links: 3.85 </span></span>
<span><span class="co">#&gt; 32 regions with no links:</span></span>
<span><span class="co">#&gt; 13, 21, 22, 146, 156, 157, 158, 159, 160, 161, 162, 163,</span></span>
<span><span class="co">#&gt; 164, 165, 174, 186, 248, 267, 271, 274, 303, 323, 325, 326,</span></span>
<span><span class="co">#&gt; 367, 418, 419, 430, 431, 447, 454, 516</span></span>
<span><span class="co">#&gt; 52 disjoint connected subgraphs</span></span>
<span><span class="co">#&gt; Link number distribution:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  0  1  2  3  4  5  6  7  8  9 10 11 </span></span>
<span><span class="co">#&gt; 32 56 65 73 91 69 66 40 15  4  1  2 </span></span>
<span><span class="co">#&gt; 56 least connected regions:</span></span>
<span><span class="co">#&gt; 24 25 27 45 46 55 57 80 81 107 177 179 191 193 194 195 197 198 200 211 213 216 218 221 223 225 226 228 230 231 239 240 241 244 247 249 250 253 254 257 259 265 266 269 273 305 335 359 425 441 442 470 472 474 476 477 with 1 link</span></span>
<span><span class="co">#&gt; 2 most connected regions:</span></span>
<span><span class="co">#&gt; 62 355 with 11 links</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Untuk melihat bentuk matriks bobot</span></span>
<span><span class="va">rook.w1</span><span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2mat.html">nb2mat</a></span><span class="op">(</span><span class="va">rook.w</span>,style <span class="op">=</span> <span class="st">"B"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">W9</span> <span class="op">&lt;-</span> <span class="va">rook.w1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="gerombol-k-means-inisiasi-awal" class="level3"><h3 class="anchored" data-anchor-id="gerombol-k-means-inisiasi-awal">Gerombol K-Means (inisiasi awal)</h3>
<p>Gerombol inisiasi awal menggunakan metode <em>K-means</em> di mana data yang digunakan untuk penggerombolan tak berhierarki adalah data koordinat (longitude dan latitude) atau data jarak antara satu lokasi amatan dengan lokasi amatan lainnya</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">G3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">G4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">G5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">G6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">G7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">G8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">G9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">G10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">G11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">G12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">G13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">13</span><span class="op">)</span></span>
<span><span class="va">G14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">14</span><span class="op">)</span></span>
<span><span class="va">G15</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">Sp</span>, <span class="fl">15</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G3</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3 </span></span>
<span><span class="co">#&gt; 236  88 190</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G4</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3   4 </span></span>
<span><span class="co">#&gt; 193 133  48 140</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G5</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3   4   5 </span></span>
<span><span class="co">#&gt; 122 131  48  57 156</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G6</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3   4   5   6 </span></span>
<span><span class="co">#&gt;  89 102  46 106  42 129</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G7</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3   4   5   6   7 </span></span>
<span><span class="co">#&gt;  61  48  75  57  84 115  74</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G8</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3   4   5   6   7   8 </span></span>
<span><span class="co">#&gt;  43  23  88  46  93 104  50  67</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G9</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 </span></span>
<span><span class="co">#&gt; 60 70 71 46 45 75 63 57 27</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G10</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 </span></span>
<span><span class="co">#&gt; 54 53 79 60 44 57 51 26 51 39</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G11</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 </span></span>
<span><span class="co">#&gt; 38 42 48 24 56 19 78 48 51 64 46</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G12</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 </span></span>
<span><span class="co">#&gt; 23 78 49 56 40 65 22 48 38 19 48 28</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G13</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 </span></span>
<span><span class="co">#&gt; 39 23 63 71 37 28 60 22 70 18 20 27 36</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G14</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 </span></span>
<span><span class="co">#&gt; 50 47 59 52 16 25 15 38 31 48 22 19 55 37</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">G15</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 </span></span>
<span><span class="co">#&gt;  9 24 22 48 33 39 42 60 28 47 29 35 46 22 30</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G3 <span class="op">=</span> <span class="va">G3</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G4 <span class="op">=</span> <span class="va">G4</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G5 <span class="op">=</span> <span class="va">G5</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G6 <span class="op">=</span> <span class="va">G6</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G7 <span class="op">=</span> <span class="va">G7</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G8 <span class="op">=</span> <span class="va">G8</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G9 <span class="op">=</span> <span class="va">G9</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G10 <span class="op">=</span> <span class="va">G10</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G11 <span class="op">=</span> <span class="va">G11</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G12 <span class="op">=</span> <span class="va">G12</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G13 <span class="op">=</span> <span class="va">G13</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G14 <span class="op">=</span> <span class="va">G14</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">gerombol.kmeans</span> <span class="op">&lt;-</span> <span class="va">gerombol.kmeans</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>G15 <span class="op">=</span> <span class="va">G15</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="peta-kluster-k-means" class="level4"><h4 class="anchored" data-anchor-id="peta-kluster-k-means">Peta Kluster K-Means</h4>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">indonesia.map</span> <span class="op">&lt;-</span> <span class="va">id.map</span></span>
<span><span class="va">indonesia.map</span> <span class="op">&lt;-</span> <span class="va">indonesia.map</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">91</span>,<span class="op">-</span><span class="fl">92</span>,<span class="op">-</span><span class="fl">93</span>,<span class="op">-</span><span class="fl">94</span>,<span class="op">-</span><span class="fl">95</span>,<span class="op">-</span><span class="fl">127</span>,<span class="op">-</span><span class="fl">513</span>,<span class="op">-</span><span class="fl">514</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">indonesia.kmeans</span> <span class="op">&lt;-</span> <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/geo_join.html">geo_join</a></span><span class="op">(</span>spatial_data<span class="op">=</span><span class="va">indonesia.map</span>, data_frame <span class="op">=</span> <span class="va">gerombol.kmeans</span>, by_df <span class="op">=</span> <span class="st">"ADM2_EN"</span>,by_sp <span class="op">=</span><span class="st">"ADM2_EN"</span>, how <span class="op">=</span> <span class="st">"inner"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in tigris::geo_join(spatial_data = indonesia.map,</span></span>
<span><span class="co">#&gt; data_frame = gerombol.kmeans, : We recommend using the</span></span>
<span><span class="co">#&gt; dplyr::*_join() family of functions instead.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 3"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G3 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 3</code></p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 4"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G4 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 4</code></p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 5"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G5 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 5</code></p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 6"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G6 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 6</code></p>
<div class="cell">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 7"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G7 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 7</code></p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 8"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G8 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 8</code></p>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 9"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G9 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 9</code></p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 10"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G10 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 10</code></p>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G11</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 11"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas11</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G11 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 11</code></p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 12"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G12 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 12</code></p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G13</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 13"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G13 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 13</code></p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas14</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G14</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 14"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas14</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G14 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 14</code></p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">menas15</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.kmeans</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">G15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"K-Means 15"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">menas15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/G15 map-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta <code>G = 15</code></p>
</section></section></section><section id="model-regresi-gerombol-spasial-dengan-peubah-y" class="level2"><h2 class="anchored" data-anchor-id="model-regresi-gerombol-spasial-dengan-peubah-y">Model Regresi Gerombol Spasial dengan Peubah Y</h2>
<section id="gerombol-dengan-pembobot-1" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-1">Gerombol dengan pembobot 1</h3>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">X1</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X2</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X3</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">imputasi</span><span class="op">$</span><span class="va">X6</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X7</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">15</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.1</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W1</span>, <span class="va">Sp</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.1</span> <span class="op">&lt;-</span> <span class="va">Y.IC.1</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.1</span></span>
<span><span class="co">#&gt; [1] 4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 4</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W1</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="va">Y.hG.1</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="op">-</span><span class="fl">7</span>,<span class="op">-</span><span class="fl">8</span>,<span class="op">-</span><span class="fl">16</span>,<span class="op">-</span><span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data.gerombol.spasial</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot1 <span class="op">=</span> <span class="va">fit1</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="gerombol-dengan-pembobot-2" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-2">Gerombol dengan pembobot 2</h3>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">X1</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X2</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X3</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">imputasi</span><span class="op">$</span><span class="va">X6</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X7</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.2</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W2</span>, <span class="va">Sp</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.2</span> <span class="op">&lt;-</span> <span class="va">Y.IC.2</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.2</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 3</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W2</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="va">Y.hG.2</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot2 <span class="op">=</span> <span class="va">fit2</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="gerombol-dengan-pembobot-3" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-3">Gerombol dengan pembobot 3</h3>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">X1</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X2</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X3</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">imputasi</span><span class="op">$</span><span class="va">X6</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X7</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.3</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W3</span>, <span class="va">Sp</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.3</span> <span class="op">&lt;-</span> <span class="va">Y.IC.3</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.3</span></span>
<span><span class="co">#&gt; [1] 22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 22</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W3</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="va">Y.hG.3</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot3 <span class="op">=</span> <span class="va">fit3</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="gerombol-dengan-pembobot-4" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-4">Gerombol dengan pembobot 4</h3>
<div class="cell">
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">X1</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X2</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X3</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">imputasi</span><span class="op">$</span><span class="va">X6</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X7</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.4</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W4</span>, <span class="va">Sp</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.4</span> <span class="op">&lt;-</span> <span class="va">Y.IC.4</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.4</span></span>
<span><span class="co">#&gt; [1] 7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 7</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W4</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="va">Y.hG.4</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot4 <span class="op">=</span> <span class="va">fit4</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="gerombol-dengan-pembobot-5" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-5">Gerombol dengan pembobot 5</h3>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">X1</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X2</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X3</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">imputasi</span><span class="op">$</span><span class="va">X6</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X7</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.5</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W5</span>, <span class="va">Sp</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.5</span> <span class="op">&lt;-</span> <span class="va">Y.IC.5</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.5</span></span>
<span><span class="co">#&gt; [1] 6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 6</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W5</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="va">Y.hG.5</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot5 <span class="op">=</span> <span class="va">fit5</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="gerombol-dengan-pembobot-6" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-6">Gerombol dengan pembobot 6</h3>
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">X1</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X2</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X3</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">imputasi</span><span class="op">$</span><span class="va">X6</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X7</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.6</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W6</span>, <span class="va">Sp</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.6</span> <span class="op">&lt;-</span> <span class="va">Y.IC.6</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.6</span></span>
<span><span class="co">#&gt; [1] 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 5</p>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit6</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W6</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="va">Y.hG.6</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot6 <span class="op">=</span> <span class="va">fit6</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="gerombol-dengan-pembobot-7" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-7">Gerombol dengan pembobot 7</h3>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">X1</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X2</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X3</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">imputasi</span><span class="op">$</span><span class="va">X6</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X7</span>,<span class="va">imputasi</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">30</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.7</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W7</span>, <span class="va">Sp</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.7</span> <span class="op">&lt;-</span> <span class="va">Y.IC.7</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.7</span></span>
<span><span class="co">#&gt; [1] 4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 4</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit7</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W7</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="va">Y.hG.7</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot7 <span class="op">=</span> <span class="va">fit7</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="gerombol-dengan-pembobot-8" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-8">Gerombol dengan pembobot 8</h3>
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">ADM2_EN</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">koordinat.2</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Sp.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">koordinat.2</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X1</span>,<span class="va">df</span><span class="op">$</span><span class="va">X2</span>,<span class="va">df</span><span class="op">$</span><span class="va">X3</span>,<span class="va">df</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">df</span><span class="op">$</span><span class="va">X6</span>,<span class="va">df</span><span class="op">$</span><span class="va">X7</span>,<span class="va">df</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">15</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.8</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W8</span>, <span class="va">Sp.2</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.8</span> <span class="op">&lt;-</span> <span class="va">Y.IC.8</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.8</span></span>
<span><span class="co">#&gt; [1] 13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 13</p>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit8</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W8</span>, <span class="va">Sp.2</span>, G<span class="op">=</span> <span class="va">Y.hG.8</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial.2</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">ADM2_EN</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">data.gerombol.spasial.2</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial.2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot8 <span class="op">=</span> <span class="va">fit8</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="gerombol-dengan-pembobot-9" class="level3"><h3 class="anchored" data-anchor-id="gerombol-dengan-pembobot-9">Gerombol dengan pembobot 9</h3>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## SCR: spatially clustered regression</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">imputasi</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">imputasi</span><span class="op">$</span><span class="va">ADM2_EN</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">koordinat.2</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Sp.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">koordinat.2</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X1</span>,<span class="va">df</span><span class="op">$</span><span class="va">X2</span>,<span class="va">df</span><span class="op">$</span><span class="va">X3</span>,<span class="va">df</span><span class="op">$</span><span class="va">X4</span>,</span>
<span>                     <span class="va">df</span><span class="op">$</span><span class="va">X6</span>,<span class="va">df</span><span class="op">$</span><span class="va">X7</span>,<span class="va">df</span><span class="op">$</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G.set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">15</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Y.IC.9</span> <span class="op">&lt;-</span> <span class="fu">SCR.select</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W9</span>, <span class="va">Sp.2</span>, G.set<span class="op">=</span><span class="va">G.set</span>, Phi<span class="op">=</span><span class="fl">1</span>, print<span class="op">=</span><span class="cn">F</span>, family<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span>
<span><span class="va">Y.hG.9</span> <span class="op">&lt;-</span> <span class="va">Y.IC.9</span><span class="op">$</span><span class="va">G</span>    <span class="co"># optimal number of group via BIC</span></span>
<span><span class="va">Y.hG.9</span></span>
<span><span class="co">#&gt; [1] 12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Gerombol optimum = 12</p>
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit9</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W9</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="va">Y.hG.9</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">data.gerombol.spasial.2</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial.2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Y.pembobot9 <span class="op">=</span> <span class="va">fit9</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="peta-gerombol-spasial" class="level3"><h3 class="anchored" data-anchor-id="peta-gerombol-spasial">Peta Gerombol Spasial</h3>
<p>Berikut hasil peta 9 model Regresi Gerombol Spasial</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">indonesia.map</span> <span class="op">&lt;-</span> <span class="va">id.map</span></span>
<span><span class="va">indonesia.map</span> <span class="op">&lt;-</span> <span class="va">indonesia.map</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">91</span>,<span class="op">-</span><span class="fl">92</span>,<span class="op">-</span><span class="fl">93</span>,<span class="op">-</span><span class="fl">94</span>,<span class="op">-</span><span class="fl">95</span>,<span class="op">-</span><span class="fl">127</span>,<span class="op">-</span><span class="fl">513</span>,<span class="op">-</span><span class="fl">514</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">indonesia.2</span> <span class="op">&lt;-</span> <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/geo_join.html">geo_join</a></span><span class="op">(</span>spatial_data<span class="op">=</span><span class="va">indonesia.map</span>, data_frame <span class="op">=</span> <span class="va">data.gerombol.spasial</span>, by_df <span class="op">=</span> <span class="st">"ADM2_EN"</span>,by_sp <span class="op">=</span><span class="st">"ADM2_EN"</span>, how <span class="op">=</span> <span class="st">"inner"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in tigris::geo_join(spatial_data = indonesia.map,</span></span>
<span><span class="co">#&gt; data_frame = data.gerombol.spasial, : We recommend using the</span></span>
<span><span class="co">#&gt; dplyr::*_join() family of functions instead.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="y-pembobot-1" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-1">Y pembobot 1</h4>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 1"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw1-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Gerombol Spasial pembobot jarak ambang</p>
</section><section id="y-pembobot-2" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-2">Y pembobot 2</h4>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 2"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw2-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Gerombol Spasial pembobot eksponensial</p>
</section><section id="y-pembobot-3" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-3">Y pembobot 3</h4>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 3"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw3-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Pembobot Spasial pembobot KNN (k = 3)</p>
</section><section id="y-pembobot-4" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-4">Y pembobot 4</h4>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 4"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Gerombol Spasial pembobot KNN (k = 4)</p>
</section><section id="y-pembobot-5" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-5">Y pembobot 5</h4>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 5"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Gerombol Spasial KNN (k = 5)</p>
</section><section id="y-pembobot-6" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-6">Y pembobot 6</h4>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 6"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Gerombol Spasial pembobot jarak invers (alpha = 1)</p>
</section><section id="y-pembobot-7" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-7">Y pembobot 7</h4>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 7"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Gerombol Spasial pembobot jarak invers (alpha = 2)</p>
</section><section id="y-pembobot-8" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-8">Y pembobot 8</h4>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">indonesia.3</span> <span class="op">&lt;-</span> <span class="fu">tigris</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tigris/man/geo_join.html">geo_join</a></span><span class="op">(</span>spatial_data<span class="op">=</span><span class="va">indonesia.map</span>, data_frame <span class="op">=</span> <span class="va">data.gerombol.spasial.2</span>, by_df <span class="op">=</span> <span class="st">"ADM2_EN"</span>,by_sp <span class="op">=</span><span class="st">"ADM2_EN"</span>, how <span class="op">=</span> <span class="st">"inner"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in tigris::geo_join(spatial_data = indonesia.map,</span></span>
<span><span class="co">#&gt; data_frame = data.gerombol.spasial.2, : We recommend using the</span></span>
<span><span class="co">#&gt; dplyr::*_join() family of functions instead.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 8"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Gerombol Spasial pembobot queen contiguity</p>
</section><section id="y-pembobot-9" class="level4"><h4 class="anchored" data-anchor-id="y-pembobot-9">Y pembobot 9</h4>
<div class="cell">
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Y pembobot 9"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Y.pembobot9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/yw9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Peta Regresi Gerombol Spasial rook contiguity</p>
</section></section><section id="nilai-uji-kebaikan-model" class="level3"><h3 class="anchored" data-anchor-id="nilai-uji-kebaikan-model">Nilai uji kebaikan model</h3>
<section id="mae" class="level4"><h4 class="anchored" data-anchor-id="mae">MAE</h4>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MAE.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE.4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit4</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE.6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit6</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE.7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit7</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE.8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit8</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE.9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit9</span><span class="op">$</span><span class="va">sSig</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MAE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MAE.1</span>, <span class="va">MAE.2</span>, <span class="va">MAE.3</span>, <span class="va">MAE.4</span>, <span class="va">MAE.5</span>, <span class="va">MAE.6</span>, <span class="va">MAE.7</span>, <span class="va">MAE.8</span>, <span class="va">MAE.9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="mape" class="level4"><h4 class="anchored" data-anchor-id="mape">MAPE</h4>
<div class="cell">
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MAPE.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">MAPE.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">MAPE.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">MAPE.4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit4</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">MAPE.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">MAPE.6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit6</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">MAPE.7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit7</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">MAPE.8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit8</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="va">MAPE.9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">fit9</span><span class="op">$</span><span class="va">sSig</span><span class="op">/</span><span class="va">imputasi</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">MAPE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">MAPE.1</span>, <span class="va">MAPE.2</span>, <span class="va">MAPE.3</span>, <span class="va">MAPE.4</span>, <span class="va">MAPE.5</span>, <span class="va">MAPE.6</span>, <span class="va">MAPE.7</span>, <span class="va">MAPE.8</span>, <span class="va">MAPE.9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="rmse" class="level4"><h4 class="anchored" data-anchor-id="rmse">RMSE</h4>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">RMSE.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">RMSE.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">RMSE.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">RMSE.4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit4</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">RMSE.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">RMSE.6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit6</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">RMSE.7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit7</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">RMSE.8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit8</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">RMSE.9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fit9</span><span class="op">$</span><span class="va">sSig</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">RMSE.1</span>, <span class="va">RMSE.2</span>, <span class="va">RMSE.3</span>, <span class="va">RMSE.4</span>, <span class="va">RMSE.5</span>, <span class="va">RMSE.6</span>, <span class="va">RMSE.7</span>, <span class="va">RMSE.8</span>, <span class="va">RMSE.9</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Model 1"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 4"</span>, <span class="st">"Model 5"</span>, <span class="st">"Model 6"</span>, <span class="st">"Model 7"</span>, <span class="st">"Model 8"</span>, <span class="st">"Model 9"</span><span class="op">)</span></span>
<span><span class="va">df.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Model</span>, <span class="va">MAE</span>, <span class="va">MAPE</span>, <span class="va">RMSE</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">df.model</span>, digits <span class="op">=</span> <span class="fl">2</span>, <span class="st">"simple"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">MAE</th>
<th style="text-align: right;">MAPE</th>
<th style="text-align: right;">RMSE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Model 1</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">39.98</td>
<td style="text-align: right;">3.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 2</td>
<td style="text-align: right;">5.37</td>
<td style="text-align: right;">63.82</td>
<td style="text-align: right;">5.37</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Model 3</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">7.87</td>
<td style="text-align: right;">0.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 4</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">31.01</td>
<td style="text-align: right;">2.89</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Model 5</td>
<td style="text-align: right;">3.06</td>
<td style="text-align: right;">34.31</td>
<td style="text-align: right;">3.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 6</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">45.15</td>
<td style="text-align: right;">4.24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Model 7</td>
<td style="text-align: right;">3.46</td>
<td style="text-align: right;">40.11</td>
<td style="text-align: right;">3.48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Model 8</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">18.69</td>
<td style="text-align: right;">1.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Model 9</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">15.22</td>
<td style="text-align: right;">1.40</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Berdasarkan <em>information criterion</em>, uji kebaikan model, dan pola gerombol peta dipilih model 4 dengan gerombol optimum 7 dan pembobot 4-tetangga terdekat sebagai model terbaik</p>
</section></section><section id="anova" class="level3"><h3 class="anchored" data-anchor-id="anova">ANOVA</h3>
<p>Hasil boxplot menunjukkan bahwa terdapat perbedaan antara gerombol spasial satu dengan gerombol spasial yang lain.</p>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data.gerombol.spasial</span><span class="op">$</span><span class="va">Y.pembobot4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">data.gerombol.spasial</span><span class="op">$</span><span class="va">Y.pembobot4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Y.pembobot4</span>, data <span class="op">=</span> <span class="va">data.gerombol.spasial</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"steelblue"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/boxplot yw4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Setelah didapatkan model terbaik, kemudian dilakukan analisis sidik ragam untuk mengetahui apakah terdapat perbedaan antar gerombol terhadap tingkat kemiskinan dengan hipotesis sebagai berikut:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_0\)</span>: tingkat kemiskinan antar gerombol sama <span class="math inline">\(H_1\)</span>: tingkat kemiskinan antar gerombol berbeda</p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">buat.anova</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span></span>
<span><span class="va">buat.anova</span><span class="op">$</span><span class="va">Y.pembobot4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">buat.anova</span><span class="op">$</span><span class="va">Y.pembobot4</span><span class="op">)</span></span>
<span><span class="va">aov_ral</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">Y.pembobot4</span>, data <span class="op">=</span> <span class="va">buat.anova</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov_ral</span><span class="op">)</span></span>
<span><span class="co">#&gt;              Df Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Y.pembobot4   6  14316    2386    94.3 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Residuals   507  12828      25                   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tabel ANOVA menunjukkan <code>p-value &lt; 0.05</code> sehingga tolak <span class="math inline">\(H_0\)</span> atau dapat dikatakan bahwa tingkat kemiskinan antar gerombol berbeda. Berikut rataan tiap peubah untuk setiap gerombol spasial:</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'data.table'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:raster':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     shift</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     between, first, last</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:zoo':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     yearmon, yearqtr</span></span>
<span><span class="va">rata.2</span> <span class="op">&lt;-</span> <span class="va">buat.anova</span></span>
<span><span class="va">peubahlain</span> <span class="op">&lt;-</span> <span class="va">data.gerombol.spasial</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/setDT.html">setDT</a></span><span class="op">(</span><span class="va">rata.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/setDT.html">setDT</a></span><span class="op">(</span><span class="va">peubahlain</span><span class="op">)</span></span>
<span><span class="va">rata.2</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Y.pembobot4</span><span class="op">]</span></span>
<span><span class="co">#&gt;    Y.pembobot4  mean</span></span>
<span><span class="co">#&gt;         &lt;fctr&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           4  9.39</span></span>
<span><span class="co">#&gt; 2:           7 14.35</span></span>
<span><span class="co">#&gt; 3:           6 10.84</span></span>
<span><span class="co">#&gt; 4:           3  9.28</span></span>
<span><span class="co">#&gt; 5:           1  6.04</span></span>
<span><span class="co">#&gt; 6:           5 10.10</span></span>
<span><span class="co">#&gt; 7:           2 26.72</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rataan peubah <strong><span class="math inline">\(Y\)</span></strong></p>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peubahlain</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X1</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Y.pembobot4</span><span class="op">]</span></span>
<span><span class="co">#&gt;    Y.pembobot4   mean</span></span>
<span><span class="co">#&gt;         &lt;fctr&gt;  &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           4 0.1156</span></span>
<span><span class="co">#&gt; 2:           7 0.1240</span></span>
<span><span class="co">#&gt; 3:           6 0.0603</span></span>
<span><span class="co">#&gt; 4:           3 0.0625</span></span>
<span><span class="co">#&gt; 5:           1 0.0980</span></span>
<span><span class="co">#&gt; 6:           5 0.1393</span></span>
<span><span class="co">#&gt; 7:           2 0.0747</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rataan peubah <strong><span class="math inline">\(X_1\)</span></strong></p>
<div class="cell">
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peubahlain</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Y.pembobot4</span><span class="op">]</span></span>
<span><span class="co">#&gt;    Y.pembobot4  mean</span></span>
<span><span class="co">#&gt;         &lt;fctr&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           4  53.7</span></span>
<span><span class="co">#&gt; 2:           7  64.4</span></span>
<span><span class="co">#&gt; 3:           6  61.0</span></span>
<span><span class="co">#&gt; 4:           3  59.1</span></span>
<span><span class="co">#&gt; 5:           1  62.8</span></span>
<span><span class="co">#&gt; 6:           5  61.9</span></span>
<span><span class="co">#&gt; 7:           2  63.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rataan peubah <strong><span class="math inline">\(X_2\)</span></strong></p>
<div class="cell">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peubahlain</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X3</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Y.pembobot4</span><span class="op">]</span></span>
<span><span class="co">#&gt;    Y.pembobot4  mean</span></span>
<span><span class="co">#&gt;         &lt;fctr&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           4  78.4</span></span>
<span><span class="co">#&gt; 2:           7  68.2</span></span>
<span><span class="co">#&gt; 3:           6  70.2</span></span>
<span><span class="co">#&gt; 4:           3  83.3</span></span>
<span><span class="co">#&gt; 5:           1  70.4</span></span>
<span><span class="co">#&gt; 6:           5  82.0</span></span>
<span><span class="co">#&gt; 7:           2  38.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rataan peubah <strong><span class="math inline">\(X_3\)</span></strong></p>
<div class="cell">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peubahlain</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X4</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Y.pembobot4</span><span class="op">]</span></span>
<span><span class="co">#&gt;    Y.pembobot4  mean</span></span>
<span><span class="co">#&gt;         &lt;fctr&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           4  55.8</span></span>
<span><span class="co">#&gt; 2:           7  53.1</span></span>
<span><span class="co">#&gt; 3:           6  53.8</span></span>
<span><span class="co">#&gt; 4:           3  52.3</span></span>
<span><span class="co">#&gt; 5:           1  52.5</span></span>
<span><span class="co">#&gt; 6:           5  51.5</span></span>
<span><span class="co">#&gt; 7:           2  58.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rataan peubah <strong><span class="math inline">\(X_4\)</span></strong></p>
<div class="cell">
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peubahlain</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X6</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Y.pembobot4</span><span class="op">]</span></span>
<span><span class="co">#&gt;    Y.pembobot4  mean</span></span>
<span><span class="co">#&gt;         &lt;fctr&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           4  5.14</span></span>
<span><span class="co">#&gt; 2:           7  3.25</span></span>
<span><span class="co">#&gt; 3:           6  4.56</span></span>
<span><span class="co">#&gt; 4:           3  5.64</span></span>
<span><span class="co">#&gt; 5:           1  4.50</span></span>
<span><span class="co">#&gt; 6:           5  5.16</span></span>
<span><span class="co">#&gt; 7:           2  3.57</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rataan peubah <strong><span class="math inline">\(X_6\)</span></strong></p>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peubahlain</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X7</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Y.pembobot4</span><span class="op">]</span></span>
<span><span class="co">#&gt;    Y.pembobot4    mean</span></span>
<span><span class="co">#&gt;         &lt;fctr&gt;   &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           4 2855535</span></span>
<span><span class="co">#&gt; 2:           7 2622613</span></span>
<span><span class="co">#&gt; 3:           6 2952842</span></span>
<span><span class="co">#&gt; 4:           3 3255377</span></span>
<span><span class="co">#&gt; 5:           1 2965390</span></span>
<span><span class="co">#&gt; 6:           5 2291751</span></span>
<span><span class="co">#&gt; 7:           2 3361544</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rataan peubah <strong><span class="math inline">\(X_7\)</span></strong></p>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">peubahlain</span><span class="op">[</span> ,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X8</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Y.pembobot4</span><span class="op">]</span></span>
<span><span class="co">#&gt;    Y.pembobot4  mean</span></span>
<span><span class="co">#&gt;         &lt;fctr&gt; &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:           4  84.9</span></span>
<span><span class="co">#&gt; 2:           7  81.5</span></span>
<span><span class="co">#&gt; 3:           6  76.6</span></span>
<span><span class="co">#&gt; 4:           3  87.8</span></span>
<span><span class="co">#&gt; 5:           1  86.0</span></span>
<span><span class="co">#&gt; 6:           5  86.7</span></span>
<span><span class="co">#&gt; 7:           2  63.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rataan peubah <strong><span class="math inline">\(X_8\)</span></strong></p>
<section id="uji-lanjut-tukey" class="level4"><h4 class="anchored" data-anchor-id="uji-lanjut-tukey">Uji lanjut (Tukey)</h4>
<p>Sudah diketahui melalui ANOVA bahwa terdapat perbedaan tingkat kemiskinan antar gerombol. Pertanyaannya gerombol mana yang berbeda? Oleh karena itu dilakukan uji lanjut menggunakan uji Tukey untuk mengecek perbedaan tingkat kemiskinan di setiap gerombolnya sehingga dikethaui mana gerombol dengan tingkat kemiskinan sama dan gerombol dengan tingkat kemiskinan berbeda.</p>
<div class="cell">
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tukey.gerombol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">aov_ral</span>, <span class="st">'Y.pembobot4'</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">tukey.gerombol</span><span class="op">$</span><span class="va">Y.pembobot4</span></span>
<span><span class="co">#&gt;        diff     lwr    upr    p adj</span></span>
<span><span class="co">#&gt; 2-1  20.678  17.745  23.61 1.69e-10</span></span>
<span><span class="co">#&gt; 3-1   3.236   0.698   5.77 3.37e-03</span></span>
<span><span class="co">#&gt; 4-1   3.343   0.812   5.88 2.02e-03</span></span>
<span><span class="co">#&gt; 5-1   4.062   1.617   6.51 2.44e-05</span></span>
<span><span class="co">#&gt; 6-1   4.801   1.794   7.81 6.07e-05</span></span>
<span><span class="co">#&gt; 7-1   8.310   5.766  10.85 1.69e-10</span></span>
<span><span class="co">#&gt; 3-2 -17.443 -20.138 -14.75 1.69e-10</span></span>
<span><span class="co">#&gt; 4-2 -17.335 -20.025 -14.64 1.69e-10</span></span>
<span><span class="co">#&gt; 5-2 -16.616 -19.225 -14.01 1.69e-10</span></span>
<span><span class="co">#&gt; 6-2 -15.877 -19.019 -12.73 1.69e-10</span></span>
<span><span class="co">#&gt; 7-2 -12.369 -15.070  -9.67 1.69e-10</span></span>
<span><span class="co">#&gt; 4-3   0.108  -2.144   2.36 1.00e+00</span></span>
<span><span class="co">#&gt; 5-3   0.827  -1.327   2.98 9.17e-01</span></span>
<span><span class="co">#&gt; 6-3   1.566  -1.210   4.34 6.37e-01</span></span>
<span><span class="co">#&gt; 7-3   5.074   2.810   7.34 1.94e-09</span></span>
<span><span class="co">#&gt; 5-4   0.719  -1.428   2.87 9.56e-01</span></span>
<span><span class="co">#&gt; 6-4   1.458  -1.312   4.23 7.09e-01</span></span>
<span><span class="co">#&gt; 7-4   4.966   2.708   7.22 3.93e-09</span></span>
<span><span class="co">#&gt; 6-5   0.739  -1.953   3.43 9.84e-01</span></span>
<span><span class="co">#&gt; 7-5   4.247   2.086   6.41 2.21e-07</span></span>
<span><span class="co">#&gt; 7-6   3.508   0.727   6.29 3.93e-03</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dua gerombol diketahui berbeda nyata ketika memiliki nilai <code>p-value</code> dibawah <code>0.05</code> atau mengandung nilai 0 pada selang antara batas bawah dan batas atasnya. Dengan demikian, 7 gerombol yang ada di bagi menjadi 4 kelompok sebagai berikut:</p>
<ul>
<li>Kelompok a (kemiskinan rendah) : gerombol 1</li>
<li>Kelompok b (kemiskinan sedang) : gerombol 3, 4, 5, 6</li>
<li>Kelompok c (kemiskinan tinggi) : gerombol 7</li>
<li>Kelompok d (kemiskinan sangat tinggi) : gerombol 2</li>
</ul></section><section id="peta-per-gerombol-untuk-model-terbaik" class="level4"><h4 class="anchored" data-anchor-id="peta-per-gerombol-untuk-model-terbaik">Peta per gerombol untuk model terbaik</h4>
<p>Berikut peta untuk masing-masing gerombol</p>
<section id="gerombol-ke-1" class="level5"><h5 class="anchored" data-anchor-id="gerombol-ke-1">Gerombol ke-1</h5>
<div class="cell">
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot4.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gerombol spasial 1"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                                <span class="st">"2"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"4"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"5"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"6"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"7"</span><span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Y.pembobot4.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/finclus1-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="gerombol-ke-2" class="level5"><h5 class="anchored" data-anchor-id="gerombol-ke-2">Gerombol ke-2</h5>
<div class="cell">
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot4.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gerombol spasial 2"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2"</span> <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                                <span class="st">"1"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"4"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"5"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"6"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"7"</span><span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Y.pembobot4.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/finclus2-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="gerombol-ke-3" class="level5"><h5 class="anchored" data-anchor-id="gerombol-ke-3">Gerombol ke-3</h5>
<div class="cell">
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot4.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gerombol spasial 3"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"3"</span> <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                                <span class="st">"1"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"2"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"4"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"5"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"6"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"7"</span><span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Y.pembobot4.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/finclus3-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="gerombol-ke-4" class="level5"><h5 class="anchored" data-anchor-id="gerombol-ke-4">Gerombol ke-4</h5>
<div class="cell">
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot4.4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gerombol spasial 4"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"4"</span> <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                                <span class="st">"1"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"2"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"5"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"6"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"7"</span><span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Y.pembobot4.4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/finclus4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="gerombol-ke-5" class="level5"><h5 class="anchored" data-anchor-id="gerombol-ke-5">Gerombol ke-5</h5>
<div class="cell">
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot4.5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gerombol spasial 5"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"5"</span> <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                                <span class="st">"1"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"2"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"4"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"6"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"7"</span><span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Y.pembobot4.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/finclus5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="gerombol-ke-6" class="level5"><h5 class="anchored" data-anchor-id="gerombol-ke-6">Gerombol ke-6</h5>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot4.6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gerombol spasial 6"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"6"</span> <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                                <span class="st">"1"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"2"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"4"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"5"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"7"</span><span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Y.pembobot4.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/finclus6-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="gerombol-ke-7" class="level5"><h5 class="anchored" data-anchor-id="gerombol-ke-7">Gerombol ke-7</h5>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y.pembobot4.7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">indonesia.2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Y.pembobot4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gerombol spasial 7"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"7"</span> <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>                                <span class="st">"1"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"2"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"4"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"5"</span><span class="op">=</span><span class="st">"white"</span>, <span class="st">"6"</span><span class="op">=</span><span class="st">"white"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">Y.pembobot4.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="RegresiSpasialGerombol_files/figure-html/finclus7-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="peubah-peubah-berpengaruh" class="level3"><h3 class="anchored" data-anchor-id="peubah-peubah-berpengaruh">Peubah-Peubah berpengaruh</h3>
<p>Peubah berpengaruh signifikan dicari menggunakan uji t pada tahap iterasi terakhir model Regresi Gerombol Spasial. peubah dengan <code>p-value</code> lebih kecil dari <code>0.05</code> maka dikatakan signifikan dengan hipotesis sebagai berikut:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(H_0\)</span>: peubah penjelas tidak berpengaruh signifikan terhadap <span class="math inline">\(Y\)</span> <span class="math inline">\(H_1\)</span>: peubah penjelas berpengaruh signifikan terhadap <span class="math inline">\(Y\)</span></p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit4</span> <span class="op">&lt;-</span> <span class="fu">SCR</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">W4</span>, <span class="va">Sp</span>, G<span class="op">=</span> <span class="fl">7</span>, Phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "length sepanjang 57 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.898  -4.641  -0.468   4.317  11.419 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     2.39e+01   2.00e+01    1.19   0.2382   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -1.42e+01   1.31e+01   -1.09   0.2810   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.84e-01   1.33e-01   -2.13   0.0382 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -9.31e-02   4.54e-02   -2.05   0.0458 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  5.60e-01   2.60e-01    2.16   0.0360 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.62e+00   5.68e-01   -2.85   0.0063 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -9.45e-07   1.85e-06   -0.51   0.6115   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.57e-02   9.23e-02   -0.82   0.4160   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.08 on 49 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.518,  Adjusted R-squared:  0.449 </span></span>
<span><span class="co">#&gt; F-statistic: 7.52 on 7 and 49 DF,  p-value: 3.85e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 46 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.568  -4.249   0.071   1.896  15.719 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     3.96e+01   2.28e+01    1.74   0.0903 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.19e+00   1.45e+01    0.08   0.9352   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  7.36e-03   1.02e-01    0.07   0.9427   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.85e-01   5.44e-02   -3.41   0.0016 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4 -1.27e-01   2.44e-01   -0.52   0.6057   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.31e-01   5.20e-01   -0.25   0.8028   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.54e-06   2.20e-06    0.70   0.4883   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.47e-01   8.50e-02   -1.72   0.0928 . </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.39 on 38 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.586,  Adjusted R-squared:  0.509 </span></span>
<span><span class="co">#&gt; F-statistic: 7.67 on 7 and 38 DF,  p-value: 9.06e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 93 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.305  -4.082  -0.778   3.075  18.194 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     7.20e+00   1.05e+01    0.68    0.497   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  2.06e+00   9.89e+00    0.21    0.836   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  4.02e-02   7.69e-02    0.52    0.602   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.02e-01   3.35e-02   -3.06    0.003 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.37e-01   1.41e-01    1.68    0.096 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  3.61e-02   3.49e-01    0.10    0.918   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.44e-06   1.21e-06    1.19    0.239   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.01e-01   6.89e-02   -1.47    0.144   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.41 on 85 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.316,  Adjusted R-squared:  0.26 </span></span>
<span><span class="co">#&gt; F-statistic: 5.61 on 7 and 85 DF,  p-value: 2.43e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 89 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 4"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -7.757 -2.223 -0.157  2.373 11.821 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     2.85e+01   9.54e+00    2.99   0.0037 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  3.09e+00   6.99e+00    0.44   0.6596    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.23e-01   7.00e-02   -3.18   0.0021 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -8.64e-02   2.51e-02   -3.45   0.0009 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  3.42e-01   1.19e-01    2.86   0.0053 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  4.83e-01   2.38e-01    2.03   0.0456 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -2.96e-06   9.45e-07   -3.13   0.0024 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.16e-01   5.24e-02   -2.21   0.0302 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.2 on 81 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.375,  Adjusted R-squared:  0.321 </span></span>
<span><span class="co">#&gt; F-statistic: 6.94 on 7 and 81 DF,  p-value: 1.8e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 104 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 5"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -8.572 -1.976 -0.455  2.251  9.937 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     1.18e+00   6.91e+00    0.17    0.865   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.42e+01   5.84e+00    2.43    0.017 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.36e-01   4.27e-02    3.18    0.002 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -6.11e-02   2.74e-02   -2.23    0.028 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  9.45e-02   7.62e-02    1.24    0.218   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -3.95e-02   1.56e-01   -0.25    0.800   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -2.26e-07   5.19e-07   -0.44    0.663   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7  1.44e-02   5.72e-02    0.25    0.802   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 3.16 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.436,  Adjusted R-squared:  0.395 </span></span>
<span><span class="co">#&gt; F-statistic: 10.6 on 7 and 96 DF,  p-value: 8.07e-10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 47 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 6"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -11.25  -3.89   0.41   3.46  11.75 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     4.61e+00   1.47e+01    0.31  0.75491    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  2.74e+01   1.49e+01    1.84  0.07282 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.04e-01   1.08e-01    0.96  0.34295    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.52e-01   4.05e-02   -3.76  0.00056 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.68e-01   1.98e-01    1.35  0.18478    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.08e+00   4.53e-01   -2.39  0.02156 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  6.59e-07   1.54e-06    0.43  0.67143    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -4.94e-02   6.03e-02   -0.82  0.41796    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.58 on 39 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.683,  Adjusted R-squared:  0.626 </span></span>
<span><span class="co">#&gt; F-statistic:   12 on 7 and 39 DF,  p-value: 4.73e-08</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 78 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 7"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -11.112  -2.991   0.447   3.091  13.683 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     9.18e+00   1.42e+01    0.65   0.5205   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.62e+01   8.26e+00    1.96   0.0546 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.27e-01   9.58e-02    1.32   0.1903   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -3.77e-02   3.32e-02   -1.13   0.2605   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.22e-01   1.70e-01    1.31   0.1958   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -5.63e-01   3.88e-01   -1.45   0.1508   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  2.88e-07   1.42e-06    0.20   0.8399   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.80e-01   5.41e-02   -3.33   0.0014 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.53 on 70 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.444,  Adjusted R-squared:  0.389 </span></span>
<span><span class="co">#&gt; F-statistic:    8 on 7 and 70 DF,  p-value: 4.15e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 57 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.898  -4.641  -0.468   4.317  11.419 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     2.39e+01   2.00e+01    1.19   0.2382   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -1.42e+01   1.31e+01   -1.09   0.2810   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.84e-01   1.33e-01   -2.13   0.0382 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -9.31e-02   4.54e-02   -2.05   0.0458 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  5.60e-01   2.60e-01    2.16   0.0360 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.62e+00   5.68e-01   -2.85   0.0063 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -9.45e-07   1.85e-06   -0.51   0.6115   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.57e-02   9.23e-02   -0.82   0.4160   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.08 on 49 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.518,  Adjusted R-squared:  0.449 </span></span>
<span><span class="co">#&gt; F-statistic: 7.52 on 7 and 49 DF,  p-value: 3.85e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 46 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.735  -4.293   0.272   2.026  15.646 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     4.17e+01   2.26e+01    1.84  0.07293 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -2.50e-01   1.45e+01   -0.02  0.98633    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -1.36e-02   1.00e-01   -0.14  0.89314    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.97e-01   5.45e-02   -3.62  0.00086 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4 -1.31e-01   2.43e-01   -0.54  0.59294    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.38e-01   5.19e-01   -0.27  0.79100    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.62e-06   2.20e-06    0.73  0.46708    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.48e-01   8.47e-02   -1.75  0.08830 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.37 on 38 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.598,  Adjusted R-squared:  0.524 </span></span>
<span><span class="co">#&gt; F-statistic: 8.07 on 7 and 38 DF,  p-value: 5.39e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 91 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.968  -4.052  -0.723   3.172  17.394 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     7.43e+00   1.06e+01    0.70    0.487   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  6.22e-01   1.01e+01    0.06    0.951   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  4.44e-02   7.70e-02    0.58    0.566   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.09e-01   3.22e-02   -3.40    0.001 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.31e-01   1.41e-01    1.64    0.105   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  8.44e-02   3.50e-01    0.24    0.810   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.56e-06   1.23e-06    1.27    0.208   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.01e-01   6.99e-02   -1.44    0.152   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.47 on 83 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.335,  Adjusted R-squared:  0.279 </span></span>
<span><span class="co">#&gt; F-statistic: 5.98 on 7 and 83 DF,  p-value: 1.19e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 92 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 4"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -8.149 -2.650  0.052  2.138 11.941 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     2.87e+01   8.74e+00    3.28  0.00152 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  6.98e+00   6.65e+00    1.05  0.29709    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.34e-01   6.37e-02   -3.68  0.00041 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -5.86e-02   2.71e-02   -2.16  0.03363 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  3.52e-01   1.16e-01    3.03  0.00322 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  4.03e-01   2.19e-01    1.84  0.06977 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -3.19e-06   8.83e-07   -3.62  0.00051 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.34e-01   4.99e-02   -2.70  0.00849 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.01 on 84 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.378,  Adjusted R-squared:  0.326 </span></span>
<span><span class="co">#&gt; F-statistic: 7.28 on 7 and 84 DF,  p-value: 8.17e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 105 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 5"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -8.695 -1.925 -0.205  2.087  6.995 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    -5.86e-01   6.35e+00   -0.09  0.92666    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.71e+01   5.42e+00    3.15  0.00219 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.42e-01   3.94e-02    3.59  0.00052 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -5.88e-02   2.56e-02   -2.29  0.02392 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  8.84e-02   7.14e-02    1.24  0.21867    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.17e-01   1.48e-01   -0.79  0.43254    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -1.25e-07   4.87e-07   -0.26  0.79784    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7  3.04e-02   5.33e-02    0.57  0.57039    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.97 on 97 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.492,  Adjusted R-squared:  0.455 </span></span>
<span><span class="co">#&gt; F-statistic: 13.4 on 7 and 97 DF,  p-value: 5.22e-12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 45 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 6"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -11.405  -3.912   0.302   3.705  12.555 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     6.70e+00   1.49e+01    0.45  0.65456    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  2.93e+01   1.56e+01    1.88  0.06742 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.26e-01   1.10e-01    1.14  0.26001    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.55e-01   4.14e-02   -3.74  0.00062 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.12e-01   2.01e-01    1.05  0.29847    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.03e+00   4.83e-01   -2.14  0.03892 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  4.04e-07   1.56e-06    0.26  0.79660    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -4.65e-02   6.17e-02   -0.75  0.45611    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.64 on 37 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.681,  Adjusted R-squared:  0.62 </span></span>
<span><span class="co">#&gt; F-statistic: 11.3 on 7 and 37 DF,  p-value: 1.51e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 78 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 7"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -11.081  -2.914   0.496   3.087  13.578 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     9.78e+00   1.41e+01    0.69   0.4899   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.64e+01   8.33e+00    1.97   0.0530 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.27e-01   9.58e-02    1.32   0.1900   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -3.99e-02   3.29e-02   -1.22   0.2282   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.17e-01   1.68e-01    1.29   0.2006   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -5.75e-01   3.81e-01   -1.51   0.1354   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  3.32e-07   1.39e-06    0.24   0.8115   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.85e-01   5.40e-02   -3.42   0.0011 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.51 on 70 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.454,  Adjusted R-squared:  0.399 </span></span>
<span><span class="co">#&gt; F-statistic: 8.32 on 7 and 70 DF,  p-value: 2.35e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 57 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.898  -4.641  -0.468   4.317  11.419 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     2.39e+01   2.00e+01    1.19   0.2382   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -1.42e+01   1.31e+01   -1.09   0.2810   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.84e-01   1.33e-01   -2.13   0.0382 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -9.31e-02   4.54e-02   -2.05   0.0458 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  5.60e-01   2.60e-01    2.16   0.0360 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.62e+00   5.68e-01   -2.85   0.0063 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -9.45e-07   1.85e-06   -0.51   0.6115   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.57e-02   9.23e-02   -0.82   0.4160   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.08 on 49 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.518,  Adjusted R-squared:  0.449 </span></span>
<span><span class="co">#&gt; F-statistic: 7.52 on 7 and 49 DF,  p-value: 3.85e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 47 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -13.74  -4.22   0.16   2.00  15.64 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     4.18e+01   2.22e+01    1.88  0.06725 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -3.20e-01   1.41e+01   -0.02  0.98203    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -1.35e-02   9.91e-02   -0.14  0.89207    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.98e-01   4.66e-02   -4.25  0.00013 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4 -1.32e-01   2.36e-01   -0.56  0.57731    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.35e-01   5.00e-01   -0.27  0.78843    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.62e-06   2.17e-06    0.75  0.45992    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.48e-01   8.19e-02   -1.80  0.07913 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.29 on 39 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.608,  Adjusted R-squared:  0.538 </span></span>
<span><span class="co">#&gt; F-statistic: 8.66 on 7 and 39 DF,  p-value: 2.25e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 89 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.402  -4.039  -0.523   3.000  17.771 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     6.87e+00   1.07e+01    0.64   0.5230   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.64e+00   1.02e+01    0.16   0.8723   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  3.72e-02   7.86e-02    0.47   0.6370   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.02e-01   3.43e-02   -2.99   0.0037 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.53e-01   1.44e-01    1.76   0.0821 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  3.81e-02   3.54e-01    0.11   0.9147   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.55e-06   1.24e-06    1.25   0.2162   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.08e-01   7.06e-02   -1.52   0.1316   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.5 on 81 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.324,  Adjusted R-squared:  0.266 </span></span>
<span><span class="co">#&gt; F-statistic: 5.55 on 7 and 81 DF,  p-value: 3.07e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 93 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 4"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -8.158 -2.899 -0.019  2.037 11.950 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     2.89e+01   8.71e+00    3.32  0.00132 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  7.48e+00   6.60e+00    1.13  0.26056    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.26e-01   6.26e-02   -3.61  0.00052 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -5.36e-02   2.63e-02   -2.04  0.04466 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  3.31e-01   1.13e-01    2.94  0.00423 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  4.15e-01   2.18e-01    1.90  0.06021 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -3.14e-06   8.78e-07   -3.57  0.00059 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.39e-01   4.94e-02   -2.82  0.00593 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4 on 85 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.376,  Adjusted R-squared:  0.324 </span></span>
<span><span class="co">#&gt; F-statistic: 7.31 on 7 and 85 DF,  p-value: 7.51e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 105 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 5"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt;  -8.72  -2.00  -0.29   2.18   6.87 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    -5.10e-01   6.09e+00   -0.08  0.93350    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.77e+01   5.17e+00    3.42  0.00091 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.58e-01   3.82e-02    4.13  7.6e-05 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -7.47e-02   2.46e-02   -3.03  0.00313 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  6.29e-02   6.90e-02    0.91  0.36407    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.65e-02   1.45e-01   -0.11  0.90932    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -1.73e-07   4.68e-07   -0.37  0.71162    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7  4.56e-02   5.12e-02    0.89  0.37520    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.84 on 97 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.534,  Adjusted R-squared:  0.501 </span></span>
<span><span class="co">#&gt; F-statistic: 15.9 on 7 and 97 DF,  p-value: 9.49e-14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 43 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 6"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -11.877  -4.054   0.647   3.869  12.453 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     3.61e+00   1.56e+01    0.23  0.81846    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  3.22e+01   1.61e+01    2.00  0.05317 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.54e-01   1.14e-01    1.35  0.18711    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.51e-01   4.21e-02   -3.59  0.00099 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  1.98e-01   2.04e-01    0.97  0.33844    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.04e+00   4.88e-01   -2.12  0.04080 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  8.78e-07   1.75e-06    0.50  0.61961    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -4.17e-02   6.25e-02   -0.67  0.50909    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.7 on 35 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.688,  Adjusted R-squared:  0.625 </span></span>
<span><span class="co">#&gt; F-statistic:   11 on 7 and 35 DF,  p-value: 2.9e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 80 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 7"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.905  -3.096   0.489   3.102  13.888 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     1.10e+01   1.36e+01    0.81  0.42294    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.56e+01   8.18e+00    1.91  0.05993 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.16e-01   9.35e-02    1.25  0.21710    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -3.74e-02   3.18e-02   -1.17  0.24414    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.26e-01   1.66e-01    1.36  0.17679    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -6.05e-01   3.58e-01   -1.69  0.09531 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.36e-07   1.26e-06    0.11  0.91420    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.92e-01   5.38e-02   -3.56  0.00066 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.47 on 72 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.461,  Adjusted R-squared:  0.408 </span></span>
<span><span class="co">#&gt; F-statistic: 8.79 on 7 and 72 DF,  p-value: 9.01e-08</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 57 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.898  -4.641  -0.468   4.317  11.419 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     2.39e+01   2.00e+01    1.19   0.2382   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -1.42e+01   1.31e+01   -1.09   0.2810   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.84e-01   1.33e-01   -2.13   0.0382 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -9.31e-02   4.54e-02   -2.05   0.0458 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  5.60e-01   2.60e-01    2.16   0.0360 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.62e+00   5.68e-01   -2.85   0.0063 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -9.45e-07   1.85e-06   -0.51   0.6115   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.57e-02   9.23e-02   -0.82   0.4160   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.08 on 49 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.518,  Adjusted R-squared:  0.449 </span></span>
<span><span class="co">#&gt; F-statistic: 7.52 on 7 and 49 DF,  p-value: 3.85e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 48 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.902  -4.574   0.071   1.872  15.372 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     4.99e+01   2.05e+01    2.43  0.01963 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -3.62e+00   1.37e+01   -0.26  0.79262    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.36e-02   9.85e-02   -0.24  0.81188    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.91e-01   4.59e-02   -4.15  0.00017 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4 -1.89e-01   2.28e-01   -0.83  0.41156    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -2.12e-01   4.93e-01   -0.43  0.66992    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.17e-06   2.12e-06    0.55  0.58230    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.83e-01   7.33e-02   -2.50  0.01681 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.29 on 40 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.608,  Adjusted R-squared:  0.54 </span></span>
<span><span class="co">#&gt; F-statistic: 8.88 on 7 and 40 DF,  p-value: 1.49e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 88 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.644  -4.213  -0.937   3.089  17.449 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     3.05e+00   1.09e+01    0.28   0.7808   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  3.55e+00   1.02e+01    0.35   0.7283   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  4.12e-02   7.81e-02    0.53   0.5988   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.08e-01   3.42e-02   -3.15   0.0023 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.53e-01   1.43e-01    1.77   0.0804 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  5.77e-02   3.52e-01    0.16   0.8701   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.69e-06   1.23e-06    1.37   0.1760   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -6.94e-02   7.45e-02   -0.93   0.3549   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.45 on 80 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.322,  Adjusted R-squared:  0.263 </span></span>
<span><span class="co">#&gt; F-statistic: 5.42 on 7 and 80 DF,  p-value: 4.05e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 93 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 4"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -8.158 -2.899 -0.019  2.037 11.950 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     2.89e+01   8.71e+00    3.32  0.00132 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  7.48e+00   6.60e+00    1.13  0.26056    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.26e-01   6.26e-02   -3.61  0.00052 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -5.36e-02   2.63e-02   -2.04  0.04466 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  3.31e-01   1.13e-01    2.94  0.00423 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  4.15e-01   2.18e-01    1.90  0.06021 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -3.14e-06   8.78e-07   -3.57  0.00059 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.39e-01   4.94e-02   -2.82  0.00593 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4 on 85 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.376,  Adjusted R-squared:  0.324 </span></span>
<span><span class="co">#&gt; F-statistic: 7.31 on 7 and 85 DF,  p-value: 7.51e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 104 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 5"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt;  -8.74  -1.97  -0.25   2.11   6.84 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    -1.66e-01   5.94e+00   -0.03  0.97773    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.76e+01   5.04e+00    3.50  0.00072 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.52e-01   3.72e-02    4.08  9.4e-05 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -7.93e-02   2.41e-02   -3.29  0.00139 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  6.75e-02   6.72e-02    1.00  0.31756    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -3.01e-02   1.41e-01   -0.21  0.83134    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -2.24e-07   4.56e-07   -0.49  0.62507    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7  5.04e-02   4.99e-02    1.01  0.31485    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.77 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.554,  Adjusted R-squared:  0.522 </span></span>
<span><span class="co">#&gt; F-statistic:   17 on 7 and 96 DF,  p-value: 1.82e-14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 42 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 6"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -12.11  -3.96   0.30   3.76  11.27 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)    -3.35e+00   1.67e+01   -0.20   0.8424   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  3.94e+01   1.72e+01    2.29   0.0284 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.95e-01   1.19e-01    1.63   0.1114   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.49e-01   4.20e-02   -3.55   0.0011 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.51e-01   2.08e-01    1.21   0.2364   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -9.25e-01   4.96e-01   -1.86   0.0709 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.68e-06   1.88e-06    0.89   0.3771   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.12e-02   6.74e-02   -1.06   0.2979   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.67 on 34 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.676,  Adjusted R-squared:  0.609 </span></span>
<span><span class="co">#&gt; F-statistic: 10.1 on 7 and 34 DF,  p-value: 8.98e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 82 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 7"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.936  -3.040   0.541   3.154  13.947 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     9.54e+00   1.31e+01    0.73  0.46869    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.55e+01   7.94e+00    1.95  0.05491 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.29e-01   8.91e-02    1.45  0.15115    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -3.44e-02   3.10e-02   -1.11  0.27096    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.29e-01   1.63e-01    1.40  0.16498    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -6.20e-01   3.53e-01   -1.76  0.08304 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.39e-07   1.22e-06    0.11  0.91002    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.89e-01   5.29e-02   -3.57  0.00064 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.41 on 74 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.509,  Adjusted R-squared:  0.462 </span></span>
<span><span class="co">#&gt; F-statistic: 10.9 on 7 and 74 DF,  p-value: 2.13e-09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 57 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.898  -4.641  -0.468   4.317  11.419 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     2.39e+01   2.00e+01    1.19   0.2382   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -1.42e+01   1.31e+01   -1.09   0.2810   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.84e-01   1.33e-01   -2.13   0.0382 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -9.31e-02   4.54e-02   -2.05   0.0458 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  5.60e-01   2.60e-01    2.16   0.0360 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.62e+00   5.68e-01   -2.85   0.0063 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -9.45e-07   1.85e-06   -0.51   0.6115   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.57e-02   9.23e-02   -0.82   0.4160   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.08 on 49 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.518,  Adjusted R-squared:  0.449 </span></span>
<span><span class="co">#&gt; F-statistic: 7.52 on 7 and 49 DF,  p-value: 3.85e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 48 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.902  -4.574   0.071   1.872  15.372 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     4.99e+01   2.05e+01    2.43  0.01963 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -3.62e+00   1.37e+01   -0.26  0.79262    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.36e-02   9.85e-02   -0.24  0.81188    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.91e-01   4.59e-02   -4.15  0.00017 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4 -1.89e-01   2.28e-01   -0.83  0.41156    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -2.12e-01   4.93e-01   -0.43  0.66992    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.17e-06   2.12e-06    0.55  0.58230    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.83e-01   7.33e-02   -2.50  0.01681 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.29 on 40 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.608,  Adjusted R-squared:  0.54 </span></span>
<span><span class="co">#&gt; F-statistic: 8.88 on 7 and 40 DF,  p-value: 1.49e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 88 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.644  -4.213  -0.937   3.089  17.449 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     3.05e+00   1.09e+01    0.28   0.7808   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  3.55e+00   1.02e+01    0.35   0.7283   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  4.12e-02   7.81e-02    0.53   0.5988   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.08e-01   3.42e-02   -3.15   0.0023 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.53e-01   1.43e-01    1.77   0.0804 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  5.77e-02   3.52e-01    0.16   0.8701   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.69e-06   1.23e-06    1.37   0.1760   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -6.94e-02   7.45e-02   -0.93   0.3549   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.45 on 80 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.322,  Adjusted R-squared:  0.263 </span></span>
<span><span class="co">#&gt; F-statistic: 5.42 on 7 and 80 DF,  p-value: 4.05e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 94 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 4"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -8.015 -3.029  0.085  2.113 12.001 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     2.87e+01   8.74e+00    3.29  0.00147 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  7.08e+00   6.61e+00    1.07  0.28726    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.32e-01   6.26e-02   -3.70  0.00037 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -5.51e-02   2.64e-02   -2.09  0.03959 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  3.45e-01   1.12e-01    3.07  0.00284 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  4.39e-01   2.18e-01    2.02  0.04696 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -3.24e-06   8.75e-07   -3.71  0.00037 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.37e-01   4.95e-02   -2.78  0.00670 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.02 on 86 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.382,  Adjusted R-squared:  0.331 </span></span>
<span><span class="co">#&gt; F-statistic: 7.58 on 7 and 86 DF,  p-value: 4.2e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 103 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 5"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -6.078 -2.076 -0.417  2.125  6.900 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     6.72e-01   5.63e+00    0.12  0.90530    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.85e+01   4.78e+00    3.87  0.00020 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.63e-01   3.55e-02    4.59  1.4e-05 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -7.89e-02   2.28e-02   -3.46  0.00082 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  6.72e-02   6.37e-02    1.05  0.29467    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -5.84e-02   1.34e-01   -0.44  0.66364    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -8.16e-08   4.34e-07   -0.19  0.85147    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7  3.29e-02   4.76e-02    0.69  0.49169    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.63 on 95 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.598,  Adjusted R-squared:  0.569 </span></span>
<span><span class="co">#&gt; F-statistic: 20.2 on 7 and 95 DF,  p-value: 2.27e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 41 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 6"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -12.122  -3.975   0.283   3.843  10.947 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)    -4.78e+00   1.71e+01   -0.28   0.7818   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  4.03e+01   1.75e+01    2.30   0.0276 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.97e-01   1.21e-01    1.63   0.1118   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.49e-01   4.24e-02   -3.51   0.0013 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.66e-01   2.12e-01    1.25   0.2194   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -9.16e-01   5.02e-01   -1.83   0.0769 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.91e-06   1.95e-06    0.98   0.3346   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.66e-02   6.89e-02   -1.11   0.2743   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.74 on 33 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.676,  Adjusted R-squared:  0.607 </span></span>
<span><span class="co">#&gt; F-statistic: 9.84 on 7 and 33 DF,  p-value: 1.43e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 83 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 7"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.939  -3.037   0.514   3.057  13.968 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     9.55e+00   1.30e+01    0.73  0.46531    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.55e+01   7.89e+00    1.96  0.05351 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.30e-01   8.83e-02    1.47  0.14639    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -3.42e-02   3.07e-02   -1.11  0.26958    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.28e-01   1.62e-01    1.41  0.16274    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -6.19e-01   3.50e-01   -1.77  0.08129 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.26e-07   1.21e-06    0.10  0.91757    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.88e-01   5.25e-02   -3.59  0.00059 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.37 on 75 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.51,   Adjusted R-squared:  0.464 </span></span>
<span><span class="co">#&gt; F-statistic: 11.2 on 7 and 75 DF,  p-value: 1.37e-09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 57 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.898  -4.641  -0.468   4.317  11.419 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     2.39e+01   2.00e+01    1.19   0.2382   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -1.42e+01   1.31e+01   -1.09   0.2810   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.84e-01   1.33e-01   -2.13   0.0382 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -9.31e-02   4.54e-02   -2.05   0.0458 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  5.60e-01   2.60e-01    2.16   0.0360 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -1.62e+00   5.68e-01   -2.85   0.0063 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -9.45e-07   1.85e-06   -0.51   0.6115   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.57e-02   9.23e-02   -0.82   0.4160   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.08 on 49 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.518,  Adjusted R-squared:  0.449 </span></span>
<span><span class="co">#&gt; F-statistic: 7.52 on 7 and 49 DF,  p-value: 3.85e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 48 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.902  -4.574   0.071   1.872  15.372 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     4.99e+01   2.05e+01    2.43  0.01963 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1 -3.62e+00   1.37e+01   -0.26  0.79262    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.36e-02   9.85e-02   -0.24  0.81188    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.91e-01   4.59e-02   -4.15  0.00017 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4 -1.89e-01   2.28e-01   -0.83  0.41156    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -2.12e-01   4.93e-01   -0.43  0.66992    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.17e-06   2.12e-06    0.55  0.58230    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.83e-01   7.33e-02   -2.50  0.01681 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.29 on 40 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.608,  Adjusted R-squared:  0.54 </span></span>
<span><span class="co">#&gt; F-statistic: 8.88 on 7 and 40 DF,  p-value: 1.49e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 88 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -13.644  -4.213  -0.937   3.089  17.449 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     3.05e+00   1.09e+01    0.28   0.7808   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  3.55e+00   1.02e+01    0.35   0.7283   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  4.12e-02   7.81e-02    0.53   0.5988   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.08e-01   3.42e-02   -3.15   0.0023 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.53e-01   1.43e-01    1.77   0.0804 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  5.77e-02   3.52e-01    0.16   0.8701   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.69e-06   1.23e-06    1.37   0.1760   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -6.94e-02   7.45e-02   -0.93   0.3549   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 6.45 on 80 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.322,  Adjusted R-squared:  0.263 </span></span>
<span><span class="co">#&gt; F-statistic: 5.42 on 7 and 80 DF,  p-value: 4.05e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 94 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 4"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -8.015 -3.029  0.085  2.113 12.001 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     2.87e+01   8.74e+00    3.29  0.00147 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  7.08e+00   6.61e+00    1.07  0.28726    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2 -2.32e-01   6.26e-02   -3.70  0.00037 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -5.51e-02   2.64e-02   -2.09  0.03959 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  3.45e-01   1.12e-01    3.07  0.00284 ** </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5  4.39e-01   2.18e-01    2.02  0.04696 *  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -3.24e-06   8.75e-07   -3.71  0.00037 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.37e-01   4.95e-02   -2.78  0.00670 ** </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.02 on 86 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.382,  Adjusted R-squared:  0.331 </span></span>
<span><span class="co">#&gt; F-statistic: 7.58 on 7 and 86 DF,  p-value: 4.2e-07</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 103 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 5"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -6.078 -2.076 -0.417  2.125  6.900 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     6.72e-01   5.63e+00    0.12  0.90530    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.85e+01   4.78e+00    3.87  0.00020 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.63e-01   3.55e-02    4.59  1.4e-05 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -7.89e-02   2.28e-02   -3.46  0.00082 ***</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  6.72e-02   6.37e-02    1.05  0.29467    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -5.84e-02   1.34e-01   -0.44  0.66364    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6 -8.16e-08   4.34e-07   -0.19  0.85147    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7  3.29e-02   4.76e-02    0.69  0.49169    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 2.63 on 95 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.598,  Adjusted R-squared:  0.569 </span></span>
<span><span class="co">#&gt; F-statistic: 20.2 on 7 and 95 DF,  p-value: 2.27e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 41 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 6"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -12.122  -3.975   0.283   3.843  10.947 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)    -4.78e+00   1.71e+01   -0.28   0.7818   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  4.03e+01   1.75e+01    2.30   0.0276 * </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.97e-01   1.21e-01    1.63   0.1118   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -1.49e-01   4.24e-02   -3.51   0.0013 **</span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.66e-01   2.12e-01    1.25   0.2194   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -9.16e-01   5.02e-01   -1.83   0.0769 . </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.91e-06   1.95e-06    0.98   0.3346   </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -7.66e-02   6.89e-02   -1.11   0.2743   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.74 on 33 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.676,  Adjusted R-squared:  0.607 </span></span>
<span><span class="co">#&gt; F-statistic: 9.84 on 7 and 33 DF,  p-value: 1.43e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [1] "length sepanjang 83 dan p + 1 sebesar 9"</span></span>
<span><span class="co">#&gt; [1] "Sekarang adalah gerombol ke- 7"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = Y[Ind == g] ~ X[Ind == g, ])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.939  -3.037   0.514   3.057  13.968 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     9.55e+00   1.30e+01    0.73  0.46531    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]1  1.55e+01   7.89e+00    1.96  0.05351 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]2  1.30e-01   8.83e-02    1.47  0.14639    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]3 -3.42e-02   3.07e-02   -1.11  0.26958    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]4  2.28e-01   1.62e-01    1.41  0.16274    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]5 -6.19e-01   3.50e-01   -1.77  0.08129 .  </span></span>
<span><span class="co">#&gt; X[Ind == g, ]6  1.26e-07   1.21e-06    0.10  0.91757    </span></span>
<span><span class="co">#&gt; X[Ind == g, ]7 -1.88e-01   5.25e-02   -3.59  0.00059 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 5.37 on 75 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.51,   Adjusted R-squared:  0.464 </span></span>
<span><span class="co">#&gt; F-statistic: 11.2 on 7 and 75 DF,  p-value: 1.37e-09</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Peubah-Peubah signifikan di tiap gerombolnya adalah sebagai berikut:</p>
<ul>
<li>Gerombol 1: <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_3\)</span>, <span class="math inline">\(X_4\)</span>, <span class="math inline">\(X_6\)</span>
</li>
<li>Gerombol 2: <span class="math inline">\(X_3\)</span>, <span class="math inline">\(X_8\)</span>
</li>
<li>Gerombol 3: <span class="math inline">\(X_3\)</span>
</li>
<li>Gerombol 4: <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_3\)</span>, <span class="math inline">\(X_4\)</span>, <span class="math inline">\(X_6\)</span>, <span class="math inline">\(X_7\)</span>, <span class="math inline">\(X_8\)</span>
</li>
<li>Gerombol 5: <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_3\)</span>
</li>
<li>Gerombol 6: <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_3\)</span>
</li>
<li>Gerombol 7: <span class="math inline">\(X_8\)</span>
</li>
</ul>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-agustina2015" class="csl-entry" role="listitem">
Agustina, M., Wasono, R., &amp; Darsyah, M. (2015). Pemodelan geographically weighted regression (GWR) pada tingkat kemiskinan di provinsi jawa tengah. <em>Jurnal Statistika</em>, <em>3</em>.
</div>
<div id="ref-james2013" class="csl-entry" role="listitem">
James, G. M., Witten, D., Hastle, T., &amp; Tibshirani, R. (2013). <em>An introduction to statistical learning: With applications in r</em> (5th ed.). Springer.
</div>
<div id="ref-li2018" class="csl-entry" role="listitem">
Li, F., &amp; Sang, H. (2018). Spatial homogeneity pursuit of regression coefficients for large datasets. <em>Journal of the American Statistical Association</em>, <em>114</em>, 1–37. <a href="https://doi.org/10.1080/01621459.2018.1529595">https://doi.org/10.1080/01621459.2018.1529595</a>
</div>
<div id="ref-putri2021" class="csl-entry" role="listitem">
Putri, S. A. H., &amp; Hajarisman, N. (2021). Pemodelan data kemiskinan di provinsi jawa barat menggunakan metode geographically weighted regression (GWR) dengan fungsi pembobot kernel bi-square. <em>Prosiding Statistika</em>, <em>7</em>(1), 208–215.
</div>
<div id="ref-rahmawati2010" class="csl-entry" role="listitem">
Rahmawati, R., &amp; Djuraidah, A. (2010). Regresi terboboti geografis dengan pembobot kernel kuadrat ganda untuk data kemiskinan di kabupaten jember. <em>Forum Statistika Dan Komputasi</em>, <em>15</em>(2), 32–37.
</div>
<div id="ref-rahmawati2011" class="csl-entry" role="listitem">
Rahmawati, R., &amp; Djuraidah, A. (2011). Analisis geographically weighted regression (GWR) dengan pembobot kernel gaussian untuk data kemiskinan. <em>Prosiding Seminar Nasional Statistik</em>, 326–322.
</div>
<div id="ref-ritonga2022" class="csl-entry" role="listitem">
Ritonga, N. S., Angraini, Y., &amp; Susetyo, B. (2022). Penerapan metode geographically weighted regression (GWR) pada kasus kriminalitas di provinsi sumatera utara tahun 2020. In <em>[skripsi]</em>. Institut Pertanian Bogor.
</div>
<div id="ref-sayidar2024" class="csl-entry" role="listitem">
Sayidar, A. M., Djuraidah, A., &amp; Sadik, K. (2024). Penerapan regresi gerombol spasial pada data kemiskinan indonesia tahun 2022. In <em>[skripsi]</em>. Institut Pertanian Bogor.
</div>
<div id="ref-sugasawa2021" class="csl-entry" role="listitem">
Sugasawa, S., &amp; Murakami, D. (2021). <em>Spatially clustered regression</em>. <em>44</em>, 100525.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/statistika-spasial\.github\.io\/book");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./ModelEpidemiologi.html" class="pagination-link" aria-label="Model Epidemiologi">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Model Epidemiologi</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="Referensi">
        <span class="nav-page-text">Referensi</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb114" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regresi Spasial Gerombol {#sec-spatclusreg .unnumbered}</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deskripsi</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>Regresi gerombol spasial (*Spatially Clustered Regression*) merupakan pengembangan dari metode regresi terboboti geografis (RTGT) yang digabungkan dengan analisis gerombol <span class="co">[</span><span class="ot">@sugasawa2021</span><span class="co">]</span>. Perpaduan antara analisis gerombol dengan regresi spasial memberikan interpretasi yang lebih sederhana pada model lokal <span class="co">[</span><span class="ot">@li2018</span><span class="co">]</span>. Metode ini menghasilkan satu model regresi pada setiap gerombol. </span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>Model regresi gerombol spasial sebagai berikut</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>y_i = \beta_0(g_i)  + \sum_k \beta_k (g_i) x_{ik} + \epsilon_i </span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1301}</span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a>dengan:</span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>  y_i &amp;: \text{nilai amatan peubah respon gerombol ke-i} <span class="sc">\\</span></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>  g_i &amp;: \text{gerombol ke-i} <span class="sc">\\</span></span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>  \beta_0 (g_i) &amp;: \text{konstanta/intersep pada gerombol ke-i} <span class="sc">\\</span></span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>  \beta_i (g_i) &amp;: \text{koefisien regresi peubah penjelas ke-p pada gerombol ke-i} <span class="sc">\\</span></span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>  X_{ip} &amp;: \text{peubah penjelas ke-p pada gerombol ke-i} <span class="sc">\\</span></span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>  \epsilon_i &amp;: \text{galat pada gerombol ke-i}</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>Sebelum mendapatkan model regresi gerombol spasial, pertama-tama dilakukan inisiasi gerombol awal $g_0$ dan nilai beta awal $\theta_0=(\beta_0 (g_i ), \beta_i (g_i))$. Gerombol awal didapatkan melalui metode K-means berdasarkan koordinat kabupaten/kota di Indonesia. Nilai beta awal diinisiasi dengan membentuk matriks **0** berukuran $p×G$, dengan $p$ merupakan banyaknya koefisien beta dan $G$ merupakan banyaknya gerombol yang ingin dibentuk. Ragam dalam gerombol diformulakan sebagai</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>W(C_k) = \sum_{x_i\in C_k} (x_i - \mu_k) ^2</span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1302}</span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>Sehingga total ragam dalam gerombol (TRG), yaitu:</span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a>TRG = \sum_{k=1}^k W(C_k) = \sum_{k=1}^k \sum_{x_i\in C_k} (x_i - \mu_k) ^2</span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1303}</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>dengan:</span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a>x_i : &amp; \ \text{amatan dalam klaster }C_k <span class="sc">\\</span></span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>\mu_k : &amp; \ \text{rataan dari amatan pada gerombol }C_k</span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a>Penentuan amatan dalam gerombol menggunakan fungsi likelihood terpenalti. Nilai parameter pada setiap gerombol bernilai sama. Fungsi penalti likelihood memiliki formula sebagai berikut:</span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a>Q(\theta,g) ≡ \sum_{i=1}^n log f (y_i | x_i;\theta_(g_i)) + \phi \sum_{i&lt;j} w_{ij} I(g_i=g_j)</span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1304}</span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true" tabindex="-1"></a>dengan:</span>
<span id="cb114-65"><a href="#cb114-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-66"><a href="#cb114-66" aria-hidden="true" tabindex="-1"></a>\begin{align*}</span>
<span id="cb114-67"><a href="#cb114-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-68"><a href="#cb114-68" aria-hidden="true" tabindex="-1"></a>  Q(\theta,g) : &amp; \ \text{fungsi objektif likelihood terpenalti nilai peubah penjelas bagi beta pada gerombol g} <span class="sc">\\</span></span>
<span id="cb114-69"><a href="#cb114-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-70"><a href="#cb114-70" aria-hidden="true" tabindex="-1"></a>  f (y_i | x_i;\theta_(g_i)) : &amp; \ \text{fungsi likelihood peubah respons dan penjelas saat gerombol ke-i} <span class="sc">\\</span></span>
<span id="cb114-71"><a href="#cb114-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-72"><a href="#cb114-72" aria-hidden="true" tabindex="-1"></a>  \phi : &amp; \ \text{kekuatan hubungan spasial yang diberi nilai 1 } <span class="sc">\\</span></span>
<span id="cb114-73"><a href="#cb114-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-74"><a href="#cb114-74" aria-hidden="true" tabindex="-1"></a>  w_{ij} : &amp; \ \text{nilai fungsi pembobot} <span class="sc">\\</span></span>
<span id="cb114-75"><a href="#cb114-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-76"><a href="#cb114-76" aria-hidden="true" tabindex="-1"></a>  I(g_i=g_j) : &amp; \ \text{matriks indeks dengan unsur bernilai 1 untuk amatan dengan gerombol }g_i=g_j</span>
<span id="cb114-77"><a href="#cb114-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-78"><a href="#cb114-78" aria-hidden="true" tabindex="-1"></a>\end{align*}</span>
<span id="cb114-79"><a href="#cb114-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-80"><a href="#cb114-80" aria-hidden="true" tabindex="-1"></a>Nilai inisiasi gerombol $g_0$ dan nilai beta $\beta_0$ dimasukan ke dalam fungsi likelihood  terpenalti (@eq-1304) untuk menentukan amatan berada pada gerombol. Nilai $g_k$ dan $\beta_k$ diperbaiki pada setiap iterasi-k hingga mendapatkan anggota $g_k$ dan nilai $\beta_k$ yang memaksimumkan fungsi likelihood terpenalti. Konvergensi didapatkan ketika perbedaan nilai saat ini dan nilai hasil pembaharuan lebih kecil dari nilai toleransi $\epsilon$. Nilai toleransi ditetapkan bernilai $\epsilon=10^{-6}$ <span class="co">[</span><span class="ot">@sugasawa2021</span><span class="co">]</span>. </span>
<span id="cb114-81"><a href="#cb114-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-82"><a href="#cb114-82" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb114-83"><a href="#cb114-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-84"><a href="#cb114-84" aria-hidden="true" tabindex="-1"></a>Penelitian ini mengacu pada @sayidar2024. Data yang digunakan dalam penelitian ini merupakan data sekunder yang bersumber dari hasil publikasi Badan Pusat Statistik mengenai indikator kemiskinan di Indonesia tahun 2022. Unit pengamatan berupa 514 kabupaten/kota di Indonesia, satu peubah respons, dan delapan peubah penjelas. Peubah-Peubah yang digunakan dalam penelitian ini tertera pada @tbl-gerombol.</span>
<span id="cb114-85"><a href="#cb114-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-86"><a href="#cb114-86" aria-hidden="true" tabindex="-1"></a>| Peubah | Keterangan                                              | Satuan             | Referensi               |</span>
<span id="cb114-87"><a href="#cb114-87" aria-hidden="true" tabindex="-1"></a>|--------|---------------------------------------------------------|--------------------|-------------------------|</span>
<span id="cb114-88"><a href="#cb114-88" aria-hidden="true" tabindex="-1"></a>| $(x,y)$  | Koordinat kabupaten/kota                              | Bujur, lintang     | -                       |</span>
<span id="cb114-89"><a href="#cb114-89" aria-hidden="true" tabindex="-1"></a>| $y$      | Persentase penduduk miskin                            | %                  | -                       |</span>
<span id="cb114-90"><a href="#cb114-90" aria-hidden="true" tabindex="-1"></a>| $x_1$    | Banyak sarana kesehatan per jumlah penduduk            | %                 | @rahmawati2010     |</span>
<span id="cb114-91"><a href="#cb114-91" aria-hidden="true" tabindex="-1"></a>| $x_2$    | Persentase penduduk yang mempunyai pendidikan &lt; SMA    | %                 | -                   |</span>
<span id="cb114-92"><a href="#cb114-92" aria-hidden="true" tabindex="-1"></a>| $x_3$    | Persentase rumah tangga yang menggunakan air minum layak|%                 | @rahmawati2011            |</span>
<span id="cb114-93"><a href="#cb114-93" aria-hidden="true" tabindex="-1"></a>| $x_4$    | Persentase pengeluaran per kapita untuk makanan         | %                | Damayanti dan Ratnasari (2013)      |</span>
<span id="cb114-94"><a href="#cb114-94" aria-hidden="true" tabindex="-1"></a>| $x_5$    | Indeks pembangunan manusia                              | -                | @putri2021                   |</span>
<span id="cb114-95"><a href="#cb114-95" aria-hidden="true" tabindex="-1"></a>| $x_6$    | Tingkat pengangguran terbuka                            | %                | @putri2021                   |</span>
<span id="cb114-96"><a href="#cb114-96" aria-hidden="true" tabindex="-1"></a>| $x_7$    | Upah minimum kerja                                      | Rp               | @agustina2015            |</span>
<span id="cb114-97"><a href="#cb114-97" aria-hidden="true" tabindex="-1"></a>| $x_8$    | Persentase rumah tangga dengan Jamban sendiri           | %                | @agustina2015            |</span>
<span id="cb114-98"><a href="#cb114-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-99"><a href="#cb114-99" aria-hidden="true" tabindex="-1"></a>: Peubah yang digunakan {#tbl-gerombol .striped .hover}</span>
<span id="cb114-100"><a href="#cb114-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-101"><a href="#cb114-101" aria-hidden="true" tabindex="-1"></a>Peubah yang digunakan pada penelitian ini merupakan referensi dari penelitian-penelitian terdahulu yang menggunakan metode Regresi Terboboti Geografis, di antaranya dilakukan oleh Rahmawati &amp; Djuraidah <span class="co">[</span><span class="ot">-@rahmawati2010;-@rahmawati2011</span><span class="co">]</span> yang menunjukkan peubah, banyaknya sarana kesehatan dan persentase rumah tangga yang menggunakan air minum layak. Peubah persentase penduduk yang mempunyai pendidikan di bawah SMA merupakan hal baru yang sebelumnya oleh @rahmawati2010 diketahui bahwa persentase penduduk yang mempunyai pendidikan di bawah SD berpengaruh terhadap tingkat kemiskinan. Kemudian, @putri2021 menunjukkan peubah IPM dan TPT berpengaruh terhadap kemiskinan. Terakhir, penelitian @agustina2015 menunjukkan faktor upah minimum kerja (UMK) dan persentase rumah tangga memiliki jamban sendiri berpengaruh terhadap model. Peubah-Peubah signifikan pada model Regresi Terboboti Geografis tersebut dijadikan acuan peubah-peubah yang digunakan pada model Regresi Gerombol Spasial.</span>
<span id="cb114-102"><a href="#cb114-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-103"><a href="#cb114-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-104"><a href="#cb114-104" aria-hidden="true" tabindex="-1"></a><span class="fu">## Metode Penelitian</span></span>
<span id="cb114-105"><a href="#cb114-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-106"><a href="#cb114-106" aria-hidden="true" tabindex="-1"></a>Analisis pada penelitian ini dilakukan dengan bantuan perangkat lunak RStudio. Tahapan analisis yang dilakukan adalah sebagai berikut:</span>
<span id="cb114-107"><a href="#cb114-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-108"><a href="#cb114-108" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Melakukan *preprocessing* data berupa penyesuaian format data, yaitu bentuk tabel agar sesuai dengan keperluan analisis dan penanganan *missing value* menggunakan **Group Mean Imputation** di mana provinsi didefinisikan sebagai sebuah grup.</span>
<span id="cb114-109"><a href="#cb114-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-110"><a href="#cb114-110" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Melakukan eksplorasi data untuk mengetahui karakteristik data tingkat kemiskinan kabupaten/kota di Indonesia secara umum. Eksplorasi data yang dilakukan adalah sebagai berikut:</span>
<span id="cb114-111"><a href="#cb114-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-112"><a href="#cb114-112" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Analisis deskriptif peubah respons dan peubah penjelas. Berupa ringkasan data dan ukuran penyebaran data peubah-peubah.</span>
<span id="cb114-113"><a href="#cb114-113" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Peta tematik untuk melihat pola sebaran peubah respons di setiap amatan</span>
<span id="cb114-114"><a href="#cb114-114" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Boxplot untuk mengetahui pencilan, sebaran, dan karakteristik pada peubah respons. Boxplot dapat digunakan sebagai indikasi awal apakah terdapat efek spasial dalam data, yaitu daerah pencilan yang menunjukkan bahwa nilai dari peubah cukup bervariasi <span class="co">[</span><span class="ot">@ritonga2022</span><span class="co">]</span>.</span>
<span id="cb114-115"><a href="#cb114-115" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Korelasi data antara peubah respons dan peubah penjelas. Korelasi digunakan untuk menggambarkan hubungan linear antarpeubah.</span>
<span id="cb114-116"><a href="#cb114-116" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb114-117"><a href="#cb114-117" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Melakukan pengecekan asumsi galat regresi sebagai berikut:</span>
<span id="cb114-118"><a href="#cb114-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-119"><a href="#cb114-119" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Pengecekan normalitas menggunakan uji Shapiro-Wilk</span>
<span id="cb114-120"><a href="#cb114-120" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Pengecekan autokorelasi menggunakan uji Durbin-Watson</span>
<span id="cb114-121"><a href="#cb114-121" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Pengecekan heteroskedastisitas menggunakan uji Breusch-Pagan</span>
<span id="cb114-122"><a href="#cb114-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-123"><a href="#cb114-123" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Melakukan pengecekan asumsi multikolinearitas pada seluruh peubah penjelas menggunakan nilai *variance inflation factor* (VIF). Jika terdapat peubah penjelas yang terdeteksi mengandung multikolinearitas, peubah penjelas tersebut dibuang dari model. VIF di atas 5 dianggap mengandung multikolinearitas <span class="co">[</span><span class="ot">@james2013</span><span class="co">]</span></span>
<span id="cb114-124"><a href="#cb114-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-125"><a href="#cb114-125" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Melakukan uji efek spasial, yaitu uji asumsi keragaman spasial menggunakan uji Moran dan uji asumsi heterogenitas spasial menggunakan uji Breusch-Pagan. Jika salah satu dari kedua uji tersebut menunjukkan terdapat efek spasial maka dapat dilanjutkan melakukan analisis Regresi Gerombol Spasial. </span>
<span id="cb114-126"><a href="#cb114-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-127"><a href="#cb114-127" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Membentuk matriks jarak menggunakan jarak ecludian antar dua kabupaten/kota berdasarkan koordinat amatan dan matriks pembobot spasial menggunakan fungsi pembobot jarak ambang, fungsi pembobot eksponensial, fungsi pembobot *3-nearest neighboor*, fungsi pembobot *4-nearest neighbor*, fungsi pembobot *5-nearest neighbor*, fungsi *invers distance weight* $(\alpha=1)$, fungsi *invers distance weight* $(\alpha=2)$, *rock contiguity*, dan *queen contiguity*.</span>
<span id="cb114-128"><a href="#cb114-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-129"><a href="#cb114-129" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Inisiasi anggota gerombol awal $g_0$ untuk total gerombol $G \in {3,4,5,6,…,15}$ menggunakan algoritma *K-means clustering*. Klaster atau gerombol dibentuk menggunakan data latitude dan longitude tiap lokasi amatan.</span>
<span id="cb114-130"><a href="#cb114-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-131"><a href="#cb114-131" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Inisiasi nilai beta awal $\beta_0$ sesuai banyaknya amatan $n$ dan gerombol $G$. Di mana $\beta_0$ merupakan matriks berdimensi $n×G$ dengan unsur bernilai 1 pada setiap baris dan kolomnya.</span>
<span id="cb114-132"><a href="#cb114-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-133"><a href="#cb114-133" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Melakukan *penalty likelihood* melalui fungsi objektif @eq-1304 untuk menggerombolkan data amatan. *Penalty likelihood* berfungsi untuk mendapatkan nilai parameter beta duga dan anggota gerombol akhir di mana menggunakan gerombol inisiasi awal *K-Means* ditambah matriks pembobot spasial sehingga didapatkan model Regresi Gerombol Spasial sebanyak 117 kombinasi. Fungsi objektif *penalty likelihood* dioptimasi berdasarkan Langkah-langkah berikut:</span>
<span id="cb114-134"><a href="#cb114-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-135"><a href="#cb114-135" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Inisiasi nilai parameter beta awal $\beta_0$ dan anggota gerombol awal $g_0$</span>
<span id="cb114-136"><a href="#cb114-136" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Perbaharui nilai parameter ke-k $\beta_k$ untuk setiap gerombol $g=1,2,3,…,G$ </span>
<span id="cb114-137"><a href="#cb114-137" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Perbaharui anggota gerombol ke-k $g_k$ untuk setiap gerombol $g=1,2,3,…,G$ </span>
<span id="cb114-138"><a href="#cb114-138" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>Ulangi langkah hingga konvergen</span>
<span id="cb114-139"><a href="#cb114-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-140"><a href="#cb114-140" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Menentukan model terbaik dari masing-masing pembobot spasial sekaligus mendapatkan $G$ gerombol optimum menggunakan *information criterion*.</span>
<span id="cb114-141"><a href="#cb114-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-142"><a href="#cb114-142" aria-hidden="true" tabindex="-1"></a><span class="ss">11. </span>Melakukan uji kebaikan model menggunakan mean absolute error (MAE), mean absolute percentage error (MAPE) dan root mean square error (RMSE) untuk model terbaik berdasarkan masing-masing fungsi pembobot pada Langkah 10.</span>
<span id="cb114-143"><a href="#cb114-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-144"><a href="#cb114-144" aria-hidden="true" tabindex="-1"></a><span class="ss">12. </span>Melakukan analisis sidik ragam atau ANOVA pada model terbaik hasil uji kebaikan model untuk mengetahui perbedaan gerombol pada tingkat kemiskinan. Kemudian, dilanjutkan melakukan uji lanjut Tukey model.</span>
<span id="cb114-145"><a href="#cb114-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-146"><a href="#cb114-146" aria-hidden="true" tabindex="-1"></a><span class="ss">13. </span>Uji peubah berpengaruh tiap gerombol spasial menggunakan uji parsial atau uji t.</span>
<span id="cb114-147"><a href="#cb114-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-148"><a href="#cb114-148" aria-hidden="true" tabindex="-1"></a><span class="ss">14. </span>Penarikan interpretasi dan kesimpulan.</span>
<span id="cb114-149"><a href="#cb114-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-150"><a href="#cb114-150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tahapan Analisis dengan R</span></span>
<span id="cb114-151"><a href="#cb114-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-152"><a href="#cb114-152" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package</span></span>
<span id="cb114-153"><a href="#cb114-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-154"><a href="#cb114-154" aria-hidden="true" tabindex="-1"></a>Pertama-tama perlu memanggil fungsi untuk memodelkan Regresi Gerombol Spasial menggunanakan fungsi <span class="in">`SCR()`</span> dan fungsi untuk mendapatkan gerombol optimum menggunakan fungsi <span class="in">`SCR.select()`</span>. Metode Regresi Gerombol Spasial dapat diimplementasikan ke dalam beragam jenis data, yaitu *family gaussian*, *family poisson*, dan *family binomial negative*. Selanjutnya, metode Regresi Gerombol Spasial memiliki dua opsi jenis penggerombolan, yaitu opsi *K-means* dan opsi *Fuzzy*, tetapi secara umum opsi *K-means* sudah cukup memberikan gerombol dengan pola yang cukup baik. Di mana langkah-langkah singkat penggunaan metode ini ialah sebagai berikut:</span>
<span id="cb114-155"><a href="#cb114-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-156"><a href="#cb114-156" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Eksplorasi data</span>
<span id="cb114-157"><a href="#cb114-157" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>uji asumsi galat</span>
<span id="cb114-158"><a href="#cb114-158" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>deteksi multikolinearitas</span>
<span id="cb114-159"><a href="#cb114-159" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>deteksi efek spasial</span>
<span id="cb114-160"><a href="#cb114-160" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>membentuk matriks pembobot spasial</span>
<span id="cb114-161"><a href="#cb114-161" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>membentuk inisiasi gerombol awal menggunakan k-means</span>
<span id="cb114-162"><a href="#cb114-162" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Memodelkan Regresi Gerombol Spasial dengan fungsi objektif *penalty likelihood* untuk mengoptimumkan jumlah amatan di tiap gerombol dan nilai parameter beta duga. Model dengan gerombol optimum untuk masing-masing pembobot spasial dilihat melalui nilai *information criterion* pada fungsi <span class="in">`SCR.select()`</span></span>
<span id="cb114-163"><a href="#cb114-163" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Membandingkan model terbaik pada pembobot yang berbeda menggunakan dua kriteria, yaitu:</span>
<span id="cb114-164"><a href="#cb114-164" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Uji kebaikan model (MAE, MAPE, dan RMSE) serta,</span>
<span id="cb114-165"><a href="#cb114-165" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Pola gerombol pada peta yang berpola atau tidak acak (subjektif)</span>
<span id="cb114-166"><a href="#cb114-166" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Melakukan analisis sidik ragam mengetahui perbedaan peubah $Y$ di tiap gerombol yang terbentuk dari model terbaik</span>
<span id="cb114-167"><a href="#cb114-167" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Uji peubah berpengaruh di setiap gerombol</span>
<span id="cb114-168"><a href="#cb114-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-169"><a href="#cb114-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load func, cache=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb114-170"><a href="#cb114-170" aria-hidden="true" tabindex="-1"></a><span class="in">## packages</span></span>
<span id="cb114-171"><a href="#cb114-171" aria-hidden="true" tabindex="-1"></a><span class="in">library(SparseM)</span></span>
<span id="cb114-172"><a href="#cb114-172" aria-hidden="true" tabindex="-1"></a><span class="in">library(MASS)</span></span>
<span id="cb114-173"><a href="#cb114-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-174"><a href="#cb114-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-175"><a href="#cb114-175" aria-hidden="true" tabindex="-1"></a><span class="in">###  Spatially clustered regression (with LASSO)   ###</span></span>
<span id="cb114-176"><a href="#cb114-176" aria-hidden="true" tabindex="-1"></a><span class="in">## Input</span></span>
<span id="cb114-177"><a href="#cb114-177" aria-hidden="true" tabindex="-1"></a><span class="in"># Y: n-dimensional response vector </span></span>
<span id="cb114-178"><a href="#cb114-178" aria-hidden="true" tabindex="-1"></a><span class="in"># X: (n,p)-matrix of covariates (p: number of covariates)</span></span>
<span id="cb114-179"><a href="#cb114-179" aria-hidden="true" tabindex="-1"></a><span class="in"># W: (n,n)-matrix of spatial weight</span></span>
<span id="cb114-180"><a href="#cb114-180" aria-hidden="true" tabindex="-1"></a><span class="in"># Sp: (n,2)-matrix of location information </span></span>
<span id="cb114-181"><a href="#cb114-181" aria-hidden="true" tabindex="-1"></a><span class="in"># G: number of groups </span></span>
<span id="cb114-182"><a href="#cb114-182" aria-hidden="true" tabindex="-1"></a><span class="in"># Phi: tuning parameter for spatial similarity </span></span>
<span id="cb114-183"><a href="#cb114-183" aria-hidden="true" tabindex="-1"></a><span class="in"># offset: n-dimensional vector of offset term (applicable only to "poisson" and "NB")</span></span>
<span id="cb114-184"><a href="#cb114-184" aria-hidden="true" tabindex="-1"></a><span class="in"># fuzzy: if True, SFCR is applied</span></span>
<span id="cb114-185"><a href="#cb114-185" aria-hidden="true" tabindex="-1"></a><span class="in"># maxitr: maximum number of iterations</span></span>
<span id="cb114-186"><a href="#cb114-186" aria-hidden="true" tabindex="-1"></a><span class="in"># family: distribution family ("gaussian", "poisson" or "NB)</span></span>
<span id="cb114-187"><a href="#cb114-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-188"><a href="#cb114-188" aria-hidden="true" tabindex="-1"></a><span class="in">## Output</span></span>
<span id="cb114-189"><a href="#cb114-189" aria-hidden="true" tabindex="-1"></a><span class="in"># Beta: (G,p)-matrix of group-wise regression coefficients</span></span>
<span id="cb114-190"><a href="#cb114-190" aria-hidden="true" tabindex="-1"></a><span class="in"># Sig: G-dimensional vector of group-wise standard deviations (only for "gaussian" and "NB")</span></span>
<span id="cb114-191"><a href="#cb114-191" aria-hidden="true" tabindex="-1"></a><span class="in"># group: n-dimensional vector of group assignment </span></span>
<span id="cb114-192"><a href="#cb114-192" aria-hidden="true" tabindex="-1"></a><span class="in"># sBeta: (n,p)-matrix of location-wise regression coefficients</span></span>
<span id="cb114-193"><a href="#cb114-193" aria-hidden="true" tabindex="-1"></a><span class="in"># sSig: n-dimensional vector of location-wise standard deviations (only for "gaussian")</span></span>
<span id="cb114-194"><a href="#cb114-194" aria-hidden="true" tabindex="-1"></a><span class="in"># s: n-dimensional vector of location-wise standard deviations (only for "gaussian")</span></span>
<span id="cb114-195"><a href="#cb114-195" aria-hidden="true" tabindex="-1"></a><span class="in"># ML: maximum log-likelihood</span></span>
<span id="cb114-196"><a href="#cb114-196" aria-hidden="true" tabindex="-1"></a><span class="in"># itr: number of iterations </span></span>
<span id="cb114-197"><a href="#cb114-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-198"><a href="#cb114-198" aria-hidden="true" tabindex="-1"></a><span class="in">## Remark</span></span>
<span id="cb114-199"><a href="#cb114-199" aria-hidden="true" tabindex="-1"></a><span class="in"># matrix X should not include an intercept term</span></span>
<span id="cb114-200"><a href="#cb114-200" aria-hidden="true" tabindex="-1"></a><span class="in"># initial grouping is determined by K-means of spatial locations</span></span>
<span id="cb114-201"><a href="#cb114-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-202"><a href="#cb114-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-203"><a href="#cb114-203" aria-hidden="true" tabindex="-1"></a><span class="in">## Main function </span></span>
<span id="cb114-204"><a href="#cb114-204" aria-hidden="true" tabindex="-1"></a><span class="in">SCR &lt;- function(Y, X, W, Sp, G=5, Phi=1, offset=NULL, fuzzy=F, maxitr=100, delta=1, family="gaussian"){</span></span>
<span id="cb114-205"><a href="#cb114-205" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Preparations</span></span>
<span id="cb114-206"><a href="#cb114-206" aria-hidden="true" tabindex="-1"></a><span class="in">  ep &lt;- 10^(-5)      # convergence criterion </span></span>
<span id="cb114-207"><a href="#cb114-207" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- as.matrix(X)</span></span>
<span id="cb114-208"><a href="#cb114-208" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- dim(X)[1]     # number of samples</span></span>
<span id="cb114-209"><a href="#cb114-209" aria-hidden="true" tabindex="-1"></a><span class="in">  p &lt;- dim(X)[2]+1   # number of regression coefficients</span></span>
<span id="cb114-210"><a href="#cb114-210" aria-hidden="true" tabindex="-1"></a><span class="in">  XX &lt;- as.matrix( cbind(1,X) )</span></span>
<span id="cb114-211"><a href="#cb114-211" aria-hidden="true" tabindex="-1"></a><span class="in">  W &lt;- as(W, "sparseMatrix")</span></span>
<span id="cb114-212"><a href="#cb114-212" aria-hidden="true" tabindex="-1"></a><span class="in">  if(is.null(offset)){ offset &lt;- rep(0, n) }</span></span>
<span id="cb114-213"><a href="#cb114-213" aria-hidden="true" tabindex="-1"></a><span class="in">  nmax &lt;- function(x){ max(na.omit(x)) }   # new max function </span></span>
<span id="cb114-214"><a href="#cb114-214" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-215"><a href="#cb114-215" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Initial values</span></span>
<span id="cb114-216"><a href="#cb114-216" aria-hidden="true" tabindex="-1"></a><span class="in">  M &lt;- 20  # the number of initial values of k-means</span></span>
<span id="cb114-217"><a href="#cb114-217" aria-hidden="true" tabindex="-1"></a><span class="in">  WSS &lt;- c()</span></span>
<span id="cb114-218"><a href="#cb114-218" aria-hidden="true" tabindex="-1"></a><span class="in">  CL &lt;- list()</span></span>
<span id="cb114-219"><a href="#cb114-219" aria-hidden="true" tabindex="-1"></a><span class="in">  for(k in 1:M){</span></span>
<span id="cb114-220"><a href="#cb114-220" aria-hidden="true" tabindex="-1"></a><span class="in">    set.seed(123)</span></span>
<span id="cb114-221"><a href="#cb114-221" aria-hidden="true" tabindex="-1"></a><span class="in">    CL[[k]] &lt;- kmeans(Sp, G)</span></span>
<span id="cb114-222"><a href="#cb114-222" aria-hidden="true" tabindex="-1"></a><span class="in">    WSS[k] &lt;- CL[[k]]$tot.withinss</span></span>
<span id="cb114-223"><a href="#cb114-223" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-224"><a href="#cb114-224" aria-hidden="true" tabindex="-1"></a><span class="in">  Ind &lt;- CL[[which.min(WSS)]]$cluster</span></span>
<span id="cb114-225"><a href="#cb114-225" aria-hidden="true" tabindex="-1"></a><span class="in">  Pen &lt;- rep(0, G)</span></span>
<span id="cb114-226"><a href="#cb114-226" aria-hidden="true" tabindex="-1"></a><span class="in">  Beta &lt;- matrix(0, p, G)</span></span>
<span id="cb114-227"><a href="#cb114-227" aria-hidden="true" tabindex="-1"></a><span class="in">  dimnames(Beta)[[2]] &lt;- paste0("G=",1:G)</span></span>
<span id="cb114-228"><a href="#cb114-228" aria-hidden="true" tabindex="-1"></a><span class="in">  Sig &lt;- rep(1, G)    # not needed under non-Gaussian case</span></span>
<span id="cb114-229"><a href="#cb114-229" aria-hidden="true" tabindex="-1"></a><span class="in">  Nu &lt;- rep(1, G) </span></span>
<span id="cb114-230"><a href="#cb114-230" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-231"><a href="#cb114-231" aria-hidden="true" tabindex="-1"></a><span class="in">  ## iterative algorithm </span></span>
<span id="cb114-232"><a href="#cb114-232" aria-hidden="true" tabindex="-1"></a><span class="in">  val &lt;- 0</span></span>
<span id="cb114-233"><a href="#cb114-233" aria-hidden="true" tabindex="-1"></a><span class="in">  mval &lt;- 0</span></span>
<span id="cb114-234"><a href="#cb114-234" aria-hidden="true" tabindex="-1"></a><span class="in">  for(k in 1:maxitr){</span></span>
<span id="cb114-235"><a href="#cb114-235" aria-hidden="true" tabindex="-1"></a><span class="in">    cval &lt;- val</span></span>
<span id="cb114-236"><a href="#cb114-236" aria-hidden="true" tabindex="-1"></a><span class="in">    #print(paste("Sekarang adalah k ke-", k))</span></span>
<span id="cb114-237"><a href="#cb114-237" aria-hidden="true" tabindex="-1"></a><span class="in">    ## penalty term</span></span>
<span id="cb114-238"><a href="#cb114-238" aria-hidden="true" tabindex="-1"></a><span class="in">    Ind.mat &lt;- matrix(0, n, G)</span></span>
<span id="cb114-239"><a href="#cb114-239" aria-hidden="true" tabindex="-1"></a><span class="in">    for(g in 1:G){</span></span>
<span id="cb114-240"><a href="#cb114-240" aria-hidden="true" tabindex="-1"></a><span class="in">      Ind.mat[Ind==g, g] &lt;- 1</span></span>
<span id="cb114-241"><a href="#cb114-241" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-242"><a href="#cb114-242" aria-hidden="true" tabindex="-1"></a><span class="in">    Ind.mat &lt;- as(Ind.mat, "sparseMatrix")</span></span>
<span id="cb114-243"><a href="#cb114-243" aria-hidden="true" tabindex="-1"></a><span class="in">    Pen &lt;- W%*%Ind.mat     # penalty term</span></span>
<span id="cb114-244"><a href="#cb114-244" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-245"><a href="#cb114-245" aria-hidden="true" tabindex="-1"></a><span class="in">    ## model parameters (clustered case)</span></span>
<span id="cb114-246"><a href="#cb114-246" aria-hidden="true" tabindex="-1"></a><span class="in">    if(fuzzy==F){</span></span>
<span id="cb114-247"><a href="#cb114-247" aria-hidden="true" tabindex="-1"></a><span class="in">      for(g in 1:G){</span></span>
<span id="cb114-248"><a href="#cb114-248" aria-hidden="true" tabindex="-1"></a><span class="in">        #print(paste("length sepanjang", length(Ind[Ind==g]), "dan p + 1 sebesar", p+1))</span></span>
<span id="cb114-249"><a href="#cb114-249" aria-hidden="true" tabindex="-1"></a><span class="in">        if(length(Ind[Ind==g])&gt;p+1){</span></span>
<span id="cb114-250"><a href="#cb114-250" aria-hidden="true" tabindex="-1"></a><span class="in">          # gaussian</span></span>
<span id="cb114-251"><a href="#cb114-251" aria-hidden="true" tabindex="-1"></a><span class="in">          if(family=="gaussian"){</span></span>
<span id="cb114-252"><a href="#cb114-252" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- lm(Y[Ind==g]~X[Ind==g,])</span></span>
<span id="cb114-253"><a href="#cb114-253" aria-hidden="true" tabindex="-1"></a><span class="in">            #print(paste("Sekarang adalah gerombol ke-", g))</span></span>
<span id="cb114-254"><a href="#cb114-254" aria-hidden="true" tabindex="-1"></a><span class="in">            #print(summary(fit)) #Jika ingin melihat peubah berpengaruh maka hilangkan tanda pagar</span></span>
<span id="cb114-255"><a href="#cb114-255" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-256"><a href="#cb114-256" aria-hidden="true" tabindex="-1"></a><span class="in">            resid &lt;- Y-as.vector(XX%*%Beta[,g])</span></span>
<span id="cb114-257"><a href="#cb114-257" aria-hidden="true" tabindex="-1"></a><span class="in">            Sig[g] &lt;- sqrt(mean(resid[Ind==g]^2))</span></span>
<span id="cb114-258"><a href="#cb114-258" aria-hidden="true" tabindex="-1"></a><span class="in">            Sig[g] &lt;- max(Sig[g], 0.1)</span></span>
<span id="cb114-259"><a href="#cb114-259" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-260"><a href="#cb114-260" aria-hidden="true" tabindex="-1"></a><span class="in">          # poisson</span></span>
<span id="cb114-261"><a href="#cb114-261" aria-hidden="true" tabindex="-1"></a><span class="in">          if(family=="poisson"){</span></span>
<span id="cb114-262"><a href="#cb114-262" aria-hidden="true" tabindex="-1"></a><span class="in">            x &lt;- X[Ind==g,]</span></span>
<span id="cb114-263"><a href="#cb114-263" aria-hidden="true" tabindex="-1"></a><span class="in">            y &lt;- Y[Ind==g]</span></span>
<span id="cb114-264"><a href="#cb114-264" aria-hidden="true" tabindex="-1"></a><span class="in">            off &lt;- offset[Ind==g]</span></span>
<span id="cb114-265"><a href="#cb114-265" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- glm(y~x, offset=off, family="poisson")</span></span>
<span id="cb114-266"><a href="#cb114-266" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-267"><a href="#cb114-267" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-268"><a href="#cb114-268" aria-hidden="true" tabindex="-1"></a><span class="in">          # NB</span></span>
<span id="cb114-269"><a href="#cb114-269" aria-hidden="true" tabindex="-1"></a><span class="in">          if(family=="NB"){</span></span>
<span id="cb114-270"><a href="#cb114-270" aria-hidden="true" tabindex="-1"></a><span class="in">            x &lt;- X[Ind==g,]</span></span>
<span id="cb114-271"><a href="#cb114-271" aria-hidden="true" tabindex="-1"></a><span class="in">            y &lt;- Y[Ind==g]</span></span>
<span id="cb114-272"><a href="#cb114-272" aria-hidden="true" tabindex="-1"></a><span class="in">            off &lt;- offset[Ind==g]</span></span>
<span id="cb114-273"><a href="#cb114-273" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- glm.nb(y~x+offset(off))</span></span>
<span id="cb114-274"><a href="#cb114-274" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef( fit ) )</span></span>
<span id="cb114-275"><a href="#cb114-275" aria-hidden="true" tabindex="-1"></a><span class="in">            Nu[g] &lt;- fit$theta</span></span>
<span id="cb114-276"><a href="#cb114-276" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-277"><a href="#cb114-277" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb114-278"><a href="#cb114-278" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-279"><a href="#cb114-279" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-280"><a href="#cb114-280" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-281"><a href="#cb114-281" aria-hidden="true" tabindex="-1"></a><span class="in">    ## model parameters (fuzzy case)</span></span>
<span id="cb114-282"><a href="#cb114-282" aria-hidden="true" tabindex="-1"></a><span class="in">    if(fuzzy==T){</span></span>
<span id="cb114-283"><a href="#cb114-283" aria-hidden="true" tabindex="-1"></a><span class="in">      # Gaussian</span></span>
<span id="cb114-284"><a href="#cb114-284" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="gaussian"){</span></span>
<span id="cb114-285"><a href="#cb114-285" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- XX%*%Beta      # (n,G)-matrix</span></span>
<span id="cb114-286"><a href="#cb114-286" aria-hidden="true" tabindex="-1"></a><span class="in">        ESig &lt;- t(matrix(rep(Sig,n), G, n))    # (n,G)-matrix</span></span>
<span id="cb114-287"><a href="#cb114-287" aria-hidden="true" tabindex="-1"></a><span class="in">        log.dens &lt;- log(dnorm(Y,Mu,ESig)) + Phi*Pen</span></span>
<span id="cb114-288"><a href="#cb114-288" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(log.dens, 1, max)</span></span>
<span id="cb114-289"><a href="#cb114-289" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(log.dens-mval), 1, sum))</span></span>
<span id="cb114-290"><a href="#cb114-290" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(log.dens-log.denom)     # weight</span></span>
<span id="cb114-291"><a href="#cb114-291" aria-hidden="true" tabindex="-1"></a><span class="in">        for(g in 1:G){ </span></span>
<span id="cb114-292"><a href="#cb114-292" aria-hidden="true" tabindex="-1"></a><span class="in">          if(sum(PP[,g])&gt;0.1){</span></span>
<span id="cb114-293"><a href="#cb114-293" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- lm(Y~X, weights=PP[,g])</span></span>
<span id="cb114-294"><a href="#cb114-294" aria-hidden="true" tabindex="-1"></a><span class="in">            </span></span>
<span id="cb114-295"><a href="#cb114-295" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-296"><a href="#cb114-296" aria-hidden="true" tabindex="-1"></a><span class="in">            resid &lt;- Y-as.vector(XX%*%Beta[,g])</span></span>
<span id="cb114-297"><a href="#cb114-297" aria-hidden="true" tabindex="-1"></a><span class="in">            Sig[g] &lt;- sqrt( sum(PP[,g]*resid^2)/sum(PP[,g]) )</span></span>
<span id="cb114-298"><a href="#cb114-298" aria-hidden="true" tabindex="-1"></a><span class="in">            Sig[g] &lt;- max(Sig[g], 0.1)</span></span>
<span id="cb114-299"><a href="#cb114-299" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-300"><a href="#cb114-300" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb114-301"><a href="#cb114-301" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-302"><a href="#cb114-302" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb114-303"><a href="#cb114-303" aria-hidden="true" tabindex="-1"></a><span class="in">      # Poisson</span></span>
<span id="cb114-304"><a href="#cb114-304" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="poisson"){</span></span>
<span id="cb114-305"><a href="#cb114-305" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta)    # (n,G)-matrix</span></span>
<span id="cb114-306"><a href="#cb114-306" aria-hidden="true" tabindex="-1"></a><span class="in">        log.dens &lt;- log(dpois(Y, Mu)) + Phi*Pen </span></span>
<span id="cb114-307"><a href="#cb114-307" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(log.dens, 1, max)</span></span>
<span id="cb114-308"><a href="#cb114-308" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(log.dens-mval), 1, sum))</span></span>
<span id="cb114-309"><a href="#cb114-309" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(log.dens-log.denom)     # weight</span></span>
<span id="cb114-310"><a href="#cb114-310" aria-hidden="true" tabindex="-1"></a><span class="in">        for(g in 1:G){</span></span>
<span id="cb114-311"><a href="#cb114-311" aria-hidden="true" tabindex="-1"></a><span class="in">          if(sum(PP[,g])&gt;0.1){</span></span>
<span id="cb114-312"><a href="#cb114-312" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- glm(Y~X, offset=offset, weights=PP[,g], family="poisson")</span></span>
<span id="cb114-313"><a href="#cb114-313" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-314"><a href="#cb114-314" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-315"><a href="#cb114-315" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb114-316"><a href="#cb114-316" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-317"><a href="#cb114-317" aria-hidden="true" tabindex="-1"></a><span class="in">      # NB</span></span>
<span id="cb114-318"><a href="#cb114-318" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="NB"){</span></span>
<span id="cb114-319"><a href="#cb114-319" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta)    # (n,G)-matrix</span></span>
<span id="cb114-320"><a href="#cb114-320" aria-hidden="true" tabindex="-1"></a><span class="in">        log.dens &lt;- dnbinom(Y, size=Nu, prob=Nu/(Nu+Mu), log=T) + Phi*Pen </span></span>
<span id="cb114-321"><a href="#cb114-321" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(log.dens, 1, max)</span></span>
<span id="cb114-322"><a href="#cb114-322" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(log.dens-mval), 1, sum))</span></span>
<span id="cb114-323"><a href="#cb114-323" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(log.dens-log.denom)     # weight</span></span>
<span id="cb114-324"><a href="#cb114-324" aria-hidden="true" tabindex="-1"></a><span class="in">        for(g in 1:G){</span></span>
<span id="cb114-325"><a href="#cb114-325" aria-hidden="true" tabindex="-1"></a><span class="in">          if(sum(PP[,g])&gt;0.1){</span></span>
<span id="cb114-326"><a href="#cb114-326" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- glm.nb(Y~X+offset(offset), weights=PP[,g])</span></span>
<span id="cb114-327"><a href="#cb114-327" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-328"><a href="#cb114-328" aria-hidden="true" tabindex="-1"></a><span class="in">            Nu[g] &lt;- fit$theta</span></span>
<span id="cb114-329"><a href="#cb114-329" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-330"><a href="#cb114-330" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb114-331"><a href="#cb114-331" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-332"><a href="#cb114-332" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-333"><a href="#cb114-333" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-334"><a href="#cb114-334" aria-hidden="true" tabindex="-1"></a><span class="in">    ## Grouping (clustered case)</span></span>
<span id="cb114-335"><a href="#cb114-335" aria-hidden="true" tabindex="-1"></a><span class="in">    if(fuzzy==F){</span></span>
<span id="cb114-336"><a href="#cb114-336" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="gaussian"){</span></span>
<span id="cb114-337"><a href="#cb114-337" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- XX%*%Beta      # (n,G)-matrix</span></span>
<span id="cb114-338"><a href="#cb114-338" aria-hidden="true" tabindex="-1"></a><span class="in">        ESig &lt;- t(matrix(rep(Sig,n), G, n))    # (n,G)-matrix</span></span>
<span id="cb114-339"><a href="#cb114-339" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- dnorm(Y, Mu, ESig, log=T) + Phi*Pen     # penalized likelihood</span></span>
<span id="cb114-340"><a href="#cb114-340" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-341"><a href="#cb114-341" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="poisson"){ </span></span>
<span id="cb114-342"><a href="#cb114-342" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta) </span></span>
<span id="cb114-343"><a href="#cb114-343" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- dpois(Y, Mu, log=T)  + Phi*Pen    # penalized likelihood</span></span>
<span id="cb114-344"><a href="#cb114-344" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-345"><a href="#cb114-345" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="NB"){ </span></span>
<span id="cb114-346"><a href="#cb114-346" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta) </span></span>
<span id="cb114-347"><a href="#cb114-347" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- dnbinom(Y, size=Nu, prob=Nu/(Nu+Mu), log=T)  + Phi*Pen    # penalized likelihood</span></span>
<span id="cb114-348"><a href="#cb114-348" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-349"><a href="#cb114-349" aria-hidden="true" tabindex="-1"></a><span class="in">      Ind &lt;- apply(Q, 1, which.max)</span></span>
<span id="cb114-350"><a href="#cb114-350" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-351"><a href="#cb114-351" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-352"><a href="#cb114-352" aria-hidden="true" tabindex="-1"></a><span class="in">    ## Grouping (fuzzy case)</span></span>
<span id="cb114-353"><a href="#cb114-353" aria-hidden="true" tabindex="-1"></a><span class="in">    if(fuzzy==T){</span></span>
<span id="cb114-354"><a href="#cb114-354" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="gaussian"){</span></span>
<span id="cb114-355"><a href="#cb114-355" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- XX%*%Beta      # (n,G)-matrix</span></span>
<span id="cb114-356"><a href="#cb114-356" aria-hidden="true" tabindex="-1"></a><span class="in">        ESig &lt;- t(matrix(rep(Sig,n), G, n))    # (n,G)-matrix</span></span>
<span id="cb114-357"><a href="#cb114-357" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- delta*(dnorm(Y, Mu, ESig, log=T) + Phi*Pen)   # penalized likelihood</span></span>
<span id="cb114-358"><a href="#cb114-358" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(Q, 1, max)</span></span>
<span id="cb114-359"><a href="#cb114-359" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(Q-mval), 1, sum))</span></span>
<span id="cb114-360"><a href="#cb114-360" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(Q-log.denom)</span></span>
<span id="cb114-361"><a href="#cb114-361" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-362"><a href="#cb114-362" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="poisson"){ </span></span>
<span id="cb114-363"><a href="#cb114-363" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta)    # (n,G)-matrix</span></span>
<span id="cb114-364"><a href="#cb114-364" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- delta*(dpois(Y, Mu, log=T)  + Phi*Pen)   # penalized likelihood</span></span>
<span id="cb114-365"><a href="#cb114-365" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(Q, 1, max)</span></span>
<span id="cb114-366"><a href="#cb114-366" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(Q-mval), 1, sum))</span></span>
<span id="cb114-367"><a href="#cb114-367" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(Q-log.denom)</span></span>
<span id="cb114-368"><a href="#cb114-368" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-369"><a href="#cb114-369" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="NB"){ </span></span>
<span id="cb114-370"><a href="#cb114-370" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta)    # (n,G)-matrix</span></span>
<span id="cb114-371"><a href="#cb114-371" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- delta*(dnbinom(Y, size=Nu, prob=Nu/(Nu+Mu), log=T) + Phi*Pen)   # penalized likelihood</span></span>
<span id="cb114-372"><a href="#cb114-372" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(Q, 1, max)</span></span>
<span id="cb114-373"><a href="#cb114-373" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(Q-mval), 1, sum))</span></span>
<span id="cb114-374"><a href="#cb114-374" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(Q-log.denom)</span></span>
<span id="cb114-375"><a href="#cb114-375" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-376"><a href="#cb114-376" aria-hidden="true" tabindex="-1"></a><span class="in">      Ind &lt;- apply(PP, 1, which.max)</span></span>
<span id="cb114-377"><a href="#cb114-377" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-378"><a href="#cb114-378" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-379"><a href="#cb114-379" aria-hidden="true" tabindex="-1"></a><span class="in">    ## Value of objective function</span></span>
<span id="cb114-380"><a href="#cb114-380" aria-hidden="true" tabindex="-1"></a><span class="in">    val &lt;- sum( apply(Q, 1, nmax) ) </span></span>
<span id="cb114-381"><a href="#cb114-381" aria-hidden="true" tabindex="-1"></a><span class="in">    dd &lt;- abs(cval-val)/abs(val)</span></span>
<span id="cb114-382"><a href="#cb114-382" aria-hidden="true" tabindex="-1"></a><span class="in">    mval &lt;- max(mval, cval)</span></span>
<span id="cb114-383"><a href="#cb114-383" aria-hidden="true" tabindex="-1"></a><span class="in">    if( dd&lt;ep | abs(mval-val)&lt;ep ){ break }</span></span>
<span id="cb114-384"><a href="#cb114-384" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-385"><a href="#cb114-385" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-386"><a href="#cb114-386" aria-hidden="true" tabindex="-1"></a><span class="in">  ## varying parameters</span></span>
<span id="cb114-387"><a href="#cb114-387" aria-hidden="true" tabindex="-1"></a><span class="in">  if(fuzzy==F){  sBeta &lt;- t(Beta[,Ind]) }</span></span>
<span id="cb114-388"><a href="#cb114-388" aria-hidden="true" tabindex="-1"></a><span class="in">  if(fuzzy==T){  sBeta &lt;- PP%*%t(Beta) }</span></span>
<span id="cb114-389"><a href="#cb114-389" aria-hidden="true" tabindex="-1"></a><span class="in">  sSig &lt;- Sig[Ind]     # location-wise error variance</span></span>
<span id="cb114-390"><a href="#cb114-390" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-391"><a href="#cb114-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-392"><a href="#cb114-392" aria-hidden="true" tabindex="-1"></a><span class="in">  ## maximum likelihood </span></span>
<span id="cb114-393"><a href="#cb114-393" aria-hidden="true" tabindex="-1"></a><span class="in">  if(family=="gaussian"){</span></span>
<span id="cb114-394"><a href="#cb114-394" aria-hidden="true" tabindex="-1"></a><span class="in">    hmu &lt;- apply(XX*sBeta, 1, sum)</span></span>
<span id="cb114-395"><a href="#cb114-395" aria-hidden="true" tabindex="-1"></a><span class="in">    ML &lt;- sum( dnorm(Y, hmu, sSig, log=T) ) </span></span>
<span id="cb114-396"><a href="#cb114-396" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-397"><a href="#cb114-397" aria-hidden="true" tabindex="-1"></a><span class="in">  if(family=="poisson"){</span></span>
<span id="cb114-398"><a href="#cb114-398" aria-hidden="true" tabindex="-1"></a><span class="in">    hmu &lt;- exp(offset + apply(XX*sBeta, 1, sum))</span></span>
<span id="cb114-399"><a href="#cb114-399" aria-hidden="true" tabindex="-1"></a><span class="in">    ML &lt;- sum( dpois(Y, hmu, log=T) ) </span></span>
<span id="cb114-400"><a href="#cb114-400" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-401"><a href="#cb114-401" aria-hidden="true" tabindex="-1"></a><span class="in">  if(family=="NB"){</span></span>
<span id="cb114-402"><a href="#cb114-402" aria-hidden="true" tabindex="-1"></a><span class="in">    sNu &lt;- Nu[Ind]</span></span>
<span id="cb114-403"><a href="#cb114-403" aria-hidden="true" tabindex="-1"></a><span class="in">    hmu &lt;- exp(offset + apply(XX*sBeta, 1, sum))</span></span>
<span id="cb114-404"><a href="#cb114-404" aria-hidden="true" tabindex="-1"></a><span class="in">    ML &lt;- sum( dnbinom(Y, size=sNu, prob=sNu/(sNu+hmu), log=T) ) </span></span>
<span id="cb114-405"><a href="#cb114-405" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-406"><a href="#cb114-406" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-407"><a href="#cb114-407" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Results</span></span>
<span id="cb114-408"><a href="#cb114-408" aria-hidden="true" tabindex="-1"></a><span class="in">  result &lt;- list(Beta=Beta, Sig=Sig, Nu=Nu, group=Ind, sBeta=sBeta, sSig=sSig, ML=ML, itr=k)</span></span>
<span id="cb114-409"><a href="#cb114-409" aria-hidden="true" tabindex="-1"></a><span class="in">  return(result)</span></span>
<span id="cb114-410"><a href="#cb114-410" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb114-411"><a href="#cb114-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-412"><a href="#cb114-412" aria-hidden="true" tabindex="-1"></a><span class="in">###  Selection of tuning parameters  ###</span></span>
<span id="cb114-413"><a href="#cb114-413" aria-hidden="true" tabindex="-1"></a><span class="in">## Imput</span></span>
<span id="cb114-414"><a href="#cb114-414" aria-hidden="true" tabindex="-1"></a><span class="in"># most of inputs are the same as 'SCR' </span></span>
<span id="cb114-415"><a href="#cb114-415" aria-hidden="true" tabindex="-1"></a><span class="in"># G.set: vector of candidates for G</span></span>
<span id="cb114-416"><a href="#cb114-416" aria-hidden="true" tabindex="-1"></a><span class="in"># print: if True, interim progress is reported </span></span>
<span id="cb114-417"><a href="#cb114-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-418"><a href="#cb114-418" aria-hidden="true" tabindex="-1"></a><span class="in">## Output</span></span>
<span id="cb114-419"><a href="#cb114-419" aria-hidden="true" tabindex="-1"></a><span class="in"># BIC: BIC-type criteria</span></span>
<span id="cb114-420"><a href="#cb114-420" aria-hidden="true" tabindex="-1"></a><span class="in"># select: selection results </span></span>
<span id="cb114-421"><a href="#cb114-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-422"><a href="#cb114-422" aria-hidden="true" tabindex="-1"></a><span class="in">## Main function </span></span>
<span id="cb114-423"><a href="#cb114-423" aria-hidden="true" tabindex="-1"></a><span class="in">SCR.select &lt;- function(Y, X, W, Sp, G.set=NULL, Phi=1, offset=NULL, maxitr=50, print=T, family="gaussian"){</span></span>
<span id="cb114-424"><a href="#cb114-424" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Preparations</span></span>
<span id="cb114-425"><a href="#cb114-425" aria-hidden="true" tabindex="-1"></a><span class="in">  if(is.null(G.set)){ G.set &lt;- seq(10, 40, by=5) }</span></span>
<span id="cb114-426"><a href="#cb114-426" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- as.matrix(X)</span></span>
<span id="cb114-427"><a href="#cb114-427" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- dim(X)[1]</span></span>
<span id="cb114-428"><a href="#cb114-428" aria-hidden="true" tabindex="-1"></a><span class="in">  p &lt;- dim(X)[2]+1</span></span>
<span id="cb114-429"><a href="#cb114-429" aria-hidden="true" tabindex="-1"></a><span class="in">  L &lt;- length(G.set)</span></span>
<span id="cb114-430"><a href="#cb114-430" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-431"><a href="#cb114-431" aria-hidden="true" tabindex="-1"></a><span class="in">  ## computing information criteria</span></span>
<span id="cb114-432"><a href="#cb114-432" aria-hidden="true" tabindex="-1"></a><span class="in">  BIC &lt;- c()</span></span>
<span id="cb114-433"><a href="#cb114-433" aria-hidden="true" tabindex="-1"></a><span class="in">  for(l in 1:L){</span></span>
<span id="cb114-434"><a href="#cb114-434" aria-hidden="true" tabindex="-1"></a><span class="in">    fit &lt;- SCR(Y, X, W, Sp, offset=offset, G=G.set[l], Phi=Phi, maxitr=maxitr, family=family)</span></span>
<span id="cb114-435"><a href="#cb114-435" aria-hidden="true" tabindex="-1"></a><span class="in">    pp &lt;- length(fit$Beta) </span></span>
<span id="cb114-436"><a href="#cb114-436" aria-hidden="true" tabindex="-1"></a><span class="in">    if(family=="gaussian"| family=="NB"){ pp &lt;- pp + G.set[l] }</span></span>
<span id="cb114-437"><a href="#cb114-437" aria-hidden="true" tabindex="-1"></a><span class="in">    BIC[l] &lt;- -2*fit$ML + log(n)*pp</span></span>
<span id="cb114-438"><a href="#cb114-438" aria-hidden="true" tabindex="-1"></a><span class="in">    if(print){ print( paste0("G=",G.set[l], ", iteration=", fit$itr) ) }</span></span>
<span id="cb114-439"><a href="#cb114-439" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-440"><a href="#cb114-440" aria-hidden="true" tabindex="-1"></a><span class="in">  names(BIC) &lt;- paste0("G=", G.set)</span></span>
<span id="cb114-441"><a href="#cb114-441" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-442"><a href="#cb114-442" aria-hidden="true" tabindex="-1"></a><span class="in">  ## selection</span></span>
<span id="cb114-443"><a href="#cb114-443" aria-hidden="true" tabindex="-1"></a><span class="in">  hG &lt;- G.set[which.min(BIC)]</span></span>
<span id="cb114-444"><a href="#cb114-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-445"><a href="#cb114-445" aria-hidden="true" tabindex="-1"></a><span class="in">  ## result</span></span>
<span id="cb114-446"><a href="#cb114-446" aria-hidden="true" tabindex="-1"></a><span class="in">  Result &lt;- list(BIC=BIC, G=hG)</span></span>
<span id="cb114-447"><a href="#cb114-447" aria-hidden="true" tabindex="-1"></a><span class="in">  return(Result)</span></span>
<span id="cb114-448"><a href="#cb114-448" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb114-449"><a href="#cb114-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-450"><a href="#cb114-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-451"><a href="#cb114-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load package, cache=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb114-452"><a href="#cb114-452" aria-hidden="true" tabindex="-1"></a><span class="in">library(readxl)</span></span>
<span id="cb114-453"><a href="#cb114-453" aria-hidden="true" tabindex="-1"></a><span class="in">library(corrplot)</span></span>
<span id="cb114-454"><a href="#cb114-454" aria-hidden="true" tabindex="-1"></a><span class="in">library(RColorBrewer)</span></span>
<span id="cb114-455"><a href="#cb114-455" aria-hidden="true" tabindex="-1"></a><span class="in">library(car)</span></span>
<span id="cb114-456"><a href="#cb114-456" aria-hidden="true" tabindex="-1"></a><span class="in">library(lmtest)</span></span>
<span id="cb114-457"><a href="#cb114-457" aria-hidden="true" tabindex="-1"></a><span class="in">library(MASS)</span></span>
<span id="cb114-458"><a href="#cb114-458" aria-hidden="true" tabindex="-1"></a><span class="in">library(rcompanion)</span></span>
<span id="cb114-459"><a href="#cb114-459" aria-hidden="true" tabindex="-1"></a><span class="in">library(sf)</span></span>
<span id="cb114-460"><a href="#cb114-460" aria-hidden="true" tabindex="-1"></a><span class="in">library(FastKNN)</span></span>
<span id="cb114-461"><a href="#cb114-461" aria-hidden="true" tabindex="-1"></a><span class="in">library(devtools)</span></span>
<span id="cb114-462"><a href="#cb114-462" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb114-463"><a href="#cb114-463" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb114-464"><a href="#cb114-464" aria-hidden="true" tabindex="-1"></a><span class="in">library(sp)</span></span>
<span id="cb114-465"><a href="#cb114-465" aria-hidden="true" tabindex="-1"></a><span class="in">library(binovisualfields)</span></span>
<span id="cb114-466"><a href="#cb114-466" aria-hidden="true" tabindex="-1"></a><span class="in">library(raster)</span></span>
<span id="cb114-467"><a href="#cb114-467" aria-hidden="true" tabindex="-1"></a><span class="in">library(spdep)</span></span>
<span id="cb114-468"><a href="#cb114-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-469"><a href="#cb114-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-470"><a href="#cb114-470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Persiapan Data</span></span>
<span id="cb114-471"><a href="#cb114-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-472"><a href="#cb114-472" aria-hidden="true" tabindex="-1"></a>Data excel kemiskinan dipanggil dengan mendefinisikan *dataframe* "kemiskinan"</span>
<span id="cb114-473"><a href="#cb114-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-474"><a href="#cb114-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load data}</span></span>
<span id="cb114-475"><a href="#cb114-475" aria-hidden="true" tabindex="-1"></a><span class="in">kemiskinan &lt;- read_xlsx("data/kemiskinan_2022.xlsx", sheet = 1)</span></span>
<span id="cb114-476"><a href="#cb114-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-477"><a href="#cb114-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-478"><a href="#cb114-478" aria-hidden="true" tabindex="-1"></a>Melihat *summary* dari data kemiskinan sebagai berikut:</span>
<span id="cb114-479"><a href="#cb114-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-480"><a href="#cb114-480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sum data}</span></span>
<span id="cb114-481"><a href="#cb114-481" aria-hidden="true" tabindex="-1"></a><span class="in">summary(kemiskinan)</span></span>
<span id="cb114-482"><a href="#cb114-482" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-483"><a href="#cb114-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-484"><a href="#cb114-484" aria-hidden="true" tabindex="-1"></a>Melihat missing value pada *dataframe*</span>
<span id="cb114-485"><a href="#cb114-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-488"><a href="#cb114-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-489"><a href="#cb114-489" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">is.na</span>(kemiskinan<span class="sc">$</span>X6))</span>
<span id="cb114-490"><a href="#cb114-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-491"><a href="#cb114-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-492"><a href="#cb114-492" aria-hidden="true" tabindex="-1"></a>Diketahui terdapat *missing value* di peubah Tingkat Pengangguran Terbuka (TPT) dengan rincian:</span>
<span id="cb114-493"><a href="#cb114-493" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Sumatera Utara: 3</span>
<span id="cb114-494"><a href="#cb114-494" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Papua: 6</span>
<span id="cb114-495"><a href="#cb114-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-496"><a href="#cb114-496" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Data hasil imputasi</span></span>
<span id="cb114-497"><a href="#cb114-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-498"><a href="#cb114-498" aria-hidden="true" tabindex="-1"></a>*Missing value* tersebut diatasi menggunakan *Group Mean Imputation* di mana provinsi dianggap sebagai grup (imputasi dilakukan menggunakan ms excel dan hasilnya langsung dipanggil sebagai *dataframe* "imputasi")</span>
<span id="cb114-499"><a href="#cb114-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load data 2}</span></span>
<span id="cb114-500"><a href="#cb114-500" aria-hidden="true" tabindex="-1"></a><span class="in">imputasi &lt;- read_xlsx("data/kemiskinan_2022.xlsx", sheet = 2)</span></span>
<span id="cb114-501"><a href="#cb114-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-502"><a href="#cb114-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-503"><a href="#cb114-503" aria-hidden="true" tabindex="-1"></a>Melihat *summary* dari data hasil imputasi</span>
<span id="cb114-506"><a href="#cb114-506" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-507"><a href="#cb114-507" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(imputasi)</span>
<span id="cb114-508"><a href="#cb114-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-509"><a href="#cb114-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-510"><a href="#cb114-510" aria-hidden="true" tabindex="-1"></a><span class="fu">### Eksplorasi Data</span></span>
<span id="cb114-511"><a href="#cb114-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-512"><a href="#cb114-512" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Boxplot sebaran</span></span>
<span id="cb114-513"><a href="#cb114-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-514"><a href="#cb114-514" aria-hidden="true" tabindex="-1"></a>fungsi untuk melihat amatan yang termasuk ke dalam pencilan</span>
<span id="cb114-515"><a href="#cb114-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-516"><a href="#cb114-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r set outlier}</span></span>
<span id="cb114-517"><a href="#cb114-517" aria-hidden="true" tabindex="-1"></a><span class="in">findoutlier &lt;- function(x) {</span></span>
<span id="cb114-518"><a href="#cb114-518" aria-hidden="true" tabindex="-1"></a><span class="in">  return(x &lt; quantile(x, .25) - 1.5*IQR(x) | x &gt; quantile(x, .75) + 1.5*IQR(x))</span></span>
<span id="cb114-519"><a href="#cb114-519" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb114-520"><a href="#cb114-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-521"><a href="#cb114-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-522"><a href="#cb114-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r show outlier}</span></span>
<span id="cb114-523"><a href="#cb114-523" aria-hidden="true" tabindex="-1"></a><span class="in">#Y = Tingkat Kemiskinan</span></span>
<span id="cb114-524"><a href="#cb114-524" aria-hidden="true" tabindex="-1"></a><span class="in">imputasi &lt;- imputasi %&gt;%</span></span>
<span id="cb114-525"><a href="#cb114-525" aria-hidden="true" tabindex="-1"></a><span class="in">        mutate(outlier.y = ifelse(findoutlier(Y), `ADM2_EN`, NA))</span></span>
<span id="cb114-526"><a href="#cb114-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-527"><a href="#cb114-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-528"><a href="#cb114-528" aria-hidden="true" tabindex="-1"></a>Nama-Nama Daerah pencilan tingkat kemiskinan (35 Kabupaten)</span>
<span id="cb114-531"><a href="#cb114-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-532"><a href="#cb114-532" aria-hidden="true" tabindex="-1"></a>imputasi<span class="sc">$</span>outlier.y[<span class="sc">!</span><span class="fu">is.na</span>(imputasi<span class="sc">$</span>outlier.y)]</span>
<span id="cb114-533"><a href="#cb114-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-534"><a href="#cb114-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-535"><a href="#cb114-535" aria-hidden="true" tabindex="-1"></a>Grafik boxplot tingkat kemiskinan kabupaten/kota di Indonesia (%)</span>
<span id="cb114-536"><a href="#cb114-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r boxplot}</span></span>
<span id="cb114-537"><a href="#cb114-537" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(imputasi, aes(x= "",y = Y)) +</span></span>
<span id="cb114-538"><a href="#cb114-538" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(fill = "lightblue") +</span></span>
<span id="cb114-539"><a href="#cb114-539" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_classic() +</span></span>
<span id="cb114-540"><a href="#cb114-540" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_flip()</span></span>
<span id="cb114-541"><a href="#cb114-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-542"><a href="#cb114-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-543"><a href="#cb114-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-544"><a href="#cb114-544" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Eksplorasi Spasial</span></span>
<span id="cb114-545"><a href="#cb114-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-546"><a href="#cb114-546" aria-hidden="true" tabindex="-1"></a>Membaca peta Indonesia</span>
<span id="cb114-547"><a href="#cb114-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-550"><a href="#cb114-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-551"><a href="#cb114-551" aria-hidden="true" tabindex="-1"></a>id.map <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/shp/idn_admbnda_adm2_bps_20200401.shp"</span>)</span>
<span id="cb114-552"><a href="#cb114-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-553"><a href="#cb114-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-554"><a href="#cb114-554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r read map}</span></span>
<span id="cb114-555"><a href="#cb114-555" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.map &lt;- id.map</span></span>
<span id="cb114-556"><a href="#cb114-556" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.map &lt;- indonesia.map[c(-91,-92,-93,-94,-95,-127,-513,-514),]</span></span>
<span id="cb114-557"><a href="#cb114-557" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.2 &lt;- tigris::geo_join(spatial_data=indonesia.map, data_frame = imputasi, by_df = "ADM2_EN",by_sp ="ADM2_EN", how = "inner")</span></span>
<span id="cb114-558"><a href="#cb114-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-559"><a href="#cb114-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-560"><a href="#cb114-560" aria-hidden="true" tabindex="-1"></a>Peta tematik tingkat kemiskinan di Indonesia</span>
<span id="cb114-561"><a href="#cb114-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-562"><a href="#cb114-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot map}</span></span>
<span id="cb114-563"><a href="#cb114-563" aria-hidden="true" tabindex="-1"></a><span class="in">#Y = Tingkat kemiskinan (persen)</span></span>
<span id="cb114-564"><a href="#cb114-564" aria-hidden="true" tabindex="-1"></a><span class="in">plot(indonesia.2["Y"], </span></span>
<span id="cb114-565"><a href="#cb114-565" aria-hidden="true" tabindex="-1"></a><span class="in">     main = "Tingkat Kemiskinan",</span></span>
<span id="cb114-566"><a href="#cb114-566" aria-hidden="true" tabindex="-1"></a><span class="in">     breaks = "quantile", nbreaks = 7,</span></span>
<span id="cb114-567"><a href="#cb114-567" aria-hidden="true" tabindex="-1"></a><span class="in">     pal = brewer.pal(7, "Blues"),</span></span>
<span id="cb114-568"><a href="#cb114-568" aria-hidden="true" tabindex="-1"></a><span class="in">     graticule = st_crs(4326))</span></span>
<span id="cb114-569"><a href="#cb114-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-570"><a href="#cb114-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-571"><a href="#cb114-571" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Korelasi</span></span>
<span id="cb114-572"><a href="#cb114-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-573"><a href="#cb114-573" aria-hidden="true" tabindex="-1"></a>Melihat korelasi antar peubah</span>
<span id="cb114-574"><a href="#cb114-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-575"><a href="#cb114-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r corr}</span></span>
<span id="cb114-576"><a href="#cb114-576" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- imputasi[,c(4,5,9,10,11,12,13,14,15)]</span></span>
<span id="cb114-577"><a href="#cb114-577" aria-hidden="true" tabindex="-1"></a><span class="in">korelasi &lt;- cor(data)</span></span>
<span id="cb114-578"><a href="#cb114-578" aria-hidden="true" tabindex="-1"></a><span class="in">corrplot(korelasi, method = "number", type = "upper")</span></span>
<span id="cb114-579"><a href="#cb114-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-580"><a href="#cb114-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-581"><a href="#cb114-581" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Scatter plot</span></span>
<span id="cb114-582"><a href="#cb114-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-583"><a href="#cb114-583" aria-hidden="true" tabindex="-1"></a>Membuat plot tebaran antara peubah respons dan peubah penjelas</span>
<span id="cb114-584"><a href="#cb114-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r scatter plot}</span></span>
<span id="cb114-585"><a href="#cb114-585" aria-hidden="true" tabindex="-1"></a><span class="in">tmp &lt;- par(mfrow=c(2,4))</span></span>
<span id="cb114-586"><a href="#cb114-586" aria-hidden="true" tabindex="-1"></a><span class="in">plot(data$X1 , data$Y, ylab = "penduduk miskin (%)", xlab = "X1")</span></span>
<span id="cb114-587"><a href="#cb114-587" aria-hidden="true" tabindex="-1"></a><span class="in">plot(data$X2 , data$Y, ylab = "penduduk miskin (%)", xlab = "X2")</span></span>
<span id="cb114-588"><a href="#cb114-588" aria-hidden="true" tabindex="-1"></a><span class="in">plot(data$X3 , data$Y, ylab = "penduduk miskin (%)", xlab = "X3")</span></span>
<span id="cb114-589"><a href="#cb114-589" aria-hidden="true" tabindex="-1"></a><span class="in">plot(data$X4 , data$Y, ylab = "penduduk miskin (%)", xlab = "X4")</span></span>
<span id="cb114-590"><a href="#cb114-590" aria-hidden="true" tabindex="-1"></a><span class="in">plot(data$X5 , data$Y, ylab = "penduduk miskin (%)", xlab = "X5")</span></span>
<span id="cb114-591"><a href="#cb114-591" aria-hidden="true" tabindex="-1"></a><span class="in">plot(data$X6 , data$Y, ylab = "penduduk miskin (%)", xlab = "X6")</span></span>
<span id="cb114-592"><a href="#cb114-592" aria-hidden="true" tabindex="-1"></a><span class="in">plot(data$X7 , data$Y, ylab = "penduduk miskin (%)", xlab = "X7")</span></span>
<span id="cb114-593"><a href="#cb114-593" aria-hidden="true" tabindex="-1"></a><span class="in">plot(data$X8 , data$Y, ylab = "penduduk miskin (%)", xlab = "X8")</span></span>
<span id="cb114-594"><a href="#cb114-594" aria-hidden="true" tabindex="-1"></a><span class="in">par(tmp)</span></span>
<span id="cb114-595"><a href="#cb114-595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-596"><a href="#cb114-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-597"><a href="#cb114-597" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pengecekan asumsi galat</span></span>
<span id="cb114-598"><a href="#cb114-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-599"><a href="#cb114-599" aria-hidden="true" tabindex="-1"></a>Membentuk regresi linear berganda terlebih dahulu</span>
<span id="cb114-600"><a href="#cb114-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-601"><a href="#cb114-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r regression}</span></span>
<span id="cb114-602"><a href="#cb114-602" aria-hidden="true" tabindex="-1"></a><span class="in">regresi.klasik &lt;- lm(Y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8, data = imputasi)</span></span>
<span id="cb114-603"><a href="#cb114-603" aria-hidden="true" tabindex="-1"></a><span class="in">summary(regresi.klasik)</span></span>
<span id="cb114-604"><a href="#cb114-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-605"><a href="#cb114-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-606"><a href="#cb114-606" aria-hidden="true" tabindex="-1"></a>terdapat lima peubah yang signifikan.</span>
<span id="cb114-607"><a href="#cb114-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-608"><a href="#cb114-608" aria-hidden="true" tabindex="-1"></a>Dilanjutkan menguji asumsi galat/sisaan yang terdiri dari uji normalitas, homoskedastisitas, dan autokorelasi</span>
<span id="cb114-609"><a href="#cb114-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-610"><a href="#cb114-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r saphiro test}</span></span>
<span id="cb114-611"><a href="#cb114-611" aria-hidden="true" tabindex="-1"></a><span class="in">dwtest(regresi.klasik) #autokorelasi</span></span>
<span id="cb114-612"><a href="#cb114-612" aria-hidden="true" tabindex="-1"></a><span class="in">bptest(regresi.klasik) #homoskedastisitas</span></span>
<span id="cb114-613"><a href="#cb114-613" aria-hidden="true" tabindex="-1"></a><span class="in">shapiro.test(regresi.klasik$residuals) #normalitas</span></span>
<span id="cb114-614"><a href="#cb114-614" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-615"><a href="#cb114-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-616"><a href="#cb114-616" aria-hidden="true" tabindex="-1"></a>Seluruh asumsi tidak terpenuhi karena <span class="in">`p-value &lt; 0.05`</span></span>
<span id="cb114-617"><a href="#cb114-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-618"><a href="#cb114-618" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deteksi multikolinearitas</span></span>
<span id="cb114-619"><a href="#cb114-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-620"><a href="#cb114-620" aria-hidden="true" tabindex="-1"></a>Sebuah peubah penjelas dikatakan mengandung multikolinearitas ketika memiliki VIF di atas 5 <span class="co">[</span><span class="ot">@james2013</span><span class="co">]</span></span>
<span id="cb114-621"><a href="#cb114-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-622"><a href="#cb114-622" aria-hidden="true" tabindex="-1"></a><span class="in">```{r vif 1}</span></span>
<span id="cb114-623"><a href="#cb114-623" aria-hidden="true" tabindex="-1"></a><span class="in">vif(regresi.klasik) #Multikolinearitas</span></span>
<span id="cb114-624"><a href="#cb114-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-625"><a href="#cb114-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-626"><a href="#cb114-626" aria-hidden="true" tabindex="-1"></a>Terlihat peubah $X_5$ (IPM) memiliki VIF &gt; 5 sehingga dikeluarkan dari model</span>
<span id="cb114-627"><a href="#cb114-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-628"><a href="#cb114-628" aria-hidden="true" tabindex="-1"></a><span class="fu">#### deteksi multikolinearitas tanpa peubah X5</span></span>
<span id="cb114-629"><a href="#cb114-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-632"><a href="#cb114-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-633"><a href="#cb114-633" aria-hidden="true" tabindex="-1"></a>regresi.klasik<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4 <span class="sc">+</span> X6 <span class="sc">+</span> X7 <span class="sc">+</span> X8, <span class="at">data =</span> imputasi)</span>
<span id="cb114-634"><a href="#cb114-634" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regresi.klasik<span class="fl">.2</span>)</span>
<span id="cb114-635"><a href="#cb114-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-636"><a href="#cb114-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-637"><a href="#cb114-637" aria-hidden="true" tabindex="-1"></a>terdapat empat peubah penjelas yang signifikan</span>
<span id="cb114-638"><a href="#cb114-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-641"><a href="#cb114-641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-642"><a href="#cb114-642" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(regresi.klasik<span class="fl">.2</span>)</span>
<span id="cb114-643"><a href="#cb114-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-644"><a href="#cb114-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-645"><a href="#cb114-645" aria-hidden="true" tabindex="-1"></a>sudah tidak ada peubah dengan nilai <span class="in">`VIF &gt; 5`</span> sehingga aman dari multikolinearitas</span>
<span id="cb114-646"><a href="#cb114-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-647"><a href="#cb114-647" aria-hidden="true" tabindex="-1"></a><span class="fu">### Asumsi efek spasial</span></span>
<span id="cb114-648"><a href="#cb114-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-649"><a href="#cb114-649" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Heteroskedastisitas spasial</span></span>
<span id="cb114-650"><a href="#cb114-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-651"><a href="#cb114-651" aria-hidden="true" tabindex="-1"></a>Menggunakan uji Breusch-Pagan untuk mengecek heteroskedastisitas spasial dengan hipotesis</span>
<span id="cb114-652"><a href="#cb114-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-653"><a href="#cb114-653" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_0$: Tidak terdapat heteroskedastisitas spasial</span></span>
<span id="cb114-654"><a href="#cb114-654" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_1$: Terdapat heteroskedastisitas spasial</span></span>
<span id="cb114-655"><a href="#cb114-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-656"><a href="#cb114-656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r bptest}</span></span>
<span id="cb114-657"><a href="#cb114-657" aria-hidden="true" tabindex="-1"></a><span class="in">#heteroskedastisitas spasial</span></span>
<span id="cb114-658"><a href="#cb114-658" aria-hidden="true" tabindex="-1"></a><span class="in">bptest(regresi.klasik.2)</span></span>
<span id="cb114-659"><a href="#cb114-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-660"><a href="#cb114-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-661"><a href="#cb114-661" aria-hidden="true" tabindex="-1"></a>Tolak $H_0$ sehingga dapat dikatakan terdapat heteroskedastisitas spasial</span>
<span id="cb114-662"><a href="#cb114-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-663"><a href="#cb114-663" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Autokorelasi spasial</span></span>
<span id="cb114-664"><a href="#cb114-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-665"><a href="#cb114-665" aria-hidden="true" tabindex="-1"></a>Menggunakan uji Moran untuk mengecek autokorelasi spasial dengan hipotesis</span>
<span id="cb114-666"><a href="#cb114-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-667"><a href="#cb114-667" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_0$: tidak terdapat autokorelasi spasial</span></span>
<span id="cb114-668"><a href="#cb114-668" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_1$: terdapat autokorelasi spasial</span></span>
<span id="cb114-669"><a href="#cb114-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-670"><a href="#cb114-670" aria-hidden="true" tabindex="-1"></a>digunakan beragam pembobot spasial untuk mendapatkan nilai indeks Moran membentuk matrik jarak</span>
<span id="cb114-671"><a href="#cb114-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-672"><a href="#cb114-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r moran test}</span></span>
<span id="cb114-673"><a href="#cb114-673" aria-hidden="true" tabindex="-1"></a><span class="in">koordinat &lt;- imputasi[,c(16,17)]</span></span>
<span id="cb114-674"><a href="#cb114-674" aria-hidden="true" tabindex="-1"></a><span class="in">Sp &lt;- as.matrix(koordinat)</span></span>
<span id="cb114-675"><a href="#cb114-675" aria-hidden="true" tabindex="-1"></a><span class="in">DD &lt;- as.matrix(dist(Sp))</span></span>
<span id="cb114-676"><a href="#cb114-676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-677"><a href="#cb114-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-678"><a href="#cb114-678" aria-hidden="true" tabindex="-1"></a><span class="fu">##### KNN</span></span>
<span id="cb114-679"><a href="#cb114-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-680"><a href="#cb114-680" aria-hidden="true" tabindex="-1"></a>K-Nearest Neighbor Weight (k = 5)</span>
<span id="cb114-681"><a href="#cb114-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-682"><a href="#cb114-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r knn}</span></span>
<span id="cb114-683"><a href="#cb114-683" aria-hidden="true" tabindex="-1"></a><span class="in">W.knn &lt;- knn2nb(knearneigh(koordinat,k=5,longlat=TRUE))</span></span>
<span id="cb114-684"><a href="#cb114-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-685"><a href="#cb114-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-686"><a href="#cb114-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r w knn}</span></span>
<span id="cb114-687"><a href="#cb114-687" aria-hidden="true" tabindex="-1"></a><span class="in">W.knn1 &lt;- nb2listw(W.knn, style = 'W')</span></span>
<span id="cb114-688"><a href="#cb114-688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-689"><a href="#cb114-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-690"><a href="#cb114-690" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Invers Distance Weight</span></span>
<span id="cb114-691"><a href="#cb114-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-692"><a href="#cb114-692" aria-hidden="true" tabindex="-1"></a><span class="in">```{r idw}</span></span>
<span id="cb114-693"><a href="#cb114-693" aria-hidden="true" tabindex="-1"></a><span class="in">alpha1 = 1</span></span>
<span id="cb114-694"><a href="#cb114-694" aria-hidden="true" tabindex="-1"></a><span class="in">W.idw &lt;- 1/(DD^alpha1)</span></span>
<span id="cb114-695"><a href="#cb114-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-696"><a href="#cb114-696" aria-hidden="true" tabindex="-1"></a><span class="in">diag(W.idw) &lt;- 0</span></span>
<span id="cb114-697"><a href="#cb114-697" aria-hidden="true" tabindex="-1"></a><span class="in">rtot &lt;- rowSums(W.idw, na.rm = TRUE)</span></span>
<span id="cb114-698"><a href="#cb114-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-699"><a href="#cb114-699" aria-hidden="true" tabindex="-1"></a><span class="in">W.idw.sd &lt;- W.idw/rtot</span></span>
<span id="cb114-700"><a href="#cb114-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-701"><a href="#cb114-701" aria-hidden="true" tabindex="-1"></a><span class="in">W.idw.1 = mat2listw(W.idw.sd,style = 'W')</span></span>
<span id="cb114-702"><a href="#cb114-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-703"><a href="#cb114-703" aria-hidden="true" tabindex="-1"></a><span class="in">alpha2 = 2</span></span>
<span id="cb114-704"><a href="#cb114-704" aria-hidden="true" tabindex="-1"></a><span class="in">W.idw2 = 1/(DD^alpha2)</span></span>
<span id="cb114-705"><a href="#cb114-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-706"><a href="#cb114-706" aria-hidden="true" tabindex="-1"></a><span class="in">diag(W.idw2) &lt;- 0</span></span>
<span id="cb114-707"><a href="#cb114-707" aria-hidden="true" tabindex="-1"></a><span class="in">rtot &lt;- rowSums(W.idw2,na.rm=TRUE)</span></span>
<span id="cb114-708"><a href="#cb114-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-709"><a href="#cb114-709" aria-hidden="true" tabindex="-1"></a><span class="in">W.idw.sd2 &lt;- W.idw2/rtot</span></span>
<span id="cb114-710"><a href="#cb114-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-711"><a href="#cb114-711" aria-hidden="true" tabindex="-1"></a><span class="in">W.idw.22 = mat2listw(W.idw.sd2,style='W')</span></span>
<span id="cb114-712"><a href="#cb114-712" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-713"><a href="#cb114-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-714"><a href="#cb114-714" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Eksponensial Distance Weight</span></span>
<span id="cb114-715"><a href="#cb114-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-716"><a href="#cb114-716" aria-hidden="true" tabindex="-1"></a><span class="in">```{r exponential}</span></span>
<span id="cb114-717"><a href="#cb114-717" aria-hidden="true" tabindex="-1"></a><span class="in">W.e &lt;- exp((-1)*DD^2/(2.65^2))</span></span>
<span id="cb114-718"><a href="#cb114-718" aria-hidden="true" tabindex="-1"></a><span class="in">diag(W.e) &lt;- 0</span></span>
<span id="cb114-719"><a href="#cb114-719" aria-hidden="true" tabindex="-1"></a><span class="in">rtot &lt;- rowSums(W.e,na.rm=TRUE)</span></span>
<span id="cb114-720"><a href="#cb114-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-721"><a href="#cb114-721" aria-hidden="true" tabindex="-1"></a><span class="in">W.e.sd &lt;- W.e/rtot</span></span>
<span id="cb114-722"><a href="#cb114-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-723"><a href="#cb114-723" aria-hidden="true" tabindex="-1"></a><span class="in">W.ed1 &lt;- mat2listw(W.e.sd,style = 'W')</span></span>
<span id="cb114-724"><a href="#cb114-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-725"><a href="#cb114-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-726"><a href="#cb114-726" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Rook Contiguity</span></span>
<span id="cb114-727"><a href="#cb114-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-728"><a href="#cb114-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rock}</span></span>
<span id="cb114-729"><a href="#cb114-729" aria-hidden="true" tabindex="-1"></a><span class="in">sf_use_s2(FALSE)</span></span>
<span id="cb114-730"><a href="#cb114-730" aria-hidden="true" tabindex="-1"></a><span class="in">W.rook &lt;- poly2nb(as(indonesia.map, "Spatial"),queen = F)</span></span>
<span id="cb114-731"><a href="#cb114-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-732"><a href="#cb114-732" aria-hidden="true" tabindex="-1"></a><span class="in">W.rook.s &lt;- nb2listw(W.rook,style='W', zero.policy = TRUE)</span></span>
<span id="cb114-733"><a href="#cb114-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-734"><a href="#cb114-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-735"><a href="#cb114-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-736"><a href="#cb114-736" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Queen Contiguity</span></span>
<span id="cb114-737"><a href="#cb114-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-738"><a href="#cb114-738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r queen}</span></span>
<span id="cb114-739"><a href="#cb114-739" aria-hidden="true" tabindex="-1"></a><span class="in">sf_use_s2(FALSE)</span></span>
<span id="cb114-740"><a href="#cb114-740" aria-hidden="true" tabindex="-1"></a><span class="in">W.queen &lt;- poly2nb(as(indonesia.map, "Spatial"),queen = T)</span></span>
<span id="cb114-741"><a href="#cb114-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-742"><a href="#cb114-742" aria-hidden="true" tabindex="-1"></a><span class="in">W.queen.s &lt;- nb2listw(W.queen,style='W', zero.policy =TRUE)</span></span>
<span id="cb114-743"><a href="#cb114-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-744"><a href="#cb114-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-745"><a href="#cb114-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-746"><a href="#cb114-746" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Pemilihan matriks bobot</span></span>
<span id="cb114-747"><a href="#cb114-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-748"><a href="#cb114-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r compare mtx}</span></span>
<span id="cb114-749"><a href="#cb114-749" aria-hidden="true" tabindex="-1"></a><span class="in">MI.knn &lt;- moran(imputasi$Y, W.knn1, n=length(W.knn1$neighbours), S0=Szero(W.knn1))</span></span>
<span id="cb114-750"><a href="#cb114-750" aria-hidden="true" tabindex="-1"></a><span class="in">MI.power1 &lt;-moran(imputasi$Y,W.idw.1, n =length(W.idw.1$neighbours), S0=Szero(W.idw.1))</span></span>
<span id="cb114-751"><a href="#cb114-751" aria-hidden="true" tabindex="-1"></a><span class="in">MI.power2 &lt;- moran(imputasi$Y, W.idw.22, n=length(W.idw.22$neighbours),S0=Szero(W.idw.22))</span></span>
<span id="cb114-752"><a href="#cb114-752" aria-hidden="true" tabindex="-1"></a><span class="in">MI.exp1 &lt;- moran(imputasi$Y, W.ed1, n=length(W.ed1$neighbours), S0=Szero(W.ed1))</span></span>
<span id="cb114-753"><a href="#cb114-753" aria-hidden="true" tabindex="-1"></a><span class="in">MI.rook &lt;- moran.test(imputasi$Y, W.rook.s, randomisation=TRUE, zero.policy = TRUE)</span></span>
<span id="cb114-754"><a href="#cb114-754" aria-hidden="true" tabindex="-1"></a><span class="in">MI.queen &lt;- moran.test(imputasi$Y, W.queen.s,randomisation = TRUE, zero.policy = TRUE)</span></span>
<span id="cb114-755"><a href="#cb114-755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-756"><a href="#cb114-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-757"><a href="#cb114-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r index moran}</span></span>
<span id="cb114-758"><a href="#cb114-758" aria-hidden="true" tabindex="-1"></a><span class="in">moranindeks&lt;-data.frame(</span></span>
<span id="cb114-759"><a href="#cb114-759" aria-hidden="true" tabindex="-1"></a><span class="in">  "Matriks Bobot"=c("KNN (k=5)", "Power distance weight (alpha=1)", "Power distance weight (alpha=2)", "Exponential distance weight (alpha=1)", "Rook Contiguity", "Queen Contiguity"),</span></span>
<span id="cb114-760"><a href="#cb114-760" aria-hidden="true" tabindex="-1"></a><span class="in">  "Nilai Indeks Moran"=c(MI.knn$I, MI.power1$I, MI.power2$I, MI.exp1$I, 0.087286515, 0.085003993))</span></span>
<span id="cb114-761"><a href="#cb114-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-762"><a href="#cb114-762" aria-hidden="true" tabindex="-1"></a><span class="in">moranindeks</span></span>
<span id="cb114-763"><a href="#cb114-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-764"><a href="#cb114-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-765"><a href="#cb114-765" aria-hidden="true" tabindex="-1"></a>Matrik bobot yang menghasilkan nilai Indeks Moran terbesar adalah matriks bobot KNN (k = 5)</span>
<span id="cb114-766"><a href="#cb114-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-767"><a href="#cb114-767" aria-hidden="true" tabindex="-1"></a><span class="in">```{r autocorr}</span></span>
<span id="cb114-768"><a href="#cb114-768" aria-hidden="true" tabindex="-1"></a><span class="in">#Autokorelasi spasial</span></span>
<span id="cb114-769"><a href="#cb114-769" aria-hidden="true" tabindex="-1"></a><span class="in">Woptimum &lt;- W.knn1</span></span>
<span id="cb114-770"><a href="#cb114-770" aria-hidden="true" tabindex="-1"></a><span class="in">moran.test(imputasi$Y,Woptimum, randomisation=TRUE, zero.policy = TRUE)</span></span>
<span id="cb114-771"><a href="#cb114-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-772"><a href="#cb114-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-773"><a href="#cb114-773" aria-hidden="true" tabindex="-1"></a>Tolak $H_0$ sehingga dapat dikatakan terdapat autokorelasi spasial.</span>
<span id="cb114-774"><a href="#cb114-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-775"><a href="#cb114-775" aria-hidden="true" tabindex="-1"></a><span class="fu">### Matriks pembobot spasial</span></span>
<span id="cb114-776"><a href="#cb114-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-777"><a href="#cb114-777" aria-hidden="true" tabindex="-1"></a>Karena syarat adanya efek spasial terpenuhi maka dapat dilanjutkan analisis menggunakan Regresi Gerombol Spasial. Pertama-tama perlu mendefinisikan matriks pembobot spasial dalam studi kasus ini menggunakan 9 kombinasi pembobot spasial sebagai berikut:</span>
<span id="cb114-778"><a href="#cb114-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-779"><a href="#cb114-779" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan pembobot 1 (1 atau 0) Jarak Ambang</span></span>
<span id="cb114-780"><a href="#cb114-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-781"><a href="#cb114-781" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w1}</span></span>
<span id="cb114-782"><a href="#cb114-782" aria-hidden="true" tabindex="-1"></a><span class="in">koordinat &lt;- imputasi[,c(16,17)]</span></span>
<span id="cb114-783"><a href="#cb114-783" aria-hidden="true" tabindex="-1"></a><span class="in">batas &lt;- knn2nb(knearneigh(koordinat))</span></span>
<span id="cb114-784"><a href="#cb114-784" aria-hidden="true" tabindex="-1"></a><span class="in">batas.maks &lt;- unlist(nbdists(batas, koordinat, longlat = F))</span></span>
<span id="cb114-785"><a href="#cb114-785" aria-hidden="true" tabindex="-1"></a><span class="in">summary(batas.maks)</span></span>
<span id="cb114-786"><a href="#cb114-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-787"><a href="#cb114-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-788"><a href="#cb114-788" aria-hidden="true" tabindex="-1"></a>batas dmaks agar seluruh amatan setidaknya memiliki satu tetangga ialah 2,65 km</span>
<span id="cb114-789"><a href="#cb114-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-790"><a href="#cb114-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w11}</span></span>
<span id="cb114-791"><a href="#cb114-791" aria-hidden="true" tabindex="-1"></a><span class="in">koordinat &lt;- imputasi[,c(16,17)]</span></span>
<span id="cb114-792"><a href="#cb114-792" aria-hidden="true" tabindex="-1"></a><span class="in">Sp &lt;- as.matrix(koordinat)</span></span>
<span id="cb114-793"><a href="#cb114-793" aria-hidden="true" tabindex="-1"></a><span class="in">DD &lt;- as.matrix(dist(Sp))</span></span>
<span id="cb114-794"><a href="#cb114-794" aria-hidden="true" tabindex="-1"></a><span class="in">th &lt;- 2.65</span></span>
<span id="cb114-795"><a href="#cb114-795" aria-hidden="true" tabindex="-1"></a><span class="in">W1 &lt;- matrix(0, 514, 514)</span></span>
<span id="cb114-796"><a href="#cb114-796" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:514){</span></span>
<span id="cb114-797"><a href="#cb114-797" aria-hidden="true" tabindex="-1"></a><span class="in">  W1[i,] &lt;- ifelse(DD[i,]&lt;th, 1, 0)</span></span>
<span id="cb114-798"><a href="#cb114-798" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb114-799"><a href="#cb114-799" aria-hidden="true" tabindex="-1"></a><span class="in">diag(W1) &lt;- 0</span></span>
<span id="cb114-800"><a href="#cb114-800" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-801"><a href="#cb114-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-802"><a href="#cb114-802" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan pembobot 2 (eksponensial)</span></span>
<span id="cb114-803"><a href="#cb114-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-804"><a href="#cb114-804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w2}</span></span>
<span id="cb114-805"><a href="#cb114-805" aria-hidden="true" tabindex="-1"></a><span class="in">koordinat &lt;- imputasi[,c(16,17)]</span></span>
<span id="cb114-806"><a href="#cb114-806" aria-hidden="true" tabindex="-1"></a><span class="in">Sp &lt;- as.matrix(koordinat)</span></span>
<span id="cb114-807"><a href="#cb114-807" aria-hidden="true" tabindex="-1"></a><span class="in">DD &lt;- as.matrix(dist(Sp))</span></span>
<span id="cb114-808"><a href="#cb114-808" aria-hidden="true" tabindex="-1"></a><span class="in">th &lt;- 2.65</span></span>
<span id="cb114-809"><a href="#cb114-809" aria-hidden="true" tabindex="-1"></a><span class="in">W2 &lt;- matrix(0, 514, 514)</span></span>
<span id="cb114-810"><a href="#cb114-810" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:514){</span></span>
<span id="cb114-811"><a href="#cb114-811" aria-hidden="true" tabindex="-1"></a><span class="in">  W2[i,] &lt;- exp(DD[i,]*(-1)/th^2)</span></span>
<span id="cb114-812"><a href="#cb114-812" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb114-813"><a href="#cb114-813" aria-hidden="true" tabindex="-1"></a><span class="in">diag(W2) &lt;- 0</span></span>
<span id="cb114-814"><a href="#cb114-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-815"><a href="#cb114-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-816"><a href="#cb114-816" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan pembobot 3 (KNN) k = 3</span></span>
<span id="cb114-817"><a href="#cb114-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-818"><a href="#cb114-818" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w3}</span></span>
<span id="cb114-819"><a href="#cb114-819" aria-hidden="true" tabindex="-1"></a><span class="in">nrst &lt;- lapply(1:nrow(DD), function(i) k.nearest.neighbors(i, DD, k = 3))</span></span>
<span id="cb114-820"><a href="#cb114-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-821"><a href="#cb114-821" aria-hidden="true" tabindex="-1"></a><span class="in">## Build w</span></span>
<span id="cb114-822"><a href="#cb114-822" aria-hidden="true" tabindex="-1"></a><span class="in">W3 &lt;- matrix(nrow = dim(DD), ncol=dim(DD)) ## all NA right now</span></span>
<span id="cb114-823"><a href="#cb114-823" aria-hidden="true" tabindex="-1"></a><span class="in">W3[is.na(W3)] &lt;- 0 ## populate with 0</span></span>
<span id="cb114-824"><a href="#cb114-824" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:length(nrst)) for(j in nrst[[i]]) W3[i,j] = 1</span></span>
<span id="cb114-825"><a href="#cb114-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-826"><a href="#cb114-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-827"><a href="#cb114-827" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan pembobot 4 (KNN) k = 4</span></span>
<span id="cb114-828"><a href="#cb114-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-829"><a href="#cb114-829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w4}</span></span>
<span id="cb114-830"><a href="#cb114-830" aria-hidden="true" tabindex="-1"></a><span class="in">nrst.2 &lt;- lapply(1:nrow(DD), function(i) k.nearest.neighbors(i, DD, k = 4))</span></span>
<span id="cb114-831"><a href="#cb114-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-832"><a href="#cb114-832" aria-hidden="true" tabindex="-1"></a><span class="in">## Build w</span></span>
<span id="cb114-833"><a href="#cb114-833" aria-hidden="true" tabindex="-1"></a><span class="in">W4 &lt;- matrix(nrow = dim(DD), ncol=dim(DD)) ## all NA right now</span></span>
<span id="cb114-834"><a href="#cb114-834" aria-hidden="true" tabindex="-1"></a><span class="in">W4[is.na(W4)] &lt;- 0 ## populate with 0</span></span>
<span id="cb114-835"><a href="#cb114-835" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:length(nrst.2)) for(j in nrst.2[[i]]) W4[i,j] = 1</span></span>
<span id="cb114-836"><a href="#cb114-836" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-837"><a href="#cb114-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-838"><a href="#cb114-838" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan pembobot 5 (KNN) k = 5</span></span>
<span id="cb114-839"><a href="#cb114-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-840"><a href="#cb114-840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w5}</span></span>
<span id="cb114-841"><a href="#cb114-841" aria-hidden="true" tabindex="-1"></a><span class="in">nrst.3 &lt;- lapply(1:nrow(DD), function(i) k.nearest.neighbors(i, DD, k = 5))</span></span>
<span id="cb114-842"><a href="#cb114-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-843"><a href="#cb114-843" aria-hidden="true" tabindex="-1"></a><span class="in">## Build w</span></span>
<span id="cb114-844"><a href="#cb114-844" aria-hidden="true" tabindex="-1"></a><span class="in">W5 &lt;- matrix(nrow = dim(DD), ncol=dim(DD)) ## all NA right now</span></span>
<span id="cb114-845"><a href="#cb114-845" aria-hidden="true" tabindex="-1"></a><span class="in">W5[is.na(W5)] &lt;- 0 ## populate with 0</span></span>
<span id="cb114-846"><a href="#cb114-846" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:length(nrst.3)) for(j in nrst.3[[i]]) W5[i,j] = 1</span></span>
<span id="cb114-847"><a href="#cb114-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-848"><a href="#cb114-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-849"><a href="#cb114-849" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan pembobot 6 (Invers Distance Weight)</span></span>
<span id="cb114-850"><a href="#cb114-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-851"><a href="#cb114-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w6}</span></span>
<span id="cb114-852"><a href="#cb114-852" aria-hidden="true" tabindex="-1"></a><span class="in">koordinat &lt;- imputasi[,c(16,17)]</span></span>
<span id="cb114-853"><a href="#cb114-853" aria-hidden="true" tabindex="-1"></a><span class="in">Sp &lt;- as.matrix(koordinat)</span></span>
<span id="cb114-854"><a href="#cb114-854" aria-hidden="true" tabindex="-1"></a><span class="in">DD &lt;- as.matrix(dist(Sp))</span></span>
<span id="cb114-855"><a href="#cb114-855" aria-hidden="true" tabindex="-1"></a><span class="in">#Alpha = 1 </span></span>
<span id="cb114-856"><a href="#cb114-856" aria-hidden="true" tabindex="-1"></a><span class="in">alpha1=1 </span></span>
<span id="cb114-857"><a href="#cb114-857" aria-hidden="true" tabindex="-1"></a><span class="in">W.idw &lt;-1/(DD^alpha1) </span></span>
<span id="cb114-858"><a href="#cb114-858" aria-hidden="true" tabindex="-1"></a><span class="in">class(W.idw)</span></span>
<span id="cb114-859"><a href="#cb114-859" aria-hidden="true" tabindex="-1"></a><span class="in">diag(W.idw) = 0</span></span>
<span id="cb114-860"><a href="#cb114-860" aria-hidden="true" tabindex="-1"></a><span class="in">W6 &lt;- W.idw</span></span>
<span id="cb114-861"><a href="#cb114-861" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-862"><a href="#cb114-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-863"><a href="#cb114-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-864"><a href="#cb114-864" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan pembobot 7 (Invers Distance Weight: Alpha 2)</span></span>
<span id="cb114-865"><a href="#cb114-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-866"><a href="#cb114-866" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w7}</span></span>
<span id="cb114-867"><a href="#cb114-867" aria-hidden="true" tabindex="-1"></a><span class="in">koordinat &lt;- imputasi[,c(16,17)]</span></span>
<span id="cb114-868"><a href="#cb114-868" aria-hidden="true" tabindex="-1"></a><span class="in">Sp &lt;- as.matrix(koordinat)</span></span>
<span id="cb114-869"><a href="#cb114-869" aria-hidden="true" tabindex="-1"></a><span class="in">DD &lt;- as.matrix(dist(Sp))</span></span>
<span id="cb114-870"><a href="#cb114-870" aria-hidden="true" tabindex="-1"></a><span class="in">#Alpha = 2</span></span>
<span id="cb114-871"><a href="#cb114-871" aria-hidden="true" tabindex="-1"></a><span class="in">alpha2=2  </span></span>
<span id="cb114-872"><a href="#cb114-872" aria-hidden="true" tabindex="-1"></a><span class="in">W.idw2 &lt;-1/(DD^alpha2) </span></span>
<span id="cb114-873"><a href="#cb114-873" aria-hidden="true" tabindex="-1"></a><span class="in">class(W.idw2)</span></span>
<span id="cb114-874"><a href="#cb114-874" aria-hidden="true" tabindex="-1"></a><span class="in">diag(W.idw2) = 0</span></span>
<span id="cb114-875"><a href="#cb114-875" aria-hidden="true" tabindex="-1"></a><span class="in">W7 &lt;- W.idw2</span></span>
<span id="cb114-876"><a href="#cb114-876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-877"><a href="#cb114-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-878"><a href="#cb114-878" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan Pembobot 8 (Queen Contiguity)</span></span>
<span id="cb114-879"><a href="#cb114-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-880"><a href="#cb114-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w8}</span></span>
<span id="cb114-881"><a href="#cb114-881" aria-hidden="true" tabindex="-1"></a><span class="in">sf_use_s2(FALSE)</span></span>
<span id="cb114-882"><a href="#cb114-882" aria-hidden="true" tabindex="-1"></a><span class="in">queen.w &lt;- poly2nb(as(indonesia.map, "Spatial"),queen = T)</span></span>
<span id="cb114-883"><a href="#cb114-883" aria-hidden="true" tabindex="-1"></a><span class="in">summary(queen.w)</span></span>
<span id="cb114-884"><a href="#cb114-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-885"><a href="#cb114-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-888"><a href="#cb114-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-889"><a href="#cb114-889" aria-hidden="true" tabindex="-1"></a><span class="co">#Untuk melihat bentuk matriks bobot</span></span>
<span id="cb114-890"><a href="#cb114-890" aria-hidden="true" tabindex="-1"></a>queen.w1<span class="ot">&lt;-</span><span class="fu">nb2mat</span>(queen.w,<span class="at">style =</span> <span class="st">"B"</span>, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) </span>
<span id="cb114-891"><a href="#cb114-891" aria-hidden="true" tabindex="-1"></a>W8 <span class="ot">&lt;-</span> queen.w1</span>
<span id="cb114-892"><a href="#cb114-892" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-893"><a href="#cb114-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-894"><a href="#cb114-894" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Pembentukan Pembobot 9 (Rook Contiguity)</span></span>
<span id="cb114-895"><a href="#cb114-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-896"><a href="#cb114-896" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generate w9}</span></span>
<span id="cb114-897"><a href="#cb114-897" aria-hidden="true" tabindex="-1"></a><span class="in">sf_use_s2(FALSE)</span></span>
<span id="cb114-898"><a href="#cb114-898" aria-hidden="true" tabindex="-1"></a><span class="in">rook.w &lt;- poly2nb(as(indonesia.map, "Spatial"),queen = F)</span></span>
<span id="cb114-899"><a href="#cb114-899" aria-hidden="true" tabindex="-1"></a><span class="in">summary(rook.w)</span></span>
<span id="cb114-900"><a href="#cb114-900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-901"><a href="#cb114-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-904"><a href="#cb114-904" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-905"><a href="#cb114-905" aria-hidden="true" tabindex="-1"></a><span class="co">#Untuk melihat bentuk matriks bobot</span></span>
<span id="cb114-906"><a href="#cb114-906" aria-hidden="true" tabindex="-1"></a>rook.w1<span class="ot">&lt;-</span><span class="fu">nb2mat</span>(rook.w,<span class="at">style =</span> <span class="st">"B"</span>, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) </span>
<span id="cb114-907"><a href="#cb114-907" aria-hidden="true" tabindex="-1"></a>W9 <span class="ot">&lt;-</span> rook.w1</span>
<span id="cb114-908"><a href="#cb114-908" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-909"><a href="#cb114-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-910"><a href="#cb114-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-911"><a href="#cb114-911" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol K-Means (inisiasi awal)</span></span>
<span id="cb114-912"><a href="#cb114-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-913"><a href="#cb114-913" aria-hidden="true" tabindex="-1"></a>Gerombol inisiasi awal menggunakan metode *K-means* di mana data yang digunakan untuk penggerombolan tak berhierarki adalah data koordinat (longitude dan latitude) atau data jarak antara satu lokasi amatan dengan lokasi amatan lainnya</span>
<span id="cb114-914"><a href="#cb114-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-917"><a href="#cb114-917" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-918"><a href="#cb114-918" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb114-919"><a href="#cb114-919" aria-hidden="true" tabindex="-1"></a>G3 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">3</span>)</span>
<span id="cb114-920"><a href="#cb114-920" aria-hidden="true" tabindex="-1"></a>G4 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">4</span>)</span>
<span id="cb114-921"><a href="#cb114-921" aria-hidden="true" tabindex="-1"></a>G5 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">5</span>)</span>
<span id="cb114-922"><a href="#cb114-922" aria-hidden="true" tabindex="-1"></a>G6 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">6</span>)</span>
<span id="cb114-923"><a href="#cb114-923" aria-hidden="true" tabindex="-1"></a>G7 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">7</span>)</span>
<span id="cb114-924"><a href="#cb114-924" aria-hidden="true" tabindex="-1"></a>G8 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">8</span>)</span>
<span id="cb114-925"><a href="#cb114-925" aria-hidden="true" tabindex="-1"></a>G9 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">9</span>)</span>
<span id="cb114-926"><a href="#cb114-926" aria-hidden="true" tabindex="-1"></a>G10 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">10</span>)</span>
<span id="cb114-927"><a href="#cb114-927" aria-hidden="true" tabindex="-1"></a>G11 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">11</span>)</span>
<span id="cb114-928"><a href="#cb114-928" aria-hidden="true" tabindex="-1"></a>G12 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">12</span>)</span>
<span id="cb114-929"><a href="#cb114-929" aria-hidden="true" tabindex="-1"></a>G13 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">13</span>)</span>
<span id="cb114-930"><a href="#cb114-930" aria-hidden="true" tabindex="-1"></a>G14 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">14</span>)</span>
<span id="cb114-931"><a href="#cb114-931" aria-hidden="true" tabindex="-1"></a>G15 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(Sp, <span class="dv">15</span>)</span>
<span id="cb114-932"><a href="#cb114-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-933"><a href="#cb114-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-936"><a href="#cb114-936" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-937"><a href="#cb114-937" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G3<span class="sc">$</span>cluster)</span>
<span id="cb114-938"><a href="#cb114-938" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G4<span class="sc">$</span>cluster)</span>
<span id="cb114-939"><a href="#cb114-939" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G5<span class="sc">$</span>cluster)</span>
<span id="cb114-940"><a href="#cb114-940" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G6<span class="sc">$</span>cluster)</span>
<span id="cb114-941"><a href="#cb114-941" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G7<span class="sc">$</span>cluster)</span>
<span id="cb114-942"><a href="#cb114-942" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G8<span class="sc">$</span>cluster)</span>
<span id="cb114-943"><a href="#cb114-943" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G9<span class="sc">$</span>cluster)</span>
<span id="cb114-944"><a href="#cb114-944" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G10<span class="sc">$</span>cluster)</span>
<span id="cb114-945"><a href="#cb114-945" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G11<span class="sc">$</span>cluster)</span>
<span id="cb114-946"><a href="#cb114-946" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G12<span class="sc">$</span>cluster)</span>
<span id="cb114-947"><a href="#cb114-947" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G13<span class="sc">$</span>cluster)</span>
<span id="cb114-948"><a href="#cb114-948" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G14<span class="sc">$</span>cluster)</span>
<span id="cb114-949"><a href="#cb114-949" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(G15<span class="sc">$</span>cluster)</span>
<span id="cb114-950"><a href="#cb114-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-951"><a href="#cb114-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-954"><a href="#cb114-954" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-955"><a href="#cb114-955" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> imputasi[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">16</span>,<span class="dv">17</span>)]</span>
<span id="cb114-956"><a href="#cb114-956" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G3 =</span> G3<span class="sc">$</span>cluster)</span>
<span id="cb114-957"><a href="#cb114-957" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G4 =</span> G4<span class="sc">$</span>cluster)</span>
<span id="cb114-958"><a href="#cb114-958" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G5 =</span> G5<span class="sc">$</span>cluster)</span>
<span id="cb114-959"><a href="#cb114-959" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G6 =</span> G6<span class="sc">$</span>cluster)</span>
<span id="cb114-960"><a href="#cb114-960" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G7 =</span> G7<span class="sc">$</span>cluster)</span>
<span id="cb114-961"><a href="#cb114-961" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G8 =</span> G8<span class="sc">$</span>cluster)</span>
<span id="cb114-962"><a href="#cb114-962" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G9 =</span> G9<span class="sc">$</span>cluster)</span>
<span id="cb114-963"><a href="#cb114-963" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G10 =</span> G10<span class="sc">$</span>cluster)</span>
<span id="cb114-964"><a href="#cb114-964" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G11 =</span> G11<span class="sc">$</span>cluster)</span>
<span id="cb114-965"><a href="#cb114-965" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G12 =</span> G12<span class="sc">$</span>cluster)</span>
<span id="cb114-966"><a href="#cb114-966" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G13 =</span> G13<span class="sc">$</span>cluster)</span>
<span id="cb114-967"><a href="#cb114-967" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G14 =</span> G14<span class="sc">$</span>cluster)</span>
<span id="cb114-968"><a href="#cb114-968" aria-hidden="true" tabindex="-1"></a>gerombol.kmeans <span class="ot">&lt;-</span> gerombol.kmeans <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">G15 =</span> G15<span class="sc">$</span>cluster)</span>
<span id="cb114-969"><a href="#cb114-969" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-970"><a href="#cb114-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-971"><a href="#cb114-971" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Peta Kluster K-Means</span></span>
<span id="cb114-972"><a href="#cb114-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-973"><a href="#cb114-973" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cluster map}</span></span>
<span id="cb114-974"><a href="#cb114-974" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.map &lt;- id.map</span></span>
<span id="cb114-975"><a href="#cb114-975" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.map &lt;- indonesia.map[c(-91,-92,-93,-94,-95,-127,-513,-514),]</span></span>
<span id="cb114-976"><a href="#cb114-976" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.kmeans &lt;- tigris::geo_join(spatial_data=indonesia.map, data_frame = gerombol.kmeans, by_df = "ADM2_EN",by_sp ="ADM2_EN", how = "inner")</span></span>
<span id="cb114-977"><a href="#cb114-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-978"><a href="#cb114-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-979"><a href="#cb114-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G3 map}</span></span>
<span id="cb114-980"><a href="#cb114-980" aria-hidden="true" tabindex="-1"></a><span class="in">menas3 &lt;- ggplot() +</span></span>
<span id="cb114-981"><a href="#cb114-981" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G3))) +</span></span>
<span id="cb114-982"><a href="#cb114-982" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 3",</span></span>
<span id="cb114-983"><a href="#cb114-983" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-984"><a href="#cb114-984" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-985"><a href="#cb114-985" aria-hidden="true" tabindex="-1"></a><span class="in">menas3</span></span>
<span id="cb114-986"><a href="#cb114-986" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-987"><a href="#cb114-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-988"><a href="#cb114-988" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 3`</span></span>
<span id="cb114-989"><a href="#cb114-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-990"><a href="#cb114-990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G4 map}</span></span>
<span id="cb114-991"><a href="#cb114-991" aria-hidden="true" tabindex="-1"></a><span class="in">menas4 &lt;- ggplot() +</span></span>
<span id="cb114-992"><a href="#cb114-992" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G4))) +</span></span>
<span id="cb114-993"><a href="#cb114-993" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 4",</span></span>
<span id="cb114-994"><a href="#cb114-994" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-995"><a href="#cb114-995" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-996"><a href="#cb114-996" aria-hidden="true" tabindex="-1"></a><span class="in">menas4</span></span>
<span id="cb114-997"><a href="#cb114-997" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-998"><a href="#cb114-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-999"><a href="#cb114-999" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 4`</span></span>
<span id="cb114-1000"><a href="#cb114-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1001"><a href="#cb114-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G5 map}</span></span>
<span id="cb114-1002"><a href="#cb114-1002" aria-hidden="true" tabindex="-1"></a><span class="in">menas5 &lt;- ggplot() +</span></span>
<span id="cb114-1003"><a href="#cb114-1003" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G5))) +</span></span>
<span id="cb114-1004"><a href="#cb114-1004" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 5",</span></span>
<span id="cb114-1005"><a href="#cb114-1005" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1006"><a href="#cb114-1006" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1007"><a href="#cb114-1007" aria-hidden="true" tabindex="-1"></a><span class="in">menas5</span></span>
<span id="cb114-1008"><a href="#cb114-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1009"><a href="#cb114-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1010"><a href="#cb114-1010" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 5`</span></span>
<span id="cb114-1011"><a href="#cb114-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1012"><a href="#cb114-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G6 map}</span></span>
<span id="cb114-1013"><a href="#cb114-1013" aria-hidden="true" tabindex="-1"></a><span class="in">menas6 &lt;- ggplot() +</span></span>
<span id="cb114-1014"><a href="#cb114-1014" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G6))) +</span></span>
<span id="cb114-1015"><a href="#cb114-1015" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 6",</span></span>
<span id="cb114-1016"><a href="#cb114-1016" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1017"><a href="#cb114-1017" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1018"><a href="#cb114-1018" aria-hidden="true" tabindex="-1"></a><span class="in">menas6</span></span>
<span id="cb114-1019"><a href="#cb114-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1020"><a href="#cb114-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1021"><a href="#cb114-1021" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 6`</span></span>
<span id="cb114-1022"><a href="#cb114-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1023"><a href="#cb114-1023" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G7 map}</span></span>
<span id="cb114-1024"><a href="#cb114-1024" aria-hidden="true" tabindex="-1"></a><span class="in">menas7 &lt;- ggplot() +</span></span>
<span id="cb114-1025"><a href="#cb114-1025" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G7))) +</span></span>
<span id="cb114-1026"><a href="#cb114-1026" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 7",</span></span>
<span id="cb114-1027"><a href="#cb114-1027" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1028"><a href="#cb114-1028" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1029"><a href="#cb114-1029" aria-hidden="true" tabindex="-1"></a><span class="in">menas7</span></span>
<span id="cb114-1030"><a href="#cb114-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1031"><a href="#cb114-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1032"><a href="#cb114-1032" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 7`</span></span>
<span id="cb114-1033"><a href="#cb114-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1034"><a href="#cb114-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G8 map}</span></span>
<span id="cb114-1035"><a href="#cb114-1035" aria-hidden="true" tabindex="-1"></a><span class="in">menas8 &lt;- ggplot() +</span></span>
<span id="cb114-1036"><a href="#cb114-1036" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G8))) +</span></span>
<span id="cb114-1037"><a href="#cb114-1037" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 8",</span></span>
<span id="cb114-1038"><a href="#cb114-1038" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1039"><a href="#cb114-1039" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1040"><a href="#cb114-1040" aria-hidden="true" tabindex="-1"></a><span class="in">menas8</span></span>
<span id="cb114-1041"><a href="#cb114-1041" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1042"><a href="#cb114-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1043"><a href="#cb114-1043" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 8`</span></span>
<span id="cb114-1044"><a href="#cb114-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1045"><a href="#cb114-1045" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G9 map}</span></span>
<span id="cb114-1046"><a href="#cb114-1046" aria-hidden="true" tabindex="-1"></a><span class="in">menas9 &lt;- ggplot() +</span></span>
<span id="cb114-1047"><a href="#cb114-1047" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G9))) +</span></span>
<span id="cb114-1048"><a href="#cb114-1048" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 9",</span></span>
<span id="cb114-1049"><a href="#cb114-1049" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1050"><a href="#cb114-1050" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1051"><a href="#cb114-1051" aria-hidden="true" tabindex="-1"></a><span class="in">menas9</span></span>
<span id="cb114-1052"><a href="#cb114-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1053"><a href="#cb114-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1054"><a href="#cb114-1054" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 9`</span></span>
<span id="cb114-1055"><a href="#cb114-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1056"><a href="#cb114-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G10 map}</span></span>
<span id="cb114-1057"><a href="#cb114-1057" aria-hidden="true" tabindex="-1"></a><span class="in">menas10 &lt;- ggplot() +</span></span>
<span id="cb114-1058"><a href="#cb114-1058" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G10))) +</span></span>
<span id="cb114-1059"><a href="#cb114-1059" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 10",</span></span>
<span id="cb114-1060"><a href="#cb114-1060" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1061"><a href="#cb114-1061" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1062"><a href="#cb114-1062" aria-hidden="true" tabindex="-1"></a><span class="in">menas10</span></span>
<span id="cb114-1063"><a href="#cb114-1063" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1064"><a href="#cb114-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1065"><a href="#cb114-1065" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 10`</span></span>
<span id="cb114-1066"><a href="#cb114-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1067"><a href="#cb114-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G11 map}</span></span>
<span id="cb114-1068"><a href="#cb114-1068" aria-hidden="true" tabindex="-1"></a><span class="in">menas11 &lt;- ggplot() +</span></span>
<span id="cb114-1069"><a href="#cb114-1069" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G11))) +</span></span>
<span id="cb114-1070"><a href="#cb114-1070" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 11",</span></span>
<span id="cb114-1071"><a href="#cb114-1071" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1072"><a href="#cb114-1072" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1073"><a href="#cb114-1073" aria-hidden="true" tabindex="-1"></a><span class="in">menas11</span></span>
<span id="cb114-1074"><a href="#cb114-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1075"><a href="#cb114-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1076"><a href="#cb114-1076" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 11`</span></span>
<span id="cb114-1077"><a href="#cb114-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1078"><a href="#cb114-1078" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G12 map}</span></span>
<span id="cb114-1079"><a href="#cb114-1079" aria-hidden="true" tabindex="-1"></a><span class="in">menas12 &lt;- ggplot() +</span></span>
<span id="cb114-1080"><a href="#cb114-1080" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G12))) +</span></span>
<span id="cb114-1081"><a href="#cb114-1081" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 12",</span></span>
<span id="cb114-1082"><a href="#cb114-1082" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1083"><a href="#cb114-1083" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1084"><a href="#cb114-1084" aria-hidden="true" tabindex="-1"></a><span class="in">menas12</span></span>
<span id="cb114-1085"><a href="#cb114-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1086"><a href="#cb114-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1087"><a href="#cb114-1087" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 12`</span></span>
<span id="cb114-1088"><a href="#cb114-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1089"><a href="#cb114-1089" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G13 map}</span></span>
<span id="cb114-1090"><a href="#cb114-1090" aria-hidden="true" tabindex="-1"></a><span class="in">menas13 &lt;- ggplot() +</span></span>
<span id="cb114-1091"><a href="#cb114-1091" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G13))) +</span></span>
<span id="cb114-1092"><a href="#cb114-1092" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 13",</span></span>
<span id="cb114-1093"><a href="#cb114-1093" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1094"><a href="#cb114-1094" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1095"><a href="#cb114-1095" aria-hidden="true" tabindex="-1"></a><span class="in">menas13</span></span>
<span id="cb114-1096"><a href="#cb114-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1097"><a href="#cb114-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1098"><a href="#cb114-1098" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 13`</span></span>
<span id="cb114-1099"><a href="#cb114-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1100"><a href="#cb114-1100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G14 map}</span></span>
<span id="cb114-1101"><a href="#cb114-1101" aria-hidden="true" tabindex="-1"></a><span class="in">menas14 &lt;- ggplot() +</span></span>
<span id="cb114-1102"><a href="#cb114-1102" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G14))) +</span></span>
<span id="cb114-1103"><a href="#cb114-1103" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 14",</span></span>
<span id="cb114-1104"><a href="#cb114-1104" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1105"><a href="#cb114-1105" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1106"><a href="#cb114-1106" aria-hidden="true" tabindex="-1"></a><span class="in">menas14</span></span>
<span id="cb114-1107"><a href="#cb114-1107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1108"><a href="#cb114-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1109"><a href="#cb114-1109" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 14`</span></span>
<span id="cb114-1110"><a href="#cb114-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1111"><a href="#cb114-1111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r G15 map}</span></span>
<span id="cb114-1112"><a href="#cb114-1112" aria-hidden="true" tabindex="-1"></a><span class="in">menas15 &lt;- ggplot() +</span></span>
<span id="cb114-1113"><a href="#cb114-1113" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.kmeans, aes(fill = as.factor(G15))) +</span></span>
<span id="cb114-1114"><a href="#cb114-1114" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "K-Means 15",</span></span>
<span id="cb114-1115"><a href="#cb114-1115" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1116"><a href="#cb114-1116" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1117"><a href="#cb114-1117" aria-hidden="true" tabindex="-1"></a><span class="in">menas15</span></span>
<span id="cb114-1118"><a href="#cb114-1118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1119"><a href="#cb114-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1120"><a href="#cb114-1120" aria-hidden="true" tabindex="-1"></a>Peta <span class="in">`G = 15`</span></span>
<span id="cb114-1121"><a href="#cb114-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1122"><a href="#cb114-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1123"><a href="#cb114-1123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model Regresi Gerombol Spasial dengan Peubah Y</span></span>
<span id="cb114-1124"><a href="#cb114-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1125"><a href="#cb114-1125" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 1</span></span>
<span id="cb114-1126"><a href="#cb114-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1127"><a href="#cb114-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw1}</span></span>
<span id="cb114-1128"><a href="#cb114-1128" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1129"><a href="#cb114-1129" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb114-1130"><a href="#cb114-1130" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- imputasi$Y</span></span>
<span id="cb114-1131"><a href="#cb114-1131" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(imputasi$X1,imputasi$X2,imputasi$X3,imputasi$X4,</span></span>
<span id="cb114-1132"><a href="#cb114-1132" aria-hidden="true" tabindex="-1"></a><span class="in">                     imputasi$X6,imputasi$X7,imputasi$X8))</span></span>
<span id="cb114-1133"><a href="#cb114-1133" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 15, by=1)</span></span>
<span id="cb114-1134"><a href="#cb114-1134" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.1 &lt;- SCR.select(Y, X, W1, Sp, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1135"><a href="#cb114-1135" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.1 &lt;- Y.IC.1$G    # optimal number of group via BIC</span></span>
<span id="cb114-1136"><a href="#cb114-1136" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.1</span></span>
<span id="cb114-1137"><a href="#cb114-1137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1138"><a href="#cb114-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1139"><a href="#cb114-1139" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 4</span>
<span id="cb114-1140"><a href="#cb114-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1143"><a href="#cb114-1143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1144"><a href="#cb114-1144" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W1, Sp, <span class="at">G=</span> Y.hG<span class="fl">.1</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1145"><a href="#cb114-1145" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial <span class="ot">&lt;-</span> imputasi[,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">7</span>,<span class="sc">-</span><span class="dv">8</span>,<span class="sc">-</span><span class="dv">16</span>,<span class="sc">-</span><span class="dv">17</span>)]</span>
<span id="cb114-1146"><a href="#cb114-1146" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial <span class="ot">&lt;-</span> data.gerombol.spasial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot1 =</span> fit1<span class="sc">$</span>group)</span>
<span id="cb114-1147"><a href="#cb114-1147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1148"><a href="#cb114-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1149"><a href="#cb114-1149" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 2</span></span>
<span id="cb114-1150"><a href="#cb114-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1151"><a href="#cb114-1151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw2}</span></span>
<span id="cb114-1152"><a href="#cb114-1152" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1153"><a href="#cb114-1153" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb114-1154"><a href="#cb114-1154" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- imputasi$Y</span></span>
<span id="cb114-1155"><a href="#cb114-1155" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(imputasi$X1,imputasi$X2,imputasi$X3,imputasi$X4,</span></span>
<span id="cb114-1156"><a href="#cb114-1156" aria-hidden="true" tabindex="-1"></a><span class="in">                     imputasi$X6,imputasi$X7,imputasi$X8))</span></span>
<span id="cb114-1157"><a href="#cb114-1157" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 30, by=1)</span></span>
<span id="cb114-1158"><a href="#cb114-1158" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.2 &lt;- SCR.select(Y, X, W2, Sp, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1159"><a href="#cb114-1159" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.2 &lt;- Y.IC.2$G    # optimal number of group via BIC</span></span>
<span id="cb114-1160"><a href="#cb114-1160" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.2</span></span>
<span id="cb114-1161"><a href="#cb114-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1162"><a href="#cb114-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1163"><a href="#cb114-1163" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 3</span>
<span id="cb114-1164"><a href="#cb114-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1167"><a href="#cb114-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1168"><a href="#cb114-1168" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W2, Sp, <span class="at">G=</span> Y.hG<span class="fl">.2</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1169"><a href="#cb114-1169" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial <span class="ot">&lt;-</span> data.gerombol.spasial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot2 =</span> fit2<span class="sc">$</span>group)</span>
<span id="cb114-1170"><a href="#cb114-1170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1171"><a href="#cb114-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1172"><a href="#cb114-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1173"><a href="#cb114-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 3</span></span>
<span id="cb114-1174"><a href="#cb114-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1175"><a href="#cb114-1175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw3}</span></span>
<span id="cb114-1176"><a href="#cb114-1176" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1177"><a href="#cb114-1177" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb114-1178"><a href="#cb114-1178" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- imputasi$Y</span></span>
<span id="cb114-1179"><a href="#cb114-1179" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(imputasi$X1,imputasi$X2,imputasi$X3,imputasi$X4,</span></span>
<span id="cb114-1180"><a href="#cb114-1180" aria-hidden="true" tabindex="-1"></a><span class="in">                     imputasi$X6,imputasi$X7,imputasi$X8))</span></span>
<span id="cb114-1181"><a href="#cb114-1181" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 30, by=1)</span></span>
<span id="cb114-1182"><a href="#cb114-1182" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.3 &lt;- SCR.select(Y, X, W3, Sp, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1183"><a href="#cb114-1183" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.3 &lt;- Y.IC.3$G    # optimal number of group via BIC</span></span>
<span id="cb114-1184"><a href="#cb114-1184" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.3</span></span>
<span id="cb114-1185"><a href="#cb114-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1186"><a href="#cb114-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1187"><a href="#cb114-1187" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 22</span>
<span id="cb114-1188"><a href="#cb114-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1191"><a href="#cb114-1191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1192"><a href="#cb114-1192" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W3, Sp, <span class="at">G=</span> Y.hG<span class="fl">.3</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1193"><a href="#cb114-1193" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial <span class="ot">&lt;-</span> data.gerombol.spasial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot3 =</span> fit3<span class="sc">$</span>group)</span>
<span id="cb114-1194"><a href="#cb114-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1195"><a href="#cb114-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1196"><a href="#cb114-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1197"><a href="#cb114-1197" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 4</span></span>
<span id="cb114-1198"><a href="#cb114-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1199"><a href="#cb114-1199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw4}</span></span>
<span id="cb114-1200"><a href="#cb114-1200" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1201"><a href="#cb114-1201" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb114-1202"><a href="#cb114-1202" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- imputasi$Y</span></span>
<span id="cb114-1203"><a href="#cb114-1203" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(imputasi$X1,imputasi$X2,imputasi$X3,imputasi$X4,</span></span>
<span id="cb114-1204"><a href="#cb114-1204" aria-hidden="true" tabindex="-1"></a><span class="in">                     imputasi$X6,imputasi$X7,imputasi$X8))</span></span>
<span id="cb114-1205"><a href="#cb114-1205" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 30, by=1)</span></span>
<span id="cb114-1206"><a href="#cb114-1206" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.4 &lt;- SCR.select(Y, X, W4, Sp, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1207"><a href="#cb114-1207" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.4 &lt;- Y.IC.4$G    # optimal number of group via BIC</span></span>
<span id="cb114-1208"><a href="#cb114-1208" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.4</span></span>
<span id="cb114-1209"><a href="#cb114-1209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1210"><a href="#cb114-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1211"><a href="#cb114-1211" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 7</span>
<span id="cb114-1212"><a href="#cb114-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1215"><a href="#cb114-1215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1216"><a href="#cb114-1216" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W4, Sp, <span class="at">G=</span> Y.hG<span class="fl">.4</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1217"><a href="#cb114-1217" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial <span class="ot">&lt;-</span> data.gerombol.spasial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot4 =</span> fit4<span class="sc">$</span>group)</span>
<span id="cb114-1218"><a href="#cb114-1218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1219"><a href="#cb114-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1220"><a href="#cb114-1220" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 5</span></span>
<span id="cb114-1221"><a href="#cb114-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1222"><a href="#cb114-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw5}</span></span>
<span id="cb114-1223"><a href="#cb114-1223" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1224"><a href="#cb114-1224" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb114-1225"><a href="#cb114-1225" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- imputasi$Y</span></span>
<span id="cb114-1226"><a href="#cb114-1226" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(imputasi$X1,imputasi$X2,imputasi$X3,imputasi$X4,</span></span>
<span id="cb114-1227"><a href="#cb114-1227" aria-hidden="true" tabindex="-1"></a><span class="in">                     imputasi$X6,imputasi$X7,imputasi$X8))</span></span>
<span id="cb114-1228"><a href="#cb114-1228" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 30, by=1)</span></span>
<span id="cb114-1229"><a href="#cb114-1229" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.5 &lt;- SCR.select(Y, X, W5, Sp, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1230"><a href="#cb114-1230" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.5 &lt;- Y.IC.5$G    # optimal number of group via BIC</span></span>
<span id="cb114-1231"><a href="#cb114-1231" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.5</span></span>
<span id="cb114-1232"><a href="#cb114-1232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1233"><a href="#cb114-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1234"><a href="#cb114-1234" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 6</span>
<span id="cb114-1235"><a href="#cb114-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1238"><a href="#cb114-1238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1239"><a href="#cb114-1239" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W5, Sp, <span class="at">G=</span> Y.hG<span class="fl">.5</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1240"><a href="#cb114-1240" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial <span class="ot">&lt;-</span> data.gerombol.spasial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot5 =</span> fit5<span class="sc">$</span>group)</span>
<span id="cb114-1241"><a href="#cb114-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1242"><a href="#cb114-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1243"><a href="#cb114-1243" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 6</span></span>
<span id="cb114-1244"><a href="#cb114-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1245"><a href="#cb114-1245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw6}</span></span>
<span id="cb114-1246"><a href="#cb114-1246" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1247"><a href="#cb114-1247" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb114-1248"><a href="#cb114-1248" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- imputasi$Y</span></span>
<span id="cb114-1249"><a href="#cb114-1249" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(imputasi$X1,imputasi$X2,imputasi$X3,imputasi$X4,</span></span>
<span id="cb114-1250"><a href="#cb114-1250" aria-hidden="true" tabindex="-1"></a><span class="in">                     imputasi$X6,imputasi$X7,imputasi$X8))</span></span>
<span id="cb114-1251"><a href="#cb114-1251" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 30, by=1)</span></span>
<span id="cb114-1252"><a href="#cb114-1252" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.6 &lt;- SCR.select(Y, X, W6, Sp, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1253"><a href="#cb114-1253" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.6 &lt;- Y.IC.6$G    # optimal number of group via BIC</span></span>
<span id="cb114-1254"><a href="#cb114-1254" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.6</span></span>
<span id="cb114-1255"><a href="#cb114-1255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1256"><a href="#cb114-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1257"><a href="#cb114-1257" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 5</span>
<span id="cb114-1258"><a href="#cb114-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1261"><a href="#cb114-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1262"><a href="#cb114-1262" aria-hidden="true" tabindex="-1"></a>fit6 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W6, Sp, <span class="at">G=</span> Y.hG<span class="fl">.6</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1263"><a href="#cb114-1263" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial <span class="ot">&lt;-</span> data.gerombol.spasial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot6 =</span> fit6<span class="sc">$</span>group)</span>
<span id="cb114-1264"><a href="#cb114-1264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1265"><a href="#cb114-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1266"><a href="#cb114-1266" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 7</span></span>
<span id="cb114-1267"><a href="#cb114-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1268"><a href="#cb114-1268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw7}</span></span>
<span id="cb114-1269"><a href="#cb114-1269" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1270"><a href="#cb114-1270" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1)</span></span>
<span id="cb114-1271"><a href="#cb114-1271" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- imputasi$Y</span></span>
<span id="cb114-1272"><a href="#cb114-1272" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(imputasi$X1,imputasi$X2,imputasi$X3,imputasi$X4,</span></span>
<span id="cb114-1273"><a href="#cb114-1273" aria-hidden="true" tabindex="-1"></a><span class="in">                     imputasi$X6,imputasi$X7,imputasi$X8))</span></span>
<span id="cb114-1274"><a href="#cb114-1274" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 30, by=1)</span></span>
<span id="cb114-1275"><a href="#cb114-1275" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.7 &lt;- SCR.select(Y, X, W7, Sp, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1276"><a href="#cb114-1276" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.7 &lt;- Y.IC.7$G    # optimal number of group via BIC</span></span>
<span id="cb114-1277"><a href="#cb114-1277" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.7</span></span>
<span id="cb114-1278"><a href="#cb114-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1279"><a href="#cb114-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1280"><a href="#cb114-1280" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 4</span>
<span id="cb114-1281"><a href="#cb114-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1284"><a href="#cb114-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1285"><a href="#cb114-1285" aria-hidden="true" tabindex="-1"></a>fit7 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W7, Sp, <span class="at">G=</span> Y.hG<span class="fl">.7</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1286"><a href="#cb114-1286" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial <span class="ot">&lt;-</span> data.gerombol.spasial <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot7 =</span> fit7<span class="sc">$</span>group)</span>
<span id="cb114-1287"><a href="#cb114-1287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1288"><a href="#cb114-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1289"><a href="#cb114-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 8</span></span>
<span id="cb114-1290"><a href="#cb114-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1291"><a href="#cb114-1291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw8}</span></span>
<span id="cb114-1292"><a href="#cb114-1292" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1293"><a href="#cb114-1293" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- imputasi[order(imputasi$ADM2_EN),]</span></span>
<span id="cb114-1294"><a href="#cb114-1294" aria-hidden="true" tabindex="-1"></a><span class="in">koordinat.2 &lt;- df[,c(16,17)]</span></span>
<span id="cb114-1295"><a href="#cb114-1295" aria-hidden="true" tabindex="-1"></a><span class="in">Sp.2 &lt;- as.matrix(koordinat.2)</span></span>
<span id="cb114-1296"><a href="#cb114-1296" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- df$Y</span></span>
<span id="cb114-1297"><a href="#cb114-1297" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(df$X1,df$X2,df$X3,df$X4,</span></span>
<span id="cb114-1298"><a href="#cb114-1298" aria-hidden="true" tabindex="-1"></a><span class="in">                     df$X6,df$X7,df$X8))</span></span>
<span id="cb114-1299"><a href="#cb114-1299" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 15, by=1)</span></span>
<span id="cb114-1300"><a href="#cb114-1300" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.8 &lt;- SCR.select(Y, X, W8, Sp.2, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1301"><a href="#cb114-1301" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.8 &lt;- Y.IC.8$G    # optimal number of group via BIC</span></span>
<span id="cb114-1302"><a href="#cb114-1302" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.8</span></span>
<span id="cb114-1303"><a href="#cb114-1303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1304"><a href="#cb114-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1305"><a href="#cb114-1305" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 13</span>
<span id="cb114-1306"><a href="#cb114-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1309"><a href="#cb114-1309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1310"><a href="#cb114-1310" aria-hidden="true" tabindex="-1"></a>fit8 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W8, Sp<span class="fl">.2</span>, <span class="at">G=</span> Y.hG<span class="fl">.8</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1311"><a href="#cb114-1311" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial<span class="fl">.2</span> <span class="ot">&lt;-</span> imputasi[<span class="fu">order</span>(imputasi<span class="sc">$</span>ADM2_EN),]</span>
<span id="cb114-1312"><a href="#cb114-1312" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial<span class="fl">.2</span> <span class="ot">&lt;-</span> data.gerombol.spasial<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot8 =</span> fit8<span class="sc">$</span>group)</span>
<span id="cb114-1313"><a href="#cb114-1313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1314"><a href="#cb114-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1315"><a href="#cb114-1315" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gerombol dengan pembobot 9</span></span>
<span id="cb114-1316"><a href="#cb114-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1317"><a href="#cb114-1317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clusw9}</span></span>
<span id="cb114-1318"><a href="#cb114-1318" aria-hidden="true" tabindex="-1"></a><span class="in">## SCR: spatially clustered regression</span></span>
<span id="cb114-1319"><a href="#cb114-1319" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- imputasi[order(imputasi$ADM2_EN),]</span></span>
<span id="cb114-1320"><a href="#cb114-1320" aria-hidden="true" tabindex="-1"></a><span class="in">koordinat.2 &lt;- df[,c(16,17)]</span></span>
<span id="cb114-1321"><a href="#cb114-1321" aria-hidden="true" tabindex="-1"></a><span class="in">Sp.2 &lt;- as.matrix(koordinat.2)</span></span>
<span id="cb114-1322"><a href="#cb114-1322" aria-hidden="true" tabindex="-1"></a><span class="in">Y &lt;- df$Y</span></span>
<span id="cb114-1323"><a href="#cb114-1323" aria-hidden="true" tabindex="-1"></a><span class="in">X &lt;- as.matrix(cbind(df$X1,df$X2,df$X3,df$X4,</span></span>
<span id="cb114-1324"><a href="#cb114-1324" aria-hidden="true" tabindex="-1"></a><span class="in">                     df$X6,df$X7,df$X8))</span></span>
<span id="cb114-1325"><a href="#cb114-1325" aria-hidden="true" tabindex="-1"></a><span class="in">G.set &lt;- seq(3, 15, by=1)</span></span>
<span id="cb114-1326"><a href="#cb114-1326" aria-hidden="true" tabindex="-1"></a><span class="in">Y.IC.9 &lt;- SCR.select(Y, X, W9, Sp.2, G.set=G.set, Phi=1, print=F, family="gaussian")</span></span>
<span id="cb114-1327"><a href="#cb114-1327" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.9 &lt;- Y.IC.9$G    # optimal number of group via BIC</span></span>
<span id="cb114-1328"><a href="#cb114-1328" aria-hidden="true" tabindex="-1"></a><span class="in">Y.hG.9</span></span>
<span id="cb114-1329"><a href="#cb114-1329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1330"><a href="#cb114-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1331"><a href="#cb114-1331" aria-hidden="true" tabindex="-1"></a>Gerombol optimum = 12</span>
<span id="cb114-1332"><a href="#cb114-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1335"><a href="#cb114-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1336"><a href="#cb114-1336" aria-hidden="true" tabindex="-1"></a>fit9 <span class="ot">&lt;-</span> <span class="fu">SCR</span>(Y, X, W9, Sp, <span class="at">G=</span> Y.hG<span class="fl">.9</span>, <span class="at">Phi=</span><span class="dv">1</span>)</span>
<span id="cb114-1337"><a href="#cb114-1337" aria-hidden="true" tabindex="-1"></a>data.gerombol.spasial<span class="fl">.2</span> <span class="ot">&lt;-</span> data.gerombol.spasial<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y.pembobot9 =</span> fit9<span class="sc">$</span>group)</span>
<span id="cb114-1338"><a href="#cb114-1338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1339"><a href="#cb114-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1340"><a href="#cb114-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1341"><a href="#cb114-1341" aria-hidden="true" tabindex="-1"></a><span class="fu">### Peta Gerombol Spasial</span></span>
<span id="cb114-1342"><a href="#cb114-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1343"><a href="#cb114-1343" aria-hidden="true" tabindex="-1"></a>Berikut hasil peta 9 model Regresi Gerombol Spasial</span>
<span id="cb114-1344"><a href="#cb114-1344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1345"><a href="#cb114-1345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot 9  model}</span></span>
<span id="cb114-1346"><a href="#cb114-1346" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.map &lt;- id.map</span></span>
<span id="cb114-1347"><a href="#cb114-1347" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.map &lt;- indonesia.map[c(-91,-92,-93,-94,-95,-127,-513,-514),]</span></span>
<span id="cb114-1348"><a href="#cb114-1348" aria-hidden="true" tabindex="-1"></a><span class="in">indonesia.2 &lt;- tigris::geo_join(spatial_data=indonesia.map, data_frame = data.gerombol.spasial, by_df = "ADM2_EN",by_sp ="ADM2_EN", how = "inner")</span></span>
<span id="cb114-1349"><a href="#cb114-1349" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1350"><a href="#cb114-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1351"><a href="#cb114-1351" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 1</span></span>
<span id="cb114-1352"><a href="#cb114-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1353"><a href="#cb114-1353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw1}</span></span>
<span id="cb114-1354"><a href="#cb114-1354" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot1 &lt;- ggplot() +</span></span>
<span id="cb114-1355"><a href="#cb114-1355" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot1))) +</span></span>
<span id="cb114-1356"><a href="#cb114-1356" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 1",</span></span>
<span id="cb114-1357"><a href="#cb114-1357" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1358"><a href="#cb114-1358" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1359"><a href="#cb114-1359" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot1</span></span>
<span id="cb114-1360"><a href="#cb114-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1361"><a href="#cb114-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1362"><a href="#cb114-1362" aria-hidden="true" tabindex="-1"></a>Peta Regresi Gerombol Spasial pembobot jarak ambang</span>
<span id="cb114-1363"><a href="#cb114-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1364"><a href="#cb114-1364" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 2</span></span>
<span id="cb114-1365"><a href="#cb114-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1366"><a href="#cb114-1366" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw2}</span></span>
<span id="cb114-1367"><a href="#cb114-1367" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot2 &lt;- ggplot() +</span></span>
<span id="cb114-1368"><a href="#cb114-1368" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot2))) +</span></span>
<span id="cb114-1369"><a href="#cb114-1369" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 2",</span></span>
<span id="cb114-1370"><a href="#cb114-1370" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1371"><a href="#cb114-1371" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1372"><a href="#cb114-1372" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot2</span></span>
<span id="cb114-1373"><a href="#cb114-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1374"><a href="#cb114-1374" aria-hidden="true" tabindex="-1"></a>Peta Regresi Gerombol Spasial pembobot eksponensial</span>
<span id="cb114-1375"><a href="#cb114-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1376"><a href="#cb114-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 3</span></span>
<span id="cb114-1377"><a href="#cb114-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1378"><a href="#cb114-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw3}</span></span>
<span id="cb114-1379"><a href="#cb114-1379" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot3 &lt;- ggplot() +</span></span>
<span id="cb114-1380"><a href="#cb114-1380" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot3))) +</span></span>
<span id="cb114-1381"><a href="#cb114-1381" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 3",</span></span>
<span id="cb114-1382"><a href="#cb114-1382" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1383"><a href="#cb114-1383" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1384"><a href="#cb114-1384" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot3</span></span>
<span id="cb114-1385"><a href="#cb114-1385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1386"><a href="#cb114-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1387"><a href="#cb114-1387" aria-hidden="true" tabindex="-1"></a>Peta Regresi Pembobot Spasial pembobot KNN (k = 3)</span>
<span id="cb114-1388"><a href="#cb114-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1389"><a href="#cb114-1389" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 4</span></span>
<span id="cb114-1390"><a href="#cb114-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1391"><a href="#cb114-1391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw4}</span></span>
<span id="cb114-1392"><a href="#cb114-1392" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4 &lt;- ggplot() +</span></span>
<span id="cb114-1393"><a href="#cb114-1393" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot4))) +</span></span>
<span id="cb114-1394"><a href="#cb114-1394" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 4",</span></span>
<span id="cb114-1395"><a href="#cb114-1395" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1396"><a href="#cb114-1396" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1397"><a href="#cb114-1397" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4</span></span>
<span id="cb114-1398"><a href="#cb114-1398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1399"><a href="#cb114-1399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1400"><a href="#cb114-1400" aria-hidden="true" tabindex="-1"></a>Peta Regresi Gerombol Spasial pembobot KNN (k = 4)</span>
<span id="cb114-1401"><a href="#cb114-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1402"><a href="#cb114-1402" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 5</span></span>
<span id="cb114-1403"><a href="#cb114-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1404"><a href="#cb114-1404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw5}</span></span>
<span id="cb114-1405"><a href="#cb114-1405" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot5 &lt;- ggplot() +</span></span>
<span id="cb114-1406"><a href="#cb114-1406" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot5))) +</span></span>
<span id="cb114-1407"><a href="#cb114-1407" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 5",</span></span>
<span id="cb114-1408"><a href="#cb114-1408" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1409"><a href="#cb114-1409" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1410"><a href="#cb114-1410" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot5</span></span>
<span id="cb114-1411"><a href="#cb114-1411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1412"><a href="#cb114-1412" aria-hidden="true" tabindex="-1"></a>Peta Regresi Gerombol Spasial KNN (k = 5)</span>
<span id="cb114-1413"><a href="#cb114-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1414"><a href="#cb114-1414" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 6</span></span>
<span id="cb114-1415"><a href="#cb114-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1416"><a href="#cb114-1416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw6}</span></span>
<span id="cb114-1417"><a href="#cb114-1417" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot6 &lt;- ggplot() +</span></span>
<span id="cb114-1418"><a href="#cb114-1418" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot6))) +</span></span>
<span id="cb114-1419"><a href="#cb114-1419" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 6",</span></span>
<span id="cb114-1420"><a href="#cb114-1420" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1421"><a href="#cb114-1421" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1422"><a href="#cb114-1422" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot6</span></span>
<span id="cb114-1423"><a href="#cb114-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1424"><a href="#cb114-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1425"><a href="#cb114-1425" aria-hidden="true" tabindex="-1"></a>Peta Regresi Gerombol Spasial pembobot jarak invers (alpha = 1)</span>
<span id="cb114-1426"><a href="#cb114-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1427"><a href="#cb114-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 7</span></span>
<span id="cb114-1428"><a href="#cb114-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1429"><a href="#cb114-1429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw7}</span></span>
<span id="cb114-1430"><a href="#cb114-1430" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot7 &lt;- ggplot() +</span></span>
<span id="cb114-1431"><a href="#cb114-1431" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot7))) +</span></span>
<span id="cb114-1432"><a href="#cb114-1432" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 7",</span></span>
<span id="cb114-1433"><a href="#cb114-1433" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1434"><a href="#cb114-1434" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1435"><a href="#cb114-1435" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot7</span></span>
<span id="cb114-1436"><a href="#cb114-1436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1437"><a href="#cb114-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1438"><a href="#cb114-1438" aria-hidden="true" tabindex="-1"></a>Peta Regresi Gerombol Spasial pembobot jarak invers (alpha = 2)</span>
<span id="cb114-1439"><a href="#cb114-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1440"><a href="#cb114-1440" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 8</span></span>
<span id="cb114-1441"><a href="#cb114-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1444"><a href="#cb114-1444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb114-1445"><a href="#cb114-1445" aria-hidden="true" tabindex="-1"></a>indonesia<span class="fl">.3</span> <span class="ot">&lt;-</span> tigris<span class="sc">::</span><span class="fu">geo_join</span>(<span class="at">spatial_data=</span>indonesia.map, <span class="at">data_frame =</span> data.gerombol.spasial<span class="fl">.2</span>, <span class="at">by_df =</span> <span class="st">"ADM2_EN"</span>,<span class="at">by_sp =</span><span class="st">"ADM2_EN"</span>, <span class="at">how =</span> <span class="st">"inner"</span>)</span>
<span id="cb114-1446"><a href="#cb114-1446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1447"><a href="#cb114-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1448"><a href="#cb114-1448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw8}</span></span>
<span id="cb114-1449"><a href="#cb114-1449" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot8 &lt;- ggplot() +</span></span>
<span id="cb114-1450"><a href="#cb114-1450" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.3, aes(fill = as.factor(Y.pembobot8))) +</span></span>
<span id="cb114-1451"><a href="#cb114-1451" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 8",</span></span>
<span id="cb114-1452"><a href="#cb114-1452" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1453"><a href="#cb114-1453" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1454"><a href="#cb114-1454" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot8</span></span>
<span id="cb114-1455"><a href="#cb114-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1456"><a href="#cb114-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1457"><a href="#cb114-1457" aria-hidden="true" tabindex="-1"></a>Peta Regresi Gerombol Spasial pembobot queen contiguity</span>
<span id="cb114-1458"><a href="#cb114-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1459"><a href="#cb114-1459" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Y pembobot 9</span></span>
<span id="cb114-1460"><a href="#cb114-1460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1461"><a href="#cb114-1461" aria-hidden="true" tabindex="-1"></a><span class="in">```{r yw9}</span></span>
<span id="cb114-1462"><a href="#cb114-1462" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot9 &lt;- ggplot() +</span></span>
<span id="cb114-1463"><a href="#cb114-1463" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.3, aes(fill = as.factor(Y.pembobot9))) +</span></span>
<span id="cb114-1464"><a href="#cb114-1464" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Y pembobot 9",</span></span>
<span id="cb114-1465"><a href="#cb114-1465" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1466"><a href="#cb114-1466" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw()</span></span>
<span id="cb114-1467"><a href="#cb114-1467" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot9</span></span>
<span id="cb114-1468"><a href="#cb114-1468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1469"><a href="#cb114-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1470"><a href="#cb114-1470" aria-hidden="true" tabindex="-1"></a>Peta Regresi Gerombol Spasial rook contiguity</span>
<span id="cb114-1471"><a href="#cb114-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1472"><a href="#cb114-1472" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nilai uji kebaikan model</span></span>
<span id="cb114-1473"><a href="#cb114-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1474"><a href="#cb114-1474" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MAE</span></span>
<span id="cb114-1475"><a href="#cb114-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1476"><a href="#cb114-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mae}</span></span>
<span id="cb114-1477"><a href="#cb114-1477" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.1 &lt;- mean(abs(fit1$sSig))</span></span>
<span id="cb114-1478"><a href="#cb114-1478" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.2 &lt;- mean(abs(fit2$sSig))</span></span>
<span id="cb114-1479"><a href="#cb114-1479" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.3 &lt;- mean(abs(fit3$sSig))</span></span>
<span id="cb114-1480"><a href="#cb114-1480" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.4 &lt;- mean(abs(fit4$sSig))</span></span>
<span id="cb114-1481"><a href="#cb114-1481" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.5 &lt;- mean(abs(fit5$sSig))</span></span>
<span id="cb114-1482"><a href="#cb114-1482" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.6 &lt;- mean(abs(fit6$sSig))</span></span>
<span id="cb114-1483"><a href="#cb114-1483" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.7 &lt;- mean(abs(fit7$sSig))</span></span>
<span id="cb114-1484"><a href="#cb114-1484" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.8 &lt;- mean(abs(fit8$sSig))</span></span>
<span id="cb114-1485"><a href="#cb114-1485" aria-hidden="true" tabindex="-1"></a><span class="in">MAE.9 &lt;- mean(abs(fit9$sSig))</span></span>
<span id="cb114-1486"><a href="#cb114-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1487"><a href="#cb114-1487" aria-hidden="true" tabindex="-1"></a><span class="in">MAE &lt;- c(MAE.1, MAE.2, MAE.3, MAE.4, MAE.5, MAE.6, MAE.7, MAE.8, MAE.9)</span></span>
<span id="cb114-1488"><a href="#cb114-1488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1489"><a href="#cb114-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1490"><a href="#cb114-1490" aria-hidden="true" tabindex="-1"></a><span class="fu">#### MAPE</span></span>
<span id="cb114-1491"><a href="#cb114-1491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1492"><a href="#cb114-1492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mape}</span></span>
<span id="cb114-1493"><a href="#cb114-1493" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.1 &lt;- mean(abs(fit1$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1494"><a href="#cb114-1494" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.2 &lt;- mean(abs(fit2$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1495"><a href="#cb114-1495" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.3 &lt;- mean(abs(fit3$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1496"><a href="#cb114-1496" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.4 &lt;- mean(abs(fit4$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1497"><a href="#cb114-1497" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.5 &lt;- mean(abs(fit5$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1498"><a href="#cb114-1498" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.6 &lt;- mean(abs(fit6$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1499"><a href="#cb114-1499" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.7 &lt;- mean(abs(fit7$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1500"><a href="#cb114-1500" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.8 &lt;- mean(abs(fit8$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1501"><a href="#cb114-1501" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE.9 &lt;- mean(abs(fit9$sSig/imputasi$Y)) * 100</span></span>
<span id="cb114-1502"><a href="#cb114-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1503"><a href="#cb114-1503" aria-hidden="true" tabindex="-1"></a><span class="in">MAPE &lt;- c(MAPE.1, MAPE.2, MAPE.3, MAPE.4, MAPE.5, MAPE.6, MAPE.7, MAPE.8, MAPE.9)</span></span>
<span id="cb114-1504"><a href="#cb114-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1505"><a href="#cb114-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1506"><a href="#cb114-1506" aria-hidden="true" tabindex="-1"></a><span class="fu">#### RMSE</span></span>
<span id="cb114-1507"><a href="#cb114-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1508"><a href="#cb114-1508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rmse}</span></span>
<span id="cb114-1509"><a href="#cb114-1509" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.1 &lt;- sqrt(mean(fit1$sSig^2))</span></span>
<span id="cb114-1510"><a href="#cb114-1510" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.2 &lt;- sqrt(mean(fit2$sSig^2))</span></span>
<span id="cb114-1511"><a href="#cb114-1511" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.3 &lt;- sqrt(mean(fit3$sSig^2))</span></span>
<span id="cb114-1512"><a href="#cb114-1512" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.4 &lt;- sqrt(mean(fit4$sSig^2))</span></span>
<span id="cb114-1513"><a href="#cb114-1513" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.5 &lt;- sqrt(mean(fit5$sSig^2))</span></span>
<span id="cb114-1514"><a href="#cb114-1514" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.6 &lt;- sqrt(mean(fit6$sSig^2))</span></span>
<span id="cb114-1515"><a href="#cb114-1515" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.7 &lt;- sqrt(mean(fit7$sSig^2))</span></span>
<span id="cb114-1516"><a href="#cb114-1516" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.8 &lt;- sqrt(mean(fit8$sSig^2))</span></span>
<span id="cb114-1517"><a href="#cb114-1517" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE.9 &lt;- sqrt(mean(fit9$sSig^2))</span></span>
<span id="cb114-1518"><a href="#cb114-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1519"><a href="#cb114-1519" aria-hidden="true" tabindex="-1"></a><span class="in">RMSE &lt;- c(RMSE.1, RMSE.2, RMSE.3, RMSE.4, RMSE.5, RMSE.6, RMSE.7, RMSE.8, RMSE.9)</span></span>
<span id="cb114-1520"><a href="#cb114-1520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1521"><a href="#cb114-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1522"><a href="#cb114-1522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model compare}</span></span>
<span id="cb114-1523"><a href="#cb114-1523" aria-hidden="true" tabindex="-1"></a><span class="in">Model &lt;- c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5", "Model 6", "Model 7", "Model 8", "Model 9")</span></span>
<span id="cb114-1524"><a href="#cb114-1524" aria-hidden="true" tabindex="-1"></a><span class="in">df.model &lt;- data.frame(Model, MAE, MAPE, RMSE)</span></span>
<span id="cb114-1525"><a href="#cb114-1525" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(df.model, digits = 2, "simple")</span></span>
<span id="cb114-1526"><a href="#cb114-1526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1527"><a href="#cb114-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1528"><a href="#cb114-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1529"><a href="#cb114-1529" aria-hidden="true" tabindex="-1"></a>Berdasarkan *information criterion*, uji kebaikan model, dan pola gerombol peta dipilih model 4 dengan gerombol optimum 7 dan pembobot 4-tetangga terdekat sebagai model terbaik</span>
<span id="cb114-1530"><a href="#cb114-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1531"><a href="#cb114-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1532"><a href="#cb114-1532" aria-hidden="true" tabindex="-1"></a><span class="fu">### ANOVA</span></span>
<span id="cb114-1533"><a href="#cb114-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1534"><a href="#cb114-1534" aria-hidden="true" tabindex="-1"></a>Hasil boxplot menunjukkan bahwa terdapat perbedaan antara gerombol spasial satu dengan gerombol spasial yang lain.</span>
<span id="cb114-1535"><a href="#cb114-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1536"><a href="#cb114-1536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r boxplot yw4}</span></span>
<span id="cb114-1537"><a href="#cb114-1537" aria-hidden="true" tabindex="-1"></a><span class="in">data.gerombol.spasial$Y.pembobot4 &lt;- as.factor(data.gerombol.spasial$Y.pembobot4)</span></span>
<span id="cb114-1538"><a href="#cb114-1538" aria-hidden="true" tabindex="-1"></a><span class="in">boxplot(Y ~ Y.pembobot4, data = data.gerombol.spasial,</span></span>
<span id="cb114-1539"><a href="#cb114-1539" aria-hidden="true" tabindex="-1"></a><span class="in">        col = c("white", "steelblue"))</span></span>
<span id="cb114-1540"><a href="#cb114-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1541"><a href="#cb114-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1542"><a href="#cb114-1542" aria-hidden="true" tabindex="-1"></a>Setelah didapatkan model terbaik, kemudian dilakukan analisis sidik ragam untuk mengetahui apakah terdapat perbedaan antar gerombol terhadap tingkat kemiskinan dengan hipotesis sebagai berikut:</span>
<span id="cb114-1543"><a href="#cb114-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1544"><a href="#cb114-1544" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_0$: tingkat kemiskinan antar gerombol sama</span></span>
<span id="cb114-1545"><a href="#cb114-1545" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_1$: tingkat kemiskinan antar gerombol berbeda</span></span>
<span id="cb114-1546"><a href="#cb114-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1547"><a href="#cb114-1547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r create anova}</span></span>
<span id="cb114-1548"><a href="#cb114-1548" aria-hidden="true" tabindex="-1"></a><span class="in">buat.anova &lt;- data.gerombol.spasial</span></span>
<span id="cb114-1549"><a href="#cb114-1549" aria-hidden="true" tabindex="-1"></a><span class="in">buat.anova$Y.pembobot4 &lt;- as.factor(buat.anova$Y.pembobot4)</span></span>
<span id="cb114-1550"><a href="#cb114-1550" aria-hidden="true" tabindex="-1"></a><span class="in">aov_ral &lt;- aov(Y ~ Y.pembobot4, data = buat.anova)</span></span>
<span id="cb114-1551"><a href="#cb114-1551" aria-hidden="true" tabindex="-1"></a><span class="in">summary(aov_ral)</span></span>
<span id="cb114-1552"><a href="#cb114-1552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1553"><a href="#cb114-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1554"><a href="#cb114-1554" aria-hidden="true" tabindex="-1"></a>Tabel ANOVA menunjukkan <span class="in">`p-value &lt; 0.05`</span> sehingga tolak $H_0$ atau dapat dikatakan bahwa tingkat kemiskinan antar gerombol berbeda. Berikut rataan tiap peubah untuk setiap gerombol spasial:</span>
<span id="cb114-1555"><a href="#cb114-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1556"><a href="#cb114-1556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean y}</span></span>
<span id="cb114-1557"><a href="#cb114-1557" aria-hidden="true" tabindex="-1"></a><span class="in">library(data.table)</span></span>
<span id="cb114-1558"><a href="#cb114-1558" aria-hidden="true" tabindex="-1"></a><span class="in">rata.2 &lt;- buat.anova</span></span>
<span id="cb114-1559"><a href="#cb114-1559" aria-hidden="true" tabindex="-1"></a><span class="in">peubahlain &lt;- data.gerombol.spasial</span></span>
<span id="cb114-1560"><a href="#cb114-1560" aria-hidden="true" tabindex="-1"></a><span class="in">setDT(rata.2)</span></span>
<span id="cb114-1561"><a href="#cb114-1561" aria-hidden="true" tabindex="-1"></a><span class="in">setDT(peubahlain)</span></span>
<span id="cb114-1562"><a href="#cb114-1562" aria-hidden="true" tabindex="-1"></a><span class="in">rata.2[ ,list(mean=mean(Y)), by=Y.pembobot4]</span></span>
<span id="cb114-1563"><a href="#cb114-1563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1564"><a href="#cb114-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1565"><a href="#cb114-1565" aria-hidden="true" tabindex="-1"></a>Rataan peubah **$Y$**</span>
<span id="cb114-1566"><a href="#cb114-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1567"><a href="#cb114-1567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean x1}</span></span>
<span id="cb114-1568"><a href="#cb114-1568" aria-hidden="true" tabindex="-1"></a><span class="in">peubahlain[ ,list(mean=mean(X1)), by=Y.pembobot4]</span></span>
<span id="cb114-1569"><a href="#cb114-1569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1570"><a href="#cb114-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1571"><a href="#cb114-1571" aria-hidden="true" tabindex="-1"></a>Rataan peubah **$X_1$**</span>
<span id="cb114-1572"><a href="#cb114-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1573"><a href="#cb114-1573" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean x2}</span></span>
<span id="cb114-1574"><a href="#cb114-1574" aria-hidden="true" tabindex="-1"></a><span class="in">peubahlain[ ,list(mean=mean(X2)), by=Y.pembobot4]</span></span>
<span id="cb114-1575"><a href="#cb114-1575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1576"><a href="#cb114-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1577"><a href="#cb114-1577" aria-hidden="true" tabindex="-1"></a>Rataan peubah **$X_2$**</span>
<span id="cb114-1578"><a href="#cb114-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1579"><a href="#cb114-1579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean x3}</span></span>
<span id="cb114-1580"><a href="#cb114-1580" aria-hidden="true" tabindex="-1"></a><span class="in">peubahlain[ ,list(mean=mean(X3)), by=Y.pembobot4]</span></span>
<span id="cb114-1581"><a href="#cb114-1581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1582"><a href="#cb114-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1583"><a href="#cb114-1583" aria-hidden="true" tabindex="-1"></a>Rataan peubah **$X_3$**</span>
<span id="cb114-1584"><a href="#cb114-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1585"><a href="#cb114-1585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean x4}</span></span>
<span id="cb114-1586"><a href="#cb114-1586" aria-hidden="true" tabindex="-1"></a><span class="in">peubahlain[ ,list(mean=mean(X4)), by=Y.pembobot4]</span></span>
<span id="cb114-1587"><a href="#cb114-1587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1588"><a href="#cb114-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1589"><a href="#cb114-1589" aria-hidden="true" tabindex="-1"></a>Rataan peubah **$X_4$**</span>
<span id="cb114-1590"><a href="#cb114-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1591"><a href="#cb114-1591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean x6}</span></span>
<span id="cb114-1592"><a href="#cb114-1592" aria-hidden="true" tabindex="-1"></a><span class="in">peubahlain[ ,list(mean=mean(X6)), by=Y.pembobot4]</span></span>
<span id="cb114-1593"><a href="#cb114-1593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1594"><a href="#cb114-1594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1595"><a href="#cb114-1595" aria-hidden="true" tabindex="-1"></a>Rataan peubah **$X_6$**</span>
<span id="cb114-1596"><a href="#cb114-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1597"><a href="#cb114-1597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean x7}</span></span>
<span id="cb114-1598"><a href="#cb114-1598" aria-hidden="true" tabindex="-1"></a><span class="in">peubahlain[ ,list(mean=mean(X7)), by=Y.pembobot4]</span></span>
<span id="cb114-1599"><a href="#cb114-1599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1600"><a href="#cb114-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1601"><a href="#cb114-1601" aria-hidden="true" tabindex="-1"></a>Rataan peubah **$X_7$**</span>
<span id="cb114-1602"><a href="#cb114-1602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1603"><a href="#cb114-1603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mean x8}</span></span>
<span id="cb114-1604"><a href="#cb114-1604" aria-hidden="true" tabindex="-1"></a><span class="in">peubahlain[ ,list(mean=mean(X8)), by=Y.pembobot4]</span></span>
<span id="cb114-1605"><a href="#cb114-1605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1606"><a href="#cb114-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1607"><a href="#cb114-1607" aria-hidden="true" tabindex="-1"></a>Rataan peubah **$X_8$**</span>
<span id="cb114-1608"><a href="#cb114-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1609"><a href="#cb114-1609" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Uji lanjut (Tukey)</span></span>
<span id="cb114-1610"><a href="#cb114-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1611"><a href="#cb114-1611" aria-hidden="true" tabindex="-1"></a>Sudah diketahui melalui ANOVA bahwa terdapat perbedaan tingkat kemiskinan antar gerombol. Pertanyaannya gerombol mana yang berbeda? Oleh karena itu dilakukan uji lanjut menggunakan uji Tukey untuk mengecek perbedaan tingkat kemiskinan di setiap gerombolnya sehingga dikethaui mana gerombol dengan tingkat kemiskinan sama dan gerombol dengan tingkat kemiskinan berbeda.</span>
<span id="cb114-1612"><a href="#cb114-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1613"><a href="#cb114-1613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tukey test}</span></span>
<span id="cb114-1614"><a href="#cb114-1614" aria-hidden="true" tabindex="-1"></a><span class="in">tukey.gerombol &lt;- TukeyHSD(aov_ral, 'Y.pembobot4', conf.level = 0.95)</span></span>
<span id="cb114-1615"><a href="#cb114-1615" aria-hidden="true" tabindex="-1"></a><span class="in">tukey.gerombol$Y.pembobot4</span></span>
<span id="cb114-1616"><a href="#cb114-1616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1617"><a href="#cb114-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1618"><a href="#cb114-1618" aria-hidden="true" tabindex="-1"></a>Dua gerombol diketahui berbeda nyata ketika memiliki nilai <span class="in">`p-value`</span> dibawah <span class="in">`0.05`</span> atau mengandung nilai 0 pada selang antara batas bawah dan batas atasnya. Dengan demikian, 7 gerombol yang ada di bagi menjadi 4 kelompok sebagai berikut:</span>
<span id="cb114-1619"><a href="#cb114-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1620"><a href="#cb114-1620" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Kelompok a (kemiskinan rendah) : gerombol 1</span>
<span id="cb114-1621"><a href="#cb114-1621" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Kelompok b (kemiskinan sedang) : gerombol 3, 4, 5, 6</span>
<span id="cb114-1622"><a href="#cb114-1622" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Kelompok c (kemiskinan tinggi) : gerombol 7</span>
<span id="cb114-1623"><a href="#cb114-1623" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Kelompok d (kemiskinan sangat tinggi) : gerombol 2</span>
<span id="cb114-1624"><a href="#cb114-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1625"><a href="#cb114-1625" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Peta per gerombol untuk model terbaik</span></span>
<span id="cb114-1626"><a href="#cb114-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1627"><a href="#cb114-1627" aria-hidden="true" tabindex="-1"></a>Berikut peta untuk masing-masing gerombol</span>
<span id="cb114-1628"><a href="#cb114-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1629"><a href="#cb114-1629" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gerombol ke-1</span></span>
<span id="cb114-1630"><a href="#cb114-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1631"><a href="#cb114-1631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r finclus1}</span></span>
<span id="cb114-1632"><a href="#cb114-1632" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.1 &lt;- ggplot() +</span></span>
<span id="cb114-1633"><a href="#cb114-1633" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot4))) +</span></span>
<span id="cb114-1634"><a href="#cb114-1634" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Gerombol spasial 1",</span></span>
<span id="cb114-1635"><a href="#cb114-1635" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1636"><a href="#cb114-1636" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb114-1637"><a href="#cb114-1637" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("1" = "darkblue",</span></span>
<span id="cb114-1638"><a href="#cb114-1638" aria-hidden="true" tabindex="-1"></a><span class="in">                                "2"="white", "3"="white", "4"="white", "5"="white", "6"="white", "7"="white")) </span></span>
<span id="cb114-1639"><a href="#cb114-1639" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.1</span></span>
<span id="cb114-1640"><a href="#cb114-1640" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1641"><a href="#cb114-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1642"><a href="#cb114-1642" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gerombol ke-2</span></span>
<span id="cb114-1643"><a href="#cb114-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1644"><a href="#cb114-1644" aria-hidden="true" tabindex="-1"></a><span class="in">```{r finclus2}</span></span>
<span id="cb114-1645"><a href="#cb114-1645" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.2 &lt;- ggplot() +</span></span>
<span id="cb114-1646"><a href="#cb114-1646" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot4))) +</span></span>
<span id="cb114-1647"><a href="#cb114-1647" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Gerombol spasial 2",</span></span>
<span id="cb114-1648"><a href="#cb114-1648" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1649"><a href="#cb114-1649" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb114-1650"><a href="#cb114-1650" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("2" = "darkblue",</span></span>
<span id="cb114-1651"><a href="#cb114-1651" aria-hidden="true" tabindex="-1"></a><span class="in">                                "1"="white", "3"="white", "4"="white", "5"="white", "6"="white", "7"="white")) </span></span>
<span id="cb114-1652"><a href="#cb114-1652" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.2</span></span>
<span id="cb114-1653"><a href="#cb114-1653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1654"><a href="#cb114-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1655"><a href="#cb114-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1656"><a href="#cb114-1656" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gerombol ke-3</span></span>
<span id="cb114-1657"><a href="#cb114-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1658"><a href="#cb114-1658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r finclus3}</span></span>
<span id="cb114-1659"><a href="#cb114-1659" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.3 &lt;- ggplot() +</span></span>
<span id="cb114-1660"><a href="#cb114-1660" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot4))) +</span></span>
<span id="cb114-1661"><a href="#cb114-1661" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Gerombol spasial 3",</span></span>
<span id="cb114-1662"><a href="#cb114-1662" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1663"><a href="#cb114-1663" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb114-1664"><a href="#cb114-1664" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("3" = "darkblue",</span></span>
<span id="cb114-1665"><a href="#cb114-1665" aria-hidden="true" tabindex="-1"></a><span class="in">                                "1"="white", "2"="white", "4"="white", "5"="white", "6"="white", "7"="white")) </span></span>
<span id="cb114-1666"><a href="#cb114-1666" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.3</span></span>
<span id="cb114-1667"><a href="#cb114-1667" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1668"><a href="#cb114-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1669"><a href="#cb114-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1670"><a href="#cb114-1670" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gerombol ke-4</span></span>
<span id="cb114-1671"><a href="#cb114-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1672"><a href="#cb114-1672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r finclus4}</span></span>
<span id="cb114-1673"><a href="#cb114-1673" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.4 &lt;- ggplot() +</span></span>
<span id="cb114-1674"><a href="#cb114-1674" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot4))) +</span></span>
<span id="cb114-1675"><a href="#cb114-1675" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Gerombol spasial 4",</span></span>
<span id="cb114-1676"><a href="#cb114-1676" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1677"><a href="#cb114-1677" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb114-1678"><a href="#cb114-1678" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("4" = "darkblue",</span></span>
<span id="cb114-1679"><a href="#cb114-1679" aria-hidden="true" tabindex="-1"></a><span class="in">                                "1"="white", "2"="white", "3"="white", "5"="white", "6"="white", "7"="white")) </span></span>
<span id="cb114-1680"><a href="#cb114-1680" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.4</span></span>
<span id="cb114-1681"><a href="#cb114-1681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1682"><a href="#cb114-1682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1683"><a href="#cb114-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1684"><a href="#cb114-1684" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gerombol ke-5</span></span>
<span id="cb114-1685"><a href="#cb114-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1686"><a href="#cb114-1686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r finclus5}</span></span>
<span id="cb114-1687"><a href="#cb114-1687" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.5 &lt;- ggplot() +</span></span>
<span id="cb114-1688"><a href="#cb114-1688" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot4))) +</span></span>
<span id="cb114-1689"><a href="#cb114-1689" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Gerombol spasial 5",</span></span>
<span id="cb114-1690"><a href="#cb114-1690" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1691"><a href="#cb114-1691" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb114-1692"><a href="#cb114-1692" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("5" = "darkblue",</span></span>
<span id="cb114-1693"><a href="#cb114-1693" aria-hidden="true" tabindex="-1"></a><span class="in">                                "1"="white", "2"="white", "3"="white", "4"="white", "6"="white", "7"="white")) </span></span>
<span id="cb114-1694"><a href="#cb114-1694" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.5</span></span>
<span id="cb114-1695"><a href="#cb114-1695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1696"><a href="#cb114-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1697"><a href="#cb114-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1698"><a href="#cb114-1698" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gerombol ke-6</span></span>
<span id="cb114-1699"><a href="#cb114-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1700"><a href="#cb114-1700" aria-hidden="true" tabindex="-1"></a><span class="in">```{r finclus6}</span></span>
<span id="cb114-1701"><a href="#cb114-1701" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.6 &lt;- ggplot() +</span></span>
<span id="cb114-1702"><a href="#cb114-1702" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot4))) +</span></span>
<span id="cb114-1703"><a href="#cb114-1703" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Gerombol spasial 6",</span></span>
<span id="cb114-1704"><a href="#cb114-1704" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1705"><a href="#cb114-1705" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb114-1706"><a href="#cb114-1706" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("6" = "darkblue",</span></span>
<span id="cb114-1707"><a href="#cb114-1707" aria-hidden="true" tabindex="-1"></a><span class="in">                                "1"="white", "2"="white", "3"="white", "4"="white", "5"="white", "7"="white")) </span></span>
<span id="cb114-1708"><a href="#cb114-1708" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.6</span></span>
<span id="cb114-1709"><a href="#cb114-1709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1710"><a href="#cb114-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1711"><a href="#cb114-1711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1712"><a href="#cb114-1712" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Gerombol ke-7</span></span>
<span id="cb114-1713"><a href="#cb114-1713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1714"><a href="#cb114-1714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r finclus7}</span></span>
<span id="cb114-1715"><a href="#cb114-1715" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.7 &lt;- ggplot() +</span></span>
<span id="cb114-1716"><a href="#cb114-1716" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = indonesia.2, aes(fill = as.factor(Y.pembobot4))) +</span></span>
<span id="cb114-1717"><a href="#cb114-1717" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Gerombol spasial 7",</span></span>
<span id="cb114-1718"><a href="#cb114-1718" aria-hidden="true" tabindex="-1"></a><span class="in">       fill = "Cluster") +</span></span>
<span id="cb114-1719"><a href="#cb114-1719" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_bw() +</span></span>
<span id="cb114-1720"><a href="#cb114-1720" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("7" = "darkblue",</span></span>
<span id="cb114-1721"><a href="#cb114-1721" aria-hidden="true" tabindex="-1"></a><span class="in">                                "1"="white", "2"="white", "3"="white", "4"="white", "5"="white", "6"="white")) </span></span>
<span id="cb114-1722"><a href="#cb114-1722" aria-hidden="true" tabindex="-1"></a><span class="in">Y.pembobot4.7</span></span>
<span id="cb114-1723"><a href="#cb114-1723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1724"><a href="#cb114-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1725"><a href="#cb114-1725" aria-hidden="true" tabindex="-1"></a><span class="fu">### Peubah-Peubah berpengaruh</span></span>
<span id="cb114-1726"><a href="#cb114-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1727"><a href="#cb114-1727" aria-hidden="true" tabindex="-1"></a>Peubah berpengaruh signifikan dicari menggunakan uji t pada tahap iterasi terakhir model Regresi Gerombol Spasial. peubah dengan <span class="in">`p-value`</span> lebih kecil dari <span class="in">`0.05`</span> maka dikatakan signifikan dengan hipotesis sebagai berikut:</span>
<span id="cb114-1728"><a href="#cb114-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1729"><a href="#cb114-1729" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_0$: peubah penjelas tidak berpengaruh signifikan terhadap $Y$</span></span>
<span id="cb114-1730"><a href="#cb114-1730" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; $H_1$: peubah penjelas berpengaruh signifikan terhadap $Y$</span></span>
<span id="cb114-1731"><a href="#cb114-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1732"><a href="#cb114-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb114-1733"><a href="#cb114-1733" aria-hidden="true" tabindex="-1"></a><span class="in">## Main function </span></span>
<span id="cb114-1734"><a href="#cb114-1734" aria-hidden="true" tabindex="-1"></a><span class="in">SCR &lt;- function(Y, X, W, Sp, G=5, Phi=1, offset=NULL, fuzzy=F, maxitr=100, delta=1, family="gaussian"){</span></span>
<span id="cb114-1735"><a href="#cb114-1735" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Preparations</span></span>
<span id="cb114-1736"><a href="#cb114-1736" aria-hidden="true" tabindex="-1"></a><span class="in">  ep &lt;- 10^(-5)      # convergence criterion </span></span>
<span id="cb114-1737"><a href="#cb114-1737" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- as.matrix(X)</span></span>
<span id="cb114-1738"><a href="#cb114-1738" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- dim(X)[1]     # number of samples</span></span>
<span id="cb114-1739"><a href="#cb114-1739" aria-hidden="true" tabindex="-1"></a><span class="in">  p &lt;- dim(X)[2]+1   # number of regression coefficients</span></span>
<span id="cb114-1740"><a href="#cb114-1740" aria-hidden="true" tabindex="-1"></a><span class="in">  XX &lt;- as.matrix( cbind(1,X) )</span></span>
<span id="cb114-1741"><a href="#cb114-1741" aria-hidden="true" tabindex="-1"></a><span class="in">  W &lt;- as(W, "sparseMatrix")</span></span>
<span id="cb114-1742"><a href="#cb114-1742" aria-hidden="true" tabindex="-1"></a><span class="in">  if(is.null(offset)){ offset &lt;- rep(0, n) }</span></span>
<span id="cb114-1743"><a href="#cb114-1743" aria-hidden="true" tabindex="-1"></a><span class="in">  nmax &lt;- function(x){ max(na.omit(x)) }   # new max function </span></span>
<span id="cb114-1744"><a href="#cb114-1744" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-1745"><a href="#cb114-1745" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Initial values</span></span>
<span id="cb114-1746"><a href="#cb114-1746" aria-hidden="true" tabindex="-1"></a><span class="in">  M &lt;- 20  # the number of initial values of k-means</span></span>
<span id="cb114-1747"><a href="#cb114-1747" aria-hidden="true" tabindex="-1"></a><span class="in">  WSS &lt;- c()</span></span>
<span id="cb114-1748"><a href="#cb114-1748" aria-hidden="true" tabindex="-1"></a><span class="in">  CL &lt;- list()</span></span>
<span id="cb114-1749"><a href="#cb114-1749" aria-hidden="true" tabindex="-1"></a><span class="in">  for(k in 1:M){</span></span>
<span id="cb114-1750"><a href="#cb114-1750" aria-hidden="true" tabindex="-1"></a><span class="in">    set.seed(123)</span></span>
<span id="cb114-1751"><a href="#cb114-1751" aria-hidden="true" tabindex="-1"></a><span class="in">    CL[[k]] &lt;- kmeans(Sp, G)</span></span>
<span id="cb114-1752"><a href="#cb114-1752" aria-hidden="true" tabindex="-1"></a><span class="in">    WSS[k] &lt;- CL[[k]]$tot.withinss</span></span>
<span id="cb114-1753"><a href="#cb114-1753" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-1754"><a href="#cb114-1754" aria-hidden="true" tabindex="-1"></a><span class="in">  Ind &lt;- CL[[which.min(WSS)]]$cluster</span></span>
<span id="cb114-1755"><a href="#cb114-1755" aria-hidden="true" tabindex="-1"></a><span class="in">  Pen &lt;- rep(0, G)</span></span>
<span id="cb114-1756"><a href="#cb114-1756" aria-hidden="true" tabindex="-1"></a><span class="in">  Beta &lt;- matrix(0, p, G)</span></span>
<span id="cb114-1757"><a href="#cb114-1757" aria-hidden="true" tabindex="-1"></a><span class="in">  dimnames(Beta)[[2]] &lt;- paste0("G=",1:G)</span></span>
<span id="cb114-1758"><a href="#cb114-1758" aria-hidden="true" tabindex="-1"></a><span class="in">  Sig &lt;- rep(1, G)    # not needed under non-Gaussian case</span></span>
<span id="cb114-1759"><a href="#cb114-1759" aria-hidden="true" tabindex="-1"></a><span class="in">  Nu &lt;- rep(1, G) </span></span>
<span id="cb114-1760"><a href="#cb114-1760" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-1761"><a href="#cb114-1761" aria-hidden="true" tabindex="-1"></a><span class="in">  ## iterative algorithm </span></span>
<span id="cb114-1762"><a href="#cb114-1762" aria-hidden="true" tabindex="-1"></a><span class="in">  val &lt;- 0</span></span>
<span id="cb114-1763"><a href="#cb114-1763" aria-hidden="true" tabindex="-1"></a><span class="in">  mval &lt;- 0</span></span>
<span id="cb114-1764"><a href="#cb114-1764" aria-hidden="true" tabindex="-1"></a><span class="in">  for(k in 1:maxitr){</span></span>
<span id="cb114-1765"><a href="#cb114-1765" aria-hidden="true" tabindex="-1"></a><span class="in">    cval &lt;- val</span></span>
<span id="cb114-1766"><a href="#cb114-1766" aria-hidden="true" tabindex="-1"></a><span class="in">    #print(paste("Sekarang adalah k ke-", k))</span></span>
<span id="cb114-1767"><a href="#cb114-1767" aria-hidden="true" tabindex="-1"></a><span class="in">    ## penalty term</span></span>
<span id="cb114-1768"><a href="#cb114-1768" aria-hidden="true" tabindex="-1"></a><span class="in">    Ind.mat &lt;- matrix(0, n, G)</span></span>
<span id="cb114-1769"><a href="#cb114-1769" aria-hidden="true" tabindex="-1"></a><span class="in">    for(g in 1:G){</span></span>
<span id="cb114-1770"><a href="#cb114-1770" aria-hidden="true" tabindex="-1"></a><span class="in">      Ind.mat[Ind==g, g] &lt;- 1</span></span>
<span id="cb114-1771"><a href="#cb114-1771" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-1772"><a href="#cb114-1772" aria-hidden="true" tabindex="-1"></a><span class="in">    Ind.mat &lt;- as(Ind.mat, "sparseMatrix")</span></span>
<span id="cb114-1773"><a href="#cb114-1773" aria-hidden="true" tabindex="-1"></a><span class="in">    Pen &lt;- W%*%Ind.mat     # penalty term</span></span>
<span id="cb114-1774"><a href="#cb114-1774" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-1775"><a href="#cb114-1775" aria-hidden="true" tabindex="-1"></a><span class="in">    ## model parameters (clustered case)</span></span>
<span id="cb114-1776"><a href="#cb114-1776" aria-hidden="true" tabindex="-1"></a><span class="in">    if(fuzzy==F){</span></span>
<span id="cb114-1777"><a href="#cb114-1777" aria-hidden="true" tabindex="-1"></a><span class="in">      for(g in 1:G){</span></span>
<span id="cb114-1778"><a href="#cb114-1778" aria-hidden="true" tabindex="-1"></a><span class="in">        print(paste("length sepanjang", length(Ind[Ind==g]), "dan p + 1 sebesar", p+1))</span></span>
<span id="cb114-1779"><a href="#cb114-1779" aria-hidden="true" tabindex="-1"></a><span class="in">        if(length(Ind[Ind==g])&gt;p+1){</span></span>
<span id="cb114-1780"><a href="#cb114-1780" aria-hidden="true" tabindex="-1"></a><span class="in">          # gaussian</span></span>
<span id="cb114-1781"><a href="#cb114-1781" aria-hidden="true" tabindex="-1"></a><span class="in">          if(family=="gaussian"){</span></span>
<span id="cb114-1782"><a href="#cb114-1782" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- lm(Y[Ind==g]~X[Ind==g,])</span></span>
<span id="cb114-1783"><a href="#cb114-1783" aria-hidden="true" tabindex="-1"></a><span class="in">            print(paste("Sekarang adalah gerombol ke-", g))</span></span>
<span id="cb114-1784"><a href="#cb114-1784" aria-hidden="true" tabindex="-1"></a><span class="in">            print(summary(fit)) #Jika ingin melihat peubah berpengaruh maka hilangkan tanda pagar</span></span>
<span id="cb114-1785"><a href="#cb114-1785" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-1786"><a href="#cb114-1786" aria-hidden="true" tabindex="-1"></a><span class="in">            resid &lt;- Y-as.vector(XX%*%Beta[,g])</span></span>
<span id="cb114-1787"><a href="#cb114-1787" aria-hidden="true" tabindex="-1"></a><span class="in">            Sig[g] &lt;- sqrt(mean(resid[Ind==g]^2))</span></span>
<span id="cb114-1788"><a href="#cb114-1788" aria-hidden="true" tabindex="-1"></a><span class="in">            Sig[g] &lt;- max(Sig[g], 0.1)</span></span>
<span id="cb114-1789"><a href="#cb114-1789" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-1790"><a href="#cb114-1790" aria-hidden="true" tabindex="-1"></a><span class="in">          # poisson</span></span>
<span id="cb114-1791"><a href="#cb114-1791" aria-hidden="true" tabindex="-1"></a><span class="in">          if(family=="poisson"){</span></span>
<span id="cb114-1792"><a href="#cb114-1792" aria-hidden="true" tabindex="-1"></a><span class="in">            x &lt;- X[Ind==g,]</span></span>
<span id="cb114-1793"><a href="#cb114-1793" aria-hidden="true" tabindex="-1"></a><span class="in">            y &lt;- Y[Ind==g]</span></span>
<span id="cb114-1794"><a href="#cb114-1794" aria-hidden="true" tabindex="-1"></a><span class="in">            off &lt;- offset[Ind==g]</span></span>
<span id="cb114-1795"><a href="#cb114-1795" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- glm(y~x, offset=off, family="poisson")</span></span>
<span id="cb114-1796"><a href="#cb114-1796" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-1797"><a href="#cb114-1797" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-1798"><a href="#cb114-1798" aria-hidden="true" tabindex="-1"></a><span class="in">          # NB</span></span>
<span id="cb114-1799"><a href="#cb114-1799" aria-hidden="true" tabindex="-1"></a><span class="in">          if(family=="NB"){</span></span>
<span id="cb114-1800"><a href="#cb114-1800" aria-hidden="true" tabindex="-1"></a><span class="in">            x &lt;- X[Ind==g,]</span></span>
<span id="cb114-1801"><a href="#cb114-1801" aria-hidden="true" tabindex="-1"></a><span class="in">            y &lt;- Y[Ind==g]</span></span>
<span id="cb114-1802"><a href="#cb114-1802" aria-hidden="true" tabindex="-1"></a><span class="in">            off &lt;- offset[Ind==g]</span></span>
<span id="cb114-1803"><a href="#cb114-1803" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- glm.nb(y~x+offset(off))</span></span>
<span id="cb114-1804"><a href="#cb114-1804" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef( fit ) )</span></span>
<span id="cb114-1805"><a href="#cb114-1805" aria-hidden="true" tabindex="-1"></a><span class="in">            Nu[g] &lt;- fit$theta</span></span>
<span id="cb114-1806"><a href="#cb114-1806" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-1807"><a href="#cb114-1807" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb114-1808"><a href="#cb114-1808" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1809"><a href="#cb114-1809" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-1810"><a href="#cb114-1810" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-1811"><a href="#cb114-1811" aria-hidden="true" tabindex="-1"></a><span class="in">    ## model parameters (fuzzy case)</span></span>
<span id="cb114-1812"><a href="#cb114-1812" aria-hidden="true" tabindex="-1"></a><span class="in">    if(fuzzy==T){</span></span>
<span id="cb114-1813"><a href="#cb114-1813" aria-hidden="true" tabindex="-1"></a><span class="in">      # Gaussian</span></span>
<span id="cb114-1814"><a href="#cb114-1814" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="gaussian"){</span></span>
<span id="cb114-1815"><a href="#cb114-1815" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- XX%*%Beta      # (n,G)-matrix</span></span>
<span id="cb114-1816"><a href="#cb114-1816" aria-hidden="true" tabindex="-1"></a><span class="in">        ESig &lt;- t(matrix(rep(Sig,n), G, n))    # (n,G)-matrix</span></span>
<span id="cb114-1817"><a href="#cb114-1817" aria-hidden="true" tabindex="-1"></a><span class="in">        log.dens &lt;- log(dnorm(Y,Mu,ESig)) + Phi*Pen</span></span>
<span id="cb114-1818"><a href="#cb114-1818" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(log.dens, 1, max)</span></span>
<span id="cb114-1819"><a href="#cb114-1819" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(log.dens-mval), 1, sum))</span></span>
<span id="cb114-1820"><a href="#cb114-1820" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(log.dens-log.denom)     # weight</span></span>
<span id="cb114-1821"><a href="#cb114-1821" aria-hidden="true" tabindex="-1"></a><span class="in">        for(g in 1:G){ </span></span>
<span id="cb114-1822"><a href="#cb114-1822" aria-hidden="true" tabindex="-1"></a><span class="in">          if(sum(PP[,g])&gt;0.1){</span></span>
<span id="cb114-1823"><a href="#cb114-1823" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- lm(Y~X, weights=PP[,g])</span></span>
<span id="cb114-1824"><a href="#cb114-1824" aria-hidden="true" tabindex="-1"></a><span class="in">            </span></span>
<span id="cb114-1825"><a href="#cb114-1825" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-1826"><a href="#cb114-1826" aria-hidden="true" tabindex="-1"></a><span class="in">            resid &lt;- Y-as.vector(XX%*%Beta[,g])</span></span>
<span id="cb114-1827"><a href="#cb114-1827" aria-hidden="true" tabindex="-1"></a><span class="in">            Sig[g] &lt;- sqrt( sum(PP[,g]*resid^2)/sum(PP[,g]) )</span></span>
<span id="cb114-1828"><a href="#cb114-1828" aria-hidden="true" tabindex="-1"></a><span class="in">            Sig[g] &lt;- max(Sig[g], 0.1)</span></span>
<span id="cb114-1829"><a href="#cb114-1829" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-1830"><a href="#cb114-1830" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb114-1831"><a href="#cb114-1831" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1832"><a href="#cb114-1832" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb114-1833"><a href="#cb114-1833" aria-hidden="true" tabindex="-1"></a><span class="in">      # Poisson</span></span>
<span id="cb114-1834"><a href="#cb114-1834" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="poisson"){</span></span>
<span id="cb114-1835"><a href="#cb114-1835" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta)    # (n,G)-matrix</span></span>
<span id="cb114-1836"><a href="#cb114-1836" aria-hidden="true" tabindex="-1"></a><span class="in">        log.dens &lt;- log(dpois(Y, Mu)) + Phi*Pen </span></span>
<span id="cb114-1837"><a href="#cb114-1837" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(log.dens, 1, max)</span></span>
<span id="cb114-1838"><a href="#cb114-1838" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(log.dens-mval), 1, sum))</span></span>
<span id="cb114-1839"><a href="#cb114-1839" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(log.dens-log.denom)     # weight</span></span>
<span id="cb114-1840"><a href="#cb114-1840" aria-hidden="true" tabindex="-1"></a><span class="in">        for(g in 1:G){</span></span>
<span id="cb114-1841"><a href="#cb114-1841" aria-hidden="true" tabindex="-1"></a><span class="in">          if(sum(PP[,g])&gt;0.1){</span></span>
<span id="cb114-1842"><a href="#cb114-1842" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- glm(Y~X, offset=offset, weights=PP[,g], family="poisson")</span></span>
<span id="cb114-1843"><a href="#cb114-1843" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-1844"><a href="#cb114-1844" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-1845"><a href="#cb114-1845" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb114-1846"><a href="#cb114-1846" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1847"><a href="#cb114-1847" aria-hidden="true" tabindex="-1"></a><span class="in">      # NB</span></span>
<span id="cb114-1848"><a href="#cb114-1848" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="NB"){</span></span>
<span id="cb114-1849"><a href="#cb114-1849" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta)    # (n,G)-matrix</span></span>
<span id="cb114-1850"><a href="#cb114-1850" aria-hidden="true" tabindex="-1"></a><span class="in">        log.dens &lt;- dnbinom(Y, size=Nu, prob=Nu/(Nu+Mu), log=T) + Phi*Pen </span></span>
<span id="cb114-1851"><a href="#cb114-1851" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(log.dens, 1, max)</span></span>
<span id="cb114-1852"><a href="#cb114-1852" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(log.dens-mval), 1, sum))</span></span>
<span id="cb114-1853"><a href="#cb114-1853" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(log.dens-log.denom)     # weight</span></span>
<span id="cb114-1854"><a href="#cb114-1854" aria-hidden="true" tabindex="-1"></a><span class="in">        for(g in 1:G){</span></span>
<span id="cb114-1855"><a href="#cb114-1855" aria-hidden="true" tabindex="-1"></a><span class="in">          if(sum(PP[,g])&gt;0.1){</span></span>
<span id="cb114-1856"><a href="#cb114-1856" aria-hidden="true" tabindex="-1"></a><span class="in">            fit &lt;- glm.nb(Y~X+offset(offset), weights=PP[,g])</span></span>
<span id="cb114-1857"><a href="#cb114-1857" aria-hidden="true" tabindex="-1"></a><span class="in">            Beta[,g] &lt;- as.vector( coef(fit) )</span></span>
<span id="cb114-1858"><a href="#cb114-1858" aria-hidden="true" tabindex="-1"></a><span class="in">            Nu[g] &lt;- fit$theta</span></span>
<span id="cb114-1859"><a href="#cb114-1859" aria-hidden="true" tabindex="-1"></a><span class="in">          }</span></span>
<span id="cb114-1860"><a href="#cb114-1860" aria-hidden="true" tabindex="-1"></a><span class="in">        }</span></span>
<span id="cb114-1861"><a href="#cb114-1861" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1862"><a href="#cb114-1862" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-1863"><a href="#cb114-1863" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-1864"><a href="#cb114-1864" aria-hidden="true" tabindex="-1"></a><span class="in">    ## Grouping (clustered case)</span></span>
<span id="cb114-1865"><a href="#cb114-1865" aria-hidden="true" tabindex="-1"></a><span class="in">    if(fuzzy==F){</span></span>
<span id="cb114-1866"><a href="#cb114-1866" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="gaussian"){</span></span>
<span id="cb114-1867"><a href="#cb114-1867" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- XX%*%Beta      # (n,G)-matrix</span></span>
<span id="cb114-1868"><a href="#cb114-1868" aria-hidden="true" tabindex="-1"></a><span class="in">        ESig &lt;- t(matrix(rep(Sig,n), G, n))    # (n,G)-matrix</span></span>
<span id="cb114-1869"><a href="#cb114-1869" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- dnorm(Y, Mu, ESig, log=T) + Phi*Pen     # penalized likelihood</span></span>
<span id="cb114-1870"><a href="#cb114-1870" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1871"><a href="#cb114-1871" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="poisson"){ </span></span>
<span id="cb114-1872"><a href="#cb114-1872" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta) </span></span>
<span id="cb114-1873"><a href="#cb114-1873" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- dpois(Y, Mu, log=T)  + Phi*Pen    # penalized likelihood</span></span>
<span id="cb114-1874"><a href="#cb114-1874" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1875"><a href="#cb114-1875" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="NB"){ </span></span>
<span id="cb114-1876"><a href="#cb114-1876" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta) </span></span>
<span id="cb114-1877"><a href="#cb114-1877" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- dnbinom(Y, size=Nu, prob=Nu/(Nu+Mu), log=T)  + Phi*Pen    # penalized likelihood</span></span>
<span id="cb114-1878"><a href="#cb114-1878" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1879"><a href="#cb114-1879" aria-hidden="true" tabindex="-1"></a><span class="in">      Ind &lt;- apply(Q, 1, which.max)</span></span>
<span id="cb114-1880"><a href="#cb114-1880" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-1881"><a href="#cb114-1881" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-1882"><a href="#cb114-1882" aria-hidden="true" tabindex="-1"></a><span class="in">    ## Grouping (fuzzy case)</span></span>
<span id="cb114-1883"><a href="#cb114-1883" aria-hidden="true" tabindex="-1"></a><span class="in">    if(fuzzy==T){</span></span>
<span id="cb114-1884"><a href="#cb114-1884" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="gaussian"){</span></span>
<span id="cb114-1885"><a href="#cb114-1885" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- XX%*%Beta      # (n,G)-matrix</span></span>
<span id="cb114-1886"><a href="#cb114-1886" aria-hidden="true" tabindex="-1"></a><span class="in">        ESig &lt;- t(matrix(rep(Sig,n), G, n))    # (n,G)-matrix</span></span>
<span id="cb114-1887"><a href="#cb114-1887" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- delta*(dnorm(Y, Mu, ESig, log=T) + Phi*Pen)   # penalized likelihood</span></span>
<span id="cb114-1888"><a href="#cb114-1888" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(Q, 1, max)</span></span>
<span id="cb114-1889"><a href="#cb114-1889" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(Q-mval), 1, sum))</span></span>
<span id="cb114-1890"><a href="#cb114-1890" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(Q-log.denom)</span></span>
<span id="cb114-1891"><a href="#cb114-1891" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1892"><a href="#cb114-1892" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="poisson"){ </span></span>
<span id="cb114-1893"><a href="#cb114-1893" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta)    # (n,G)-matrix</span></span>
<span id="cb114-1894"><a href="#cb114-1894" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- delta*(dpois(Y, Mu, log=T)  + Phi*Pen)   # penalized likelihood</span></span>
<span id="cb114-1895"><a href="#cb114-1895" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(Q, 1, max)</span></span>
<span id="cb114-1896"><a href="#cb114-1896" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(Q-mval), 1, sum))</span></span>
<span id="cb114-1897"><a href="#cb114-1897" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(Q-log.denom)</span></span>
<span id="cb114-1898"><a href="#cb114-1898" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1899"><a href="#cb114-1899" aria-hidden="true" tabindex="-1"></a><span class="in">      if(family=="NB"){ </span></span>
<span id="cb114-1900"><a href="#cb114-1900" aria-hidden="true" tabindex="-1"></a><span class="in">        Mu &lt;- exp(offset + XX%*%Beta)    # (n,G)-matrix</span></span>
<span id="cb114-1901"><a href="#cb114-1901" aria-hidden="true" tabindex="-1"></a><span class="in">        Q &lt;- delta*(dnbinom(Y, size=Nu, prob=Nu/(Nu+Mu), log=T) + Phi*Pen)   # penalized likelihood</span></span>
<span id="cb114-1902"><a href="#cb114-1902" aria-hidden="true" tabindex="-1"></a><span class="in">        mval &lt;- apply(Q, 1, max)</span></span>
<span id="cb114-1903"><a href="#cb114-1903" aria-hidden="true" tabindex="-1"></a><span class="in">        log.denom &lt;- mval + log(apply(exp(Q-mval), 1, sum))</span></span>
<span id="cb114-1904"><a href="#cb114-1904" aria-hidden="true" tabindex="-1"></a><span class="in">        PP &lt;- exp(Q-log.denom)</span></span>
<span id="cb114-1905"><a href="#cb114-1905" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb114-1906"><a href="#cb114-1906" aria-hidden="true" tabindex="-1"></a><span class="in">      Ind &lt;- apply(PP, 1, which.max)</span></span>
<span id="cb114-1907"><a href="#cb114-1907" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb114-1908"><a href="#cb114-1908" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb114-1909"><a href="#cb114-1909" aria-hidden="true" tabindex="-1"></a><span class="in">    ## Value of objective function</span></span>
<span id="cb114-1910"><a href="#cb114-1910" aria-hidden="true" tabindex="-1"></a><span class="in">    val &lt;- sum( apply(Q, 1, nmax) ) </span></span>
<span id="cb114-1911"><a href="#cb114-1911" aria-hidden="true" tabindex="-1"></a><span class="in">    dd &lt;- abs(cval-val)/abs(val)</span></span>
<span id="cb114-1912"><a href="#cb114-1912" aria-hidden="true" tabindex="-1"></a><span class="in">    mval &lt;- max(mval, cval)</span></span>
<span id="cb114-1913"><a href="#cb114-1913" aria-hidden="true" tabindex="-1"></a><span class="in">    if( dd&lt;ep | abs(mval-val)&lt;ep ){ break }</span></span>
<span id="cb114-1914"><a href="#cb114-1914" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-1915"><a href="#cb114-1915" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-1916"><a href="#cb114-1916" aria-hidden="true" tabindex="-1"></a><span class="in">  ## varying parameters</span></span>
<span id="cb114-1917"><a href="#cb114-1917" aria-hidden="true" tabindex="-1"></a><span class="in">  if(fuzzy==F){  sBeta &lt;- t(Beta[,Ind]) }</span></span>
<span id="cb114-1918"><a href="#cb114-1918" aria-hidden="true" tabindex="-1"></a><span class="in">  if(fuzzy==T){  sBeta &lt;- PP%*%t(Beta) }</span></span>
<span id="cb114-1919"><a href="#cb114-1919" aria-hidden="true" tabindex="-1"></a><span class="in">  sSig &lt;- Sig[Ind]     # location-wise error variance</span></span>
<span id="cb114-1920"><a href="#cb114-1920" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-1921"><a href="#cb114-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1922"><a href="#cb114-1922" aria-hidden="true" tabindex="-1"></a><span class="in">  ## maximum likelihood </span></span>
<span id="cb114-1923"><a href="#cb114-1923" aria-hidden="true" tabindex="-1"></a><span class="in">  if(family=="gaussian"){</span></span>
<span id="cb114-1924"><a href="#cb114-1924" aria-hidden="true" tabindex="-1"></a><span class="in">    hmu &lt;- apply(XX*sBeta, 1, sum)</span></span>
<span id="cb114-1925"><a href="#cb114-1925" aria-hidden="true" tabindex="-1"></a><span class="in">    ML &lt;- sum( dnorm(Y, hmu, sSig, log=T) ) </span></span>
<span id="cb114-1926"><a href="#cb114-1926" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-1927"><a href="#cb114-1927" aria-hidden="true" tabindex="-1"></a><span class="in">  if(family=="poisson"){</span></span>
<span id="cb114-1928"><a href="#cb114-1928" aria-hidden="true" tabindex="-1"></a><span class="in">    hmu &lt;- exp(offset + apply(XX*sBeta, 1, sum))</span></span>
<span id="cb114-1929"><a href="#cb114-1929" aria-hidden="true" tabindex="-1"></a><span class="in">    ML &lt;- sum( dpois(Y, hmu, log=T) ) </span></span>
<span id="cb114-1930"><a href="#cb114-1930" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-1931"><a href="#cb114-1931" aria-hidden="true" tabindex="-1"></a><span class="in">  if(family=="NB"){</span></span>
<span id="cb114-1932"><a href="#cb114-1932" aria-hidden="true" tabindex="-1"></a><span class="in">    sNu &lt;- Nu[Ind]</span></span>
<span id="cb114-1933"><a href="#cb114-1933" aria-hidden="true" tabindex="-1"></a><span class="in">    hmu &lt;- exp(offset + apply(XX*sBeta, 1, sum))</span></span>
<span id="cb114-1934"><a href="#cb114-1934" aria-hidden="true" tabindex="-1"></a><span class="in">    ML &lt;- sum( dnbinom(Y, size=sNu, prob=sNu/(sNu+hmu), log=T) ) </span></span>
<span id="cb114-1935"><a href="#cb114-1935" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-1936"><a href="#cb114-1936" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-1937"><a href="#cb114-1937" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Results</span></span>
<span id="cb114-1938"><a href="#cb114-1938" aria-hidden="true" tabindex="-1"></a><span class="in">  result &lt;- list(Beta=Beta, Sig=Sig, Nu=Nu, group=Ind, sBeta=sBeta, sSig=sSig, ML=ML, itr=k)</span></span>
<span id="cb114-1939"><a href="#cb114-1939" aria-hidden="true" tabindex="-1"></a><span class="in">  return(result)</span></span>
<span id="cb114-1940"><a href="#cb114-1940" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb114-1941"><a href="#cb114-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1942"><a href="#cb114-1942" aria-hidden="true" tabindex="-1"></a><span class="in">###  Selection of tuning parameters  ###</span></span>
<span id="cb114-1943"><a href="#cb114-1943" aria-hidden="true" tabindex="-1"></a><span class="in">## Imput</span></span>
<span id="cb114-1944"><a href="#cb114-1944" aria-hidden="true" tabindex="-1"></a><span class="in"># most of inputs are the same as 'SCR' </span></span>
<span id="cb114-1945"><a href="#cb114-1945" aria-hidden="true" tabindex="-1"></a><span class="in"># G.set: vector of candidates for G</span></span>
<span id="cb114-1946"><a href="#cb114-1946" aria-hidden="true" tabindex="-1"></a><span class="in"># print: if True, interim progress is reported </span></span>
<span id="cb114-1947"><a href="#cb114-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1948"><a href="#cb114-1948" aria-hidden="true" tabindex="-1"></a><span class="in">## Output</span></span>
<span id="cb114-1949"><a href="#cb114-1949" aria-hidden="true" tabindex="-1"></a><span class="in"># BIC: BIC-type criteria</span></span>
<span id="cb114-1950"><a href="#cb114-1950" aria-hidden="true" tabindex="-1"></a><span class="in"># select: selection results </span></span>
<span id="cb114-1951"><a href="#cb114-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1952"><a href="#cb114-1952" aria-hidden="true" tabindex="-1"></a><span class="in">## Main function </span></span>
<span id="cb114-1953"><a href="#cb114-1953" aria-hidden="true" tabindex="-1"></a><span class="in">SCR.select &lt;- function(Y, X, W, Sp, G.set=NULL, Phi=1, offset=NULL, maxitr=50, print=T, family="gaussian"){</span></span>
<span id="cb114-1954"><a href="#cb114-1954" aria-hidden="true" tabindex="-1"></a><span class="in">  ## Preparations</span></span>
<span id="cb114-1955"><a href="#cb114-1955" aria-hidden="true" tabindex="-1"></a><span class="in">  if(is.null(G.set)){ G.set &lt;- seq(10, 40, by=5) }</span></span>
<span id="cb114-1956"><a href="#cb114-1956" aria-hidden="true" tabindex="-1"></a><span class="in">  X &lt;- as.matrix(X)</span></span>
<span id="cb114-1957"><a href="#cb114-1957" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- dim(X)[1]</span></span>
<span id="cb114-1958"><a href="#cb114-1958" aria-hidden="true" tabindex="-1"></a><span class="in">  p &lt;- dim(X)[2]+1</span></span>
<span id="cb114-1959"><a href="#cb114-1959" aria-hidden="true" tabindex="-1"></a><span class="in">  L &lt;- length(G.set)</span></span>
<span id="cb114-1960"><a href="#cb114-1960" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-1961"><a href="#cb114-1961" aria-hidden="true" tabindex="-1"></a><span class="in">  ## computing information criteria</span></span>
<span id="cb114-1962"><a href="#cb114-1962" aria-hidden="true" tabindex="-1"></a><span class="in">  BIC &lt;- c()</span></span>
<span id="cb114-1963"><a href="#cb114-1963" aria-hidden="true" tabindex="-1"></a><span class="in">  for(l in 1:L){</span></span>
<span id="cb114-1964"><a href="#cb114-1964" aria-hidden="true" tabindex="-1"></a><span class="in">    fit &lt;- SCR(Y, X, W, Sp, offset=offset, G=G.set[l], Phi=Phi, maxitr=maxitr, family=family)</span></span>
<span id="cb114-1965"><a href="#cb114-1965" aria-hidden="true" tabindex="-1"></a><span class="in">    pp &lt;- length(fit$Beta) </span></span>
<span id="cb114-1966"><a href="#cb114-1966" aria-hidden="true" tabindex="-1"></a><span class="in">    if(family=="gaussian"| family=="NB"){ pp &lt;- pp + G.set[l] }</span></span>
<span id="cb114-1967"><a href="#cb114-1967" aria-hidden="true" tabindex="-1"></a><span class="in">    BIC[l] &lt;- -2*fit$ML + log(n)*pp</span></span>
<span id="cb114-1968"><a href="#cb114-1968" aria-hidden="true" tabindex="-1"></a><span class="in">    if(print){ print( paste0("G=",G.set[l], ", iteration=", fit$itr) ) }</span></span>
<span id="cb114-1969"><a href="#cb114-1969" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb114-1970"><a href="#cb114-1970" aria-hidden="true" tabindex="-1"></a><span class="in">  names(BIC) &lt;- paste0("G=", G.set)</span></span>
<span id="cb114-1971"><a href="#cb114-1971" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb114-1972"><a href="#cb114-1972" aria-hidden="true" tabindex="-1"></a><span class="in">  ## selection</span></span>
<span id="cb114-1973"><a href="#cb114-1973" aria-hidden="true" tabindex="-1"></a><span class="in">  hG &lt;- G.set[which.min(BIC)]</span></span>
<span id="cb114-1974"><a href="#cb114-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1975"><a href="#cb114-1975" aria-hidden="true" tabindex="-1"></a><span class="in">  ## result</span></span>
<span id="cb114-1976"><a href="#cb114-1976" aria-hidden="true" tabindex="-1"></a><span class="in">  Result &lt;- list(BIC=BIC, G=hG)</span></span>
<span id="cb114-1977"><a href="#cb114-1977" aria-hidden="true" tabindex="-1"></a><span class="in">  return(Result)</span></span>
<span id="cb114-1978"><a href="#cb114-1978" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb114-1979"><a href="#cb114-1979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1980"><a href="#cb114-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1981"><a href="#cb114-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1982"><a href="#cb114-1982" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fit scr}</span></span>
<span id="cb114-1983"><a href="#cb114-1983" aria-hidden="true" tabindex="-1"></a><span class="in">fit4 &lt;- SCR(Y, X, W4, Sp, G= 7, Phi=1)</span></span>
<span id="cb114-1984"><a href="#cb114-1984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb114-1985"><a href="#cb114-1985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1986"><a href="#cb114-1986" aria-hidden="true" tabindex="-1"></a>Peubah-Peubah signifikan di tiap gerombolnya adalah sebagai berikut:</span>
<span id="cb114-1987"><a href="#cb114-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-1988"><a href="#cb114-1988" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gerombol 1: $X_2$, $X_3$, $X_4$, $X_6$</span>
<span id="cb114-1989"><a href="#cb114-1989" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gerombol 2: $X_3$, $X_8$</span>
<span id="cb114-1990"><a href="#cb114-1990" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gerombol 3: $X_3$</span>
<span id="cb114-1991"><a href="#cb114-1991" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gerombol 4: $X_2$, $X_3$, $X_4$, $X_6$, $X_7$, $X_8$</span>
<span id="cb114-1992"><a href="#cb114-1992" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gerombol 5: $X_1$, $X_2$, $X_3$</span>
<span id="cb114-1993"><a href="#cb114-1993" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gerombol 6: $X_1$, $X_3$</span>
<span id="cb114-1994"><a href="#cb114-1994" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Gerombol 7: $X_8$</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>