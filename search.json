[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ANALISIS SPASIAL DENGAN TEKNIK STATISTIKA",
    "section": "",
    "text": "Kata Pengantar\nSains data berkaitan dengan menemukan jawaban atas pertanyaan berdasarkan data yang tersedia, dan mengomunikasikan upaya tersebut. Selain menunjukkan hasil, komunikasi ini melibatkan pembagian data yang digunakan, namun juga memaparkan jalur yang mengarah pada jawaban dengan cara yang komprehensif dan dapat direproduksi. Hal ini juga mengakui fakta bahwa data yang tersedia mungkin tidak cukup untuk menjawab pertanyaan, dan bahwa jawaban apa pun bergantung pada pengumpulan data atau protokol pengambilan sampel yang digunakan.\nBuku ini memperkenalkan dan menjelaskan konsep-konsep yang mendasari data spasial: titik, garis, poligon, raster, cakupan, atribut geometri, kubus data, sistem referensi, serta konsep tingkat tinggi termasuk bagaimana atribut berhubungan dengan geometri dan bagaimana hal ini mempengaruhi analisis. Hubungan atribut dengan geometri disebut tumpuan, dan perubahan tumpuan juga mengubah karakteristik atribut. Beberapa proses pembuatan data berlangsung terus-menerus di ruang angkasa, dan dapat diamati di mana saja. Lainnya bersifat terpisah, diamati dalam wadah bertessel. Dalam analisis data spasial modern, metode tesellated sering digunakan untuk semua data, meluas ke seluruh partisi lama hingga ke proses titik, model geostatistik, dan model kisi. Dukungan (dan pemahaman tentang dukungan) inilah yang mendasari pentingnya keterwakilan spasial. Buku ini ditujukan bagi para ilmuwan data yang ingin menguasai penggunaan data spasial dalam analisis mereka. Sebagai contoh bagaimana melakukan sesuatu, ia menggunakan R. Di edisi mendatang kami berharap dapat memperluasnya dengan contoh menggunakan Python (lihat, misalnya, Bivand 2022a) dan Julia.\nSeringkali data spasial dianggap bermuara pada pengamatan garis bujur dan lintang dalam kumpulan data, dan memperlakukannya sama seperti variabel lainnya. Hal ini membawa risiko hilangnya peluang dan analisis yang tidak berarti. Contohnya,\npasangan koordinat sebenarnya adalah pasangan, dan kehilangan maknanya jika diperlakukan secara independen Daripada memiliki lokasi titik, observasi sering kali dikaitkan dengan garis spasial, area, atau sel grid Jarak spasial antar observasi seringkali tidak direpresentasikan dengan baik melalui jarak garis lurus, namun dengan jarak lingkaran besar, jarak melalui jaringan, atau dengan mengukur usaha yang diperlukan untuk berpindah dari A ke B.",
    "crumbs": [
      "Kata Pengantar"
    ]
  },
  {
    "objectID": "index.html#versi-cetak-buku-ini",
    "href": "index.html#versi-cetak-buku-ini",
    "title": "ANALISIS SPASIAL DENGAN TEKNIK STATISTIKA",
    "section": "Versi cetak buku ini",
    "text": "Versi cetak buku ini",
    "crumbs": [
      "Kata Pengantar"
    ]
  },
  {
    "objectID": "index.html#acknowledgements",
    "href": "index.html#acknowledgements",
    "title": "ANALISIS SPASIAL DENGAN TEKNIK STATISTIKA",
    "section": "Acknowledgements",
    "text": "Acknowledgements",
    "crumbs": [
      "Kata Pengantar"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Appendix A — Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Summary</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Pendahuluan",
    "section": "",
    "text": "Apa yang akan Anda pelajari",
    "crumbs": [
      "Pendahuluan"
    ]
  },
  {
    "objectID": "intro.html#bagaimana-buku-ini-disusun",
    "href": "intro.html#bagaimana-buku-ini-disusun",
    "title": "Pendahuluan",
    "section": "Bagaimana buku ini disusun",
    "text": "Bagaimana buku ini disusun",
    "crumbs": [
      "Pendahuluan"
    ]
  },
  {
    "objectID": "intro.html#apa-yang-tidak-akan-dipelajari",
    "href": "intro.html#apa-yang-tidak-akan-dipelajari",
    "title": "Pendahuluan",
    "section": "Apa yang tidak akan dipelajari",
    "text": "Apa yang tidak akan dipelajari\nPython, Julia, dan lainnya",
    "crumbs": [
      "Pendahuluan"
    ]
  },
  {
    "objectID": "intro.html#prasyarat",
    "href": "intro.html#prasyarat",
    "title": "Pendahuluan",
    "section": "Prasyarat",
    "text": "Prasyarat\nWe’ve made a few assumptions about what you already know to get the most out of this book. You should be generally numerically literate, and it’s helpful if you have some basic programming experience already. If you’ve never programmed before, you might find Hands on Programming with R by Garrett to be a valuable adjunct to this book.\nYou need four things to run the code in this book: R, RStudio, a collection of R packages called the tidyverse, and a handful of other packages. Packages are the fundamental units of reproducible R code. They include reusable functions, documentation that describes how to use them, and sample data.\nR\nTo download R, go to CRAN, the comprehensive R archive network, https://cloud.r-project.org. A new major version of R comes out once a year, and there are 2-3 minor releases each year. It’s a good idea to update regularly. Upgrading can be a bit of a hassle, especially for major versions that require you to re-install all your packages, but putting it off only makes it worse. We recommend R 4.2.0 or later for this book.\nRStudio\nRStudio is an integrated development environment, or IDE, for R programming, which you can download from https://posit.co/download/rstudio-desktop/. RStudio is updated a couple of times a year, and it will automatically let you know when a new version is out, so there’s no need to check back. It’s a good idea to upgrade regularly to take advantage of the latest and greatest features. For this book, make sure you have at least RStudio 2022.02.0.\nPaket lain yang digunakan\nThere are many other excellent packages that are not part of the tidyverse because they solve problems in a different domain or are designed with a different set of underlying principles. This doesn’t make them better or worse; it just makes them different. In other words, the complement to the tidyverse is not the messyverse but many other universes of interrelated packages. As you tackle more data science projects with R, you’ll learn new packages and new ways of thinking about data.\nWe’ll use many packages from outside the tidyverse in this book. For example, we’ll use the following packages because they provide interesting datasets for us to work with in the process of learning R:\n\ninstall.packages(\n  c(\"arrow\", \"babynames\", \"curl\", \"duckdb\", \"gapminder\", \n    \"ggrepel\", \"ggridges\", \"ggthemes\", \"hexbin\", \"janitor\", \"Lahman\", \n    \"leaflet\", \"maps\", \"nycflights13\", \"openxlsx\", \"palmerpenguins\", \n    \"repurrrsive\", \"tidymodels\", \"writexl\")\n  )\n\nWe’ll also use a selection of other packages for one off examples. You don’t need to install them now, just remember that whenever you see an error like this:\n\nlibrary(ggrepel)\n#&gt; Error in library(ggrepel) : there is no package called ‘ggrepel’\n\nYou need to run install.packages(\"ggrepel\") to install the package.",
    "crumbs": [
      "Pendahuluan"
    ]
  },
  {
    "objectID": "intro.html#menjalankan-sintaks-r",
    "href": "intro.html#menjalankan-sintaks-r",
    "title": "Pendahuluan",
    "section": "Menjalankan Sintaks R",
    "text": "Menjalankan Sintaks R\nThe previous section showed you several examples of running R code. The code in the book looks like this:\n\n1 + 2\n#&gt; [1] 3\n\nIf you run the same code in your local console, it will look like this:\n&gt; 1 + 2\n[1] 3\nThere are two main differences. In your console, you type after the &gt;, called the prompt; we don’t show the prompt in the book. In the book, the output is commented out with #&gt;; in your console, it appears directly after your code. These two differences mean that if you’re working with an electronic version of the book, you can easily copy code out of the book and paste it into the console.\nThroughout the book, we use a consistent set of conventions to refer to code:\n\nFunctions are displayed in a code font and followed by parentheses, like sum() or mean().\nOther R objects (such as data or function arguments) are in a code font, without parentheses, like flights or x.\nSometimes, to make it clear which package an object comes from, we’ll use the package name followed by two colons, like dplyr::mutate() or nycflights13::flights. This is also valid R code.",
    "crumbs": [
      "Pendahuluan"
    ]
  },
  {
    "objectID": "01-SpasialAutoRegresifModel.html",
    "href": "01-SpasialAutoRegresifModel.html",
    "title": "\n1  Spasial Autoregresif Model\n",
    "section": "",
    "text": "1.1 Deskripsi\nModel regresi spasial digunakan untuk mengetahui hubungan antara satu peubah dengan satu atau lebih peubah dengan memperhatikan adanya efek spasial (Cahyati et al., 2018). Persamaan umum untuk model regresi spasial dapat dirumuskan sebagai berikut (Griffith, 1988):\n\\(y = \\rho W_1 y + X\\beta + \\gamma W_2 X\\beta + u\\)\n\\(u = \\lambda W u + \\epsilon\\)\nDengan asumsi bahwa \\(\\epsilon \\sim N(0, \\sigma^2 I)\\), dengan:\n\\[\\begin{align*}\ny & : \\text{vektor peubah respon berukuran } n \\times 1, \\\\\n\\rho & : \\text{koefisien autoregresi lag spasial pada peubah respon}, \\\\\nW_1 & : \\text{matriks pembobot spasial bagi peubah respon berukuran } n \\times n, \\\\\nW_2 & : \\text{matriks pembobot spasial bagi peubah penjelas berukuran } n \\times n, \\\\\n\\gamma & : \\text{koefisien autoregresi lag spasial pada peubah penjelas}, \\\\\nX & : \\text{matriks peubah bebas dengan ukuran } n \\times (k + 1), \\\\\n\\beta & : \\text{vektor koefisien parameter regresi berukuran } (k + 1) \\times 1, \\\\\nu & : \\text{vektor galat yang diasumsikan mengandung autokorelasi berukuran } n \\times 1, \\\\\n\\lambda & : \\text{koefisien autoregresi galat spasial}, \\\\\n\\epsilon & : \\text{vektor galat yang bebas autokorelasi berukuran } n \\times 1.\n\\end{align*}\\]\nJika pada persamaan nilai koefisien \\(\\gamma = 0\\) dan \\(\\lambda = 0\\), maka model yang digunakan akan menjadi model SAR. SAR merupakan pemodelan pada data dengan menambahkan pengaruh spasial pada peubah respon. Persamaan untuk model SAR adalah sebagai berikut (LeSage dan Pace, 2009):\n\\(y = \\rho W y + X\\beta + \\epsilon\\)\nDengan \\(y\\) merupakan peubah respon, \\(W\\) merupakan matriks pembobot spasial, \\(\\beta\\) adalah koefisien parameter regresi, \\(\\epsilon\\) merupakan sisaan, dan \\(\\rho\\) merupakan koefisien autoregressive lag spasial. Jika tidak terdapat ketergantungan spasial antara wilayah ke-\\(i\\) dan wilayah ke-\\(j\\), \\(\\rho\\) bernilai 0.\nSaat nilai koefisien \\(\\rho\\) dan \\(\\lambda\\) pada persamaan bernilai nol, maka model yang digunakan adalah model SLX. SLX adalah model regresi spasial dengan dependensi spasial hanya pada peubah penjelas (Vega dan Elhorst, 2015). Persamaan untuk SLX sebagai berikut (LeSage dan Pace, 2009):\n\\(y = X\\beta + \\gamma WX + \\epsilon\\)\nDengan \\(y\\) merupakan peubah respon, \\(W\\) merupakan matriks pembobot spasial, \\(\\beta\\) adalah koefisien parameter regresi, \\(\\epsilon\\) merupakan sisaan, dan \\(\\gamma\\) merupakan koefisien lag spasial pada peubah penjelas.\nJika nilai koefisien \\(\\lambda\\) pada persamaan bernilai nol, maka model yang digunakan adalah SDM. SDM merupakan model regresi spasial yang digunakan ketika data memiliki dependensi spasial pada peubah respon dan peubah penjelas sehingga pembobotan spasial dilakukan pada peubah respon dan peubah penjelas. Persamaan untuk SDM sebagai berikut (LeSage dan Pace, 2009):\n\\(y = \\rho W_1 y + X\\beta + \\gamma W_2 X + \\epsilon\\)\nDengan:\n\\[\\begin{align*}\ny & : \\text{vektor peubah respon}, \\\\\nW_1 & : \\text{matriks pembobot spasial bagi peubah respon berukuran } n \\times n, \\\\\nW_2 & : \\text{matriks pembobot spasial bagi peubah penjelas berukuran } n \\times n, \\\\\n\\beta & : \\text{vektor koefisien parameter regresi}, \\\\\n\\epsilon & : \\text{vektor sisaan}, \\\\\n\\rho & : \\text{koefisien lag spasial pada peubah respon}, \\\\\n\\gamma & : \\text{koefisien lag spasial pada peubah penjelas}.\n\\end{align*}\\]",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Spasial Autoregresif Model</span>"
    ]
  },
  {
    "objectID": "01-SpasialAutoRegresifModel.html#data",
    "href": "01-SpasialAutoRegresifModel.html#data",
    "title": "\n1  Spasial Autoregresif Model\n",
    "section": "\n1.2 Data",
    "text": "1.2 Data\nData yang digunakan pada penelitian ini merupakan data sekunder yang diambil dari situs Open Data Jabar. Unit amatan pada penelitian ini adalah 27 kabupaten/kota di Jawa Barat. Peubah yang digunakan dapat dilihat pada tabel berikut.\n\nPeubah yang Digunakan\n\n\n\n\n\n\nKode\nPeubah\nSumber Pustaka\n\n\n\nY\nTotal produksi sampah dalam ton/jiwa/km2\n-\n\n\nX1\nPDRB tahun 2021\nPrajati et al. (2015)\n\n\nX2\nJumlah pengeluaran per kapita dalam ribu rupiah\nPrajati et al. (2015)\n\n\nX3\nRata-rata lama sekolah\nPrajati et al. (2015)\n\n\nX4\nAngka melek huruf\nPrajati et al. (2015)\n\n\nX5\nJumlah UMKM & Demirbas\nDemirbas (2011)\n\n\nX6\nJumlah tempat rekreasi dan pariwisata\nKarim et al. (2022)\n\n\nX7\nJumlah pasar rakyat\nPersen\n\n\nX8\nJumlah restoran & Demirbas\nDemirbas (2011)",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Spasial Autoregresif Model</span>"
    ]
  },
  {
    "objectID": "01-SpasialAutoRegresifModel.html#prosedur-analisis-data",
    "href": "01-SpasialAutoRegresifModel.html#prosedur-analisis-data",
    "title": "\n1  Spasial Autoregresif Model\n",
    "section": "\n1.3 Prosedur Analisis Data",
    "text": "1.3 Prosedur Analisis Data\nAnalisis data dilakukan dengan menggunakan perangkat lunak R, dengan tahapan analisis data sebagai berikut:\n\n\nEksplorasi Data:\n\nMelakukan eksplorasi data untuk mengetahui karakteristik data.\n\n\n\nDeteksi Multikolinieritas:\n\nMendeteksi multikolinieritas antar peubah penjelas dengan melihat nilai Variance Inflation Factor (VIF).\n\nVIF dihitung menggunakan persamaan berikut:\n\\(VIF = \\frac{1}{1 - R_i^2}\\)\ndengan (R_i^2) adalah koefisien determinasi antara (X_i) dengan peubah penjelas lainnya.\n\nMenurut Akinwande et al. (2015), nilai VIF yang lebih dari lima menunjukkan adanya multikolinieritas, menjadi acuan untuk mengeluarkan peubah penjelas dari model.\n\n\n\nTransformasi Peubah:\n\nMelakukan transformasi pada peubah (Y).\nMelakukan transformasi pada peubah (X) yang memiliki nilai keragaman yang tinggi.\n\n\n\nUji Efek Spasial:\n\nKeragaman Spasial menggunakan uji Breusch-Pagan berdasarkan persamaan.\nDependensi Spasial berdasarkan persamaan sampai persamaan.\n\n\n\nPendugaan Parameter Model SAR, SLX, dan SDM:\n\nMenggunakan metode Maximum Likelihood.\n\n\n\nEvaluasi Model:\n\nEvaluasi model terbaik berdasarkan nilai Bayesian Information Criterion (BIC) terkecil dan Nagelkerke pseudo R-Squared terbesar.\n\nMelakukan uji asumsi.\nBIC:\n\\(BIC = -2 \\log(\\hat{L}) + \\log(N)K\\) dengan (\\(\\hat{L}\\)) adalah nilai maximum likelihood, (\\(K\\)) adalah jumlah parameter yang diestimasi dalam model, dan (\\(N\\)) adalah jumlah sampel (Li dan Nyholt, 2001).\nNagelkerke Pseudo R-Squared:\n\\(\\text{pseudo R}^2 = \\frac{\\left(1 - \\frac{LL_0}{LL_F}\\right)^{2/N}}{1 - \\left(\\frac{LL_0}{LL_F}\\right)^{2/N}}\\) dengan (\\(LL_0\\)) adalah nilai log likelihood dari model tanpa peubah penjelas, (\\(LL_F\\)) adalah nilai log likelihood dari model dengan peubah penjelas, dan (\\(N\\)) adalah jumlah sampel (Walker dan Smith, 2016).\n\n\n\n\nInterpretasi dan Kesimpulan:\n\nMelakukan interpretasi dari model yang terpilih dan menarik kesimpulan.",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Spasial Autoregresif Model</span>"
    ]
  },
  {
    "objectID": "01-SpasialAutoRegresifModel.html#tahapan-analisis-r",
    "href": "01-SpasialAutoRegresifModel.html#tahapan-analisis-r",
    "title": "\n1  Spasial Autoregresif Model\n",
    "section": "\n1.4 Tahapan Analisis R",
    "text": "1.4 Tahapan Analisis R\nTahap awal dalam pemodelan menggunakan R Studio adalah melakukan input data dan install package sesuai kebutuhan dalam analisis. Package yang perlu diinstall adalah sebagai berikut:\nPackage\n\nCodelibrary(readxl)\nlibrary(rgdal)\nlibrary(spdep)\n# Warning: package 'spdep' was built under R version 4.2.3\nlibrary(raster)\n# Warning: package 'raster' was built under R version 4.2.3\nlibrary(rcompanion)\n# Warning: package 'rcompanion' was built under R version 4.2.3\nlibrary(MASS)\n# Warning: package 'MASS' was built under R version 4.2.3\nlibrary(knitr)\n# Warning: package 'knitr' was built under R version 4.2.2\nlibrary(kableExtra)\nlibrary(lmtest)\n# Warning: package 'zoo' was built under R version 4.2.3\nlibrary(spatialreg)\nlibrary(DescTools)\n# Warning: package 'DescTools' was built under R version 4.2.2\nlibrary(sf)\nlibrary(reporter)\n# Warning: package 'reporter' was built under R version 4.2.3\n# Warning: package 'common' was built under R version 4.2.3\nlibrary(tidyverse)\n# Warning: package 'ggplot2' was built under R version 4.2.2\n# Warning: package 'tidyr' was built under R version 4.2.3\n# Warning: package 'purrr' was built under R version 4.2.3\n# Warning: package 'stringr' was built under R version 4.2.3\n# Warning: package 'forcats' was built under R version 4.2.2\nlibrary(ggplot2)\n\n\nInput Data\n\nData &lt;-read_excel(\"data/produksi_sampah_jabar_2021.xlsx\")\nY  &lt;- unname(unlist(Data[,7]))\nX  &lt;- unname(unlist(Data[,10]))\nX1 &lt;- unname(unlist(Data[,8]))\nX2 &lt;- unname(unlist(Data[,13]))\nX3 &lt;- unname(unlist(Data[,9]))\nX4 &lt;- unname(unlist(Data[,16]))\nX5 &lt;- unname(unlist(Data[,11]))\nX6 &lt;- unname(unlist(Data[,14]))\nX7 &lt;- unname(unlist(Data[,15]))\nX8 &lt;- unname(unlist(Data[,12]))\n\nY2 &lt;- Y/X\nData$produksi_sampah_per_kepadatan&lt;-Y2\n\nInput Peta Pulau Jawa\n\nsf_use_s2(FALSE)\n# Spherical geometry (s2) switched off\npetajawa&lt;- readOGR(dsn = \"data/shp/jawa.shp\", layer=\"jawa\")\n# OGR data source with driver: ESRI Shapefile \n# Source: \"E:\\Materi_Orasi\\bookdown\\data\\shp\\jawa.shp\", layer: \"jawa\"\n# with 119 features\n# It has 5 fields\n# subset peta pulau jawa menjadi jawa barat\npetajabar &lt;- subset(petajawa,PROVINSI==\"JAWA BARAT\")\n\n#Menambahkan kolom variabel dalam file shp\npetajabar$sampah &lt;- Data$jumlah_produksi_sampah\npetajabar$PDRB &lt;- sqrt(Data$PDRB)\npetajabar$RLS &lt;- Data$RLS\npetajabar$kepadatan &lt;- Data$Kepadatan\npetajabar$umkm &lt;- log(Data$jumlah_umkm)\npetajabar$pengeluaran &lt;- Data$jumlah_pengeluaran_per_kapita\npetajabar$restoran &lt;- Data$jumlah_restoran\npetajabar$AMH &lt;- Data$Angka_melek_huruf\npetajabar$pasar &lt;- Data$Jumlah_pasar_rakyat\npetajabar$rekreasi &lt;- Data$Jumlah_tempat_rekreasi_dan_pariwisata\npetajabar$daerah &lt;- Data$nama_kabupaten_kota\npetajabar$prod_sampah &lt;- Data$produksi_sampah_per_kepadatan\n\nEksplorasi Data\nPeta sebaran produksi sampah per kepadatan penduduk dapat dihasilkan dengan syntax berikut:\n\n## Peta Produksi Sampah per Kepadatan Penduduk\n# Create list object for sp.layout\nsp.label &lt;- function(x, label) {list(\"sp.text\", coordinates(x), label, cex = 0.4)}\nNUMB.sp.label &lt;- function(x) {sp.label(x, as.vector(petajabar$daerah))}\nmake.NUMB.sp.label &lt;- function(x) {do.call(\"list\")}\n\ncolfunc&lt;-colorRampPalette(c(\"green\",\"orange\",\"red\"))\ncolor&lt;-colfunc(100)\nspplot(petajabar, \"prod_sampah\", col.regions=color, \n       cex = 0.5,\n       bg = \"white\", border=\"light grey\")\n\n\n\n\n\n\n\nDiagram kotak garis dari produksi sampah per kepadatan penduduk dapat dihasilkan menggunakan syntax\n\nboxplot(Y2, xlab = \"Produksi sampah per kepadatan penduduk\", horizontal = TRUE)\n\n\n\n\n\n\n\nBerdasarkan diagram kotak garis, dapat dilihat bahwa garis di bagian kanan diagram kotak garis lebih panjang. Hal tersebut menunjukkan bahwa data produksi sampah per kepadatan penduduk cenderung menjulur ke kanan.\nNilai deskriptif merupakan gambaran dari data yang akan digunakan dalam penelitian dan nilai deskriptif dari seluruh peubah yang digunakan pada penelitian ini ditampilkan pada Tabel 2. Peubah penjelas yang memiliki nilai minimum paling kecil adalah peubah X8 dengan nilai 0. Wilayah yang memiliki peubah X8 atau jumlah restoran sama dengan 0 adalah Kabupaten Kuningan. Wilayah yang memiliki jumlah restoran terbanyak adalah Kota Bekasi dengan jumlah sebanyak 1024 restoran. Peubah penjelas dengan nilai rataan tertinggi yaitu peubah X5 atau jumlah UMKM. Sedangkan peubah penjelas dengan rataan terkecil dibandingkan peubah lainnya adalah X3 atau rata-rata lama sekolah. Peubah penjelas dengan nilai standar deviasi yang tinggi adalah peubah X1 dan X5.\n\ntabel_deskriptif &lt;-matrix(\n    c(min(Y2),\n      min(X1),\n      min(X2),\n      min(X3),\n      min(X4),\n      min(X5),\n      min(X6),\n      min(X7),\n      min(X8),\n      max(Y2),\n      max(X1),\n      max(X2),\n      max(X3),\n      max(X4),\n      max(X5),\n      max(X6),\n      max(X7),\n      max(X8),\n      median(Y2),\n      median(X1),\n      median(X2),\n      median(X3),\n      median(X4),\n      median(X5),\n      median(X6),\n      median(X7),\n      median(X8),\n      mean(Y2),\n      mean(X1),\n      mean(X2),\n      mean(X3),\n      mean(X4),\n      mean(X5),\n      mean(X6),\n      mean(X7),\n      mean(X8),\n      sd(Y2),\n      sd(X1),\n      sd(X2),\n      sd(X3),\n      sd(X4),\n      sd(X5),\n      sd(X6),\n      sd(X7),\n      sd(X8)\n    ),\n    ncol = 9,\n    byrow = TRUE\n  )\ntabel_deskriptif &lt;- round(tabel_deskriptif, 2)\nrownames(tabel_deskriptif) &lt;- c(\"Minimum\", \"Maksimum\", \"Median\", \"Rataan\", \"Standar Deviasi\")\ncolnames(tabel_deskriptif) &lt;- c(\"Y\", \"X1\", \"X2\", \"X3\", \"X4\", \"X5\", \"X6\", \"X7\", \"X8\")\ntabel_deskriptif\n#                    Y     X1    X2    X3     X4     X5    X6   X7\n# Minimum         0.01   3364  7829  6.52  93.76  34962   7.0  4.0\n# Maksimum        0.92 251829 16996 11.46  99.95 506347 300.0 95.0\n# Median          0.20  32898 10368  8.20  99.38 219238  63.0 33.0\n# Rataan          0.32  56562 10781  8.66  98.70 231755  95.7 36.3\n# Standar Deviasi 0.28  63129  2279  1.47   1.52 133919  81.5 24.7\n#                   X8\n# Minimum            0\n# Maksimum        1024\n# Median            47\n# Rataan           176\n# Standar Deviasi  295\n\nPemeriksaan Multikolinearitas\nPemeriksaan multikolinearitas menggunakan syntax sebagai berikut:\n\nreglin &lt;- lm(log(Y2)~X1+X2+X3+X4+X5+X6+X7+X8)\nas.matrix(car::vif(reglin))\n#    [,1]\n# X1 2.79\n# X2 4.75\n# X3 9.26\n# X4 2.88\n# X5 3.64\n# X6 1.57\n# X7 4.04\n# X8 2.75\n\nBerdasarkan output di atas, terlihat bahwa nilai VIF dari peubah X3 lebih dari lima sehingga peubah X3 tidak akan disertakan dalam model.\nTransformasi Peubah\nBerdasarkan hasil eksplorasi data, diketahui bahwa peubah respon menjulur ke kanan. Selain itu, peubah penjelas X1 dan X5 memiliki nilai standar deviasi yang tinggi. Hal tersebut mengindikasikan bahwa perlu dilakukan penanganan berupa transformasi pada peubah respon dan peubah penjelas. Transformasi logaritma natural merupakan transformasi yang umum dilakukan untuk peubah respon yang menjulur ke kanan (Gujarati dan Porter 2009). Penerapan transformasi pada peubah dilakukan menggunakan syntax berikut:\n\n# Transformasi peubah respon\nx &lt;- shapiro.test(log(Y2))\nnormalitas_Y &lt;- t(matrix(c(x$statistic,x$p.value)))\ncolnames(normalitas_Y) &lt;- c(\"Nilai statistik\", \"p-value\")\nrownames(normalitas_Y) &lt;- \"Uji Normalitas Y\"\nas.table(normalitas_Y)\n#                  Nilai statistik p-value\n# Uji Normalitas Y           0.942   0.138\n\nBerdasarkan hasil Uji normalitas Shapiro Wilk, didapatkan nilai nilai-p sebesar 0.14 sehingga dapat disimpulkan bahwa transformasi terhadap peubah respon telah membuat peubah menyebar mengikuti sebaran normal\n\n# Transformasi peubah penjelas\npar(mfrow=c(1,2))\nboxcox(Y2~X1)\nboxcox(Y2~X5)\n\n\n\n\n\n\n\nBerdasarkan gambar di atas, dapat dilihat bahwa nilai 0 berada pada selang nilai λ dari peubah respon X1 dan X5, sehingga transformasi yang akan digunakan adalah transformasi logaritma natural.\nPengujian Efek Spasial\n\n\nUji Breusch-Pagan\nUji Breusch-Pagan dilakukan menggunakan syntax berikut:\n\n\n\nreglin2 &lt;- lm(log(Y2)~log(X1)+X2+X3+X4+log(X5)+X6+X7+X8)\nbptest(reglin2)\n# \n#   studentized Breusch-Pagan test\n# \n# data:  reglin2\n# BP = 2, df = 8, p-value = 1\n\nHasil uji menunjukkan nilai-p &gt; 0.05, sehingga dapat disimpulkan tidak terdapat heterogenitas spasial\n\n\nUji LM dan indeks Moran\nuntuk melakukan uji LM dan indeks Moran, perlu ditentukan terlebih dahulu matriks pembobot yang akan digunakan. Pada penelitian ini akan menggunakan matriks bobot ketetanggaan Queen, ketetanggaan rook, jarak eksponensial negatif, dan invers jarak. Berikut merupakan syntax yang digunakan untuk membuat matriks bobot:\n\n\n\n#### Matriks queen ####\nqueen.nb=poly2nb(petajabar, queen = TRUE) #Pembobot queen\n# although coordinates are longitude/latitude, st_intersects assumes that they are planar\nqueen.listw=nb2listw(queen.nb) #convert nb to listw type\nqueen.jabar= queen.listw\nmat.queen &lt;- listw2mat(queen.listw)\n\n#### Matriks rook ####\nrook.nb &lt;- poly2nb(petajabar,queen = F)\n# although coordinates are longitude/latitude, st_intersects assumes that they are planar\nrook.listw &lt;- nb2listw(rook.nb)\nrook.jabar &lt;- rook.listw\nmat.rook &lt;- listw2mat(rook.listw)\n\n#### inverse distance ####\ncoor &lt;- coordinates(petajabar)\nD&lt;-as.matrix(dist(coor,method = \"euclidean\"))\n\n# inverse weight matrix\nw=1/D\ndiag(w)&lt;-0\nrtot&lt;-rowSums(w, na.rm =T)\nw_std&lt;-w/rtot\ninvers.w&lt;-mat2listw(w_std, style=\"W\")\nmat.inv &lt;- listw2mat(invers.w)\n\nw2=1/(D^2)\ndiag(w2)&lt;-0\nrtot&lt;-rowSums(w2, na.rm =T)\nw_std2&lt;-w2/rtot\ninvers.w2&lt;-mat2listw(w_std2, style = \"W\")\nmat.inv2 &lt;- listw2mat(invers.w2)\n\n#### Exponential distance ####\nalpha1=1\nW.eksp1 &lt;- exp((-alpha1)*D) \n#dinormalisasi \ndiag(W.eksp1) &lt;- 0\nrtot3 &lt;- rowSums(W.eksp1, na.rm=TRUE) \nW.eksp.sd1 &lt;- W.eksp1/rtot3 #row-normalized \nW.eksp.s1 = mat2listw(W.eksp.sd1, style='W') \nmat.eksp1 &lt;- listw2mat(W.eksp.s1)\n\nalpha2=2\nW.eksp2 &lt;- exp((-alpha2)*D) \n#dinormalisasi \ndiag(W.eksp2) &lt;- 0\nrtot3 &lt;- rowSums(W.eksp2, na.rm=TRUE) \nW.eksp.sd2 &lt;- W.eksp2/rtot3 #row-normalized \nW.eksp.s2 = mat2listw(W.eksp.sd2, style='W') \nmat.eksp2 &lt;- listw2mat(W.eksp.s2)\n\nSetelah dibuat matriks pembobot, maka akan dilakukan pengujian LM dengan semua matriks pembobot.\n\n#### LM Test Model 1 ####\nreglin2 &lt;- lm(log(Y2) ~ log(X1) + X2 + X4 + log(X5) + X6 + X7 + X8)\n\n#LM dengan queen\nLM_Queen &lt;- lm.RStests(reglin2,\n                       queen.jabar,\n                       test = c(\"RSerr\", \"RSlag\", \"adjRSerr\", \"adjRSlag\", \"SARMA\"))\n\n#LM rook\nLM_rook &lt;- lm.RStests(reglin2,\n                      rook.jabar,\n                      test = c(\"RSerr\", \"RSlag\", \"adjRSerr\", \"adjRSlag\", \"SARMA\"))\n\n#LM Inverse\nLM_inv_1 &lt;- lm.RStests(reglin2,\n                       invers.w,\n                       test = c(\"RSerr\", \"RSlag\", \"adjRSerr\", \"adjRSlag\", \"SARMA\"))\n\nLM_inv_2 &lt;- lm.RStests(reglin2,\n                       invers.w2,\n                       test = c(\"RSerr\", \"RSlag\", \"adjRSerr\", \"adjRSlag\", \"SARMA\"))\n#LM Exponential\nLM_exp_1 &lt;- lm.RStests(reglin2,\n                       W.eksp.s1,\n                       test = c(\"RSerr\", \"RSlag\", \"adjRSerr\", \"adjRSlag\", \"SARMA\"))\n\nLM_exp_2 &lt;- lm.RStests(reglin2,\n                       W.eksp.s2,\n                       test = c(\"RSerr\", \"RSlag\", \"adjRSerr\", \"adjRSlag\", \"SARMA\"))\n\ntabel_uji_LM &lt;-\n  matrix(\n    c(\n      LM_Queen$RSerr$p.value,\n      LM_Queen$RSlag$p.value,\n      LM_Queen$adjRSerr$p.value,\n      LM_Queen$adjRSlag$p.value,\n      LM_Queen$SARMA$p.value,\n      LM_rook$RSerr$p.value,\n      LM_rook$RSlag$p.value,\n      LM_rook$adjRSerr$p.value,\n      LM_rook$adjRSlag$p.value,\n      LM_rook$SARMA$p.value,\n      LM_inv_1$RSerr$p.value,\n      LM_inv_1$RSlag$p.value,\n      LM_inv_1$adjRSerr$p.value,\n      LM_inv_1$adjRSlag$p.value,\n      LM_inv_1$SARMA$p.value,\n      LM_inv_2$RSerr$p.value,\n      LM_inv_2$RSlag$p.value,\n      LM_inv_2$adjRSerr$p.value,\n      LM_inv_2$adjRSlag$p.value,\n      LM_inv_2$SARMA$p.value,\n      LM_exp_1$RSerr$p.value,\n      LM_exp_1$RSlag$p.value,\n      LM_exp_1$adjRSerr$p.value,\n      LM_exp_1$adjRSlag$p.value,\n      LM_exp_1$SARMA$p.value,\n      LM_exp_2$RSerr$p.value,\n      LM_exp_2$RSlag$p.value,\n      LM_exp_2$adjRSerr$p.value,\n      LM_exp_2$adjRSlag$p.value,\n      LM_exp_2$SARMA$p.value\n    ),\n    ncol = 6,\n    byrow = FALSE\n  )\n\ntabel_uji_LM &lt;- round(tabel_uji_LM, 3)\n\nrownames(tabel_uji_LM) &lt;-\n  c(\"LMlag\", \"LMerr\", \"RLMlag\", \"RLMerr\", \"SARMA\")\ncolnames(tabel_uji_LM) &lt;- c(\n  \"Queen\",\n  \"Rook\",\n  \"Jarak Inverse-1\",\n  \"Jarak Inverse-2\",\n  \"Negatif Eksponensial-1\",\n  \"Negatif Eksponensial-2\"\n)\nt(tabel_uji_LM)\n#                        LMlag LMerr RLMlag RLMerr SARMA\n# Queen                  0.388 0.098  0.397  0.100 0.178\n# Rook                   0.388 0.098  0.397  0.100 0.178\n# Jarak Inverse-1        0.159 0.010  0.279  0.016 0.021\n# Jarak Inverse-2        0.175 0.011  0.461  0.023 0.030\n# Negatif Eksponensial-1 0.458 0.679  0.052  0.065 0.139\n# Negatif Eksponensial-2 0.574 0.951  0.066  0.080 0.184\n\nBerdasarkan hasil Uji LM, diketahui bahwa matriks jarak invers 1 memberikan nilai LMlag, RLMlag, dan SARMA yang signifikan pada taraf nyata α = 0,05 dan paling kecil jika dibandingkan dengan matriks pembobot yang lainnya.\nSelanjutnya akan dilakukan pengujian indeks Moran dari setiap peubah penjelas dengan syntax berikut\n\n#Moran Test: Queen Contiguity\nq_x1 &lt;- moran.test(log(petajabar$PDRB),queen.jabar,randomisation=T) #X1\nq_x2 &lt;- moran.test(petajabar$pengeluaran,queen.jabar,randomisation=T) #X2\nq_x4 &lt;- moran.test(petajabar$AMH,queen.jabar,randomisation = T) #X4\nq_x5 &lt;- moran.test(log(petajabar$umkm),queen.jabar,randomisation=T) #X5\nq_x6 &lt;- moran.test(petajabar$rekreasi,queen.jabar,randomisation = T) #X6\nq_x7 &lt;- moran.test(petajabar$pasar,queen.jabar,randomisation = T) #X7\nq_x8 &lt;- moran.test(petajabar$restoran,queen.jabar,randomisation=T) #X8\n\n#Moran Test: Rook Contiguity\nr_x1 &lt;- moran.test(log(petajabar$PDRB),rook.jabar,randomisation=T) #X1\nr_x2 &lt;- moran.test(petajabar$pengeluaran,rook.jabar,randomisation=T) #X2\nr_x4 &lt;- moran.test(petajabar$AMH,rook.jabar,randomisation = T) #X4\nr_x5 &lt;- moran.test(log(petajabar$umkm),rook.jabar,randomisation=T) #X5\nr_x6 &lt;- moran.test(petajabar$rekreasi,rook.jabar,randomisation = T) #X6\nr_x7 &lt;- moran.test(petajabar$pasar,rook.jabar,randomisation = T) #X7\nr_x8 &lt;- moran.test(petajabar$restoran,rook.jabar,randomisation=T) #X8\n\n#Moran Test: Inverse Distance 1\nidw_x1 &lt;- moran.test(log(petajabar$PDRB),invers.w,randomisation=T) #X1\nidw_x2 &lt;- moran.test(petajabar$pengeluaran,invers.w,randomisation=T) #X2\nidw_x4 &lt;- moran.test(petajabar$AMH,invers.w,randomisation = T) #X4\nidw_x5 &lt;- moran.test(log(petajabar$umkm),invers.w,randomisation=T) #X5\nidw_x6 &lt;- moran.test(petajabar$rekreasi,invers.w,randomisation = T) #X6\nidw_x7 &lt;- moran.test(petajabar$pasar,invers.w,randomisation = T) #X7\nidw_x8 &lt;- moran.test(petajabar$restoran,invers.w,randomisation=T) #X8\n\n#Moran Test: Inverse Distance 2\nidw2_x1 &lt;- moran.test(log(petajabar$PDRB),invers.w2,randomisation=T) #X1\nidw2_x2 &lt;- moran.test(petajabar$pengeluaran,invers.w2,randomisation=T) #X2\nidw2_x4 &lt;- moran.test(petajabar$AMH,invers.w2,randomisation = T) #X4\nidw2_x5 &lt;- moran.test(log(petajabar$umkm),invers.w2,randomisation=T) #X5\nidw2_x6 &lt;- moran.test(petajabar$rekreasi,invers.w2,randomisation = T) #X6\nidw2_x7 &lt;- moran.test(petajabar$pasar,invers.w2,randomisation = T) #X7\nidw2_x8 &lt;- moran.test(petajabar$restoran,invers.w2,randomisation=T) #X8\n\n#Moran Test: Exponential Distance 1\nexp1_x1 &lt;- moran.test(log(petajabar$PDRB),W.eksp.s1,randomisation=T) #X1\nexp1_x2 &lt;- moran.test(petajabar$pengeluaran,W.eksp.s1,randomisation=T) #X2\nexp1_x4 &lt;- moran.test(petajabar$AMH,W.eksp.s1,randomisation = T) #X4\nexp1_x5 &lt;- moran.test(log(petajabar$umkm),W.eksp.s1,randomisation=T) #X5\nexp1_x6 &lt;- moran.test(petajabar$rekreasi,W.eksp.s1,randomisation = T) #X6\nexp1_x7 &lt;- moran.test(petajabar$pasar,W.eksp.s1,randomisation = T) #X7\nexp1_x8 &lt;- moran.test(petajabar$restoran,W.eksp.s1,randomisation=T) #X8\n\n#Moran Test: Exponential Distance 2\nexp2_x1 &lt;- moran.test(log(petajabar$PDRB),W.eksp.s2,randomisation=T) #X1\nexp2_x2 &lt;- moran.test(petajabar$pengeluaran,W.eksp.s2,randomisation=T) #X2\nexp2_x4 &lt;- moran.test(petajabar$AMH,W.eksp.s2,randomisation = T) #X4\nexp2_x5 &lt;- moran.test(log(petajabar$umkm),W.eksp.s2,randomisation=T) #X5\nexp2_x6 &lt;- moran.test(petajabar$rekreasi,W.eksp.s2,randomisation = T) #X6\nexp2_x7 &lt;- moran.test(petajabar$pasar,W.eksp.s2,randomisation = T) #X7\nexp2_x8 &lt;- moran.test(petajabar$restoran,W.eksp.s2,randomisation=T) #X8\n\ntabel_moran &lt;- matrix(c(q_x1$p.value, q_x2$p.value, q_x4$p.value, q_x5$p.value, q_x6$p.value, q_x7$p.value, q_x8$p.value, r_x1$p.value, r_x2$p.value, r_x4$p.value, r_x5$p.value, r_x6$p.value, r_x7$p.value, r_x8$p.value, idw_x1$p.value, idw_x2$p.value, idw_x4$p.value, idw_x5$p.value, idw_x6$p.value, idw_x7$p.value, idw_x8$p.value, idw2_x1$p.value, idw2_x2$p.value, idw2_x4$p.value, idw2_x5$p.value, idw2_x6$p.value, idw2_x7$p.value, idw2_x8$p.value, exp1_x1$p.value, exp1_x2$p.value, exp1_x4$p.value, exp1_x5$p.value, exp1_x6$p.value, exp1_x7$p.value, exp1_x8$p.value, exp2_x1$p.value, exp2_x2$p.value, exp2_x4$p.value, exp2_x5$p.value, exp2_x6$p.value, exp2_x7$p.value, exp2_x8$p.value), ncol = 7, byrow = FALSE)\ntabel_moran &lt;- round(tabel_moran, 3)\nrownames(tabel_moran) &lt;- c(\"Queen\", \"Rook\", \"Jarak Inverse-1\", \"Jarak Inverse-2\", \"Negatif Eksponensial-1\", \"Negatif Eksponensial-2\")\ncolnames(tabel_moran) &lt;- c(\"X1\", \"X2\",\"X4\", \"X5\", \"X6\", \"X7\", \"X8\")\nt(tabel_moran)\n#    Queen  Rook Jarak Inverse-1 Jarak Inverse-2\n# X1 0.005 0.007           0.000           0.690\n# X2 0.000 0.005           0.007           0.000\n# X4 0.672 0.000           0.017           0.114\n# X5 0.386 0.797           0.000           0.009\n# X6 0.876 0.500           0.932           0.000\n# X7 0.001 0.200           0.747           0.807\n# X8 0.006 0.000           0.293           0.751\n#    Negatif Eksponensial-1 Negatif Eksponensial-2\n# X1                  0.373                  0.672\n# X2                  0.690                  0.373\n# X4                  0.059                  0.888\n# X5                  0.060                  0.025\n# X6                  0.000                  0.004\n# X7                  0.000                  0.000\n# X8                  0.854                  0.000\n\nBerdasarkan hasil uji indeks Moran, dapat dilihat bahwa peubah X1, X2, X4, dan X8 memiliki dependensi spasial. Pada penelitian ini akan digunakan matriks pembobot jarak eksponensial negatif (s = 1) sebagai matriks pembobot bagi peubah X1, X2, X4, dan X8.  \nPemodelan Regresi Spasial\nModel yang akan dibangun adalah model SAR, model SLX, dan model SDM dengan syntax berikut:\n\nWX1 &lt;- mat.eksp1%*%log(X1)\nWX2 &lt;- mat.eksp1%*%X2\nWX4 &lt;- mat.eksp1%*%X4\nWX8 &lt;- mat.eksp1%*%X8\nmodel1 &lt;- log(Y2)~log(X1)+X2+X4+log(X5)+X6+X7+X8\nW.model1 &lt;- log(Y2)~log(X1)+X2+X4+log(X5)+X6+X7+X8+WX1+WX2+WX4+WX8\n#SAR\nmod.sar &lt;- lagsarlm(model1, listw = invers.w2)\nsummary(mod.sar, Nagelkerke = T)\n# \n# Call:lagsarlm(formula = model1, listw = invers.w2)\n# \n# Residuals:\n#       Min        1Q    Median        3Q       Max \n# -0.977977 -0.280736 -0.072287  0.265184  1.528045 \n# \n# Type: lag \n# Coefficients: (asymptotic standard errors) \n#                Estimate  Std. Error z value Pr(&gt;|z|)\n# (Intercept)  1.4894e+01  8.1550e+00  1.8263 0.067804\n# log(X1)     -4.9444e-02  2.2834e-01 -0.2165 0.828572\n# X2          -4.9239e-05  7.4524e-05 -0.6607 0.508795\n# X4          -2.4275e-01  7.1549e-02 -3.3927 0.000692\n# log(X5)      7.0580e-01  3.4319e-01  2.0566 0.039725\n# X6           3.8718e-03  1.4658e-03  2.6414 0.008256\n# X7           1.4585e-02  6.7606e-03  2.1573 0.030979\n# X8          -5.6650e-06  4.9770e-04 -0.0114 0.990918\n# \n# Rho: 0.521, LR test value: 7.86, p-value: 0.0050615\n# Asymptotic standard error: 0.149\n#     z-value: 3.51, p-value: 0.00045492\n# Wald statistic: 12.3, p-value: 0.00045492\n# \n# Log likelihood: -20.7 for lag model\n# ML residual variance (sigma squared): 0.252, (sigma: 0.502)\n# Nagelkerke pseudo-R-squared: 0.793 \n# Number of observations: 27 \n# Number of parameters estimated: 10 \n# AIC: 61.5, (AIC for lm: 67.3)\n# LM test for residual autocorrelation\n# test value: 0.00113, p-value: 0.97315\n\nHasil di atas menunjukkan peubah penjelas yang berpengaruh signifikan terhadap total produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 yaitu X4 (angka melek huruf), X5 (jumlah UMKM), X6 (jumlah tempat rekreasi dan pariwisata), dan X7 (jumlah pasar rakyat). Koefisien lag spasial (ρ) juga berpengaruh terhadap model SAR pada taraf nyata α = 0,05\n\nmod.slx &lt;- lm(W.model1)\nsummary(mod.slx)\n# \n# Call:\n# lm(formula = W.model1)\n# \n# Residuals:\n#     Min      1Q  Median      3Q     Max \n# -1.1161 -0.2879 -0.0812  0.4076  1.2618 \n# \n# Coefficients:\n#              Estimate Std. Error t value Pr(&gt;|t|)  \n# (Intercept)  2.35e+02   1.84e+02    1.27    0.222  \n# log(X1)     -7.44e-02   5.35e-01   -0.14    0.891  \n# X2          -1.50e-04   2.84e-04   -0.53    0.605  \n# X4          -2.03e-01   1.36e-01   -1.50    0.155  \n# log(X5)      6.88e-01   5.45e-01    1.26    0.226  \n# X6           4.32e-03   2.17e-03    1.99    0.065 .\n# X7           1.76e-02   1.03e-02    1.71    0.107  \n# X8           8.53e-05   1.03e-03    0.08    0.935  \n# WX1          2.55e+00   4.11e+00    0.62    0.545  \n# WX2         -8.69e-04   4.20e-03   -0.21    0.839  \n# WX4         -2.44e+00   1.84e+00   -1.33    0.205  \n# WX8          3.80e-03   1.52e-02    0.25    0.806  \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# \n# Residual standard error: 0.733 on 15 degrees of freedom\n# Multiple R-squared:  0.773,   Adjusted R-squared:  0.607 \n# F-statistic: 4.66 on 11 and 15 DF,  p-value: 0.00351\n\nHasil di atas menunjukkan tidak ada peubah penjelas yang berpengaruh terhadap produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 pada taraf nyata α = 0,05.\n\nmod.sdm &lt;- lagsarlm(W.model1, listw = invers.w2)\nsummary(mod.sdm, Nagelkerke = T)\n# \n# Call:lagsarlm(formula = W.model1, listw = invers.w2)\n# \n# Residuals:\n#       Min        1Q    Median        3Q       Max \n# -1.039830 -0.281965 -0.019636  0.316451  0.927201 \n# \n# Type: lag \n# Coefficients: (asymptotic standard errors) \n#                Estimate  Std. Error z value  Pr(&gt;|z|)\n# (Intercept)  1.5492e+02  1.1710e+02  1.3229 0.1858694\n# log(X1)     -4.9455e-01  3.2901e-01 -1.5031 0.1328066\n# X2           1.2615e-04  1.7741e-04  0.7110 0.4770697\n# X4          -1.1749e-01  8.3108e-02 -1.4137 0.1574386\n# log(X5)      1.1034e+00  3.3289e-01  3.3146 0.0009178\n# X6           3.3092e-03  1.3100e-03  2.5262 0.0115317\n# X7           1.5955e-02  6.1723e-03  2.5850 0.0097381\n# X8          -6.3528e-04  6.2430e-04 -1.0176 0.3088765\n# WX1         -1.8403e+00  2.5883e+00 -0.7110 0.4770779\n# WX2          3.4793e-03  2.6296e-03  1.3231 0.1857951\n# WX4         -1.7319e+00  1.1696e+00 -1.4807 0.1386765\n# WX8         -8.7316e-03  9.4836e-03 -0.9207 0.3572017\n# \n# Rho: 0.62, LR test value: 8.37, p-value: 0.0038193\n# Asymptotic standard error: 0.142\n#     z-value: 4.36, p-value: 1.2842e-05\n# Wald statistic: 19, p-value: 1.2842e-05\n# \n# Log likelihood: -17.8 for lag model\n# ML residual variance (sigma squared): 0.195, (sigma: 0.441)\n# Nagelkerke pseudo-R-squared: 0.834 \n# Number of observations: 27 \n# Number of parameters estimated: 14 \n# AIC: 63.6, (AIC for lm: 70)\n# LM test for residual autocorrelation\n# test value: 0.681, p-value: 0.40907\n\nHasil di atas menunjukkan peubah penjelas yang berpengaruh signifikan terhadap total produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021 yaitu X5(jumlah UMKM), X6(jumlah tempat rekreasi dan pariwisata), dan X7(jumlah pasar rakyat). Koefisien lag spasial (ρ) juga berpengaruh terhadap model SDM pada taraf nyata α = 0,05. Hanya koefisien lag spasial peubah penjelas X4 yang berpengaruh nyata terhadap model SDM pada taraf nyata α = 0,05. Hal tersebut mengindikasikan bahwa penambahan lag spasial peubah penjelas dalam model tidak berpengaruh terhadap model.\nPemilihan Model Terbaik\n\npseudo_sar &lt;- 0.7934\npseudo_slx &lt;- 0.6074\npseudo_sdm &lt;- 0.8338\nbic_sar &lt;- BIC(mod.sar)\nbic_slx &lt;- BIC(mod.slx)\nbic_sdm &lt;- BIC(mod.sdm)\ntabel_bic &lt;- matrix(c(bic_sar, bic_slx, bic_sdm, pseudo_sar, pseudo_slx, pseudo_sdm), ncol = 2, byrow = F)\ntabel_bic &lt;- round(tabel_bic,3)\nrownames(tabel_bic) &lt;- c('SAR', 'SLX', 'SDM')\ncolnames(tabel_bic) &lt;- c('BIC', paste(\"Pseudo R\",supsc('2')))\ntabel_bic\n#      BIC Pseudo R ²\n# SAR 74.4      0.793\n# SLX 86.8      0.607\n# SDM 81.7      0.834\n\nModel SAR merupakan model yang memiliki nilai BIC terkecil dibandingkan dua model lainnya. Model SAR memiliki nilai pseudo R-Squared yang tidak berbeda jauh dengan model SDM, tetapi nilai BIC model SAR lebih kecil dibandingkan model SDM. Selain itu, hanya satu koefisien lag spasial peubah penjelas pada model SDM yang signifikan. Hal tersebut menunjukkan bahwa penambahan lag spasial pada peubah penjelas tidak memberikan pengaruh pada model sehingga model SAR adalah model yang akan dipilih sebagai model terbaik untuk memodelkan produksi sampah per kepadatan penduduk di Jawa Barat tahun 2021. Selanjutnya akan dilakukan pengecekan asumsi normalitas sisaan, kehomogenan ragam sisaan dan kebebasan ragam sisaaan pada model SAR.\n\n## Asumsi\nasumsi &lt;- c(\"Normalitas\", \"Heterogenitas\", \"Autokorelasi\")\nnormalitas &lt;- shapiro.test(mod.sar$residuals)\nheterogenitas &lt;- bptest.Sarlm(mod.sar)\nautokorelasi.stat &lt;- 0.00313\nautokorelasi &lt;- 0.9553\ntabel_asumsi &lt;- matrix(c(normalitas$statistic, heterogenitas$statistic, autokorelasi.stat, normalitas$p.value, heterogenitas$p.value, autokorelasi), ncol = 2, byrow = F)\ntabel_asumsi &lt;- cbind(asumsi, round(tabel_asumsi, 3))\ncolnames(tabel_asumsi) &lt;- c(\"Asumsi\", \"Statistik Uji\", \"Nilai-P\")\ntabel_asumsi\n#      Asumsi          Statistik Uji Nilai-P\n# [1,] \"Normalitas\"    \"0.955\"       \"0.288\"\n# [2,] \"Heterogenitas\" \"2.526\"       \"0.925\"\n# [3,] \"Autokorelasi\"  \"0.003\"       \"0.955\"\n\nInterpretasi Model\nInterpretasi pada koefisien regresi spasial dilakukan dengan melihat nilai efek langsung (direct effect), efek tidak langsung (indirect effect), dan efek total (total effect). Efek langsung merupakan nilai harapan perubahan rataan semua amatan untuk peubah respon di suatu wilayah karena peningkatan satu unit untuk peubah penjelas tertentu di wilayah tersebut. Efek tidak langsung merupakan perubahan pada peubah respon di suatu wilayah yang timbul dari kenaikan satu unit pada peubah penjelas di wilayah lain. Efek langsung dan tidak langsung dihitung menggunakan syntax berikut:\n\n#### Spill-Over Effect ####\nmod.sar.fixed &lt;- lagsarlm(log(Y2)~X4+log(X5)+X6+X7, listw = invers.w)\n\n#Membuat matriks identitas\nI &lt;- matrix(0, 27, 27)\ndiag(I) &lt;- 1\nIt &lt;- matrix(1, 27, 1)\nIt_transpose &lt;- t(It)\n\n#Matriks Pembobot\nW &lt;- as.matrix(w_std)\nrho &lt;- 0.52112\nrhow &lt;- rho*W\nop &lt;- I - rhow\ninvers &lt;- solve(op)\n\n#X4\nbeta3 &lt;- -0.2983842\nb3 &lt;- beta3*invers #matriks untuk direct effect\ndirect_b3 &lt;- as.matrix(diag(b3))\ndirect_b3 &lt;- cbind(petajabar$KABKOT, direct_b3)\nb3.2 &lt;- b3\ndiag(b3.2) &lt;- 0 #matriks untuk indirect effect\nindirect_b3 &lt;- as.matrix(rowSums(b3.2))\ntotal_b3 &lt;- mean(direct_b3)+mean(indirect_b3)\n# Warning in mean.default(direct_b3): argument is not numeric or\n# logical: returning NA\n\n#X5\nbeta4 &lt;- 0.4934092\nb4 &lt;- beta4*invers #matriks untuk direct effect\ndirect_b4 &lt;- as.matrix(diag(b4))\ndirect_b4 &lt;- cbind(petajabar$KABKOT, direct_b4)\nb4.2 &lt;- b4\ndiag(b4.2) &lt;- 0 #matriks untuk indirect effect\nindirect_b4 &lt;- as.matrix(rowSums(b4.2))\ntotal_b4 &lt;- mean(direct_b4)+mean(indirect_b4)\n# Warning in mean.default(direct_b4): argument is not numeric or\n# logical: returning NA\n\n#X6\nbeta5 &lt;- 0.0043757\nb5 &lt;- beta5*invers\ndirect_b5 &lt;- as.matrix(diag(b5))\ndirect_b5 &lt;- cbind(petajabar$KABKOT, direct_b5)\nb5.2 &lt;- b5\ndiag(b5.2) &lt;- 0 #matriks untuk indirect effect\nindirect_b5 &lt;- as.matrix(rowSums(b5.2))\ntotal_b5 &lt;- mean(direct_b5)+mean(indirect_b5)\n# Warning in mean.default(direct_b5): argument is not numeric or\n# logical: returning NA\n\n#X7\nbeta6 &lt;- 0.0043757\nb6 &lt;- beta6*invers\ndirect_b6 &lt;- as.matrix(diag(b6))\ndirect_b6 &lt;- cbind(petajabar$KABKOT, direct_b6)\nb6.2 &lt;- b6\ndiag(b6.2) &lt;- 0 #matriks untuk indirect effect\nindirect_b6 &lt;- as.matrix(rowSums(b6.2))\ntotal_b6 &lt;- mean(direct_b6)+mean(indirect_b6)\n# Warning in mean.default(direct_b6): argument is not numeric or\n# logical: returning NA\ntabel_efek &lt;- matrix(c(mean(direct_b3), mean(indirect_b3), total_b3,mean(direct_b4), mean(indirect_b4), total_b4, mean(direct_b5), mean(indirect_b5), total_b5, mean(direct_b6), mean(indirect_b6), total_b6), ncol= 3, byrow = T)\n# Warning in mean.default(direct_b3): argument is not numeric or\n# logical: returning NA\n# Warning in mean.default(direct_b4): argument is not numeric or\n# logical: returning NA\n# Warning in mean.default(direct_b5): argument is not numeric or\n# logical: returning NA\n# Warning in mean.default(direct_b6): argument is not numeric or\n# logical: returning NA\ncolnames(tabel_efek) &lt;- c(\"Direct\", \"Indirect\", \"Total\")\nrownames(tabel_efek) &lt;- c(\"X4\", \"X5\", \"X6\", \"X7\")\ntabel_efek\n#    Direct Indirect Total\n# X4     NA -0.31077    NA\n# X5     NA  0.51389    NA\n# X6     NA  0.00456    NA\n# X7     NA  0.00456    NA\n\n\nindirect_b3 &lt;- cbind(petajabar$KABKOT, indirect_b3)\nindirect_b4 &lt;- cbind(petajabar$KABKOT, indirect_b4)\nindirect_b5 &lt;- cbind(petajabar$KABKOT, indirect_b5)\nindirect_b6 &lt;- cbind(petajabar$KABKOT, indirect_b6)\n\ndat.map &lt;- st_read(\"data/shp/jawa.shp\")\n# Reading layer `jawa' from data source \n#   `E:\\Materi_Orasi\\bookdown\\data\\shp\\jawa.shp' using driver `ESRI Shapefile'\n# Simple feature collection with 119 features and 5 fields\n# Geometry type: MULTIPOLYGON\n# Dimension:     XY\n# Bounding box:  xmin: 105 ymin: -8.78 xmax: 116 ymax: -5.05\n# Geodetic CRS:  WGS 84\ndat.map &lt;- dat.map %&gt;% filter(PROVNO == \"32\")\ndat.map$de_x4&lt;-as.numeric(direct_b3[,2])\ndat.map$de_x5&lt;-as.numeric(direct_b4[,2])\ndat.map$de_x6&lt;-as.numeric(direct_b5[,2])\ndat.map$de_x7&lt;-as.numeric(direct_b6[,2])\ndat.map$ie_x4&lt;-as.numeric(indirect_b3[,2])\ndat.map$ie_x5&lt;-as.numeric(indirect_b4[,2])\ndat.map$ie_x6&lt;-as.numeric(indirect_b5[,2])\ndat.map$ie_x7&lt;-as.numeric(indirect_b6[,2])\n\n\n#### Direct Effect Map ####\n\nmycol &lt;- c(\"green\", \"yellow\", \"red\", \"red4\")\nmap.de.x4 &lt;- ggplot()+\n  geom_sf(data=dat.map, mapping =  aes(geometry = geometry, fill = de_x4))+\n  scale_fill_gradientn(colours = mycol, name = NULL)+\n  labs(title= \"Direct Effect X4\")\n\nmap.de.x5 &lt;- ggplot()+\n  geom_sf(data=dat.map, mapping =  aes(geometry = geometry, fill = de_x5))+\n  scale_fill_gradientn(colours = mycol, name = NULL)+\n  labs(title= \"Direct Effect X5\")\n\nmap.de.x6 &lt;- ggplot()+\n  geom_sf(data=dat.map, mapping =  aes(geometry = geometry, fill = de_x6))+\n  scale_fill_gradientn(colours = mycol, name = NULL)+\n  labs(title= \"Direct Effect X6\")\n\nmap.de.x7 &lt;- ggplot()+\n  geom_sf(data=dat.map, mapping =  aes(geometry = geometry, fill = de_x7))+\n  scale_fill_gradientn(colours = mycol, name = NULL)+\n  labs(title= \"Direct Effect X7\")\n\n\n#### Indirect Effect Map ####\nmap.ie.x4 &lt;- ggplot()+\n  geom_sf(data=dat.map, mapping =  aes(geometry = geometry, fill = ie_x4))+\n  scale_fill_gradientn(colours = mycol, name = NULL)+\n  labs(title= \"Indirect Effect X4\")\n\nmap.ie.x5 &lt;- ggplot()+\n  geom_sf(data=dat.map, mapping =  aes(geometry = geometry, fill = ie_x5))+\n  scale_fill_gradientn(colours = mycol, name = NULL)+\n  labs(title= \"Indirect Effect X5\")\n\nmap.ie.x6 &lt;- ggplot()+\n  geom_sf(data=dat.map, mapping =  aes(geometry = geometry, fill = ie_x6))+\n  scale_fill_gradientn(colours = mycol, name = NULL)+\n  labs(title= \"Indirect Effect X6\")\n\nmap.ie.x7 &lt;- ggplot()+\n  geom_sf(data=dat.map, mapping =  aes(geometry = geometry, fill = ie_x7))+\n  scale_fill_gradientn(colours = mycol, name = NULL)+\n  labs(title= \"Indirect Effect X7\")\nmap.de.x4\n\n\n\n\n\n\nmap.ie.x4\n\n\n\n\n\n\nmap.de.x5\n\n\n\n\n\n\nmap.ie.x5\n\n\n\n\n\n\nmap.de.x6\n\n\n\n\n\n\nmap.ie.x6\n\n\n\n\n\n\nmap.de.x7\n\n\n\n\n\n\nmap.ie.x7",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Spasial Autoregresif Model</span>"
    ]
  },
  {
    "objectID": "02-SpasialDurbinModel.html",
    "href": "02-SpasialDurbinModel.html",
    "title": "\n2  Spasial Durbin Model\n",
    "section": "",
    "text": "2.1 Data\nIlustrasi model spasial Durbin (spatial Durbin model/SDM) bersumber dari penelitian Febriyanti et al. (2016). Kasus yang diteliti adalah tentang infeksi virus Dengue di kecamatan DKI Jakarta. Peubah yang digunakan dan sumber data selengkapnya disajikan pada Tabel berikut. Data dan peta ilustrasi SDM tersedia pada tautan https://ipb.link/sdm.",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Spasial Durbin Model</span>"
    ]
  },
  {
    "objectID": "02-SpasialDurbinModel.html#metode-analisis",
    "href": "02-SpasialDurbinModel.html#metode-analisis",
    "title": "\n2  Spasial Durbin Model\n",
    "section": "\n2.2 Metode Analisis",
    "text": "2.2 Metode Analisis\nLangkah-langkah metode analisis data pada penelitian ini adalah sebagai berikut: 1. Melakukan eksplorasi data untuk memeriksa multikolinearitas pada prediktor yang digunakan dengan variance inflation factors (VIF), menentukan efek spasial secara eksploratif dengan peta tematik, dan memeriksa pencilan spasial dengan menggunakan diagram kotak garis dan plot pencaran Moran. 2. Membuat matriks pembobot spasial (W) dengan metode pembobotan Queen Contiguity. 3. Menguji efek spasial: a) depedensi spasial pada peubah respon dan sisaan dari model regresi linier berganda dengan indeks Moran. b) Menguji kehomogenan ragam sisaan model regresi klasik dengan uji Breusch-Pagan. c) Pemilihan model depedensi spasial menggunakan uji pengganda Lagrange (Lagrange Multiplier/LM). 4. Memeriksa efek depedensi spasial pada prediktor dengan indeks Moran. 5. Menduga parameter model regresi spasial sesuai hasil butir (3) dan (4). 6. Memeriksa asumsi pada model regresi spasial pada butir (5). 7. Mengukur kebaikan model dengan pseudo R2 dan AIC. 8. Interpretasi Model terbaik.",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Spasial Durbin Model</span>"
    ]
  },
  {
    "objectID": "02-SpasialDurbinModel.html#tahapan-analisis-data-dengan-r",
    "href": "02-SpasialDurbinModel.html#tahapan-analisis-data-dengan-r",
    "title": "\n2  Spasial Durbin Model\n",
    "section": "\n2.3 Tahapan Analisis Data dengan R",
    "text": "2.3 Tahapan Analisis Data dengan R\nTahap awal dalam pemodelan menggunakan R Studio adalah melakukan input data dan install package yang dibutuhkan untuk analisis.\nPackage\n\nlibrary(readxl)         # Untuk import data format .xlsx\nlibrary(car)        # Untuk menghitung nilai VIF\n# Loading required package: carData\nlibrary(spdep)      # Untuk pemodelan dependensi spasial\n# Warning: package 'spdep' was built under R version 4.2.3\n# Loading required package: spData\n# To access larger datasets in this package, install the\n# spDataLarge package with: `install.packages('spDataLarge',\n# repos='https://nowosad.github.io/drat/', type='source')`\n# Loading required package: sf\n# Linking to GEOS 3.9.1, GDAL 3.4.3, PROJ 7.2.1; sf_use_s2() is TRUE\nlibrary(spatialreg) # Untuk pemodelan dependensi spasial\n# Loading required package: Matrix\n# \n# Attaching package: 'spatialreg'\n# The following objects are masked from 'package:spdep':\n# \n#     get.ClusterOption, get.coresOption, get.mcOption,\n#     get.VerboseOption, get.ZeroPolicyOption,\n#     set.ClusterOption, set.coresOption, set.mcOption,\n#     set.VerboseOption, set.ZeroPolicyOption\nlibrary(lmtest)     # Untuk pengujian asumsi\n# Loading required package: zoo\n# Warning: package 'zoo' was built under R version 4.2.3\n# \n# Attaching package: 'zoo'\n# The following objects are masked from 'package:base':\n# \n#     as.Date, as.Date.numeric\nlibrary(DataExplorer)   # Untuk visualisasi data\nlibrary(ggplot2)            # Untuk visualisasi data\n# Warning: package 'ggplot2' was built under R version 4.2.2\nlibrary(dplyr)      # Untuk mengolah dataset\n# \n# Attaching package: 'dplyr'\n# The following object is masked from 'package:car':\n# \n#     recode\n# The following objects are masked from 'package:stats':\n# \n#     filter, lag\n# The following objects are masked from 'package:base':\n# \n#     intersect, setdiff, setequal, union\n\nInput Data\n\n#Set Lokasi File\n#Input Data\nDBD&lt;-read_excel('data/3100_data.xlsx')\n#\n#Menyamakan tipe data dengan file shp\nDBD$KODE2010 &lt;- as.character(DBD$KODE2010) \n#\n#Rasio SD per 100 000 penduduk\nDBD$PSD &lt;- (DBD$SD/DBD$JUMLAHPENDUDUK)*100000 \ncolnames(DBD)[c(23, 17, 18, 19, 20, 21, 22, 24)] &lt;- c('X1','X2','X3','X4','X5','X6','X7','X8')\n#\n#Merapikan dataframe\nDBD &lt;- DBD[c('KODE2010', 'KECAMATAN', 'Y', 'X1', 'X2', 'X3', 'X4', \n     'X5', 'X6', 'X7', 'X8')]\n# \n#Input peta SHP\nshp.jkt &lt;- read_sf(\"data/shp/3100_kec.shp\")\n# \n#Menggabungkan Data ke file SHP\ngabung = inner_join(shp.jkt, DBD, by = \"KODE2010\")\nlonglat=st_coordinates(st_centroid(gabung))\n# Warning in st_centroid.sf(gabung): st_centroid assumes attributes\n# are constant over geometries of x\ngabung\n# Simple feature collection with 42 features and 17 fields\n# Geometry type: MULTIPOLYGON\n# Dimension:     XY\n# Bounding box:  xmin: 107 ymin: -6.37 xmax: 107 ymax: -6.09\n# CRS:           NA\n# # A tibble: 42 × 18\n#   PROVNO KABKOTNO KECNO KODE2010 PROVINSI    KABKOT      KECAMATAN.x\n#   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;      \n# 1 31     75       010   3175010  DKI JAKARTA JAKARTA UT… PENJARINGAN\n# 2 31     75       020   3175020  DKI JAKARTA JAKARTA UT… PADEMANGAN \n# 3 31     75       030   3175030  DKI JAKARTA JAKARTA UT… TANJUNG PR…\n# 4 31     75       040   3175040  DKI JAKARTA JAKARTA UT… KOJA       \n# 5 31     75       050   3175050  DKI JAKARTA JAKARTA UT… KELAPA GAD…\n# 6 31     75       060   3175060  DKI JAKARTA JAKARTA UT… CILINCING  \n# # ℹ 36 more rows\n# # ℹ 11 more variables: geometry &lt;MULTIPOLYGON&gt;, KECAMATAN.y &lt;chr&gt;,\n# #   Y &lt;dbl&gt;, X1 &lt;dbl&gt;, X2 &lt;dbl&gt;, X3 &lt;dbl&gt;, X4 &lt;dbl&gt;, X5 &lt;dbl&gt;,\n# #   X6 &lt;dbl&gt;, X7 &lt;dbl&gt;, X8 &lt;dbl&gt;\n\nEksplorasi Data\nUntuk mengetahui multikolinearitas pada prediktor digunakan yaitu VIF. Syntax untuk menghitung VIF setiap prediktor sebagai berikut:\n\n#Multikolinier \nmodel&lt;-lm(Y~X1+X2+X3+X4+X5+X6+X7+X8,data=gabung)\nas.matrix(vif(model))\n#    [,1]\n# X1 1.48\n# X2 1.38\n# X3 5.74\n# X4 2.31\n# X5 2.84\n# X6 1.96\n# X7 1.35\n# X8 5.68\n\nPada output terlihat nilai VIF dari prediktor lebih kecil dari 10, sehingga disimpulkan tidak terdapat multikolinearitas pada prediktor.  \n \nUntuk mengetahui efek dependensi spasial pada persentase kasus DBD secara eksploratif dapat menggunakan peta pola tebaran data. Syntax untuk membuat peta tematik sebagai berikut:\n\n#Peta persentase kasus DBD\nplotDBD = ggplot(data=gabung) +\n  geom_sf(aes(fill = cut(Y, \n       breaks = c(0.12, 0.18, 0.25, 0.40, 0.73, 1.54)))) +\n       geom_text(aes(longlat[,1],\n       longlat[,2],label=KECAMATAN.y),size=2) +\n       scale_fill_brewer(\"Presentase Kasus DBD\", \n       palette = \"RdPu\", \n       labels = c(\"0.12% - 0.18%\", \"0.18% - 0.25%\", \n       \"0.25% - 0.40%\", \"0.40% - 0.73%\", \"0.73% - 1.54%\"), \n       direction = 1) +\n  xlab(\"\") +\n  ylab(\"\") \nplotDBD\n\n\n\n\n\n\n\nPada peta persentase kasus DBD terlihat kecamatan yang berdekatan memiliki warna yang sama. Warna pada peta tampak mengelompok.Perubahan warna antar kelompok mengikuti gradasi warna, yaitu kecamatan yang warna yang pekat berdekatan dengan warna yang lebih terang. Hal ini menunjukkan bahwa autokorelasi spasial pada persentase kasus DBD DKI Jakarta tahun 2014.  \n \nPemeriksaan pencilan pada peubah Y menggunakan diagram kotak-garis. Syntax untuk membuat diagram kotak-garis sebagai berikut:\n\n#Membuat fungsi untuk menemukan outlier\nfindoutlier &lt;- function(x) {\n  return(x &lt; quantile(x, .25) - 1.5*IQR(x) | x &gt; quantile(x, .75) + 1.5*IQR(x))\n}\n# \n#Membuat kolom baru pada data DBD yang berisi Nama Kecamatan j\n#jika nilai Y merupakan outlier, dan NA jika bukan outlier\nDBD &lt;- DBD %&gt;%\n  mutate(outlier = ifelse(findoutlier(Y), KECAMATAN, NA))\n#\n#Membuat boxplot\nggplot(DBD) + aes(x = Y, y = \"\") + \n  geom_boxplot(fill = \"#EF562D\") +\n  geom_text(aes(x = Y-0.95, y = 1.06, label = outlier),\n            na.rm=TRUE, hjust=-.2)+\n  xlim(c(0.1,0.8))+\n  labs(x = \"Y\", y =\"\") + theme_light()\n# Warning: Removed 1 rows containing non-finite values\n# (`stat_boxplot()`).\n\n\n\n\n\n\n\nPada diagram kotak garis terlihat bahwa kecamatan Kelapa Gading memiliki persentase penderita infeksi virus Dengue tertinggi dan merupakan amatan pencilan. Oleh karena itu, pemeriksaan efek depedensi spasial dan efek keheterogenan spasial dilakukan pada data semua kecamatan (Model 1) dan data tanpa Kecamatan Kelapa Gading (Model 2).\nMatriks Pembobot Spasial\nSyntax untuk membuat matriks pembobot spasial langka ratu untuk Model 1 dan Model 2 sebagai berikut:\n\n#Membentuk dataset tanpa pencilan\ngabung2 &lt;- gabung[gabung$KECAMATAN.y != \"KELAPA GADING\",]\n#\n#Matriks pembobot spasial Model 1\nsf_use_s2(FALSE)\n# Spherical geometry (s2) switched off\nW.queen &lt;- poly2nb(gabung,queen=T)\nqueen.listw &lt;- nb2listw(W.queen,style='W', zero.policy = TRUE)\nsummary(queen.listw)\n# Characteristics of weights list object:\n# Neighbour list object:\n# Number of regions: 42 \n# Number of nonzero links: 212 \n# Percentage nonzero weights: 12 \n# Average number of links: 5.05 \n# Link number distribution:\n# \n#  2  3  4  5  6  7  8 \n#  1  8  5  9 13  5  1 \n# 1 least connected region:\n# 14 with 2 links\n# 1 most connected region:\n# 22 with 8 links\n# \n# Weights style: W \n# Weights constants summary:\n#    n   nn S0   S1  S2\n# W 42 1764 42 17.6 172\n#\n#Matriks pembobot spasial Model 2\nW.queen2 &lt;- poly2nb(gabung2,queen=T)\nqueen.listw2 &lt;- nb2listw(W.queen2,style='W', zero.policy = TRUE)\nsummary(queen.listw2)\n# Characteristics of weights list object:\n# Neighbour list object:\n# Number of regions: 41 \n# Number of nonzero links: 198 \n# Percentage nonzero weights: 11.8 \n# Average number of links: 4.83 \n# Link number distribution:\n# \n#  2  3  4  5  6  7  8 \n#  3  8  3 11 12  3  1 \n# 3 least connected regions:\n# 4 5 13 with 2 links\n# 1 most connected region:\n# 21 with 8 links\n# \n# Weights style: W \n# Weights constants summary:\n#    n   nn S0   S1  S2\n# W 41 1681 41 18.5 167\n\nEfek Spasial\nPerhitungan indeks Moran dan uji efek heterogenitas spasial dilakukan pada Model 1 dan Model 2 dengan menggunakan syntax sebagai berikut:\n\n#Regresi untuk Model 1 \nModel1 &lt;- lm(Y~X1+X2+X3+X4+X5+X6+X7+X8,data=gabung)\n#\n#Pemeriksaan efek spasial Model 1\nmoran1 &lt;- moran.test(gabung$Y,queen.listw)\nmoranerr1 &lt;- lm.morantest(model, queen.listw)\nbp1 &lt;- bptest(model)\n#\n#Regresi untuk Model 2 \nmodel2 &lt;- lm(Y~X1+X2+X3+X4+X5+X6+X7+X8,data=gabung2)\n#\n#Pemeriksaan efek spasial Model 2\nmoran2 &lt;- moran.test(gabung2$Y,queen.listw2)\nmoranerr2 &lt;- lm.morantest(model2, queen.listw2)\nbp2 &lt;- bptest(model2)\n#\n#Ringkasan\nIMoran &lt;- data.frame(matrix(c(\"Nilai p Uji BP\",\n          \"Indeks Moran Y\", \"Nilai p Indeks Moran Y\",\n          \"Indeks Moran Sisaan\", \n          \"Nilai p Indeks Moran Sisaan\",\n          round(bp1$p.value,2), \n          round(moran1$estimate[1], 2), \n          round(moran1$p.value, 2),\n          round(moranerr1$estimate[1], 2), \n          round(moranerr1$p.value, 2),\n          round(bp2$p.value,2),\n          round(moran2$estimate[1], 2), \n          round(moran2$p.value, 2),\n          round(moranerr2$estimate[1], 2), \n          round(moranerr2$p.value, 2)),\n          byrow = F, ncol = 3, \n          dimnames = list(1:5, c(\"Keterangan\", \n          \"Model 1\", \"Model 2\"))))\nIMoran\n#                    Keterangan Model.1 Model.2\n# 1              Nilai p Uji BP       0    0.08\n# 2              Indeks Moran Y   -0.01    0.38\n# 3      Nilai p Indeks Moran Y    0.44       0\n# 4         Indeks Moran Sisaan   -0.13   -0.11\n# 5 Nilai p Indeks Moran Sisaan     0.8    0.69\n\nBerdasarkan hasil uji Indeks Moran dan Uji Breusch Pagan dapat disimpulkan bahwa Model 1 memiliki ragam yang heterogen. Untuk Model 2 hanya memiliki autokorelasi spasial pada peubah responnya. Pada ilustrasi ini hanya dilakukan pembahasan untuk Model 2.  \n \nPengujian efek dependensi spasial menggunakan uji Lagrange Multiplier dengan syntax sebagai berikut:\n\n#Uji LM dan RLM\nspasial2&lt;-lm.RStests(model2,queen.listw2,test=c('LMlag','LMerr','RLMlag', 'RLMerr','SARMA'))\nsummary(spasial2)\n#   Rao's score (a.k.a Lagrange multiplier) diagnostics for\n#   spatial dependence\n# data:  \n# model: lm(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 +\n# X8, data = gabung2)\n# test weights: queen.listw2\n#  \n#          statistic parameter p.value  \n# RSerr        1.053         1   0.305  \n# RSlag        0.266         1   0.606  \n# adjRSerr     4.901         1   0.027 *\n# adjRSlag     4.115         1   0.043 *\n# SARMA        5.167         2   0.075 .\n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nPada output uji efek spasial terlihat nilai-p dari uji RLMlag dan RLMerr bernilai lebih kecil dari α=0.05 dan SARMA lebih besar dari α=0.05. Berdasarkan hasil uji LM ini maka model yang sesuai untuk data adalah SAR.\nEfek dependensi spasial pada prediktor\nPenentuan prediktor yang mempunyai autokorelasi spasial menggunakan indeks Moran dengan syntax sebagai berikut:\n\n#Uji Moran pada prediktor\nmoranx1 &lt;- moran.test(gabung2$X1, queen.listw2)\nmoranx2 &lt;- moran.test(gabung2$X2, queen.listw2)\nmoranx3 &lt;- moran.test(gabung2$X3, queen.listw2)\nmoranx4 &lt;- moran.test(gabung2$X4, queen.listw2)\nmoranx5 &lt;- moran.test(gabung2$X5, queen.listw2)\nmoranx6 &lt;- moran.test(gabung2$X6, queen.listw2)\nmoranx7 &lt;- moran.test(gabung2$X7, queen.listw2)\nmoranx8 &lt;- moran.test(gabung2$X8, queen.listw2)\nMoranX &lt;- data.frame(matrix(c(\"X1\", \"X2\", \"X3\", \"X4\",\n          \"X5\", \"X6\", \"X7\", \"X8\", \n          round(moranx1$estimate[1], 2), \n          round(moranx2$estimate[1], 2),\n          round(moranx3$estimate[1], 2),\n          round(moranx4$estimate[1], 2),\n          round(moranx5$estimate[1], 2),\n          round(moranx6$estimate[1], 2),\n          round(moranx7$estimate[1], 2),\n          round(moranx8$estimate[1], 2),\n          round(moranx1$p.value, 2), \n          round(moranx2$p.value, 2),\n          round(moranx3$p.value, 2),\n          round(moranx4$p.value, 2),\n          round(moranx5$p.value, 2),\n          round(moranx6$p.value, 2),\n          round(moranx7$p.value, 2),\n          round(moranx8$p.value, 2)),\n          byrow = F, ncol = 3, dimnames = list(1:8, \n          c(\"Peubah\", \"Nilai Indeks Moran\", \"Nilai-p\"))))\nMoranX\n#   Peubah Nilai.Indeks.Moran Nilai.p\n# 1     X1               0.39       0\n# 2     X2               0.11    0.07\n# 3     X3               0.29       0\n# 4     X4                0.1    0.11\n# 5     X5               0.32       0\n# 6     X6               0.05    0.23\n# 7     X7               0.12    0.06\n# 8     X8               0.51       0\n\nPada output indeks Moran tampak peubah X1, X3, X5, dan X8 memiliki autokorelasi spasial yang nyata. Oleh karena itu, pada model spasial perlu ditambahkan lag-prediktor (WX). Berdasarkan hasil uji LM dan uji indeks Moran pada prediktor, maka model spasial yang dipilih adalah SAR dan SDM.\nPendugaan parameter model SAR dan SDM\nPendugaan parameter model SAR menggunakan syntax sebagai berikut:\n\n#Model SAR\nmodelSAR&lt;-lagsarlm(model2,queen.listw2,data=gabung2)\nsummary(modelSAR,Nagelkerke=T)\n# \n# Call:\n# lagsarlm(formula = model2, data = gabung2, listw = queen.listw2)\n# \n# Residuals:\n#       Min        1Q    Median        3Q       Max \n# -0.166406 -0.067211 -0.018407  0.056343  0.228568 \n# \n# Type: lag \n# Coefficients: (asymptotic standard errors) \n#                Estimate  Std. Error z value Pr(&gt;|z|)\n# (Intercept) -1.7862e-02  7.9309e-02 -0.2252 0.821810\n# X1          -7.7444e-07  1.7298e-06 -0.4477 0.654371\n# X2          -1.0409e-02  6.5021e-03 -1.6009 0.109395\n# X3          -1.2592e-02  1.1777e-02 -1.0692 0.284969\n# X4          -9.7550e-04  3.0611e-03 -0.3187 0.749971\n# X5           5.3441e-04  1.1327e-03  0.4718 0.637057\n# X6           8.0145e-03  2.5653e-03  3.1242 0.001783\n# X7          -1.4708e-05  5.7398e-06 -2.5624 0.010396\n# X8           6.0165e-03  1.8904e-03  3.1827 0.001459\n# \n# Rho: 0.0843, LR test value: 0.246, p-value: 0.62004\n# Asymptotic standard error: 0.175\n#     z-value: 0.481, p-value: 0.63032\n# Wald statistic: 0.232, p-value: 0.63032\n# \n# Log likelihood: 40.5 for lag model\n# ML residual variance (sigma squared): 0.00809, (sigma: 0.0899)\n# Nagelkerke pseudo-R-squared: 0.676 \n# Number of observations: 41 \n# Number of parameters estimated: 11 \n# AIC: -59.1, (AIC for lm: -60.8)\n# LM test for residual autocorrelation\n# test value: 4.75, p-value: 0.029271\n\nPemodelan SDM dengan lag-prediktor X1, X3, X5, dan X8 menggunakan syntax berikut:\n\n#Model SDM\nmodelSDM &lt;- lagsarlm(model2, queen.listw2, data = gabung2,\n            Durbin = ~X1+X3+X5+X8)\nsummary(modelSDM,Nagelkerke=T)\n# \n# Call:\n# lagsarlm(formula = model2, data = gabung2, listw = queen.listw2, \n#     Durbin = ~X1 + X3 + X5 + X8)\n# \n# Residuals:\n#        Min         1Q     Median         3Q        Max \n# -0.1283448 -0.0535020 -0.0032732  0.0375121  0.2282186 \n# \n# Type: mixed \n# Coefficients: (asymptotic standard errors) \n#                Estimate  Std. Error z value  Pr(&gt;|z|)\n# (Intercept) -3.1013e-01  1.2316e-01 -2.5181 0.0117992\n# X1          -1.4365e-06  1.8076e-06 -0.7947 0.4267902\n# X2          -1.0415e-02  5.9513e-03 -1.7501 0.0801063\n# X3          -2.6781e-03  1.0746e-02 -0.2492 0.8031808\n# X4          -3.1492e-03  2.7366e-03 -1.1508 0.2498172\n# X5           3.9221e-04  1.0200e-03  0.3845 0.7005954\n# X6           6.5894e-03  2.3690e-03  2.7815 0.0054104\n# X7          -9.6902e-06  5.5183e-06 -1.7560 0.0790883\n# X8           3.8520e-03  1.8732e-03  2.0564 0.0397434\n# lag.X1       6.1233e-06  3.7831e-06  1.6186 0.1055315\n# lag.X3      -2.2872e-02  2.0222e-02 -1.1310 0.2580552\n# lag.X5      -3.8736e-03  1.9671e-03 -1.9692 0.0489277\n# lag.X8       1.3069e-02  3.9530e-03  3.3062 0.0009458\n# \n# Rho: -0.309, LR test value: 1.93, p-value: 0.16502\n# Asymptotic standard error: 0.222\n#     z-value: -1.39, p-value: 0.16353\n# Wald statistic: 1.94, p-value: 0.16353\n# \n# Log likelihood: 46.8 for mixed model\n# ML residual variance (sigma squared): 0.00586, (sigma: 0.0766)\n# Nagelkerke pseudo-R-squared: 0.761 \n# Number of observations: 41 \n# Number of parameters estimated: 15 \n# AIC: -63.5, (AIC for lm: -63.6)\n# LM test for residual autocorrelation\n# test value: 0.361, p-value: 0.54821\n\nPemeriksaan asumsi model regresi spasial\nPemeriksaan asumsi untuk Model SAR dan SDM yang terdiri dari kenormalan sisaan, homogenitas ragam, dan kebebasan sisan menggunakan syntax sebagai berikut:\n\n#Asumsi model SAR\nsisaan.sar&lt;-resid(modelSAR)\nnormSAR &lt;- shapiro.test(sisaan.sar)\nheteSAR &lt;- bptest.Sarlm(modelSAR)\nautoSAR &lt;- moran.test(sisaan.sar, listw = queen.listw2)\nasumsiSAR &lt;- data.frame(matrix(c(\"Kenormalan\", \n             \"Kehomogenan ragam\", \"Autokorelasi\", \n             round(normSAR$p.value, 2),\n             round(heteSAR$p.value, 2),\n             round(autoSAR$p.value, 2)), \n             byrow = F, ncol = 2, dimnames = list(1:3,\n             c(\"Uji\", \"p-value\"))))\nasumsiSAR$Kesimpulan &lt;- ifelse(asumsiSAR$p.value &gt; 0.05, \"Terpenuhi\", \"Tidak Terpenuhi\")\nasumsiSAR\n#                 Uji p.value      Kesimpulan\n# 1        Kenormalan    0.76       Terpenuhi\n# 2 Kehomogenan ragam    0.05 Tidak Terpenuhi\n# 3      Autokorelasi    0.89       Terpenuhi\n\n\n#Asumsi model SDM\nsisaan.SDM&lt;-resid(modelSDM)\nnormSDM &lt;- shapiro.test(sisaan.SDM)\nheteSDM &lt;- bptest.Sarlm(modelSDM)\nautoSDM &lt;- moran.test(sisaan.SDM, listw = queen.listw2)\nasumsiSDM &lt;- data.frame(matrix(c(\"Kenormalan\",\n             \"Kehomogenan ragam\", \"Autokorelasi\", \n             round(normSDM$p.value, 2), \n             round(heteSDM$p.value, 2),\n             round(autoSDM$p.value, 2)), \n             byrow = F, ncol = 2, dimnames = list(1:3,\n             c(\"Uji\", \"p-value\"))))\nasumsiSDM$Kesimpulan &lt;- ifelse(asumsiSDM$p.value &gt; 0.05, \"Terpenuhi\", \"Tidak Terpenuhi\")\nasumsiSDM\n#                 Uji p.value Kesimpulan\n# 1        Kenormalan    0.33  Terpenuhi\n# 2 Kehomogenan ragam    0.26  Terpenuhi\n# 3      Autokorelasi     0.5  Terpenuhi\n\nBerdasarkan hasil pemeriksaan asumsi pada sisaan, model SDM memenuhi seluruh asumsi.\nEvaluasi kebaikan model\nEvaluasi kebaikan model menggunakan nilai AIC dan Pseudo R-Square dengan syntax sebagai berikut:\n\n#Nilai AIC dan Pseudo-R2\nsumSAR &lt;- summary(modelSAR, Nagelkerke=T)\nsumSDM &lt;- summary(modelSDM, Nagelkerke=T)\nevaluasi &lt;- data.frame(matrix(\n  c(\"Model SAR\", \"Model SDM\",\n    round(AIC(modelSAR),2),\n    round(AIC(modelSDM),2),\n    round(sumSAR$NK,2), round(sumSDM$NK,2)),\n  byrow = F, nrow = 2, ncol = 3))\ncolnames(evaluasi) &lt;- c(\"Model\", \"AIC\", \"Pseudo-R2\")\nevaluasi\n#       Model    AIC Pseudo-R2\n# 1 Model SAR -59.09      0.68\n# 2 Model SDM -63.53      0.76\n\nPada output terlihat model SDM dibandingkan SAR mempunyai nilai AIC yang lebih rendah dan nilai Pseudo R-Square yang lebih tinggi.  \n \nPemilihan model yang lebih efisien antara SAR dan SDM dapat menggunakan uji Likelihood Ratio (LR). Uji LR antara SAR dan SDM digunakan untuk mengetahui efek penambahan lag-X pada SAR. Syntax untuk uji LR sebagai berikut:\n\n#Uji LR SAR dan SDM\nLR.Sarlm(modelSAR, modelSDM)\n# \n#   Likelihood ratio for spatial linear models\n# \n# data:  \n# Likelihood ratio = -12, df = 4, p-value = 0.01\n# sample estimates:\n# Log likelihood of modelSAR Log likelihood of modelSDM \n#                       40.5                       46.8\n\nPada output uji LR terlihat model SDM lebih efisien dibandingkan model SAR. Model SDM memenuhi semua asumsi pada sisaan, sehingga model SDM merupakan model yang terbaik untuk data infeksi virus Dengue di Jakarta.\nInterpretasi model terbaik\nInterpretasi model SDM dilakukan dengan menentukan nilai efek marginal dari setiap prediktor dengan syntax sebagai berikut:\n\n#Efek marginal\noptions(scipen = 2, digits = 2) # Untuk mengatur digit desimal dari output yang akan dikeluarkan\nimpacts(modelSDM, listw = queen.listw2)\n# Impact measures (mixed, exact):\n#        Direct   Indirect      Total\n# X1 -0.0000019  0.0000054  0.0000036\n# X2 -0.0106211  0.0026671 -0.0079539\n# X3 -0.0012705 -0.0182413 -0.0195118\n# X4 -0.0032115  0.0008065 -0.0024050\n# X5  0.0006473 -0.0033060 -0.0026587\n# X6  0.0067197 -0.0016874  0.0050322\n# X7 -0.0000099  0.0000025 -0.0000074\n# X8  0.0030936  0.0098290  0.0129226\n\nBerdasarkan output efek marginal terlihat bahwa TE positif tertinggi (0.0129226) berasal dari peubah rasio sekolah dasar per 100.000 penduduk (X8), sedangkan TE negatif terkecil (-0.0195118) berasal dari peubah rasio puskesmas per 100.000 penduduk (X3). TE peubah rasio sekolah dasar per 100.000 penduduk (X8) sebesar 0.0129226, artinya kenaikan satu persen X8 akan menaikkan sebanyak 0.0129226 persen kasus infeksi virus Dengue. DE X8 merupakan total efek dari perubahan pada X8 di suatu lokasi berdampak pada lokasi yang sama sebesar 0.0030936. IE X8 sebesar 0.0098290 merupakan total efek dari perubahan satu persen X8 di di suatu lokasi pada lokasi lainnya.  \n   Efek marginal dapat diuraikan berdasarkan daerah dan peubahnya. Berikut syntax yang dapat digunakan untuk menguraikan efek marginal untuk prediktor X8:\n\n#Membuat Matriks S untuk Peubah X8\nrho &lt;- modelSDM$rho\nbeta_hat &lt;- coef(modelSDM)[-c(1,11,12,13,14)]\nA &lt;- invIrW(queen.listw2, rho = rho) # (I - rho*W)^{-1}\nb8 &lt;- as.numeric(beta_hat[9])\ni &lt;- diag(1, ncol = 41, nrow = 41)\nwgamma &lt;- listw2mat(queen.listw2) %*% (coef(modelSDM)[14] * i)\nmat_s &lt;-  A %*% (b8 * i + wgamma)\n\n#Efek langsung\nde &lt;- diag(mat_s)\n\n#Efek tidak langsung\ndiag(mat_s) &lt;- 0\nie &lt;- rowSums(mat_s) \n\n#Efek total\nte &lt;- de+ie\n\nEfek marginal dari prediktor X1 untuk setiap kecamatan DKI Jakarta berbeda-beda. Untuk memudahkan penyajian efek marginal disajikan dalam bentuk peta dengan syntax sebagai berikut:\n\n#Menggabungkan hasil uraian efek dengan data peta\ngabung2$de &lt;- de\ngabung2$ie &lt;- ie\ngabung2$te &lt;- te\n\n#Plot Efek Langsung X8\nggplot(gabung2) + aes(fill = de) + geom_sf(size = 0.05) +\n  scale_fill_continuous(\"Efek Langsung X8\", trans = 'reverse',\n  guide = guide_legend(reverse = F))+ xlab(\"\") + ylab(\"\")\n\n\n\n\n\n\n\nPada peta efek langsung terlihat mayoritas kecamatan di DKI Jakarta berwarna biru gelap (nilai DE 0.028-0.032), kecuali kecamatan Koja, Cilincing dan Cakung yang berwarna biru muda (nilai DE 0.022).\n\n#Plot Efek Tidak Langsung X8\nggplot(gabung2) + aes(fill = ie) + geom_sf(size = 0.05) +\n  scale_fill_continuous(\"Efek Tidak Langsung X8\", \n  trans = 'reverse', guide = guide_legend(reverse = F))+\n  xlab(\"\") + ylab(\"\")\n\n\n\n\n\n\n\nPada peta efek langsung terlihat mayoritas kecamatan di DKI Jakarta berwarna biru muda (nilai DE 0.0099-0.0102), kecuali kecamatan Koja, Cilincing dan Cakung yang berwarna biru tua (nilai DE 0.0105). Peta DE dan peta IE tampak merupakan kebalikan satu sama lain.\n\n#Plot Total Efek X8\nggplot(gabung2) + aes(fill = te) + geom_sf(size = 0.05) +\n  scale_fill_continuous(\"Total Efek X8\", \n  guide = guide_legend(reverse = F))+ xlab(\"\") + ylab(\"\")\n\n\n\n\n\n\n\nUntuk menentukan efek besarnya perubahan Y di kecamatan DKI Jakarta akibat kenaikan nilai prediktor X8 di Kecamatan Kalideres sebesar 1% dapat dihitung menggunakan syntax sebagai berikut:\n\n#Nilai dugaan Y sebelum ada kenaikan nilai\nDBD_up &lt;- DBD[DBD$KECAMATAN != 'KELAPA GADING',]\nX &lt;- cbind(1, DBD_up[,4:11]) \ngamma &lt;- matrix(coef(modelSDM)[11:14], nrow = 4)\nX_2 &lt;- DBD_up[, c('X1', 'X3', 'X5', 'X8')]\nX_2 &lt;- as.matrix(X_2)\nmatw &lt;- listw2mat(queen.listw2)\ny_hat_pre &lt;- A %*% (crossprod(t(X), beta_hat) + (matw %*% X_2 %*% gamma))\n\n#Data Kec. Kalideres naikdengan kenaikan nilai\nDBD_new &lt;- DBD_up\nDBD_new[DBD_new$KECAMATAN == 'KALI DERES', \"X8\"] &lt;- 72\n\n#Nilai dugaan Y setelah ada kenaikan nilai\nX_d &lt;- cbind(1, DBD_new[,4:11]) \nX_2_d &lt;- DBD_new[, c('X1', 'X3', 'X5', 'X8')]\nX_2_d &lt;- as.matrix(X_2_d)\ny_hat_post &lt;- A %*% (crossprod(t(X_d), beta_hat) + \n             (matw %*% X_2_d %*% gamma))\n\n#Perubahan nilai\ndelta_y &lt;- y_hat_post - y_hat_pre\nDBD_new$delta_y &lt;- delta_y\n\n#Plot perubahan nilai\ngabung.new = inner_join(shp.jkt, DBD_new, by = \"KODE2010\")\nggplot(gabung.new) +\n  aes(fill = delta_y) +\n  geom_sf(size = 0.05) +\n  scale_fill_continuous(\"Perubahan Nilai\",trans = 'reverse',\n                        guide = guide_legend(reverse = F))+\n  xlab(\"\") +\n  ylab(\"\")\n\n\n\n\n\n\n\nPada peta perubahan nilai Y (kasus DBD) terlihat Kecamatan Kalideres (warna biru pekat) mempunyai kenaikan kasus DBD terbesar dibandingkan kecamatan lainnya di DKI Jakarta. Pada peta terlihat tetangga Kecamatan Kalideres tidak mengalami perubahan kasus DBD. Beberapa kecamatan yang letaknya jauh dari Kecamatan Kalideres tampak berwarna biru tua, hal ini karena adanya efek dependensi pada prediktor X8.",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Spasial Durbin Model</span>"
    ]
  },
  {
    "objectID": "03-SpasialAutoRegresifBinomialNegatif.html",
    "href": "03-SpasialAutoRegresifBinomialNegatif.html",
    "title": "\n3  Spasial Autoregresif Binomial Negatif\n",
    "section": "",
    "text": "3.1 Deskripsi\nRegresi autoregresif spasial binomial negatif (SAR-BN) adalah pengembangan analisis regresi binomial negatif dengan menambahkan adanya efek spasial pada data. Regresi spasial binomial negatif dapat digunakan pada data cacah yang memiliki dependensi spasial dan kondisi overdispersi. Model regresi spasial BN antara lain:  \nSAR merupakan pemodelan pada data dengan menambahkan pengaruh spasial pada peubah respon. Persamaan untuk model SAR sebagai berikut (Anselin 1988): [ y = W_1 y + X+ ] dengan (y) merupakan peubah respon, (W_1) merupakan matriks pembobot spasial untuk (y), () adalah koefisien parameter regresi, () merupakan sisaan, dan () merupakan koefisien autoregressive lag spasial. Model SAR binomial negatif (SAR BN) dinyatakan sebagai berikut: [ i = (w{1i}^{} y + x_i ) ] dengan (y_i (i)) SDM merupakan model regresi spasial yang digunakan ketika data memiliki dependensi spasial pada peubah respon dan peubah penjelas sehingga pembobotan spasial dilakukan pada peubah respon dan peubah penjelas. Persamaan untuk SDM sebagai berikut (Anselin 1988): [ y = W_1 y + X+ W_2 X + ] dengan (W_2) merupakan matriks pembobot spasial untuk (X) dan () merupakan koefisien untuk lag spasial pada prediktor. Spatial Durbin model binomial negatif (SDM BN) merupakan model spasial Durbin untuk data cacah dengan overdispersi. Persamaan dari SDM BN sebagai berikut (Glaser 2017): [ i = (w{1i}^{} y + x_i + w{2i}^{} x_i ) ] dengan (y_i (_i)) SLX adalah model regresi spasial dengan dependensi spasial hanya pada peubah penjelas. Persamaan untuk SLX sebagai berikut (Vega dan Elhorst 2015): [ y = X+ W_2 X + ] Spatial lag-x binomial negatif (SLX BN) merupakan model regresi spasial untuk data cacah dengan overdispersi dan terdapat dependensi spasial pada prediktor. Persamaan dari SLX BN sebagai berikut: [ i = (x_i + w{2i}^{} x_i ) ] dengan (y_i (_i))",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Spasial Autoregresif Binomial Negatif</span>"
    ]
  },
  {
    "objectID": "03-SpasialAutoRegresifBinomialNegatif.html#data",
    "href": "03-SpasialAutoRegresifBinomialNegatif.html#data",
    "title": "\n3  Spasial Autoregresif Binomial Negatif\n",
    "section": "\n3.2 Data",
    "text": "3.2 Data\nIlustrasi model SAR-BN dirujuk dari hasil penelitian Amelia et al. (2023). Data yang digunakan adalah data sekunder yang diperoleh dari Badan Pusat Statistik Jawa Barat, Dinas Kesehatan Provinsi Jawa Barat, dan Profil Kesehatan Provinsi Jawa Barat Tahun 2021 yang dikeluarkan oleh Dinas Kesehatan Jawa Barat tahun 2021. Unit amatan pada penelitian ini adalah 27 kabupaten/kota di Jawa Barat. Peubah yang digunakan dapat dilihat di Tabel berikut. Data dan peta ilustrasi SAR-BN tersedia pada tautan https://ipb.link/sar-binomial-negatif.",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Spasial Autoregresif Binomial Negatif</span>"
    ]
  },
  {
    "objectID": "03-SpasialAutoRegresifBinomialNegatif.html#metode-analasis",
    "href": "03-SpasialAutoRegresifBinomialNegatif.html#metode-analasis",
    "title": "\n3  Spasial Autoregresif Binomial Negatif\n",
    "section": "\n3.3 Metode Analasis",
    "text": "3.3 Metode Analasis\nAnalisis data dilakukan dengan menggunakan software R dengan tahapan analisis data sebagai berikut:\n\n\nEksplorasi Data:\n\nMelakukan eksplorasi data dengan membuat peta sebaran dari peubah respon.\nMembuat diagram kotak garis peubah respon.\nMembuat plot antara peubah respon dengan peubah penjelas.\nMemeriksa sebaran dari peubah respon.\n\n\n\nDeteksi Multikolinearitas:\n\nMelihat nilai Variance Inflation Factor (VIF) untuk mendeteksi multikolinearitas antar peubah penjelas.\n\n\n\nPemeriksaan Overdispersi:\n\nMemeriksa overdispersi menggunakan nilai devians dan khi kuadrat Pearson dibagi dengan derajat bebasnya.\nJika kedua nilai tersebut lebih dari satu, maka terjadi overdispersi pada data.\n\n\n\nPemodelan Regresi:\n\nMelakukan pemodelan regresi Poisson jika tidak terdapat overdispersi.\nMelakukan pemodelan regresi binomial negatif jika terdapat overdispersi.\n\n\n\nUji Efek Spasial:\n\nMenguji kehomogenan ragam sisaan model regresi klasik dengan uji Breusch-Pagan.\nPemilihan model dependensi spasial menggunakan uji pengganda Lagrange (Lagrange Multiplier/LM).\nMemeriksa efek dependensi spasial pada prediktor dengan indeks Moran.\nMelakukan pendugaan parameter model regresi spasial binomial negatif berdasarkan hasil uji efek spasial.\n\n\n\nEvaluasi Model:\n\nMengukur kebaikan model berdasarkan nilai Akaike Information Criterion (AIC) terkecil. Persamaan AIC: (AIC = -2L_k + 2p), dengan (L_k) merupakan fungsi kemungkinan maksimum dari model dengan (k) prediktor dan (p) adalah banyaknya parameter.\n\n\n\nInterpretasi dan Kesimpulan:\n\nMelakukan interpretasi dari model yang terpilih.\nMenarik kesimpulan berdasarkan hasil analisis.",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Spasial Autoregresif Binomial Negatif</span>"
    ]
  },
  {
    "objectID": "03-SpasialAutoRegresifBinomialNegatif.html#tahapan-analisis-data-dengan-r",
    "href": "03-SpasialAutoRegresifBinomialNegatif.html#tahapan-analisis-data-dengan-r",
    "title": "\n3  Spasial Autoregresif Binomial Negatif\n",
    "section": "\n3.4 Tahapan Analisis Data dengan R",
    "text": "3.4 Tahapan Analisis Data dengan R\nTahap awal dalam pendugaan model SAR-BN menggunakan R Studio adalah install package yang dibutuhkan. Package yang diinstall sebagai berikut:\nPackage\n\nlibrary(AER)\n# Warning: package 'AER' was built under R version 4.2.3\n# Loading required package: car\n# Loading required package: carData\n# Loading required package: lmtest\n# Loading required package: zoo\n# Warning: package 'zoo' was built under R version 4.2.3\n# \n# Attaching package: 'zoo'\n# The following objects are masked from 'package:base':\n# \n#     as.Date, as.Date.numeric\n# Loading required package: sandwich\n# Warning: package 'sandwich' was built under R version 4.2.3\n# Loading required package: survival\nlibrary(car)\nlibrary(sp)\nlibrary(rgdal)\n# Please note that rgdal will be retired by the end of 2023,\n# plan transition to sf/stars/terra functions using GDAL and PROJ\n# at your earliest convenience.\n# \n# rgdal: version: 1.5-32, (SVN revision 1176)\n# Geospatial Data Abstraction Library extensions to R successfully loaded\n# Loaded GDAL runtime: GDAL 3.4.3, released 2022/04/22\n# Path to GDAL shared files: C:/Users/anugraha/AppData/Local/R/win-library/4.2/rgdal/gdal\n# GDAL binary built with GEOS: TRUE \n# Loaded PROJ runtime: Rel. 7.2.1, January 1st, 2021, [PJ_VERSION: 721]\n# Path to PROJ shared files: D:\\My_Development\\pgsql13\\share\\contrib\\postgis-3.1\\proj\n# PROJ CDN enabled: FALSE\n# Linking to sp version:1.5-0\n# To mute warnings of possible GDAL/OSR exportToProj4() degradation,\n# use options(\"rgdal_show_exportToProj4_warnings\"=\"none\") before loading sp or rgdal.\nlibrary(corrplot)\n# corrplot 0.92 loaded\nlibrary(zoo)\nlibrary(lmtest)\nlibrary(spdep)\n# Warning: package 'spdep' was built under R version 4.2.3\n# Loading required package: spData\n# To access larger datasets in this package, install the\n# spDataLarge package with: `install.packages('spDataLarge',\n# repos='https://nowosad.github.io/drat/', type='source')`\n# Loading required package: sf\n# Linking to GEOS 3.9.1, GDAL 3.4.3, PROJ 7.2.1; sf_use_s2() is TRUE\nlibrary(MASS)\n# Warning: package 'MASS' was built under R version 4.2.3\nlibrary(fitdistrplus)\n# Warning: package 'fitdistrplus' was built under R version 4.2.3\nlibrary(zoo)\nlibrary(lmtest)\nlibrary(raster)\n# \n# Attaching package: 'raster'\n# The following object is masked from 'package:MASS':\n# \n#     select\nlibrary(tidyverse)\n# ── Attaching packages\n# ─────────────────────────── tidyverse\n# 1.3.2 ──\n# ✔ ggplot2 3.4.0      ✔ purrr   1.0.2 \n# ✔ tibble  3.1.8      ✔ dplyr   1.0.10\n# ✔ tidyr   1.3.0      ✔ stringr 1.5.0 \n# ✔ readr   2.1.2      ✔ forcats 0.5.2\n# Warning: package 'ggplot2' was built under R version 4.2.2\n# Warning: package 'tidyr' was built under R version 4.2.3\n# Warning: package 'purrr' was built under R version 4.2.3\n# Warning: package 'stringr' was built under R version 4.2.3\n# Warning: package 'forcats' was built under R version 4.2.2\n# ── Conflicts ────────────────────────────── tidyverse_conflicts() ──\n# ✖ tidyr::extract() masks raster::extract()\n# ✖ dplyr::filter()  masks stats::filter()\n# ✖ dplyr::lag()     masks stats::lag()\n# ✖ dplyr::recode()  masks car::recode()\n# ✖ dplyr::select()  masks raster::select(), MASS::select()\n# ✖ purrr::some()    masks car::some()\n\nInput Data\nTahap selanjutnya melakukan input data menggunakan syntax berikut:\n\n#Input Data\ndata1 &lt;-read.csv(\"data/data_stunting.csv\", header = TRUE)\nY&lt;-data1[,2]\nX1&lt;-data1[,3]\nX2&lt;-data1[,4]\nX3&lt;-data1[,5]\nX4&lt;-data1[,6]\nX5&lt;-data1[,7]\nX6&lt;-data1[,8]\n#\n#Input peta SHP\nsf_use_s2(FALSE)\n# Spherical geometry (s2) switched off\npetajawa&lt;- readOGR(dsn = \"data/shp/jawa.shp\", layer=\"jawa\")\n# OGR data source with driver: ESRI Shapefile \n# Source: \"E:\\Materi_Orasi\\bookdown\\data\\shp\\jawa.shp\", layer: \"jawa\"\n# with 119 features\n# It has 5 fields\n#\n#subset peta Pulau Jawa menjadi Jawa Barat\npetajabar &lt;- subset(petajawa,PROVINSI==\"JAWA BARAT\")\n#\n#Mendefinisikan long dan lat\nlonglat &lt;- coordinates(petajabar) \npetajabar$long &lt;- longlat[,1] #longitudinal angkanya ratusan\npetajabar$lat &lt;- longlat[,2]\n#\n#Menggabungkan Data ke file SHP\npetajabar$Stunting = data1$Stunting\npetajabar$imunisasi = data1$imunisasi\npetajabar$ASI = data1$ASI\npetajabar$TPM = data1$TPM\npetajabar$BBLR = data1$BBLR\npetajabar$sanitasi = data1$sanitasi\npetajabar$pengeluaran = data1$pengeluaran\npetajabar$daerah = data1$Kabupaten...Kota\n\nEksplorasi Data\nUntuk membuat peta tentang sebaran banyaknya stunting per 100.000 balita digunakan syntax sebagai berikut:\n\n#menambahkan list untuk memberi label pada peta\nsp.label &lt;- function(x, label) {list(\"sp.text\", coordinates(x), label, cex=0.7, col=\"black\", fontface=\"bold\")}\nNUMB.sp.label &lt;- function(x) {sp.label(x, as.vector(petajabar$KABKOT))}\nmake.NUMB.sp.label &lt;- function(x) {do.call(\"list\", NUMB.sp.label(x))}\n#\n#Peta Y\ncolfunc&lt;-colorRampPalette(c(\"green\",\"orange\",\"red\"))\ncolor&lt;-colfunc(1000)\npetajabar$Stunting&lt;-data1$Stunting\nspplot(petajabar, \"Stunting\", col.regions=color, sp.layout = make.NUMB.sp.label(petajabar), \n cex = 0.5, bg = \"white\", border=\"light grey\", \n main=\"Sebaran Kasus Stunting per 100.000 balita Jawa Barat 2021\")\n\n\n\n\n\n\n\nDiagram kotak garis untuk banyaknya stunting per 100.000 balita dibuat dengan syntax sebagai berikut:\n\n#Box-plot Stunting\nboxplot(data1$Stunting, ylab=\"Banyaknya Stunting per 100.000 balita\")\n\n\n\n\n\n\n\nPemeriksaan sebaran yang paling sesuai untuk data stunting menggunakan grafik Cullen and Frey dan plot kuantil-kuantil dengan menggunakan syntax sebagai berikut:\n\n#Grafik Cullen-Frey \npoisson &lt;- fitdist(data1$Stunting, \"pois\", method = c(\"mle\", \n      \"mme\", \"qme\", \"mge\", \"mse\"), start=NULL, fix.arg=NULL, T,\n       keepdata = TRUE)\nbinom.negatif &lt;- fitdist(data1$Stunting, \"nbinom\", method = \n       c(\"mle\", \"mme\", \"qme\", \"mge\", \"mse\"),  start=NULL, \n       fix.arg=NULL, T, keepdata = TRUE)\ndescdist(data1$Stunting, discrete = TRUE, boot=1000)\n\n\n\n\n\n\n# summary statistics\n# ------\n# min:  29   max:  958 \n# median:  162 \n# mean:  238 \n# estimated sd:  214 \n# estimated skewness:  1.79 \n# estimated kurtosis:  6.84\n\nPemeriksaan sebaran yang sesuai untuk data stunting dapat juga dilakukan menggunakan plot kuantil-kauntil dengan menggunakan syntax berikut ini:\n\n#Pemeriksaan sebaran menggunakan plot Q-Q\nqqcomp(list(poisson, binom.negatif), legendtext = c(\"Pois\", \n     \"Neg Binom\"), fitpch=\"o\", fitcol = c(\"red\",\"green\"))\n\n\n\n\n\n\n\nPada output plot Q-Q terlihat mayoritas titik-titik berwarna hijau (lambang untuk sebaran binomial negatif) berada pada garis dibandingkan dengan titik-titik berwarna merah (lambang untuk sebaran Poisson). Sebaran yang paling sesuai untuk data stunting adalah binomial negatif.\nPemeriksaan Multikolinearitas\nPemeriksaan multikolinearitas menggunakan syntax sebagai berikut:\n\n#Multikolinieritas\nreglin&lt;-lm(Y~X1+X2+X3+X4+X5+X6, data=data1)\nas.matrix(vif(reglin))\n#    [,1]\n# X1 1.15\n# X2 1.14\n# X3 1.14\n# X4 1.11\n# X5 1.20\n# X6 1.12\n\nBerdasarkan output terlihat nilai VIF semua prediktor kecil, sehingga dapat disimpulkan tidak terdapat multikolinearitas.\nUji Overdispersi\nUntuk melakukan uji dispersi menggunakan syntax sebagai berikut:\n\n#Model Regresi Poisson\npoisson&lt;-glm(Y~X1+X2+X3+X4+X5+X6,data=data1, family = poisson())\n#\n#Nilai Deviance\ndv_df&lt;-deviance(poisson)/df.residual(poisson)\n#\n#Nilai Chi-Squares\npr_df&lt;-sum(residuals(poisson,\"pearson\")^2)/df.residual(poisson)\n#\n#Overdispersi\noverdis&lt;-cbind.data.frame(dv_df,pr_df)\noverdis\n#   dv_df pr_df\n# 1   100  97.3\n\nKedua nilai statistik uji overdispersi bernilai lebih besar dari satu, maka pada data banyaknya stunting terdapat overdispersi. Untuk menangani oversdispersi pada data digunakan model regresi binomial negatif.\nPemodelan regresi binomial negatif\n\n#Regresi Binomial Negatif\nnb&lt;-glm.nb(Y~X1+X2+X3+X4+X5+X6,data=data1)\nsummary(nb)\n# \n# Call:\n# glm.nb(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6, data = data1, \n#     init.theta = 3.160525232, link = log)\n# \n# Deviance Residuals: \n#     Min       1Q   Median       3Q      Max  \n# -2.5267  -0.7953   0.0392   0.4625   1.9175  \n# \n# Coefficients:\n#              Estimate Std. Error z value Pr(&gt;|z|)    \n# (Intercept)  7.50e+00   1.28e+00    5.87  4.3e-09 ***\n# X1           4.36e-03   5.54e-03    0.79  0.43092    \n# X2          -2.23e-02   9.64e-03   -2.31  0.02082 *  \n# X3          -1.99e-02   6.82e-03   -2.91  0.00358 ** \n# X4          -1.12e-01   3.27e-02   -3.42  0.00062 ***\n# X5           1.82e-02   9.39e-03    1.94  0.05222 .  \n# X6          -1.20e-04   5.17e-05   -2.32  0.02058 *  \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# \n# (Dispersion parameter for Negative Binomial(3.16) family taken to be 1)\n# \n#     Null deviance: 61.213  on 26  degrees of freedom\n# Residual deviance: 28.266  on 20  degrees of freedom\n# AIC: 340.6\n# \n# Number of Fisher Scoring iterations: 1\n# \n# \n#               Theta:  3.161 \n#           Std. Err.:  0.835 \n# \n#  2 x log-likelihood:  -324.641\n\nPada output regresi binomial negatif terlihat prediktor X2, X3, X4, dan X5 nyata pada α=0.05 dengan AIC model sebesar 340.64.\nUji efek spasial\n\nUji LM dan indeks Moran Untuk menentukan Indeks Moran dan uji LM, terlebih dulu dibangun matriks bobot, Pada ilustrasi ini digunakan matriks ketetanggan langkah ratu, k-nearest neighbor, inverse distance weight, dan negative exponential. Syntax yang digunakan untuk membuat matriks bobot dan menghitung Indeks Moran sebagai berikut:\n\n\n#Menghitung jarak Euclidean\ndjarak&lt;-dist(longlat) \nm.djarak&lt;-as.matrix(djarak)\n#\n#Matriks Pembobot langkah ratu\nqueen.nb=poly2nb(petajabar, queen = TRUE)\n# although coordinates are longitude/latitude, st_intersects assumes that they are planar\nqueen.listw=nb2listw(queen.nb) \nqueen.jabar= queen.listw\n#\n#Matriks Pembobot KNN dengan K = 1\nW.knn1 &lt;- knn2nb(knearneigh(longlat, k=1, longlat=TRUE)) #matriks bobot dengan \nW.knn1.s &lt;- nb2listw(W.knn1, style='W')\nknn1.jabar &lt;- W.knn1.s\n#\n#Matriks Pembobot KNN dengan K = 2\nW.knn2 &lt;- knn2nb(knearneigh(longlat, k=2, longlat=TRUE)) #matriks bobot dengan \nW.knn2.s &lt;- nb2listw(W.knn2, style='W')\nknn2.jabar &lt;- W.knn2.s\n#\n#Matriks Pembobot KNN dengan K = 3\nW.knn3 &lt;- knn2nb(knearneigh(longlat, k=3, longlat=TRUE)) #matriks bobot dengan \nW.knn3.s &lt;- nb2listw(W.knn3, style='W')\nknn3.jabar &lt;- W.knn3.s\n#\n#Matriks Pembobot KNN dengan K = 4\nW.knn4 &lt;- knn2nb(knearneigh(longlat, k=4, longlat=TRUE)) #matriks bobot dengan \nW.knn4.s &lt;- nb2listw(W.knn4, style='W')\nknn4.jabar &lt;- W.knn4.s\n#\n#Matriks Pembobot KNN dengan K = 5\nW.knn5 &lt;- knn2nb(knearneigh(longlat, k=5, longlat=TRUE)) #matriks bobot dengan \nW.knn5.s &lt;- nb2listw(W.knn5, style='W')\nknn5.jabar &lt;- W.knn5.s\n#\n#Matriks Pembobot IDW alpha = 1\nalpha1=1\nW.idw1 &lt;- 1/(m.djarak^alpha1) \n#dinormalisasi \ndiag(W.idw1) &lt;- 0\nrtot1 &lt;- rowSums(W.idw1,na.rm=TRUE)\nW.idw.sd1 &lt;- W.idw1/rtot1 #row-normalized \nW.idw.s1 = mat2listw(W.idw.sd1, style='W') \nidw1.jabar &lt;- W.idw.s1\n#\n#Matriks Pembobot IDW alpha = 2\nalpha2=2\nW.idw2 &lt;- 1/(m.djarak^alpha2) \n#dinormalisasi \ndiag(W.idw2) &lt;- 0\nrtot2 &lt;- rowSums(W.idw2,na.rm=TRUE)\nW.idw.sd2 &lt;- W.idw2/rtot2 #row-normalized \nrowSums(W.idw.sd2,na.rm=TRUE)\n#  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \n#  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1 \n# 28 29 30 31 32 \n#  1  1  1  1  1\nW.idw.s2 = mat2listw(W.idw.sd2, style='W') \nidw2.jabar &lt;- W.idw.s2\n#\n#Matriks Pembobot eksponensial alpha = 1\nalpha3=1\nW.eksp1 &lt;- exp((-alpha3)*m.djarak) \n#dinormalisasi \ndiag(W.eksp1) &lt;- 0\nrtot3 &lt;- rowSums(W.eksp1, na.rm=TRUE) \nW.eksp.sd1 &lt;- W.eksp1/rtot3 #row-normalized \nW.eksp.s1 = mat2listw(W.eksp.sd1, style='W') \neks1.jabar &lt;- W.eksp.s1\n#\n#Matriks Pembobot Eksponensial alpha = 2\nalpha4=2\nW.eksp2 &lt;- exp((-alpha4)*m.djarak) \n#dinormalisasi \ndiag(W.eksp2) &lt;- 0\nrtot4 &lt;- rowSums(W.eksp2, na.rm=TRUE) \nW.eksp.sd2 &lt;- W.eksp2/rtot4 #row-normalized \nW.eksp.s2 = mat2listw(W.eksp.sd2, style='W')\neks2.jabar &lt;- W.eksp.s2\n\nSetelah dibuat matriks pembobot, dilakukan pengujian indeks Moran dengan menggunakan semua matriks pembobot pada semua prediktor.\n\n#Indeks Moran dan Nilai-p peubah X1\nx1.q &lt;- moran.test(petajabar$imunisasi,queen.jabar,randomisation=T)\nx1.k1 &lt;- moran.test(petajabar$imunisasi,knn1.jabar,randomisation=T)\nx1.k2 &lt;- moran.test(petajabar$imunisasi,knn2.jabar,randomisation=T)\nx1.k3 &lt;-moran.test(petajabar$imunisasi,knn3.jabar,randomisation=T)\nx1.k4 &lt;-moran.test(petajabar$imunisasi,knn4.jabar,randomisation=T)\nx1.k5 &lt;-moran.test(petajabar$imunisasi,knn5.jabar,randomisation=T)\nx1.eks1 &lt;- moran.test(petajabar$imunisasi,eks1.jabar,randomisation=T)\nx1.eks2 &lt;- moran.test(petajabar$imunisasi,eks2.jabar,randomisation=T)\nx1.idw1 &lt;- moran.test(petajabar$imunisasi,idw1.jabar,randomisation=T)\nx1.idw2 &lt;- moran.test(petajabar$imunisasi,idw2.jabar,randomisation=T)\n\ntab &lt;- matrix(c(x1.q$statistic, x1.k1$statistic, \n      x1.k2$statistic, x1.k3$statistic, x1.k4$statistic, \n      x1.k5$statistic, x1.eks1$statistic, x1.eks2$statistic, \n      x1.idw1$statistic, x1.idw2$statistic, x1.q$p.value, \n      x1.k1$p.value, x1.k2$p.value, x1.k3$p.value, \n      x1.k4$p.value, x1.k5$p.value, x1.eks1$p.value, \n      x1.eks2$p.value, x1.idw1$p.value, x1.idw2$p.value), \n      ncol=2, byrow=F)\ncolnames(tab) &lt;- c('Indeks Moran','P-Value')\nrownames(tab) &lt;- c('Queen','1-NN','2-NN', '3-NN', '4-NN',\n      \"5-NN\", \"Eks a=1\", \"Eks a=2\", \"IDW a=1\", \"IDW a=2\")\ntab &lt;- as.table(tab)\ntab\n#         Indeks Moran P-Value\n# Queen         1.1359  0.1280\n# 1-NN         -0.2844  0.6119\n# 2-NN          1.0040  0.1577\n# 3-NN          1.3998  0.0808\n# 4-NN          1.3841  0.0832\n# 5-NN          1.3568  0.0874\n# Eks a=1       1.0245  0.1528\n# Eks a=2       0.8734  0.1912\n# IDW a=1      -1.2322  0.8911\n# IDW a=2      -0.6401  0.7389\n\nPada output Indeks Moran untuk prediktor X1 dengan matriks bobot 3-Nearest Neighbor memiliki yang paling besar dan nilai-p paling kecil, akan tetapi tidak nyata pada α=0.05.\n\n#Indeks Moran dan Nilai-p peubah X2\nx2.q &lt;- moran.test(petajabar$ASI,queen.jabar,randomisation=T)\nx2.k1 &lt;- moran.test(petajabar$ASI,knn1.jabar,randomisation=T)\nx2.k2 &lt;- moran.test(petajabar$ASI,knn2.jabar,randomisation=T)\nx2.k3 &lt;-moran.test(petajabar$ASI,knn3.jabar,randomisation=T)\nx2.k4 &lt;-moran.test(petajabar$ASI,knn4.jabar,randomisation=T)\nx2.k5 &lt;-moran.test(petajabar$ASI,knn5.jabar,randomisation=T)\nx2.eks1 &lt;- moran.test(petajabar$ASI,eks1.jabar,randomisation=T)\nx2.eks2 &lt;- moran.test(petajabar$ASI,eks2.jabar,randomisation=T)\nx2.idw1 &lt;- moran.test(petajabar$ASI,idw1.jabar,randomisation=T)\nx2.idw2 &lt;- moran.test(petajabar$ASI,idw2.jabar,randomisation=T)\ntab &lt;- matrix(c(x2.q$statistic, x2.k1$statistic, x2.k2$statistic, \n       x2.k3$statistic, x2.k4$statistic, x2.k5$statistic, \n       x2.eks1$statistic, x2.eks2$statistic, x2.idw1$statistic, \n       x2.idw2$statistic, x2.q$p.value, x2.k1$p.value, \n       x2.k2$p.value, x2.k3$p.value, x2.k4$p.value,             \n       x2.k5$p.value, x2.eks1$p.value, x2.eks2$p.value, \n       x2.idw1$p.value, x2.idw2$p.value), ncol=2, byrow=F)\ncolnames(tab) &lt;- c('Indeks Moran','P-Value')\nrownames(tab) &lt;- c('Queen','1-NN','2-NN', '3-NN', '4-NN', \"5-NN\", \n       \"Eks a=1\", \"Eks a=2\", \"IDW a=1\", \"IDW a=2\")\ntab &lt;- as.table(tab)\ntab\n#         Indeks Moran P-Value\n# Queen        0.96677 0.16683\n# 1-NN         1.64900 0.04957\n# 2-NN         1.01098 0.15601\n# 3-NN         1.57087 0.05811\n# 4-NN         1.28312 0.09973\n# 5-NN         1.33135 0.09154\n# Eks a=1      2.71191 0.00334\n# Eks a=2      2.36743 0.00896\n# IDW a=1      1.94376 0.02596\n# IDW a=2      2.39691 0.00827\n\nPada output di atas terlihat bahwa pada pengujian indeks Moran peubah X2, matriks bobot Eksponential alpha=1 memiliki nilai-p paling kecil dan nyata pada α=0.05.\n\n#Indeks Moran dan Nilai-p peubah X3\nx3.q &lt;- moran.test(petajabar$TPM,queen.jabar,randomisation=T)\nx3.k1 &lt;- moran.test(petajabar$TPM,knn1.jabar,randomisation=T)\nx3.k2 &lt;- moran.test(petajabar$TPM,knn2.jabar,randomisation=T)\nx3.k3 &lt;-moran.test(petajabar$TPM,knn3.jabar,randomisation=T)\nx3.k4 &lt;-moran.test(petajabar$TPM,knn4.jabar,randomisation=T)\nx3.k5 &lt;-moran.test(petajabar$TPM,knn5.jabar,randomisation=T)\nx3.eks1 &lt;- moran.test(petajabar$TPM,eks1.jabar,randomisation=T)\nx3.eks2 &lt;- moran.test(petajabar$TPM,eks2.jabar,randomisation=T)\nx3.idw1 &lt;- moran.test(petajabar$TPM,idw1.jabar,randomisation=T)\nx3.idw2 &lt;- moran.test(petajabar$TPM,idw2.jabar,randomisation=T)\ntab &lt;- matrix(c(x3.q$statistic, x3.k1$statistic, x3.k2$statistic, \n       x3.k3$statistic, x3.k4$statistic, x3.k5$statistic, \n       x3.eks1$statistic, x3.eks2$statistic, x3.idw1$statistic, \n       x3.idw2$statistic, x3.q$p.value, x3.k1$p.value, \n       x3.k2$p.value, x3.k3$p.value, x3.k4$p.value,       \n       x3.k5$p.value, x3.eks1$p.value, x3.eks2$p.value, \n       x3.idw1$p.value, x3.idw2$p.value), ncol=2, byrow=F)\ncolnames(tab) &lt;- c('Indeks Moran','P-Value')\nrownames(tab) &lt;- c('Queen','1-NN','2-NN', '3-NN', '4-NN', \"5-NN\", \n        \"Eks a=1\", \"Eks a=2\", \"IDW a=1\", \"IDW a=2\")\ntab &lt;- as.table(tab)\ntab\n#         Indeks Moran P-Value\n# Queen        1.10899 0.13372\n# 1-NN         1.40712 0.07970\n# 2-NN         2.17584 0.01478\n# 3-NN         2.61314 0.00449\n# 4-NN         1.81923 0.03444\n# 5-NN         1.17499 0.12000\n# Eks a=1      0.57812 0.28159\n# Eks a=2      0.99473 0.15993\n# IDW a=1      1.72700 0.04208\n# IDW a=2      1.70949 0.04368\n\nPada output di atas terlihat bahwa pada pengujian indeks Moran peubah X3, matriks bobot 3-nearest neighbor memiliki nilai-p paling kecil dan nyata pada α=0.05.\n\n#Indeks Moran dan Nilai-p peubah X4\nx4.q &lt;- moran.test(petajabar$BBLR,queen.jabar,randomisation=T)\nx4.k1 &lt;- moran.test(petajabar$BBLR,knn1.jabar,randomisation=T)\nx4.k2 &lt;- moran.test(petajabar$BBLR,knn2.jabar,randomisation=T)\nx4.k3 &lt;-moran.test(petajabar$BBLR,knn3.jabar,randomisation=T)\nx4.k4 &lt;-moran.test(petajabar$BBLR,knn4.jabar,randomisation=T)\nx4.k5 &lt;-moran.test(petajabar$BBLR,knn5.jabar,randomisation=T)\nx4.eks1 &lt;- moran.test(petajabar$BBLR,eks1.jabar,randomisation=T)\nx4.eks2 &lt;- moran.test(petajabar$BBLR,eks2.jabar,randomisation=T)\nx4.idw1 &lt;- moran.test(petajabar$BBLR,idw1.jabar,randomisation=T)\nx4.idw2 &lt;- moran.test(petajabar$BBLR,idw2.jabar,randomisation=T)\ntab &lt;- matrix(c(x4.q$statistic, x4.k1$statistic, \n       x4.k2$statistic, x4.k3$statistic, x4.k4$statistic, \n       x4.k5$statistic, x4.eks1$statistic, x4.eks2$statistic, \n       x4.idw1$statistic, x4.idw2$statistic, x4.q$p.value, \n       x4.k1$p.value, x4.k2$p.value, x4.k3$p.value, \n       x4.k4$p.value, x4.k5$p.value, x4.eks1$p.value, \n       x4.eks2$p.value, x4.idw1$p.value, x4.idw2$p.value), \n       ncol=2, byrow=F)\ncolnames(tab) &lt;- c('Indeks Moran','P-Value')\nrownames(tab) &lt;- c('Queen','1-NN','2-NN', '3-NN', '4-NN', \"5-NN\", \n       \"Eks a=1\", \"Eks a=2\", \"IDW a=1\", \"IDW a=2\")\ntab &lt;- as.table(tab)\ntab\n#         Indeks Moran  P-Value\n# Queen       2.28e+00 1.14e-02\n# 1-NN        2.25e+00 1.23e-02\n# 2-NN        3.01e+00 1.32e-03\n# 3-NN        3.01e+00 1.31e-03\n# 4-NN        3.42e+00 3.15e-04\n# 5-NN        4.11e+00 1.95e-05\n# Eks a=1     6.50e+00 3.92e-11\n# Eks a=2     5.99e+00 1.07e-09\n# IDW a=1     2.71e+00 3.40e-03\n# IDW a=2     2.96e+00 1.56e-03\n\nPada output di atas terlihat bahwa pada pengujian indeks Moran peubah X4, matriks bobot exponential alpha =1 memiliki nilai-p paling kecil dan nyata pada α=0.05.\n\n#Indeks Moran dan Nilai-p peubah X5\nx5.q &lt;- moran.test(petajabar$sanitasi,queen.jabar,randomisation=T)\nx5.k1 &lt;- moran.test(petajabar$sanitasi,knn1.jabar,randomisation=T)\nx5.k2 &lt;- moran.test(petajabar$sanitasi,knn2.jabar,randomisation=T)\nx5.k3 &lt;-moran.test(petajabar$sanitasi,knn3.jabar,randomisation=T)\nx5.k4 &lt;-moran.test(petajabar$sanitasi,knn4.jabar,randomisation=T)\nx5.k5 &lt;-moran.test(petajabar$sanitasi,knn5.jabar,randomisation=T)\nx5.eks1 &lt;- moran.test(petajabar$sanitasi,eks1.jabar,randomisation=T)\nx5.eks2 &lt;- moran.test(petajabar$sanitasi,eks2.jabar,randomisation=T)\nx5.idw1 &lt;- moran.test(petajabar$sanitasi,idw1.jabar,randomisation=T)\nx5.idw2 &lt;- moran.test(petajabar$sanitasi,idw2.jabar,randomisation=T)\ntab &lt;- matrix(c(x5.q$statistic, x5.k1$statistic, \n       x5.k2$statistic, x5.k3$statistic, x5.k4$statistic, \n       x5.k5$statistic, x5.eks1$statistic, x5.eks2$statistic,    \n       x5.idw1$statistic, x5.idw2$statistic, x5.q$p.value, \n       x5.k1$p.value, x5.k2$p.value, x5.k3$p.value, \n       x5.k4$p.value, x5.k5$p.value, x5.eks1$p.value, \n       x5.eks2$p.value, x5.idw1$p.value, x5.idw2$p.value), \n       ncol=2, byrow=F)\ncolnames(tab) &lt;- c('Indeks Moran','P-Value')\nrownames(tab) &lt;- c('Queen','1-NN','2-NN', '3-NN', '4-NN',\n       \"5-NN\", \"Eks a=1\", \"Eks a=2\", \"IDW a=1\", \"IDW a=2\")\ntab &lt;- as.table(tab)\ntab\n#         Indeks Moran P-Value\n# Queen          0.316   0.376\n# 1-NN           1.021   0.154\n# 2-NN           0.450   0.326\n# 3-NN          -0.781   0.783\n# 4-NN          -1.425   0.923\n# 5-NN          -2.018   0.978\n# Eks a=1       -0.931   0.824\n# Eks a=2       -0.857   0.804\n# IDW a=1        0.218   0.414\n# IDW a=2        0.464   0.321\n\nPada output di atas terlihat bahwa pada pengujian indeks Moran peubah X5, matriks bobot 1-nearest neighbor memiliki nilai-p paling kecil, akan tetapi tidak nyata pada α=0.05.\n\n#Indeks Moran dan Nilai-p peubah X6\nx6.q &lt;- moran.test(petajabar$pengeluaran,queen.jabar,randomisation=T)\nx6.k1 &lt;- moran.test(petajabar$pengeluaran,knn1.jabar,randomisation=T)\nx6.k2 &lt;- moran.test(petajabar$pengeluaran,knn2.jabar,randomisation=T)\nx6.k3 &lt;-moran.test(petajabar$pengeluaran,knn3.jabar,randomisation=T)\nx6.k4 &lt;-moran.test(petajabar$pengeluaran,knn4.jabar,randomisation=T)\nx6.k5 &lt;-moran.test(petajabar$pengeluaran,knn5.jabar,randomisation=T)\nx6.eks1 &lt;- moran.test(petajabar$pengeluaran,eks1.jabar,randomisation=T)\nx6.eks2 &lt;- moran.test(petajabar$pengeluaran,eks2.jabar,randomisation=T)\nx6.idw1 &lt;- moran.test(petajabar$pengeluaran,idw1.jabar,randomisation=T)\nx6.idw2 &lt;- moran.test(petajabar$pengeluaran,idw2.jabar,randomisation=T)\ntab &lt;- matrix(c(x6.q$statistic, x6.k1$statistic, \n       x6.k2$statistic, x6.k3$statistic, x6.k4$statistic, \n       x6.k5$statistic, x6.eks1$statistic, x6.eks2$statistic, \n       x6.idw1$statistic, x6.idw2$statistic, x6.q$p.value,              \n       x6.k1$p.value, x6.k2$p.value, x6.k3$p.value, \n       x6.k4$p.value, x6.k5$p.value, x6.eks1$p.value, \n       x6.eks2$p.value, x6.idw1$p.value, x6.idw2$p.value), \n       ncol=2, byrow=F)\ncolnames(tab) &lt;- c('Indeks Moran','P-Value')\nrownames(tab) &lt;- c('Queen','1-NN','2-NN', '3-NN', '4-NN',\n       \"5-NN\", \"Eks a=1\", \"Eks a=2\", \"IDW a=1\", \"IDW a=2\")\ntab &lt;- as.table(tab)\ntab\n#         Indeks Moran P-Value\n# Queen        2.50644 0.00610\n# 1-NN         0.78374 0.21660\n# 2-NN         1.97614 0.02407\n# 3-NN         2.07182 0.01914\n# 4-NN         1.92178 0.02732\n# 5-NN         2.06378 0.01952\n# Eks a=1      2.80507 0.00252\n# Eks a=2      2.65023 0.00402\n# IDW a=1      1.28465 0.09946\n# IDW a=2      1.64738 0.04974\n\nPada output di atas terlihat bahwa pada pengujian indeks Moran peubah X6, matriks bobot exponential alpha = 1 memiliki nilai-p paling kecil dan nyata pada α=0.05.  \n \nPengujian LM dengan matriks pembobot Queen menggunakan syntax sebagai berikut:\n\n#Uji LM\nreglin&lt;-lm(log(Y)~X1+X2+X3+X4+X5+X6)\n#\n#LM dengan queen\nLM_Queen&lt;-lm.RStests(reglin, queen.jabar,\n          test=c(\"LMerr\", \"LMlag\",\"RLMerr\",\"RLMlag\"))\nsummary(LM_Queen)\n#   Rao's score (a.k.a Lagrange multiplier) diagnostics for\n#   spatial dependence\n# data:  \n# model: lm(formula = log(Y) ~ X1 + X2 + X3 + X4 + X5 + X6)\n# test weights: queen.jabar\n#  \n#          statistic parameter p.value  \n# RSerr       0.0935         1   0.760  \n# RSlag       1.3208         1   0.250  \n# adjRSerr    2.7547         1   0.097 .\n# adjRSlag    3.9821         1   0.046 *\n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nOutput uji menunjukan RLMlag nyata pada α=0.05, sehingga model yang cocok digunakan adalah SAR.  \n \nb. Uji Breusch-Pagan Uji Breusch-Pagan dihitung menggunakan syntax berikut:\n\n#Uji Breusch-Pagan\nbptest(reglin)\n# \n#   studentized Breusch-Pagan test\n# \n# data:  reglin\n# BP = 5, df = 6, p-value = 0.6\n\nNilai statistik uji Breusch-Pagan mempunyai nilai-p &gt; α=0.05, sehingga dapat disimpulkan tidak terdapat heterogenitas spasial.\nPendugaan Model Spasial Binomial Negatif\nPendugaan model SAR-BN dengan matriks pembobot Queen menggunakan syntax sebagai berikut:\n\n#SAR-BN\npetajabar$lagY&lt;-lag.listw(x=queen.jabar, var=petajabar$Stunting)\nSAR&lt;-glm.nb(petajabar$Stunting~lagY+imunisasi+ASI+TPM+BBLR\n     +sanitasi+pengeluaran,data=petajabar)\nsummary(SAR)\n# \n# Call:\n# glm.nb(formula = petajabar$Stunting ~ lagY + imunisasi + ASI + \n#     TPM + BBLR + sanitasi + pengeluaran, data = petajabar, init.theta = 3.563230447, \n#     link = log)\n# \n# Deviance Residuals: \n#     Min       1Q   Median       3Q      Max  \n# -2.9239  -0.7178   0.0416   0.5252   1.6024  \n# \n# Coefficients:\n#              Estimate Std. Error z value Pr(&gt;|z|)    \n# (Intercept)  8.53e+00   1.32e+00    6.47  9.6e-11 ***\n# lagY        -1.81e-03   8.81e-04   -2.05   0.0402 *  \n# imunisasi   -3.18e-03   6.18e-03   -0.52   0.6065    \n# ASI         -2.65e-02   9.34e-03   -2.84   0.0045 ** \n# TPM         -1.49e-02   7.04e-03   -2.12   0.0338 *  \n# BBLR        -1.38e-01   3.36e-02   -4.12  3.8e-05 ***\n# sanitasi     1.61e-02   9.08e-03    1.77   0.0769 .  \n# pengeluaran -6.54e-05   5.59e-05   -1.17   0.2419    \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# \n# (Dispersion parameter for Negative Binomial(3.56) family taken to be 1)\n# \n#     Null deviance: 68.838  on 26  degrees of freedom\n# Residual deviance: 28.064  on 19  degrees of freedom\n# AIC: 339.1\n# \n# Number of Fisher Scoring iterations: 1\n# \n# \n#               Theta:  3.563 \n#           Std. Err.:  0.948 \n# \n#  2 x log-likelihood:  -321.134\n\nPada output model SAR-BN terlihat prediktor signifikan pada kasus stunting adalah ASI, TPM, dan BBLR. Nilai AIC model sebesar 339.13.  \n \nPendugaan model SLX-BN dengan matriks pembobot untuk lag-prediktor sesuai hasil pada langkah (5) menggunakan syntax sebagai berikut:\n\n#SLX-BN\npeubah.x2 &lt;- as.matrix(data1[,4])\npeubah.x3 &lt;- as.matrix(data1[,5])\npeubah.x4 &lt;- as.matrix(data1[,6])\npeubah.x6 &lt;- as.matrix(data1[,8])\nW.knn3.mat &lt;- nb2mat(W.knn3)\npetajabar$lag.x2 &lt;- W.eksp.sd1%*%peubah.x2\npetajabar$lag.x3 &lt;- W.knn3.mat%*%peubah.x3\npetajabar$lag.x4 &lt;- W.eksp.sd1%*%peubah.x4\npetajabar$lag.x6 &lt;- W.eksp.sd1%*%peubah.x6\n\nslx_reg&lt;-glm.nb(Stunting ~imunisasi+ASI+TPM+BBLR+sanitasi \n         +pengeluaran+lag.x2+lag.x3+lag.x4+lag.x6, \n         data=petajabar)\nsummary(slx_reg)\n# \n# Call:\n# glm.nb(formula = Stunting ~ imunisasi + ASI + TPM + BBLR + sanitasi + \n#     pengeluaran + lag.x2 + lag.x3 + lag.x4 + lag.x6, data = petajabar, \n#     init.theta = 3.639873748, link = log)\n# \n# Deviance Residuals: \n#    Min      1Q  Median      3Q     Max  \n# -2.685  -1.051   0.175   0.529   1.429  \n# \n# Coefficients:\n#              Estimate Std. Error z value Pr(&gt;|z|)    \n# (Intercept) -2.45e+01   3.36e+01   -0.73  0.46582    \n# imunisasi    4.22e-03   6.56e-03    0.64  0.52041    \n# ASI          3.19e-03   1.88e-02    0.17  0.86533    \n# TPM         -2.62e-02   7.45e-03   -3.52  0.00043 ***\n# BBLR        -1.35e-01   5.22e-02   -2.59  0.00963 ** \n# sanitasi     1.94e-02   8.94e-03    2.17  0.02982 *  \n# pengeluaran -8.34e-05   1.03e-04   -0.81  0.42002    \n# lag.x2       3.06e-01   2.39e-01    1.28  0.20111    \n# lag.x3       1.73e-02   1.07e-02    1.61  0.10707    \n# lag.x4      -6.47e-01   6.85e-01   -0.94  0.34516    \n# lag.x6       9.68e-04   1.67e-03    0.58  0.56107    \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# \n# (Dispersion parameter for Negative Binomial(3.64) family taken to be 1)\n# \n#     Null deviance: 70.285  on 26  degrees of freedom\n# Residual deviance: 28.022  on 16  degrees of freedom\n# AIC: 344.5\n# \n# Number of Fisher Scoring iterations: 1\n# \n# \n#               Theta:  3.640 \n#           Std. Err.:  0.970 \n# \n#  2 x log-likelihood:  -320.509\n\nPada output model SLX-BN terlihat prediktor signifikan pada kasus stunting adalah ASI, BBLR, dan sanitasi. Nilai AIC model sebesar 344.51. \n \nPendugaan model SDM-BN dengan matriks pembobot untuk lag-prediktor sesuai hasil pada langkah (5) dan matriks pembobot Queen untuk Y menggunakan syntax sebagai berikut:\n\n#SDM-BN\nsdm_reg&lt;-glm.nb(Stunting ~ imunisasi+ASI+TPM+BBLR+sanitasi\n        +pengeluaran+lagY+lag.x2+lag.x3+lag.x4+lag.x6,\n      data=petajabar)\nsummary(sdm_reg)\n# \n# Call:\n# glm.nb(formula = Stunting ~ imunisasi + ASI + TPM + BBLR + sanitasi + \n#     pengeluaran + lagY + lag.x2 + lag.x3 + lag.x4 + lag.x6, data = petajabar, \n#     init.theta = 3.889296943, link = log)\n# \n# Deviance Residuals: \n#    Min      1Q  Median      3Q     Max  \n# -2.945  -0.778   0.147   0.482   1.380  \n# \n# Coefficients:\n#              Estimate Std. Error z value Pr(&gt;|z|)   \n# (Intercept)  6.069873  36.821197    0.16   0.8691   \n# imunisasi    0.000848   0.006862    0.12   0.9017   \n# ASI         -0.015518   0.021697   -0.72   0.4745   \n# TPM         -0.018185   0.008524   -2.13   0.0329 * \n# BBLR        -0.147939   0.050770   -2.91   0.0036 **\n# sanitasi     0.016905   0.008879    1.90   0.0569 . \n# pengeluaran -0.000104   0.000100   -1.03   0.3008   \n# lagY        -0.001595   0.001053   -1.52   0.1297   \n# lag.x2       0.069089   0.275072    0.25   0.8017   \n# lag.x3       0.011474   0.011244    1.02   0.3075   \n# lag.x4      -0.567764   0.674977   -0.84   0.4003   \n# lag.x6      -0.000144   0.001702   -0.08   0.9324   \n# ---\n# Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# \n# (Dispersion parameter for Negative Binomial(3.89) family taken to be 1)\n# \n#     Null deviance: 74.985  on 26  degrees of freedom\n# Residual deviance: 27.941  on 15  degrees of freedom\n# AIC: 344.6\n# \n# Number of Fisher Scoring iterations: 1\n# \n# \n#               Theta:  3.89 \n#           Std. Err.:  1.04 \n# \n#  2 x log-likelihood:  -318.62\n\nPada output model SDM-BN terlihat prediktor signifikan pada kasus stunting adalah TPM dan BBLR. Nilai AIC model sebesar 344.62.\nKebaikan Model\nUntuk memilih model terbaik digunakan nilai AIC dengan syntax sebagai berikut:\n\n#AIC SAR, SLX, SDM\nAIC.BN &lt;- AIC(nb)\nAIC.SAR &lt;- AIC(SAR)\nAIC.SLX &lt;- AIC(slx_reg)\nAIC.SDM &lt;- AIC(sdm_reg)\n\nnilai.aic &lt;- matrix(c(AIC.BN, AIC.SAR, AIC.SLX, AIC.SDM), ncol=1, \n            byrow=F)\ncolnames(nilai.aic) &lt;- c('AIC')\nrownames(nilai.aic) &lt;- c('Regresi Binomial Negatif',\n       'SAR-BN','SLX-BN', 'SDM-BN')\nnilai.aic &lt;- as.table(nilai.aic)\nnilai.aic\n#                          AIC\n# Regresi Binomial Negatif 341\n# SAR-BN                   339\n# SLX-BN                   345\n# SDM-BN                   345\n\nPada output terlihat nilai AIC terkecil dimiliki model SAR-BN, sehingga disimpulkan model SAR-BN merupakan model terbaik.\nInterpretasi Model\nInterpretasi pada koefisien regresi spasial dilakukan dengan melihat nilai efek langsung (direct effect), efek tidak langsung (indirect effect), dan efek total (total effect) menggunakan syntax sebagai berikut:\n\n#Membuat matriks identitas\nI &lt;- matrix(0, 27, 27)\ndiag(I) &lt;- 1\nIt &lt;- matrix(1, 27, 1)\nIt_transpose &lt;- t(It)\n#\n#Matriks Pembobot\nqueen &lt;- nb2mat(queen.nb)\nW &lt;- as.matrix(queen)\nrho &lt;- SAR$coefficients[2]\nrhow &lt;- rho*W\nop &lt;- I - rhow\ninvers &lt;- solve(op)\n#\n#X2\nbeta2 &lt;- SAR$coefficients[4]\nb2 &lt;- beta2*invers #matriks untuk direct effect\nde_x2 &lt;- mean(diag(b2))\nte_x2 &lt;- (1/27)*It_transpose%*%b2%*%It\nie_x2 &lt;- te_x2 - de_x2\n#\n#X3\nbeta3 &lt;- SAR$coefficients[5]\nb3 &lt;- beta3*invers #matriks untuk direct effect\nde_x3 &lt;- mean(diag(b3))\nte_x3 &lt;- (1/27)*It_transpose%*%b3%*%It\nie_x3 &lt;- te_x3 - de_x3\n#\n#X4\nbeta4 &lt;- SAR$coefficients[6]\nb4 &lt;- beta4*invers #matriks untuk direct effect\nde_x4 &lt;- mean(diag(b4))\nte_x4 &lt;- (1/27)*It_transpose%*%b4%*%It\nie_x4 &lt;- te_x4 - de_x4\n#\n#Penyajian DE, IE, TE\nmarginal &lt;- matrix(c(de_x2, de_x3, de_x4, ie_x2, ie_x3, ie_x4,   \n         te_x2, te_x3, te_x4), ncol=3, byrow=F)\ncolnames(marginal) &lt;- c('Efek Langsung', 'Efek Tidak Langsung', \n        'Efek Total')\nrownames(marginal) &lt;- c('X2','X3','X4')\nmarginal &lt;- as.table(marginal)\nmarginal\n#    Efek Langsung Efek Tidak Langsung Efek Total\n# X2     -2.65e-02            4.79e-05  -2.65e-02\n# X3     -1.49e-02            2.70e-05  -1.49e-02\n# X4     -1.38e-01            2.49e-04  -1.38e-01\n\nEfek langsung dan efek tidak langsung dari setiap prediktor di Kabupaten/Kota dapat sajikan dalam peta. Nilai DE dan IE untuk X2 tiap Kabupaten/Kota dihitung lebih dulu dengan syntax sebagai berikut:\n\n#Efek DE dan IE pada kabupaten/Kota untuk X2\ndirect_b2 &lt;- as.matrix(diag(b2))\ndirect_b2_kab &lt;- cbind(petajabar$KABKOT, direct_b2)\nb2.2 &lt;- b2\ndiag(b2.2) &lt;- 0 #matriks untuk indirect effect\nindirect_b2 &lt;- as.matrix(rowSums(b2.2))\nindirect_b2_kab &lt;- cbind(petajabar$KABKOT, indirect_b2)\n\ndat.map &lt;- st_read(\"data/shp/jawa.shp\")\n# Reading layer `jawa' from data source \n#   `E:\\Materi_Orasi\\bookdown\\data\\shp\\jawa.shp' using driver `ESRI Shapefile'\n# Simple feature collection with 119 features and 5 fields\n# Geometry type: MULTIPOLYGON\n# Dimension:     XY\n# Bounding box:  xmin: 105 ymin: -8.78 xmax: 116 ymax: -5.05\n# Geodetic CRS:  WGS 84\ndat.map &lt;- dat.map %&gt;% filter(PROVNO == \"32\")\ndat.map$long &lt;- longlat[,1] \ndat.map$lat &lt;- longlat[,2]\n\nSelanjutnya membuat peta untuk nilai DE X2 tiap Kabupaten/Kota menggunakan syntax berikut:\n\n#Peta DE untuk X2\ndat.map$de_x2&lt;-as.numeric(direct_b2)\nmycol &lt;- c(\"green\", \"yellow\", \"red\")\npeta.de &lt;- ggplot() +\n  geom_sf(data = dat.map, mapping = aes(geometry = geometry,\n  fill = de_x2)) + scale_fill_gradientn(colours = mycol,\n  name = NULL) + geom_text(data = dat.map, aes(long, lat,\n  label = KABKOT, fontface = \"bold\"), color = \"black\", size = 2.5)+ \n  labs(title = \"Efek Langsung Peubah X2\") +\n  theme(panel.background = element_rect(fill = \"white\"))\npeta.de\n\n\n\n\n\n\n\nUntuk membuat peta IE X2 menggunakan syntax berikut ini:\n\n#Peta IE\ndat.map$ie_x2&lt;-as.numeric(indirect_b2)\npeta.ie &lt;- ggplot() +\n  geom_sf(data = dat.map, mapping = aes(geometry = geometry,                                     \n  fill = ie_x2)) + scale_fill_gradientn(colours = mycol,                                                                      \n  name = NULL) + geom_text(data = dat.map, aes(long, lat,                                                                                                                          \n  label = KABKOT, fontface = \"bold\"), color = \"black\", \n  size = 2.5)+labs(title = \"Efek Tak Langsung Peubah X2\") +\n  theme(panel.background = element_rect(fill = \"white\"))\npeta.ie",
    "crumbs": [
      "Model Dependensi Spasial",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Spasial Autoregresif Binomial Negatif</span>"
    ]
  },
  {
    "objectID": "06-RegresiTerbobotiGeografisBinomialNegatif.html",
    "href": "06-RegresiTerbobotiGeografisBinomialNegatif.html",
    "title": "\n6  Regresi Terboboti Geografis Binomial Negatif\n",
    "section": "",
    "text": "6.1 Deskripsi\nRegresi Terboboti Geografis Binomial Negatif (RTGBN) merupakan pengembangan dari model regresi binomial negatif. Model RTGBN adalah salah satu metode yang cukup efektif menduga data yang memiliki ketergantungan spasial untuk data cacah yang memiliki overdispersi. Model ini akan menghasilkan pendugaan parameter lokal dengan masing-masing lokasi akan memiliki parameter yang berbeda (Silva & Rodrigues 2014).\nModel RTGBN dapat dirumuskan sebagai berikut:\n\\(y_i \\sim \\text{BN}\\left(\\exp\\left(\\sum_j \\beta_j(u_i,v_i) x_{ij} \\theta_i(u_i,v_i)\\right)\\right) \\quad (6.6.1)\\)\ndengan \\(y_i\\) adalah nilai amatan respon ke-i, \\(x_{ij}\\) adalah nilai amatan prediktor ke-j pada pengamatan, \\((u_i, v_i)\\) adalah logitude dan latitude lokasi-i, \\(\\beta_j(u_i, v_i)\\) adalah parameter regresi prediktor ke-j untuk setiap lokasi-i, dan \\(\\theta_i(u_i, v_i)\\) adalah parameter dispersi setiap lokasi-\\(i\\).\nPendugaan model RTG-BN menggunakan metode kemungkinan maksimum. Langkah awal dari metode kemungkinan adalah membentuk fungsi kemungkinan sebagai berikut (Ricardo & Carvalho 2013):\nPengujian parameter model RTGBN terdiri dari uji serentak dan parsial. Uji signifikansi serentak menggunakan uji rasio kemungkinan maksimum (MLRT) dengan hipotesis sebagai berikut.\ndengan statistik ujinya yaitu:\n\\(D(\\hat{\\beta}) = -2 \\ln\\left[\\frac{L(\\hat{\\omega})}{L(\\hat{\\Omega})}\\right] = 2\\left[\\ln(L(\\hat{\\Omega})) - \\ln(L(\\hat{\\omega}))\\right]\\)\nKeputusannya adalah tolak \\(H_0\\) jika $D() &gt; ^2_{p,} $ dengan \\(p\\) adalah banyaknya parameter. Tolak \\(H_0\\) artinya minimal ada satu peubah yang berpengaruh signifikan terhadap model sehingga dilanjutkan dengan pengujian parsial.\nHipotesis yang digunakan untuk pengujian parameter secara parsial. Berikut hipotesis yang digunakan untuk pengujian parameter secara parsial:\ndengan statistik ujinya dinyatakan dalam formula berikut:\n\\(Z = \\frac{\\hat{\\beta}_j(u_i,v_i)}{\\text{se}(\\hat{\\beta}_j(u_i,v_i))} \\sim \\mathcal{N}(0,1)\\)\ndengan \\(\\hat{\\beta}_j(u_i,v_i)\\) merupakan penduga parameter koefisien regresi prediktor ke-j pada lokasi ke-i dan \\(\\text{se}(\\hat{\\beta}_j)\\) adalah galat baku penduga parameter koefisien regresi prediktor ke-j pada lokasi ke-i. Keputusan adalah tolak \\(H_0\\) jika \\(|z_{\\text{hit}}| &gt; z_{\\alpha/2}\\)",
    "crumbs": [
      "Model Keragaman Spasial",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Regresi Terboboti Geografis Binomial Negatif</span>"
    ]
  },
  {
    "objectID": "06-RegresiTerbobotiGeografisBinomialNegatif.html#deskripsi",
    "href": "06-RegresiTerbobotiGeografisBinomialNegatif.html#deskripsi",
    "title": "\n6  Regresi Terboboti Geografis Binomial Negatif\n",
    "section": "",
    "text": "\\[\\begin{aligned}\nL(\\beta(u_i, v_i), \\theta_i, i=1,2,\\ldots,n) = \\prod_{i=1}^{n} \\left(\\prod_{r=0}^{y_i-1} (r + \\frac{1}{\\theta_i})\\right) \\frac{1}{y_i!} \\left(\\frac{1}{1 + \\theta_i \\mu_i}\\right)^{\\frac{1}{\\theta_i}} \\left(\\frac{\\theta_i \\mu_i}{1 + \\theta_i \\mu_i}\\right)^{y_i}\n\\end{aligned}\\]\n\n\\[\\begin{aligned}\nH_0: & \\ \\beta_1(u_i,v_i) = \\beta_2(u_i,v_i) = \\ldots = \\beta_p(u_i,v_i) = 0 \\\\\nH_1: & \\ \\text{Minimal ada satu } \\beta_j(u_i,v_i) \\neq 0, \\ j=1,2,\\ldots ,p\n\\end{aligned}\\]\n\n\n\n\n\\[\\begin{aligned}\nH_0: & \\ \\beta_j(u_i,v_i) = 0 \\\\\nH_1: & \\ \\beta_j(u_i,v_i) \\neq 0\n\\end{aligned}\\]",
    "crumbs": [
      "Model Keragaman Spasial",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Regresi Terboboti Geografis Binomial Negatif</span>"
    ]
  },
  {
    "objectID": "06-RegresiTerbobotiGeografisBinomialNegatif.html#data",
    "href": "06-RegresiTerbobotiGeografisBinomialNegatif.html#data",
    "title": "\n6  Regresi Terboboti Geografis Binomial Negatif\n",
    "section": "\n6.2 Data",
    "text": "6.2 Data\nIlustrasi untuk model RTG-BN merujuk hasil penelitian Fadila et al. (2021) tentang Tuberkulosis (TB) di Jawa Timur. Data yang digunakan merupakan data sekunder yang yang diperoleh dari Statistik Kesehatan Provinsi Jawa Timur 2019 yang dikeluarkan oleh Badan Pusat Statistik Jawa Timur, Profil Kesehatan Jawa Timur tahun 2018 dan Profil Kesehatan Jawa Timur tahun 2019 yang dikeluarkan oleh dinas kesehatan Provinsi Jawa Timur. Data yang digunakan mencakup jumlah kasus tuberkulosis dan enam peubah lainnya yang diduga berpengaruh terhadap kasus tuberkulosis (Tabel 6.6.1). Unit amatan adalah 38 kabupaten/kota yang berada di Provinsi Jawa Timur. Data dan peta ilustrasi RTG-BN tersedia pada tautan https://ipb.link/gwr-binomial-negatif.\n\\[\n\\begin{table}[ht]\n\\centering\n\\caption{Tabel Peubah dan Referensi}\n\\begin{tabular}{|c|c|c|}\n  \\hline\n  \\textbf{Kode} & \\textbf{Peubah} & \\textbf{Referensi} \\\\\n  \\hline\n  Y & Angka Tuberkulosis per 100.000 penduduk & \\\\\n  \\hline\n  X1 & Persentase rumah tangga dengan akses sanitasi layak & Nisa’ \\& Budiantara (2016) \\\\\n  \\hline\n  X2 & Persentase tempat pengolahan makanan (TPM) sehat & Lestari et al. (2014) \\\\\n  \\hline\n  X3 & Persentase rumah tangga ber-PHBS & Nisa’ \\& Budiantara (2016) \\\\\n  \\hline\n  X4 & Persentase rumah sehat & Lestari et al. (2014) \\\\\n  \\hline\n  X5 & Rata-rata konsumsi batang rokok per minggu & Tandang et al. (2018) \\\\\n  \\hline\n  X6 & Persentase pengobatan lengkap kasus Tuberkulosis & Sarani (2019) \\\\\n  \\hline\n\\end{tabular}\n\\end{table}\n\\]",
    "crumbs": [
      "Model Keragaman Spasial",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Regresi Terboboti Geografis Binomial Negatif</span>"
    ]
  },
  {
    "objectID": "06-RegresiTerbobotiGeografisBinomialNegatif.html#metode-analisis",
    "href": "06-RegresiTerbobotiGeografisBinomialNegatif.html#metode-analisis",
    "title": "\n6  Regresi Terboboti Geografis Binomial Negatif\n",
    "section": "\n6.3 Metode Analisis",
    "text": "6.3 Metode Analisis\nTahapan untuk menganalisis data jumlah kasus TB di Provinsi Jawa Timur tahun 2019 dengan pendekatan RTG-BN adalah sebagai berikut:\n\nMelakukan eksplorasi data untuk mengetahui gambaran awal data jumlah kasus TB pada balita di Provinsi Jawa Timur tahun 2019.\nMembuat peta sebaran dari setiap peubah respon dan prediktor yang digunakan.\nMemeriksa adanya multikolinearitas antar prediktor dengan menggunakan Variance Inflation Factor (VIF), jika nilai \\(VIF_i &gt; 10\\), maka terdapat multikolinear (Kutner et al. 2005):\n\n\\(VIF_i = \\frac{1}{1 - R_i^2}\\)\ndengan \\(R_i^2\\) adalah koefisien determinasi antara \\(X_i\\) dengan prediktor lainnya. Prediktor yang memiliki nilai \\(VIF_i &gt; 10\\) tidak diikutsertakan dalam penyusunan model.\n\nMemeriksa overdispersi Regresi Poisson memiliki asumsi equidispersi, artinya nilai rataan dan ragam pada peubah \\(Y\\) bernilai sama. Penyimpangan asumsi yang sering terjadi pada regresi Poisson yaitu overdispersi, yaitu nilai ragam lebih besar dari pada nilai rataan pada peubah \\(Y\\). Pengujian overdispersi menggunakan nilai devians dan Khi-kuadrat Pearson yang dibagi dengan derajat bebasnya. Hipotesis yang diuji sebagai berikut:\n\n[H_0: ] [H_1: ]\n\nStatistik Uji Devians:\n\n\\(\\[D^2 = 2\\sum_{i=1}^n \\left( y_i \\ln\\left(\\frac{y_i}{\\hat{\\mu}_i}\\right) - (y_i - \\hat{\\mu}_i) \\right)\\]\\) \\(\\[\\phi_1 = \\frac{D^2}{db}\\]\\)\ndengan \\(db = n - k\\) dengan \\(k\\) merupakan banyaknya parameter (termasuk konstanta) model regresi Poisson, \\(n\\) merupakan banyaknya amatan, dan \\(D^2\\) adalah nilai Devians.\n\nKhi-kuadrat Pearson:\n\n\\(\\chi^2 = 2\\sum_{i=1}^n \\frac{(y_i - \\mu_i)^2}{\\text{var}(y_i)}\\) \\(\\phi_2 = \\frac{\\chi^2}{db}\\)\ndengan \\(db = n - k\\) dengan \\(k\\) merupakan banyaknya parameter termasuk konstanta, \\(n\\) merupakan banyaknya pengamatan, dan \\(\\chi^2\\) adalah nilai Khi-kuadrat Pearson.\nJika \\(\\phi_1\\) atau \\(\\phi_2\\) bernilai lebih dari 1 maka terjadi overdispersi pada data. Jika tidak terdapat overdispersi maka model yang digunakan adalah model regresi Poisson, sedangkan jika terdapat overdispersi lebih cocok menggunakan model regresi binomial negatif.\n\n\nMelakukan uji efek spasial yaitu:\n\nUji dependensi spasial dengan uji LM dan Robust LM\nUji heterogenitas spasial menggunakan uji Breusch Pagan\n\n\nMenduga model regresi spasial sesuai hasil uji butir (2) dan (3). Memilih model terbaik dengan kriteria AIC.\n\nPemilihan model terbaik menggunakan Kriteria Informasi Akaike dengan rumus sebagai berikut:\n\\(AIC = -2\\log_e(L(\\hat{\\theta}|\\text{data})) + 2K\\)\ndengan \\(\\log_e(L(\\hat{\\theta}|\\text{data}))\\) adalah nilai maksimum pendugaan kemungkinan maksimum, \\(\\theta\\) adalah parameter yang tidak diketahui, \\(K\\) adalah banyaknya parameter yang diestimasi, dan \\(n\\) adalah banyaknya pengamatan.",
    "crumbs": [
      "Model Keragaman Spasial",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Regresi Terboboti Geografis Binomial Negatif</span>"
    ]
  },
  {
    "objectID": "06-RegresiTerbobotiGeografisBinomialNegatif.html#tahapan-analisis-data-dengan-r",
    "href": "06-RegresiTerbobotiGeografisBinomialNegatif.html#tahapan-analisis-data-dengan-r",
    "title": "\n6  Regresi Terboboti Geografis Binomial Negatif\n",
    "section": "\n6.4 Tahapan Analisis Data dengan R",
    "text": "6.4 Tahapan Analisis Data dengan R\nTahap awal dalam pemodelan menggunakan R Studio adalah melakukan input data dan install package sesuai kebutuhan dalam analisis. Package diperlukan adalah:\nPackage\n\nlibrary(car)         # Untuk menghitung nilai VIF\n# Loading required package: carData\nlibrary(classInt)        # Untuk membuat selang nilai\nlibrary(ggplot2)         # Untuk visualisasi data\n# Warning: package 'ggplot2' was built under R version 4.2.2\nlibrary(lmtest)      # Untuk pengujian asumsi\n# Loading required package: zoo\n# Warning: package 'zoo' was built under R version 4.2.3\n# \n# Attaching package: 'zoo'\n# The following objects are masked from 'package:base':\n# \n#     as.Date, as.Date.numeric\nlibrary(spdep)       # Untuk dependensi spasial\n# Warning: package 'spdep' was built under R version 4.2.3\n# Loading required package: spData\n# To access larger datasets in this package, install the\n# spDataLarge package with: `install.packages('spDataLarge',\n# repos='https://nowosad.github.io/drat/', type='source')`\n# Loading required package: sf\n# Linking to GEOS 3.9.1, GDAL 3.4.3, PROJ 7.2.1; sf_use_s2() is TRUE\nlibrary(sp)      # Untuk membentuk GWR model\nlibrary(spgwr)       # Untuk membentuk GWNBR\n# Warning: package 'spgwr' was built under R version 4.2.3\n# NOTE: This package does not constitute approval of GWR\n# as a method of spatial analysis; see example(gwr)\nlibrary(AER)         # Untuk uji dispersi\n# Warning: package 'AER' was built under R version 4.2.3\n# Loading required package: sandwich\n# Warning: package 'sandwich' was built under R version 4.2.3\n# Loading required package: survival\nlibrary(MASS)        # Untuk mengoptimasi parameter binomial\n# Warning: package 'MASS' was built under R version 4.2.3\nlibrary(dplyr)       # Untuk meringkas data koefisien\n# \n# Attaching package: 'dplyr'\n# The following object is masked from 'package:MASS':\n# \n#     select\n# The following object is masked from 'package:car':\n# \n#     recode\n# The following objects are masked from 'package:stats':\n# \n#     filter, lag\n# The following objects are masked from 'package:base':\n# \n#     intersect, setdiff, setequal, union\nlibrary(sf)\n\nInput Data\n\n#Set Lokasi File\n# Input Data\ngabung &lt;- readRDS('data/gabung.RDS')\ntb &lt;- read.csv('data/tb_jatim.csv')\ntb$KABUPATEN..KOTA &lt;- toupper(tb$KABUPATEN..KOTA)\n#\n#Input peta SHP\njatim &lt;- read_sf(\"data/shp/TB Jatim.shp\")\nsf_use_s2(FALSE)\n# Spherical geometry (s2) switched off\ncolnames(jatim)[2:8] &lt;- c('Y', 'X1', 'X2', 'X3', 'X4', 'X5', 'X6')\n\nlonglat = st_coordinates(st_centroid(jatim))\n# Warning in st_centroid.sf(jatim): st_centroid assumes attributes are\n# constant over geometries of x\n# Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =\n# of_largest_polygon): st_centroid does not give correct centroids for\n# longitude/latitude data\n\njatim$Y &lt;- as.numeric(jatim$Y)\njatim$X1 &lt;- as.numeric(jatim$X1)\njatim$X2 &lt;- as.numeric(jatim$X2)\njatim$X3 &lt;- as.numeric(jatim$X3)\njatim$X4 &lt;- as.numeric(jatim$X4)\njatim$X5 &lt;- as.numeric(jatim$X5)\njatim$X6 &lt;- as.numeric(jatim$X6)\nhead(jatim)\n# Simple feature collection with 6 features and 8 fields\n# Geometry type: MULTIPOLYGON\n# Dimension:     XYZ\n# Bounding box:  xmin: 111 ymin: -8.38 xmax: 112 ymax: -7.59\n# z_range:       zmin: 0 zmax: 0\n# Geodetic CRS:  WGS 84\n# # A tibble: 6 × 9\n#   KABKOT          Y    X1    X2    X3    X4    X5    X6\n#   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n# 1 Pacitan        66  91.3  35    44    76.4  58    46.7\n# 2 Ponorogo      133  95.1  56.4  66.8  79.7  55.6  56.3\n# 3 Trenggalek     80 100    84.4  42.4  81.2  59.4  70.2\n# 4 Tulungagung   119  97.3  78    43    78.8  66.1  56.5\n# 5 Blitar         74  97.6  63.5  62    69.9  63.5  49.9\n# 6 Kediri        120  88.6  13.2  49.6  78.7  80.9  52.3\n# # ℹ 1 more variable: geometry &lt;MULTIPOLYGON [°]&gt;\n\nEksplorasi Data\n\nPeta sebaran\n\nBerikut syntax yang dapat digunakan untuk membuat peta sebaran:\n\n#Menentukan batas kelas dari angka TB per 100000 penduduk\nclassIntervals(gabung$y, n = 4, style = 'kmeans')\n# style: kmeans\n#   one of 497,640 possible partitions of this variable into 4 classes\n# [5.83,20.6) [20.6,35.1) [35.1,50.2) [50.2,79.8] \n#          28          52          49          22\n\n\n#Membuat peta\ncc &lt;- c('#fbb4b9', '#f768a1', '#ae017e', '#551c53')\nplot.tb = ggplot(data=jatim) +\n  geom_sf(aes(fill = cut(Y, breaks = c(65, 104.5, 153.5, 225.5,\n         401))), lwd = 0.1, col ='black') +\n         scale_fill_manual(\"TB\", values = cc,\n         labels = c(\"66 - 104.5\", \"104.5 - 153.5\",\n         \"153.5 - 225.5\", \"225.5 - 401\"),\n         guide = guide_legend(reverse = T))+\n  xlab(\"\") +\n  ylab(\"\")\nplot.tb\n\n\n\n\n\n\n\n\nVIF\n\nVIF dihitung menggunakan syntax berikut ini:\n\n#VIF\nmodel &lt;- lm(log(Y) ~ X1 + X2 + X3 + X4 + X5 + X6, \n            data = jatim)\nas.matrix(vif(model))\n#    [,1]\n# X1 1.53\n# X2 1.18\n# X3 1.25\n# X4 1.54\n# X5 1.46\n# X6 1.55\n\nBerdasarkan nilai VIF, seluruh peubah memiliki nilai VIF &lt; 10 sehingga dapat disimpulkan tidak terdapat multikolinearitas.\nUji efek spasial\n\nIndeks Moran\n\nUntuk mengetahui efek dependensi spasial pada model regresi dengan respon ln(Y) dengan 6 (enam) prediktor (X1 sampai X6) digunakan uji Lagrange multiplier dengan syntax sebagai berikut:\n\n#Uji Lagrange Multiplier\nqueenl &lt;- poly2nb(jatim)\n# although coordinates are longitude/latitude, st_intersects assumes that they are planar\nqueenl &lt;- nb2listw(queenl)\nsummary(lm.LMtests(model, queenl, zero.policy = T,\n        test = c('LMlag', 'LMerr', 'RLMlag', 'RLMerr')))\n# Please update scripts to use lm.RStests in place of lm.LMtests\n#   Rao's score (a.k.a Lagrange multiplier) diagnostics for\n#   spatial dependence\n# data:  \n# model: lm(formula = log(Y) ~ X1 + X2 + X3 + X4 + X5 + X6,\n# data = jatim)\n# test weights: listw\n#  \n#          statistic parameter p.value\n# RSerr        0.764         1    0.38\n# RSlag        0.368         1    0.54\n# adjRSerr     0.756         1    0.38\n# adjRSlag     0.360         1    0.55\n\nPada output di atas terlihat semua uji LM dan RLM mempunyai p-value &gt; α=0.05, sehingga tidak terdapat dependensi spasial pada ln(Y) dan sisaan.\n\nUji Breusch-Pagan\n\nEfek keragaman spasial diuji dengan uji Breusch-Pagan dengan syntax berikut:\n\n#Model log(Y)\nbptest(model)\n# \n#   studentized Breusch-Pagan test\n# \n# data:  model\n# BP = 15, df = 6, p-value = 0.02\n\nHasil uji Breusch-Pagan untuk data ini menghasilkan p-value &lt; α=0.05 yang berarti terdapat heterogenitas spasial.\n\nUji Overdispersi\n\nUntuk melakukan uji dispersi menggunakan syntax sebagai berikut:\n\n#Model Regresi Poisson\npoisson&lt;-glm(Y~X1+X2+X3+X4+X5+X6,data=jatim, family = poisson())\n#\n#Nilai Deviance\ndv_df&lt;-deviance(poisson)/df.residual(poisson)\n#\n#Nilai Chi-Squares\npr_df&lt;-sum(residuals(poisson,\"pearson\")^2)/df.residual(poisson)\n#\n#Overdispersi\noverdis&lt;-cbind.data.frame(dv_df,pr_df)\noverdis\n#   dv_df pr_df\n# 1  28.7  28.7\n\nKedua nilai statistik uji overdispersi bernilai lebih besar dari satu, maka pada data TB terdapat overdispersi. Untuk menangani overdispersi pada data TB digunakan model regresi binomial negatif.\nMenduga model RTBNG\n\nRTBNG Fixed Gaussian\n\n\n#Menentukan bandwidth\nbdwt.gauss.fixed &lt;- ggwr.sel(Y ~ X1+X2+X3+X4+X5+X6, data = jatim, coords=longlat, adapt = F, gweight = gwr.Gauss)\n# Bandwidth: 1.35 CV score: 249084 \n# Bandwidth: 2.18 CV score: 243025 \n# Bandwidth: 2.7 CV score: 241754 \n# Bandwidth: 2.79 CV score: 241604 \n# Bandwidth: 3.07 CV score: 241207 \n# Bandwidth: 3.25 CV score: 241013 \n# Bandwidth: 3.36 CV score: 240908 \n# Bandwidth: 3.42 CV score: 240848 \n# Bandwidth: 3.46 CV score: 240813 \n# Bandwidth: 3.49 CV score: 240792 \n# Bandwidth: 3.51 CV score: 240779 \n# Bandwidth: 3.52 CV score: 240771 \n# Bandwidth: 3.52 CV score: 240767 \n# Bandwidth: 3.53 CV score: 240764 \n# Bandwidth: 3.53 CV score: 240762 \n# Bandwidth: 3.53 CV score: 240761 \n# Bandwidth: 3.53 CV score: 240760 \n# Bandwidth: 3.53 CV score: 240760 \n# Bandwidth: 3.53 CV score: 240759 \n# Bandwidth: 3.53 CV score: 240759 \n# Bandwidth: 3.53 CV score: 240759 \n# Bandwidth: 3.53 CV score: 240759 \n# Bandwidth: 3.53 CV score: 240759 \n# Bandwidth: 3.53 CV score: 240759\n\n#Optimasi Parameter Theta Binomial Negatif\naicvec &lt;- c()\nlibrary(MASS)\nfor(i in 1:30){\n  gwnbr.gauss.fixed &lt;- tryCatch(spgwr::ggwr(Y ~ X1 + X2\n                       + X3 + X4 + X5 + X6, data = jatim,\n                       coords=longlat, bandwidth =\n                       bdwt.gauss.fixed, gweight =\n                       gwr.Gauss, family =\n                       negative.binomial(theta= i, link\n                       = \"log\")), warning=function(w) w)\n  aicvec[i] &lt;- ifelse(is(gwnbr.gauss.fixed, 'warning'),\n                      \"not converge\",\n                      round(gwnbr.gauss.fixed$lm$aic,2))\n}\nmatrix(aicvec, ncol = 3)\n#       [,1] [,2] [,3]\n#  [1,]  482  434  453\n#  [2,]  457  435  455\n#  [3,]  446  436  457\n#  [4,]  440  438  460\n#  [5,]  436  440  462\n#  [6,]  434  442  465\n#  [7,]  432  444  467\n#  [8,]  432  446  470\n#  [9,]  432  448  472\n# [10,]  433  450  475\nplot(1:30, aicvec, xlab = 'theta',  ylab = 'AIC')\n\n\n\n\n\n\n\nDalam ilustrasi ini, dilakukan optimasi parameter theta pada sebaran binomial negatif yang digunakan. Berdasarkan pemodelan RTBNG dengan nilai theta 1 sampai 30 menghasilkan algoritma yang konvergen. Nilai AIC terkecil pada theta 8 senilai 431.98. Oleh karena itu, untuk pendekatan ini digunakan theta = 8.\n\n#Pendugaan GWR-BN\ngwnbr.gauss.fixed &lt;- spgwr::ggwr(Y ~ X1+X2+X3+X4+X5+X6,\n                     data = jatim, coords=longlat,\n                     bandwidth = bdwt.gauss.fixed,\n                     gweight=gwr.Gauss, family =\n                     negative.binomial(theta = 8, link =\n                     \"log\"))\ngwnbr.gauss.fixed\n# Call:\n# spgwr::ggwr(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6, data = jatim, \n#     coords = longlat, bandwidth = bdwt.gauss.fixed, gweight = gwr.Gauss, \n#     family = negative.binomial(theta = 8, link = \"log\"))\n# Kernel function: gwr.Gauss \n# Fixed bandwidth: 3.53 \n# Summary of GWR coefficient estimates at data points:\n#                  Min.  1st Qu.   Median  3rd Qu.     Max. Global\n# X.Intercept.  3.74054  3.81568  3.86659  3.91702  4.03409   3.84\n# X1           -0.00912 -0.00904 -0.00897 -0.00893 -0.00871  -0.01\n# X2            0.00475  0.00490  0.00496  0.00501  0.00510   0.00\n# X3            0.00351  0.00362  0.00368  0.00375  0.00388   0.00\n# X4            0.00706  0.00736  0.00747  0.00756  0.00770   0.01\n# X5            0.00216  0.00296  0.00327  0.00358  0.00410   0.00\n# X6            0.01449  0.01508  0.01536  0.01563  0.01597   0.02\n\n\nRTBNG Adaptive Gaussian\n\n\n#Menentukan Bandwidth\nbdwt.gauss.adapt &lt;- ggwr.sel(Y ~ X1+X2+X3+X4+X5+X6, \n              data = jatim,coords=longlat, adapt = T,\n              gweight = gwr.Gauss)\n# Adaptive q: 0.382 CV score: 267378 \n# Adaptive q: 0.618 CV score: 252270 \n# Adaptive q: 0.764 CV score: 246676 \n# Adaptive q: 0.854 CV score: 244198 \n# Adaptive q: 0.91 CV score: 242435 \n# Adaptive q: 0.944 CV score: 242099 \n# Adaptive q: 0.947 CV score: 242087 \n# Adaptive q: 0.961 CV score: 241737 \n# Adaptive q: 0.976 CV score: 241385 \n# Adaptive q: 0.985 CV score: 241118 \n# Adaptive q: 0.991 CV score: 240978 \n# Adaptive q: 0.994 CV score: 240899 \n# Adaptive q: 0.996 CV score: 240853 \n# Adaptive q: 0.998 CV score: 240825 \n# Adaptive q: 0.999 CV score: 240808 \n# Adaptive q: 0.999 CV score: 240798 \n# Adaptive q: 0.999 CV score: 240792 \n# Adaptive q: 1 CV score: 240788 \n# Adaptive q: 1 CV score: 240786 \n# Adaptive q: 1 CV score: 240784 \n# Adaptive q: 1 CV score: 240783 \n# Adaptive q: 1 CV score: 240783\n#\n# Optimasi Parameter Theta Binomial Negatif\naicvec &lt;- c()\nfor(i in 1:30){\n  gwnbr.gauss.adapt &lt;- spgwr::ggwr(Y ~ X1+X2+X3+X4+X5,\n                       data=jatim,coords=longlat, adapt =\n                       bdwt.gauss.adapt, gweight =\n                       gwr.Gauss, family =\n                       negative.binomial(theta = i,\n                       link=\"log\"))\n  aicvec[i] &lt;- gwnbr.gauss.adapt$lm$aic\n}\nmatrix(aicvec, ncol = 3)\n#       [,1] [,2] [,3]\n#  [1,]  480  436  458\n#  [2,]  456  437  460\n#  [3,]  445  439  463\n#  [4,]  439  441  466\n#  [5,]  436  443  468\n#  [6,]  434  445  471\n#  [7,]  433  448  474\n#  [8,]  433  450  477\n#  [9,]  433  452  479\n# [10,]  434  455  482\nplot(1:30, aicvec, xlab = 'theta',  ylab = 'AIC')\n\n\n\n\n\n\n\nBerdasarkan nilai AIC, nilai theta = 8 menghasilkan AIC terkecil sehingga pada ilustrasi ini akan digunakan model RTBNG dengan nilai theta = 8.\n\ngwnbr.gauss.adapt &lt;- spgwr::ggwr(Y ~ X1+X2+X3+X4+X5+X6,\n                     data = jatim,coords=longlat,\n                     adapt=bdwt.gauss.adapt,\n                     gweight=gwr.Gauss,\n                     family = negative.binomial(theta =\n                     8, link = \"log\"))\ngwnbr.gauss.adapt  \n# Call:\n# spgwr::ggwr(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6, data = jatim, \n#     coords = longlat, gweight = gwr.Gauss, adapt = bdwt.gauss.adapt, \n#     family = negative.binomial(theta = 8, link = \"log\"))\n# Kernel function: gwr.Gauss \n# Adaptive quantile: 1 (about 37 of 38 data points)\n# Summary of GWR coefficient estimates at data points:\n#                  Min.  1st Qu.   Median  3rd Qu.     Max. Global\n# X.Intercept.  3.73400  3.79227  3.91392  4.04821  4.08655   3.84\n# X1           -0.00912 -0.00903 -0.00885 -0.00868 -0.00852  -0.01\n# X2            0.00471  0.00475  0.00491  0.00503  0.00510   0.00\n# X3            0.00320  0.00337  0.00347  0.00372  0.00389   0.00\n# X4            0.00700  0.00709  0.00742  0.00762  0.00771   0.01\n# X5            0.00164  0.00190  0.00274  0.00361  0.00414   0.00\n# X6            0.01425  0.01467  0.01541  0.01586  0.01607   0.02\n\n\nPerbandingan nilai AIC\n\nBerikut syntax untuk memperlihatkan perbandingan AIC dari setiap model:\n\n#AIC\naicmod &lt;- c(gwnbr.gauss.fixed$lm$aic, gwnbr.gauss.adapt$lm$aic)\nmod &lt;- c('Fixed', 'Adaptive')\naicdf &lt;- data.frame(cbind(mod, round(aicmod,2)))\ncolnames(aicdf) &lt;- c('Model', 'AIC')\naicdf\n#      Model    AIC\n# 1    Fixed 431.98\n# 2 Adaptive 431.98\n\nBerdasarkan nilai AIC, model dengan bandwidth fixed gaussian memiliki nilai AIC yang sama dengan model dengan bandwidth adaptive gaussian sehingga model terbaik yang lebih sederhana untuk data ini adalah model dengan bandwidth fixed gaussian.\nInterpretasi\nInterpretasi model RTBNG dapat dilakukan dengan mengelompokkan koefisien model berdasarkan metode clustering tertentu. Dalam ilustrasi ini, dilakukan pengelompokan koefisien menggunakan kmeans.\n\n#Koefisien model\nhasil &lt;- as.data.frame(gwnbr.gauss.fixed$SDF)\nhasil$KABKOT &lt;- jatim$KABKOT\ngabung_new &lt;- merge(jatim, hasil, by= 'KABKOT', all=T)\n#\n#Standarisasi koefisien\nclustdt&lt;- scale(as.data.frame(gabung_new[,10:16])[,1:7])\n#\n#K-means clustering dengan 4 cluster\nset.seed(123)\nkcluster &lt;- kmeans(clustdt, centers = 4)\ngabung_new$cluster &lt;- kcluster$cluster\n#\n#Plot Cluster\nggplot(gabung_new) +\n  aes(fill = factor(cluster)) +\n  geom_sf(size = 0.05) +\n  scale_fill_brewer(\"Cluster\", palette = 'Set2')+\n  xlab(\"\") +\n  ylab(\"\")\n\n\n\n\n\n\n\nNilai rataan dari setiap gerombol dapat diperoleh dengan menggunakan syntax berikut ini:\n\n#ringkasan pusat gerombol\ngabungdf &lt;- as.data.frame(gabung_new)\ngabungdf %&gt;% select(cluster, X.Intercept., X1.y, X2.y, X3.y, \n           X4.y, X5.y, X6.y) %&gt;% group_by(cluster) %&gt;% summarise_each(funs(mean))\n# Warning: `summarise_each_()` was deprecated in dplyr 0.7.0.\n# ℹ Please use `across()` instead.\n# ℹ The deprecated feature was likely used in the dplyr package.\n#   Please report the issue at\n#   &lt;https://github.com/tidyverse/dplyr/issues&gt;.\n# Warning: `funs()` was deprecated in dplyr 0.8.0.\n# ℹ Please use a list of either functions or lambdas:\n# \n# # Simple named list: list(mean = mean, median = median)\n# \n# # Auto named with `tibble::lst()`: tibble::lst(mean, median)\n# \n# # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm =\n#   TRUE))\n# # A tibble: 4 × 8\n#   cluster X.Intercept.     X1.y    X2.y    X3.y    X4.y    X5.y\n#     &lt;int&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n# 1       1         3.99 -0.00884 0.00481 0.00355 0.00719 0.00248\n# 2       2         3.84 -0.00901 0.00498 0.00372 0.00751 0.00342\n# 3       3         3.91 -0.00893 0.00491 0.00363 0.00737 0.00300\n# 4       4         3.77 -0.00907 0.00506 0.00382 0.00764 0.00387\n# # ℹ 1 more variable: X6.y &lt;dbl&gt;\n\nDari output terlihat urutan rataan koefisien X1 dari terkecil sampai terbesar berturut-turut pada gerombol 4, gerombol 2, gerombol 3, dan gerombol 1. Sebaliknya urutan koefisien untuk X2 sampai X6 dari terkecil sampai terbesar berturut-turut pada gerombol 4, gerombol 2, gerombol 3, dan gerombol 1.",
    "crumbs": [
      "Model Keragaman Spasial",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Regresi Terboboti Geografis Binomial Negatif</span>"
    ]
  }
]