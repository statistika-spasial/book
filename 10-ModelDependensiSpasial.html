<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Pemodelan Statistika pada Data Geospasial - 10&nbsp; Model Dependensi Spasial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-ModelKeragamanSpasial.html" rel="next">
<link href="./part-4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-4.html">Spatial Filtering</a></li><li class="breadcrumb-item"><a href="./10-ModelDependensiSpasial.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pemodelan Statistika pada Data Geospasial</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kata Pengantar</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pendahuluan</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Dependensi Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-SpasialAutoRegresifModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-SpasialDurbinModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spasial Durbin Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-SpasialAutoRegresifBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Keragaman Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-RegresiTerbobotiGeografis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-RegresiTerbobotiGeografisCampuran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Campuran</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-RegresiTerbobotiGeografisBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed SAR-GWR</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-MetodeAnalisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Metode Analisis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-TahapanR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tahapan Analisis dengan R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Filtering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-ModelDependensiSpasial.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-ModelKeragamanSpasial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Model Epidemiologi</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Lampiran</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referensi</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Daftar isi</h2>
   
  <ul>
<li>
<a href="#deskripsi" id="toc-deskripsi" class="nav-link active" data-scroll-target="#deskripsi"><span class="header-section-number">10.1</span> Deskripsi</a>
  <ul class="collapse">
<li><a href="#fixed-effect-eigenvector-spatial-filtering-esf" id="toc-fixed-effect-eigenvector-spatial-filtering-esf" class="nav-link" data-scroll-target="#fixed-effect-eigenvector-spatial-filtering-esf">Fixed Effect Eigenvector Spatial Filtering (ESF)</a></li>
  <li><a href="#random-effect-eigenvector-spatial-filtering-re-esf" id="toc-random-effect-eigenvector-spatial-filtering-re-esf" class="nav-link" data-scroll-target="#random-effect-eigenvector-spatial-filtering-re-esf">Random Effect Eigenvector Spatial Filtering (RE-ESF)</a></li>
  <li><a href="#penduga-parameter-model" id="toc-penduga-parameter-model" class="nav-link" data-scroll-target="#penduga-parameter-model">Penduga Parameter Model</a></li>
  </ul>
</li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">10.2</span> Data</a></li>
  <li><a href="#tahapan-analisis-data" id="toc-tahapan-analisis-data" class="nav-link" data-scroll-target="#tahapan-analisis-data"><span class="header-section-number">10.3</span> Tahapan Analisis Data</a></li>
  <li>
<a href="#tahapan-analisis-data-dengan-r" id="toc-tahapan-analisis-data-dengan-r" class="nav-link" data-scroll-target="#tahapan-analisis-data-dengan-r"><span class="header-section-number">10.4</span> Tahapan Analisis Data dengan R</a>
  <ul class="collapse">
<li><a href="#package" id="toc-package" class="nav-link" data-scroll-target="#package">Package</a></li>
  <li><a href="#data-dan-peta" id="toc-data-dan-peta" class="nav-link" data-scroll-target="#data-dan-peta">Data dan Peta</a></li>
  <li><a href="#modifikasi-data" id="toc-modifikasi-data" class="nav-link" data-scroll-target="#modifikasi-data">Modifikasi Data</a></li>
  <li><a href="#plot-spasial" id="toc-plot-spasial" class="nav-link" data-scroll-target="#plot-spasial">Plot Spasial</a></li>
  <li><a href="#bobot-spasial" id="toc-bobot-spasial" class="nav-link" data-scroll-target="#bobot-spasial">Bobot Spasial</a></li>
  <li><a href="#uji-asumsi" id="toc-uji-asumsi" class="nav-link" data-scroll-target="#uji-asumsi">Uji Asumsi</a></li>
  <li><a href="#fixed-esf" id="toc-fixed-esf" class="nav-link" data-scroll-target="#fixed-esf">Fixed ESF</a></li>
  <li><a href="#random-effect-esf" id="toc-random-effect-esf" class="nav-link" data-scroll-target="#random-effect-esf">Random Effect-ESF</a></li>
  <li><a href="#random-effect-esf---vc" id="toc-random-effect-esf---vc" class="nav-link" data-scroll-target="#random-effect-esf---vc">Random Effect ESF - VC</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-4.html">Spatial Filtering</a></li><li class="breadcrumb-item"><a href="./10-ModelDependensiSpasial.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-dependensi-model" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="deskripsi" class="level2" data-number="10.1"><h2 data-number="10.1" class="anchored" data-anchor-id="deskripsi">
<span class="header-section-number">10.1</span> Deskripsi</h2>
<p>Analisis regresi spasial digunakan untuk melakukan pemodelan hubungan antara peubah respon dan prediktor dalam bentuk model regresi dengan mempertimbangkan efek spasial. Efek spasial antar lokasi dapat disebabkan oleh dependensi spasial dan heterogenitas spasial <span class="citation" data-cites="anselin1988">(<a href="references.html#ref-anselin1988" role="doc-biblioref">Anselin 1988</a>)</span>. Dependensi spasial adalah ketergantungan antara suatu lokasi dengan lokasi di sekitarnya sedangkan heterogenitas spasial adalah perbedaan pengaruh peubah prediktor terhadap respon di lokasi yang diamati. <strong>Eigenvector Spasial Filtering (ESF)</strong> adalah metode untuk mengatasi masalah dependensi spasial dengan menambahkan kombinasi linier dari vektor ciri matriks pembobot spasial pada spesifikasi model regresi (Chun &amp; Griffith, 2014). Eigenvector Spasial Filtering (ESF) dapat mengurangi kesalahan spesifikasi spasial, meningkatkan kesesuaian model, serta kenormalan dan homogenitas ragam sisaan. Metode lain yang dapat mengatasi masalah dependensi spasial adalah <strong>Random Effect Eigenvector Spatial Filtering (RE-ESF)</strong>.</p>
<p>Murakami dan Griffith (2015) memperluas Eigenvector Spatial Filtering (ESF) yang merupakan pendekatan efek tetap, ke pendekatan efek acak yaitu Random Effect Eigenvector Spatial Filtering (RE-ESF). Random Effect Eigenvector Spatial Filtering (RE-ESF) mempertimbangkan efek spasial sebagai variabel acak yang bervariasi di antara wilayah-wilayah yang diamati. Hughes dan Haran (2013) membahas kegunaan Random Effect Eigenvector Spatial Filtering (RE-ESF) untuk analisis dependensi spasial yang meminimumkan nilai ragam yang disebabkan oleh faktor acak antara peubah prediktor dan proses spasial laten.</p>
<p>Eigenvector Spatial Filtering (ESF) yang juga disebut koordinat utama matriks ketetanggaan (Dray et.al. 2006) atau pemetaan vektor ciri Moran didasarkan pada koefisien Moran (MC). Koefisien Moran untuk vektor peubah acak <span class="math inline">\(y\)</span> didefinisikan sebagai berikut:</p>
<p><span id="eq-1001"><span class="math display">\[
MC[y] = \frac{n}{(1' W1)} \left( y' MWMy \right) / \left( y' My \right)
\tag{10.1}\]</span></span></p>
<p>dengan <span class="math inline">\(W\)</span> adalah matriks bobot spasial simetris berukuran <span class="math inline">\(n \times n\)</span> dengan diagonal nol, dan <span class="math inline">\(M = (I-11'/n)\)</span> adalah matriks pemusatan. Misalkan dekomposisi eigen matriks <span class="math inline">\(MWM\)</span> sebagai <span class="math inline">\(E^* \Lambda^* E^{*'}\)</span>, dengan <span class="math inline">\(E^* = [e_1, \ldots, e_n]\)</span> adalah matriks vektor ciri. <span class="math inline">\(\Lambda^* = \text{diag}(\lambda_1, \ldots, \lambda_n)\)</span> adalah matriks diagonal yang elemennya adalah akar ciri <span class="math inline">\(\{\lambda_1, \ldots, \lambda_N\}\)</span>. Nilai koefisien Moran untuk hasil vektor ciri ke-<span class="math inline">\(l\)</span> adalah:</p>
<p><span id="eq-1002"><span class="math display">\[
MC[e_l] = \frac{n}{(1' W1)} \left( e_l' MWMye_l \right) / \left( e_l' Me_l \right) = \frac{n}{(1' W1)} \left( e_l' E^* \Lambda^* E^{*'} y e_l \right) / \left( e_l' Me_l \right) = \frac{n}{(1' W1)} \lambda_l
\tag{10.2}\]</span></span></p>
<section id="fixed-effect-eigenvector-spatial-filtering-esf" class="level3"><h3 class="anchored" data-anchor-id="fixed-effect-eigenvector-spatial-filtering-esf">Fixed Effect Eigenvector Spatial Filtering (ESF)</h3>
<p>Kombinasi linier dari akar ciri masih dapat diinterpretasikan dalam istilah MC. Misalkan <span class="math inline">\(E = [e_1, \ldots, e_L]\)</span> adalah matriks yang terdiri dari vektor ciri <span class="math inline">\(L (&lt; n)\)</span> di <span class="math inline">\(E^*\)</span>, dan <span class="math inline">\(\gamma = [\gamma_1, \ldots, \gamma_L]'\)</span> adalah vektor parameter. Model dasar dari ESF adalah:</p>
<p><span id="eq-1003"><span class="math display">\[
y = X\beta + E\gamma + \varepsilon, \quad \varepsilon \sim N(0, \sigma^2 I)
\tag{10.3}\]</span></span></p>
<p>dengan <span class="math inline">\(y\)</span> adalah vektor peubah respon berukuran <span class="math inline">\(n \times 1\)</span>, <span class="math inline">\(E\)</span> adalah matriks berukuran <span class="math inline">\(n \times L\)</span> yang terdiri dari subset <span class="math inline">\(L\)</span> (<span class="math inline">\(L &lt; n\)</span>) vektor ciri dari <span class="math inline">\(E^*\)</span>, <span class="math inline">\(\varepsilon\)</span> adalah vektor galat berukuran <span class="math inline">\(n \times 1\)</span>, <span class="math inline">\(\beta\)</span> adalah vektor parameter berukuran <span class="math inline">\(K \times 1\)</span>, <span class="math inline">\(\gamma = [\gamma_1, \ldots, \gamma_l, \ldots, \gamma_L]'\)</span> adalah vektor parameter berukuran <span class="math inline">\(L \times 1\)</span>, <span class="math inline">\(\sigma^2\)</span> adalah parameter ragam, dan <span class="math inline">\(0\)</span> adalah vektor nol berukuran <span class="math inline">\(n \times 1\)</span>.</p>
<p>Pemilihan <span class="math inline">\(L\)</span> vektor ciri pada <span class="math inline">\(E\)</span> yang signifikan dilakukan menggunakan metode regresi bertatar. <a href="#eq-1003" class="quarto-xref">Persamaan&nbsp;<span>10.3</span></a> identik dengan model regresi linier standar, sehingga linier standar, pemilihan vektor ciri yang signifikan dapat dilakukan dengan metode pemilihan bertatar dengan menggunakan metode kuadrat terkecil. Penduga parameter <span class="math inline">\(\beta\)</span> dan <span class="math inline">\(\gamma\)</span> sebagai berikut:</p>
<p><span id="eq-1004"><span class="math display">\[
\begin{bmatrix} \hat{\beta} \\ \hat{\gamma} \end{bmatrix} = \left( X^T X \quad X^T E \quad E^T X \quad I \right)^{-1}
\tag{10.4}\]</span></span></p>
</section><section id="random-effect-eigenvector-spatial-filtering-re-esf" class="level3"><h3 class="anchored" data-anchor-id="random-effect-eigenvector-spatial-filtering-re-esf">Random Effect Eigenvector Spatial Filtering (RE-ESF)</h3>
<p>Berdasarkan Hughes dan Haran (2013), model linier RE-ESF yang didasarkan pada model dengan autoregresif prior bersyarat intrinsik dirumuskan sebagai berikut:</p>
<p><span id="eq-1005"><span class="math display">\[
y = X\beta + E\gamma + \varepsilon, \quad \gamma \sim N(0, \sigma_{\gamma}^2 \Lambda), \quad \varepsilon \sim N(0, \sigma^2 I)
\tag{10.5}\]</span></span></p>
<p>dengan <span class="math inline">\(\sigma_{\gamma}^2\)</span> adalah parameter ragam dan <span class="math inline">\(\Lambda\)</span> adalah matriks diagonal berukuran <span class="math inline">\(L \times L\)</span> yang elemennya adalah <span class="math inline">\(L\)</span> pertama akar ciri dari <span class="math inline">\(MWM\)</span>, <span class="math inline">\(\gamma_1, \ldots, \gamma_L\)</span>, sesuai dengan <span class="math inline">\(L\)</span> vektor ciri di <span class="math inline">\(E\)</span>. Persamaan di atas identik dengan model campuran linier (linear mixed model atau LMM). Model campuran linier merupakan perluasan dari model linear yaitu dengan menambahkan efek acak. Metode ini banyak digunakan dalam rancangan percobaan untuk data yang berkorelasi. Bentuk umum model linear campuran adalah</p>
<p><span id="eq-1006"><span class="math display">\[
y = X\beta + Zu + \varepsilon
\tag{10.6}\]</span></span></p>
<p>dengan <span class="math inline">\(X\)</span> adalah matriks desain dari efek tetap yang teramati, <span class="math inline">\(\beta\)</span> adalah vektor parameter pengaruh efek tetap yang tidak diketahui, <span class="math inline">\(Z\)</span> adalah matriks desain efek acak yang teramati, <span class="math inline">\(u\)</span> adalah vektor efek acak yang tidak diketahui, dan <span class="math inline">\(\varepsilon\)</span> vektor galat acak yang tidak diketahui.</p>
<p>Hughes dan Haran (2013) memperkenalkan vektor ciri ke dalam <span class="math inline">\(E\)</span> yang akar cirinya lebih besar dari nol. Penduga linear tak bias terbaik (best linear unbiased estimator atau BLUE) dari <span class="math inline">\(\beta\)</span> dan <span class="math inline">\(\gamma\)</span> diperoleh sebagai berikut (Henderson 1975),</p>
<p><span id="eq-1007"><span class="math display">\[
\begin{bmatrix} \hat{\beta} \\ \hat{\gamma} \end{bmatrix} = \left( X^T X \quad X^T E \quad E^T X \quad I + \frac{\sigma^2}{\sigma_{\gamma}^2} \Lambda^{-1} \right)^{-1} \begin{bmatrix} X^T y \\ E^T y \end{bmatrix}
\tag{10.7}\]</span></span></p>
<p>dengan <span class="math inline">\(\Lambda^{-1}\)</span> adalah matriks diagonal berukuran <span class="math inline">\(L \times L\)</span> yang elemennya adalah <span class="math inline">\(1/\lambda_1, \ldots, 1/\lambda_L\)</span>. Pada <a href="#eq-1007" class="quarto-xref">Persamaan&nbsp;<span>10.7</span></a>, diagonal ke-<span class="math inline">\(l\)</span> (<span class="math inline">\(l = 1, \ldots, L\)</span>) dari <span class="math inline">\((\sigma^2/(\sigma_{\gamma}^2)) \Lambda^{-1}\)</span>, yang diberikan oleh <span class="math inline">\((\sigma^2/(\sigma_{\gamma}^2)) \gamma_l^{-1}\)</span>, menyusutkan koefisien ke-<span class="math inline">\(l\)</span> (<span class="math inline">\(\gamma_l\)</span>) menuju nol. Penyusutan ini signifikan untuk vektor eigen yang berhubungan dengan akar ciri yang lebih kecil, <span class="math inline">\(\gamma_l\)</span>. Penyusutan seperti itu yang berguna untuk menduga model sambil mempertahankan derajat kebebasan yang konstan (Hodges 2013), memungkinkan menduga model RE-ESF tanpa menerapkan pemilihan vektor ciri bertahap (stepwise eigenvector selection). Ragam dari pendugaan <span class="math inline">\(\beta\)</span> dan <span class="math inline">\(\gamma\)</span> diberikan sebagai berikut:</p>
<p><span id="eq-1008"><span class="math display">\[
\text{Var}[\hat{\beta}, \hat{\gamma}] = \sigma^2 \left( X^T X \quad X^T E \quad E^T X \quad I + \frac{\sigma^2}{\sigma_{\gamma}^2} \Lambda^{-1} \right)^{-1}
\tag{10.8}\]</span></span></p>
</section><section id="penduga-parameter-model" class="level3"><h3 class="anchored" data-anchor-id="penduga-parameter-model">Penduga Parameter Model</h3>
<p><a href="#eq-1007" class="quarto-xref">Persamaan&nbsp;<span>10.7</span></a> dapat ditulis sebagai berikut:</p>
<p><span id="eq-1009"><span class="math display">\[
y = X\beta + EV(\theta)u + \varepsilon, \quad u \sim N(0, \sigma^2 I), \quad \varepsilon \sim N(0, \sigma^2 I)
\tag{10.9}\]</span></span></p>
<p>dengan <span class="math inline">\(V(\theta)u = \gamma\)</span> dengan <span class="math inline">\(\theta = \left\{ \left( \frac{\sigma_{\gamma}^2}{\sigma^2} \right), \alpha \right\}\)</span>, dan <span class="math inline">\(V(\theta)\)</span> adalah matriks diagonal berukuran <span class="math inline">\(L \times L\)</span> yang elemen ke-<span class="math inline">\((l, l)\)</span> adalah <span class="math inline">\(\left( \frac{\sigma_{\gamma}}{\sigma} \right) \lambda_l \sqrt{\alpha}\)</span>. Berdasarkan Bates (2010), <a href="#eq-1010" class="quarto-xref">Persamaan&nbsp;<span>10.10</span></a> identik dengan model linear campuran yang pendugaannya menggunakan metode kemungkinan maksimum (maximum likelihood atau ML) dan kemungkinan maksimum terbatas (restricted maximum likelihood atau REML). Loglikelihood pada <a href="#eq-1011" class="quarto-xref">Persamaan&nbsp;<span>10.11</span></a> dapat dituliskan sebagai berikut:</p>
<p><span id="eq-1010"><span class="math display">\[
\text{log} L(\beta, \theta, \sigma^2) = -\frac{n}{2} \text{log}(2\pi\sigma^2) - \text{log}(|V(\theta)|^2) - \frac{d(\theta)}{\sigma^2}
\tag{10.10}\]</span></span></p>
<p><span id="eq-1011"><span class="math display">\[
d(\theta) = \lVert y - X\beta + EV(\theta)u \rVert^2 + \lVert u \rVert^2
\tag{10.11}\]</span></span></p>
<p>Penduga linear tak bias terbaik dari <span class="math inline">\(\beta\)</span> dan <span class="math inline">\(u\)</span> diperoleh dengan memaksimumkan <a href="#eq-1012" class="quarto-xref">Persamaan&nbsp;<span>10.12</span></a> sebagai berikut:</p>
<p><span id="eq-1012"><span class="math display">\[
\begin{bmatrix} \hat{\beta} \\ \hat{u} \end{bmatrix} = \left( X^T X \quad X^T EV(\theta) \quad V(\theta)E^T X \quad V(\theta)^2 + I \right)^{-1} \begin{bmatrix} X^T y \\ V(\theta)E^T y \end{bmatrix}
\tag{10.12}\]</span></span></p>
<p>dengan <span class="math inline">\(V(\theta)^2\)</span> adalah matriks diagonal berukuran <span class="math inline">\(L \times L\)</span> yang elemen ke-<span class="math inline">\((l, l)\)</span> adalah <span class="math inline">\(\left( \frac{\sigma_{\gamma}^2}{\sigma^2} \right) \gamma_l \alpha\)</span>. <a href="#eq-1011" class="quarto-xref">Persamaan&nbsp;<span>10.11</span></a> identik dengan <a href="#eq-1007" class="quarto-xref">Persamaan&nbsp;<span>10.7</span></a> dengan penambahan <span class="math inline">\(\alpha\)</span>. <span class="math inline">\(\theta\)</span> dapat diduga dengan memaksimumkan <a href="#eq-1010" class="quarto-xref">Persamaan&nbsp;<span>10.10</span></a>. Penduga kemungkinan maksimum dari parameter ragam (<span class="math inline">\(\theta\)</span> dan <span class="math inline">\(\sigma^2\)</span>) diketahui berbias (Bates 2010). Oleh karena itu, digunakan pendugaan REML yang memberikan pendugaan parameter ragam yang tidak bias. Residual log-likehood untuk parameter ragam diformulasikan sebagai berikut:</p>
<p><span id="eq-1013"><span class="math display">\[
\text{log} L_R(\theta, \sigma^2) = \int \text{log} L(\beta, \theta, \sigma^2) d\beta
\tag{10.13}\]</span></span></p>
<p>Dengan memaksimumkan <a href="#eq-1014" class="quarto-xref">Persamaan&nbsp;<span>10.14</span></a>, penduga tak bias diperoleh sebagai berikut:</p>
<p><span id="eq-1014"><span class="math display">\[
\sigma^2 = \frac{\lVert y - X\beta + EV(\theta)u \rVert^2}{(n-K)} \quad (13)
\tag{10.14}\]</span></span></p>
<p>Berdasarkan Bates (2010), <span class="math inline">\(\theta\)</span> diduga dengan memaksimumkan profil residual log-likelihood, <span class="math inline">\(\text{log} L_R(\theta)\)</span> yang diturunkan dengan langkah (a) mensubstitusikan <a href="#eq-1010" class="quarto-xref">Persamaan&nbsp;<span>10.10</span></a> pada <a href="#eq-1012" class="quarto-xref">Persamaan&nbsp;<span>10.12</span></a> dan menurunkan fungsi <span class="math inline">\(\text{log} L_R(\theta, \sigma^2)\)</span> dan (b) mensubstitusikan <a href="#eq-1013" class="quarto-xref">Persamaan&nbsp;<span>10.13</span></a> pada <span class="math inline">\(\text{log} L_R(\theta, \sigma^2)\)</span> dan menurunkan fungsi <span class="math inline">\(\text{log} L_R(\theta)\)</span>. Hasil fungsi profil residual log-likelihood diberikan sebagai berikut:</p>
<p><span id="eq-1015"><span class="math display">\[
\text{log} L_R(\theta) = -\frac{1}{2} \text{log} \left| \begin{bmatrix} X^T X &amp; X^T EV(\theta) \\ V(\theta) E^T X &amp; V(\theta)^2 + I \end{bmatrix} \right| - \frac{(n-K)}{2} \left( 1 + \text{log} \left( \frac{2\pi d(\theta)}{(n-K)} \right) \right)
\tag{10.15}\]</span></span></p>
<p>Maksimalisasi <a href="#eq-1016" class="quarto-xref">Persamaan&nbsp;<span>10.16</span></a> membutuhkan penghitungan determinan pada suku pertama. Beban komputasi dapat diringankan dengan mengurangi jumlah vektor eigen di <span class="math inline">\(E\)</span>. Ragam dari <span class="math inline">\(\hat{\beta}\)</span> dan <span class="math inline">\(\hat{\gamma}\)</span> yang diduga adalah sebagai berikut:</p>
<p><span id="eq-1016"><span class="math display">\[
\text{Var}[\hat{\beta}\hat{u}] = \text{Var}[\hat{\beta}V(\theta)\hat{u}] = \sigma^2 \left(X'X \quad X'E \atop E'X \quad I + \frac{\sigma^2}{\sigma_{\gamma}^2}\Lambda^{-1} \right)^{-1} \quad \text{(15)}
\tag{10.16}\]</span></span></p>
<p>dengan <span class="math inline">\(V(\theta)^{-2}\)</span> adalah matriks diagonal berukuran <span class="math inline">\(L \times L\)</span> yang elemen ke-<span class="math inline">\(l\)</span> adalah <span class="math inline">\(\left(\frac{\sigma^2}{\sigma_{\gamma}^2}\right) \lambda_l(\alpha)^{-1}\)</span>.</p>
</section></section><section id="data" class="level2" data-number="10.2"><h2 data-number="10.2" class="anchored" data-anchor-id="data">
<span class="header-section-number">10.2</span> Data</h2>
<p>Data yang digunakan pada penelitian ini adalah data empiris Stunting per Kabupaten/Kota di Indonesia tahun 2021 dari Badan Pusat Statistika yang terdiri dari 513 Kabupaten/Kota. Data tersebut terdiri dari peubah respon dan peubah penjelas. Peubah-peubah tersebut sebagai berikut:</p>
<p><span class="math display">\[Y = \text{Stunting}\]</span></p>
<p><span class="math display">\[X_1 = \text{Tingkat Kemiskinan}\]</span></p>
<p><span class="math display">\[X_2 = \text{Akses Layanan Kesehatan}\]</span></p>
<p><span class="math display">\[X_3 = \text{Gizi Ibu Hamil}\]</span></p>
<p><span class="math display">\[X_4 = \text{Akses Sanitasi}\]</span></p>
<p><span class="math display">\[X_5 = \text{Akses Air Bersih}\]</span></p>
</section><section id="tahapan-analisis-data" class="level2" data-number="10.3"><h2 data-number="10.3" class="anchored" data-anchor-id="tahapan-analisis-data">
<span class="header-section-number">10.3</span> Tahapan Analisis Data</h2>
<p>Penelitian ini dilakukan dengan langkah-langkah sebagai berikut:</p>
<ol type="1">
<li><p>Melakukan analisis eksplorasi data pada data stunting di Indonesia tahun 2021 untuk melihat gambaran umum setiap peubah yang diamati.</p></li>
<li><p>Melakukan tahap pra-pemrosesan data dengan mengidentifikasi pencilan pada peubah respon dan menanganinya.</p></li>
<li><p>Memodelkan data stunting menggunakan metode Regresi Linier, memeriksa asumsinya, dan mengevaluasi model.</p></li>
<li>
<p>Memodelkan data stunting menggunakan metode Eigenvector Spatial Filtering (ESF), dengan rincian tahapan sebagai berikut:</p>
<ol type="a">
<li>Menguji data stunting dengan indeks Moran dan Lagrange-Multiplier</li>
<li>Menghitung bobot spasial menggunakan pendekatan matriks invers jarak dan eksponensial.</li>
<li>Memodelkan data stunting menggunakan metode ESF efek tetap (fixed effects) untuk setiap unit spasial.</li>
<li>Memodelkan data stunting menggunakan metode ESF efek acak (random effect) dengan asumsi peubah acak berasal dari sebaran normal.</li>
<li>Memodelkan data stunting menggunakan metode ESF efek acak dengan pendekatan Varying Coefficient (Random Effect-ESF VC).</li>
<li>Melakukan uji hipotesis untuk efek peubah penjelas terhadap peubah respon.</li>
<li>Mengevaluasi model.</li>
</ol>
</li>
<li><p>Membandingkan kinerja model Regresi Linier, Fixed Effect-ESF, Random Effect-ESF, dan Random Effect-ESF VC menggunakan nilai Koefisien Determinasi (R-Sqrd) dan Akaike Information Criterion (AIC).</p></li>
<li><p>Menguji kelayakan dari model terbaik.</p></li>
</ol></section><section id="tahapan-analisis-data-dengan-r" class="level2" data-number="10.4"><h2 data-number="10.4" class="anchored" data-anchor-id="tahapan-analisis-data-dengan-r">
<span class="header-section-number">10.4</span> Tahapan Analisis Data dengan R</h2>
<section id="package" class="level3"><h3 class="anchored" data-anchor-id="package">Package</h3>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span> <span class="co"># Untuk pemodelan dependensi spasial</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spatialreg/">spatialreg</a></span><span class="op">)</span> <span class="co"># Untuk pemodelan dependensi spasial</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span> <span class="co"># Untuk operasi matematis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span> <span class="co"># Untuk menghitung VIF</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">nortest</span><span class="op">)</span> <span class="co"># Untuk uji kenormalan</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span> <span class="co"># Untuk menginput peta</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span> <span class="co"># Untuk visualisasi data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span> <span class="co"># Untuk mengolah dataframe</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span> <span class="co"># Untuk mengolah dataframe</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># Struktur matriks</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span> <span class="co"># Uji model linier</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">spmoran</span><span class="op">)</span> <span class="co"># ESF</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lbbe.univ-lyon1.fr/fr/fitdistrplus">fitdistrplus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="data-dan-peta" class="level3"><h3 class="anchored" data-anchor-id="data-dan-peta">Data dan Peta</h3>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Input Data</span></span>
<span><span class="va">stunting</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"data/data_stunting_indo.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Import peta SHP</span></span>
<span><span class="va">peta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"data/shp/BATAS KABUPATEN KOTA DESEMBER 2019 DUKCAPIL.shp"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="modifikasi-data" class="level3"><h3 class="anchored" data-anchor-id="modifikasi-data">Modifikasi Data</h3>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Menggabungkan Data ke file SHP</span></span>
<span><span class="co">#df = cbind(stunting,KAB_KOTA=shp.jabar$KAB_KOTA)</span></span>
<span><span class="va">dfix</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">peta</span>, <span class="va">stunting</span>, by <span class="op">=</span> <span class="st">"KAB_KOTA"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfix</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span></span>
<span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spherical geometry (s2) switched off</span></span>
<span><span class="va">longlat</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">geometry</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in st_centroid.sfc(dfix$geometry): st_centroid does not</span></span>
<span><span class="co">#&gt; give correct centroids for longitude/latitude data</span></span>
<span></span>
<span><span class="co">#library("writexl")</span></span>
<span><span class="co">#write_xlsx(dfix,"datacek.xlsx")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="plot-spasial" class="level3"><h3 class="anchored" data-anchor-id="plot-spasial">Plot Spasial</h3>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Pemetaan Kasus Stunting</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">longlat</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">longlat</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, label <span class="op">=</span> <span class="va">KAB_KOTA</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Stunting di Indonesia"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Stunting"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="10-ModelDependensiSpasial_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="bobot-spasial" class="level3"><h3 class="anchored" data-anchor-id="bobot-spasial">Bobot Spasial</h3>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Bobot Spasial</span></span>
<span><span class="va">D</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">longlat</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#inverse weight matrix</span></span>
<span><span class="va">w</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">D</span></span>
<span><span class="co"># inverse weight matrix - row-normalized</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rtot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">w</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">w_std</span> <span class="op">&lt;-</span> <span class="va">w</span> <span class="op">/</span> <span class="va">rtot</span></span>
<span><span class="va">cekrowsum</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">w_std</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">wmoran</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/mat2listw.html">mat2listw</a></span><span class="op">(</span><span class="va">w_std</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="uji-asumsi" class="level3"><h3 class="anchored" data-anchor-id="uji-asumsi">Uji Asumsi</h3>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Uji Moran Indeks (Autokorelasi)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.test.html">moran.test</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">Y</span>, <span class="va">wmoran</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Moran I test under randomisation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dfix$Y  </span></span>
<span><span class="co">#&gt; weights: wmoran    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Moran I statistic standard deviate = 29, p-value &lt;2e-16</span></span>
<span><span class="co">#&gt; alternative hypothesis: greater</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; Moran I statistic       Expectation          Variance </span></span>
<span><span class="co">#&gt;          1.84e-01         -1.97e-03          4.06e-05</span></span>
<span></span>
<span><span class="co"># Uji Breusch-Pagan (Heteroskesdasitas)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">X5</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  lm(Y ~ X1 + X2 + X3 + X4 + X5, data = dfix)</span></span>
<span><span class="co">#&gt; BP = 57, df = 63, p-value = 0.7</span></span>
<span></span>
<span><span class="co">#LM Test (Model Spsial)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">X5</span>, data <span class="op">=</span> <span class="va">dfix</span><span class="op">)</span></span>
<span><span class="va">LM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.LMtests</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">wmoran</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'LMerr'</span>, <span class="st">'LMlag'</span>, <span class="st">'RLMerr'</span>, <span class="st">'RLMlag'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Please update scripts to use lm.RStests in place of lm.LMtests</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">LM</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Rao's score (a.k.a Lagrange multiplier) diagnostics for</span></span>
<span><span class="co">#&gt;  spatial dependence</span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = Y ~ X1 + X2 + X3 + X4 + X5, data = dfix)</span></span>
<span><span class="co">#&gt; test weights: listw</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;          statistic parameter p.value    </span></span>
<span><span class="co">#&gt; RSerr        126.6         1 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; RSlag        119.4         1 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; adjRSerr      27.6         1 1.5e-07 ***</span></span>
<span><span class="co">#&gt; adjRSlag      20.4         1 6.2e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="fixed-esf" class="level3"><h3 class="anchored" data-anchor-id="fixed-esf">Fixed ESF</h3>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ESF Fixed</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="va">dfix</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">X1</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X2</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X3</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X4</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">meig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/meigen.html">meigen</a></span><span class="op">(</span>cmat <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span><span class="co">#&gt;  149/509 eigen-pairs are extracted</span></span>
<span><span class="va">esf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/esf.html">esf</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y</span>, x <span class="op">=</span> <span class="va">X</span>, meig <span class="op">=</span> <span class="va">meig</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 50</span></span>
<span><span class="co">#&gt;   76/149 eigenvectors are selected</span></span>
<span><span class="va">esf</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; esf(y = Y, x = X, meig = meig)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Coefficients------------------------------</span></span>
<span><span class="co">#&gt;              Estimate       SE t_value  p_value</span></span>
<span><span class="co">#&gt; (Intercept)  3.16e+01 2.43e+00  12.976 1.08e-32</span></span>
<span><span class="co">#&gt; V1           2.78e-01 4.53e-02   6.132 1.97e-09</span></span>
<span><span class="co">#&gt; V2           2.36e-02 2.64e-02   0.896 3.71e-01</span></span>
<span><span class="co">#&gt; V3           7.36e-05 4.44e-05   1.658 9.80e-02</span></span>
<span><span class="co">#&gt; V4          -1.47e-01 2.06e-02  -7.119 4.65e-12</span></span>
<span><span class="co">#&gt; V5           3.50e-03 2.21e-02   0.158 8.74e-01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Spatial effects (residuals)---------------</span></span>
<span><span class="co">#&gt;                      Estimate</span></span>
<span><span class="co">#&gt; SD                      5.581</span></span>
<span><span class="co">#&gt; Moran.I/max(Moran.I)    0.114</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Error statistics--------------------------</span></span>
<span><span class="co">#&gt;               stat</span></span>
<span><span class="co">#&gt; resid_SE     5.147</span></span>
<span><span class="co">#&gt; adjR2        0.648</span></span>
<span><span class="co">#&gt; logLik   -1511.474</span></span>
<span><span class="co">#&gt; AIC       3188.948</span></span>
<span><span class="co">#&gt; BIC       3540.241</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="random-effect-esf" class="level3"><h3 class="anchored" data-anchor-id="random-effect-esf">Random Effect-ESF</h3>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ESF Random</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="va">dfix</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">X1</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X2</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X3</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X4</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">meig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/meigen.html">meigen</a></span><span class="op">(</span>cmat <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span><span class="co">#&gt;  149/509 eigen-pairs are extracted</span></span>
<span><span class="va">resf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/resf.html">resf</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y</span>, x <span class="op">=</span> <span class="va">X</span>, meig <span class="op">=</span> <span class="va">meig</span><span class="op">)</span></span>
<span><span class="va">resf</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; resf(y = Y, x = X, meig = meig)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Coefficients------------------------------</span></span>
<span><span class="co">#&gt;              Estimate       SE t_value  p_value</span></span>
<span><span class="co">#&gt; (Intercept)  3.43e+01 2.46e+00  13.972 0.00e+00</span></span>
<span><span class="co">#&gt; V1           3.35e-01 5.65e-02   5.925 6.45e-09</span></span>
<span><span class="co">#&gt; V2           7.91e-03 2.54e-02   0.311 7.56e-01</span></span>
<span><span class="co">#&gt; V3           5.75e-05 4.54e-05   1.268 2.05e-01</span></span>
<span><span class="co">#&gt; V4          -1.41e-01 2.07e-02  -6.788 3.81e-11</span></span>
<span><span class="co">#&gt; V5          -3.74e-02 2.23e-02  -1.680 9.38e-02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Variance parameter------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spatial effects (residuals):</span></span>
<span><span class="co">#&gt;                      (Intercept)</span></span>
<span><span class="co">#&gt; random_SD                  2.568</span></span>
<span><span class="co">#&gt; Moran.I/max(Moran.I)       0.146</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Error statistics--------------------------</span></span>
<span><span class="co">#&gt;                  stat</span></span>
<span><span class="co">#&gt; resid_SE        5.076</span></span>
<span><span class="co">#&gt; adjR2(cond)     0.654</span></span>
<span><span class="co">#&gt; rlogLik     -1675.614</span></span>
<span><span class="co">#&gt; AIC          3369.228</span></span>
<span><span class="co">#&gt; BIC          3407.320</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; NULL model: lm( y ~ x )</span></span>
<span><span class="co">#&gt;    (r)loglik: -1711.8 ( AIC: 3437.6,  BIC: 3467.227 )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note: AIC and BIC are based on the restricted/marginal likelihood.</span></span>
<span><span class="co">#&gt;       Use method="ml" for comparison of models with different fixed effects (x)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="random-effect-esf---vc" class="level3"><h3 class="anchored" data-anchor-id="random-effect-esf---vc">Random Effect ESF - VC</h3>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ESF VC</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="va">dfix</span><span class="op">$</span><span class="va">Y</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">$</span><span class="va">X1</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X2</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X3</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X4</span>, <span class="va">dfix</span><span class="op">$</span><span class="va">X5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dfix</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">meig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/meigen.html">meigen</a></span><span class="op">(</span>coords <span class="op">=</span> <span class="va">longlat</span><span class="op">)</span></span>
<span><span class="co">#&gt;  64/509 eigen-pairs are extracted</span></span>
<span><span class="va">resf_vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/spmoran/man/resf_vc.html">resf_vc</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>                   x <span class="op">=</span> <span class="va">X</span>,</span>
<span>                   meig <span class="op">=</span> <span class="va">meig</span>,</span>
<span>                   x_sel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 1  -------"</span></span>
<span><span class="co">#&gt; [1] "1/6"</span></span>
<span><span class="co">#&gt; [1] "2/6"</span></span>
<span><span class="co">#&gt; [1] "3/6"</span></span>
<span><span class="co">#&gt; [1] "4/6"</span></span>
<span><span class="co">#&gt; [1] "5/6"</span></span>
<span><span class="co">#&gt; [1] "6/6"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3597.845"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 2  -------"</span></span>
<span><span class="co">#&gt; [1] "1/6"</span></span>
<span><span class="co">#&gt; [1] "2/6"</span></span>
<span><span class="co">#&gt; [1] "3/6"</span></span>
<span><span class="co">#&gt; [1] "4/6"</span></span>
<span><span class="co">#&gt; [1] "5/6"</span></span>
<span><span class="co">#&gt; [1] "6/6"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3453.959"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 3  -------"</span></span>
<span><span class="co">#&gt; [1] "1/6"</span></span>
<span><span class="co">#&gt; [1] "2/6"</span></span>
<span><span class="co">#&gt; [1] "3/6"</span></span>
<span><span class="co">#&gt; [1] "4/6"</span></span>
<span><span class="co">#&gt; [1] "5/6"</span></span>
<span><span class="co">#&gt; [1] "6/6"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3449.442"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 4  -------"</span></span>
<span><span class="co">#&gt; [1] "1/6"</span></span>
<span><span class="co">#&gt; [1] "2/6"</span></span>
<span><span class="co">#&gt; [1] "3/6"</span></span>
<span><span class="co">#&gt; [1] "4/6"</span></span>
<span><span class="co">#&gt; [1] "5/6"</span></span>
<span><span class="co">#&gt; [1] "6/6"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3449.264"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 5  -------"</span></span>
<span><span class="co">#&gt; [1] "1/6"</span></span>
<span><span class="co">#&gt; [1] "2/6"</span></span>
<span><span class="co">#&gt; [1] "3/6"</span></span>
<span><span class="co">#&gt; [1] "4/6"</span></span>
<span><span class="co">#&gt; [1] "5/6"</span></span>
<span><span class="co">#&gt; [1] "6/6"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3449.253"</span></span>
<span><span class="co">#&gt; [1] "-------  Iteration 6  -------"</span></span>
<span><span class="co">#&gt; [1] "1/6"</span></span>
<span><span class="co">#&gt; [1] "2/6"</span></span>
<span><span class="co">#&gt; [1] "3/6"</span></span>
<span><span class="co">#&gt; [1] "4/6"</span></span>
<span><span class="co">#&gt; [1] "5/6"</span></span>
<span><span class="co">#&gt; [1] "6/6"</span></span>
<span><span class="co">#&gt; [1] "BIC: 3449.253"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">resf_vc</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; resf_vc(y = Y, x = X, x_sel = FALSE, meig = meig)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Spatially varying coefficients on x (summary)----</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficient estimates:</span></span>
<span><span class="co">#&gt;   (Intercept)         V1               V2           </span></span>
<span><span class="co">#&gt;  Min.   :29.5   Min.   :-0.096   Min.   :-0.000131  </span></span>
<span><span class="co">#&gt;  1st Qu.:32.3   1st Qu.: 0.320   1st Qu.:-0.000131  </span></span>
<span><span class="co">#&gt;  Median :34.9   Median : 0.413   Median :-0.000131  </span></span>
<span><span class="co">#&gt;  Mean   :34.1   Mean   : 0.403   Mean   :-0.000131  </span></span>
<span><span class="co">#&gt;  3rd Qu.:35.8   3rd Qu.: 0.485   3rd Qu.:-0.000131  </span></span>
<span><span class="co">#&gt;  Max.   :38.0   Max.   : 0.797   Max.   :-0.000131  </span></span>
<span><span class="co">#&gt;        V3                 V4               V5         </span></span>
<span><span class="co">#&gt;  Min.   :6.92e-05   Min.   :-0.180   Min.   :-0.0551  </span></span>
<span><span class="co">#&gt;  1st Qu.:6.92e-05   1st Qu.:-0.159   1st Qu.:-0.0341  </span></span>
<span><span class="co">#&gt;  Median :6.92e-05   Median :-0.151   Median :-0.0291  </span></span>
<span><span class="co">#&gt;  Mean   :6.92e-05   Mean   :-0.153   Mean   :-0.0298  </span></span>
<span><span class="co">#&gt;  3rd Qu.:6.92e-05   3rd Qu.:-0.147   3rd Qu.:-0.0244  </span></span>
<span><span class="co">#&gt;  Max.   :6.92e-05   Max.   :-0.141   Max.   :-0.0121  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistical significance:</span></span>
<span><span class="co">#&gt;                         Intercept  V1  V2  V3  V4  V5</span></span>
<span><span class="co">#&gt; Not significant                 0  86 509 509   0 487</span></span>
<span><span class="co">#&gt; Significant (10% level)         0  43   0   0   0  22</span></span>
<span><span class="co">#&gt; Significant ( 5% level)         0 153   0   0   0   0</span></span>
<span><span class="co">#&gt; Significant ( 1% level)       509 227   0   0 509   0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Variance parameters----------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spatial effects (coefficients on x):</span></span>
<span><span class="co">#&gt;                      (Intercept)    V1       V2       V3    V4</span></span>
<span><span class="co">#&gt; random_SD                  3.573 0.262 6.97e-05 5.61e-08 0.023</span></span>
<span><span class="co">#&gt; Moran.I/max(Moran.I)       0.927 0.161 8.13e-01 9.95e-01 0.307</span></span>
<span><span class="co">#&gt;                          V5</span></span>
<span><span class="co">#&gt; random_SD            0.0218</span></span>
<span><span class="co">#&gt; Moran.I/max(Moran.I) 0.0556</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ----Error statistics-------------------------------------</span></span>
<span><span class="co">#&gt;                  stat</span></span>
<span><span class="co">#&gt; resid_SE        5.342</span></span>
<span><span class="co">#&gt; adjR2(cond)     0.609</span></span>
<span><span class="co">#&gt; rlogLik     -1665.418</span></span>
<span><span class="co">#&gt; AIC          3368.836</span></span>
<span><span class="co">#&gt; BIC          3449.253</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; NULL model: lm( y ~ x )</span></span>
<span><span class="co">#&gt;    (r)loglik: Inf ( AIC: -Inf,  BIC: -Inf )</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note: AIC and BIC are based on the restricted/marginal likelihood.</span></span>
<span><span class="co">#&gt;       Use method="ml" for comparison of models with different fixed effects (x and xconst)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">resf_vc</span><span class="op">$</span><span class="va">b_vc</span><span class="op">)</span></span>
<span><span class="co">#&gt;   (Intercept)    V1        V2       V3     V4      V5</span></span>
<span><span class="co">#&gt; 1        35.2 0.546 -0.000131 6.92e-05 -0.143 -0.0226</span></span>
<span><span class="co">#&gt; 2        35.3 0.667 -0.000131 6.92e-05 -0.142 -0.0152</span></span>
<span><span class="co">#&gt; 3        35.2 0.372 -0.000131 6.92e-05 -0.146 -0.0298</span></span>
<span><span class="co">#&gt; 4        35.2 0.441 -0.000131 6.92e-05 -0.144 -0.0267</span></span>
<span><span class="co">#&gt; 5        35.2 0.658 -0.000131 6.92e-05 -0.142 -0.0149</span></span>
<span><span class="co">#&gt; 6        35.2 0.478 -0.000131 6.92e-05 -0.141 -0.0241</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-anselin1988" class="csl-entry" role="listitem">
Anselin, Luc. 1988. <em>Spatial Econometrics: Methods and Models</em>. Dordrecht: Kluwer Academic Publisher.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./part-4.html" class="pagination-link" aria-label="Spatial Filtering">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Spatial Filtering</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-ModelKeragamanSpasial.html" class="pagination-link" aria-label="Model Keragaman Spasial">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb12" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Model Dependensi Spasial {#sec-dependensi-model}</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deskripsi</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>Analisis regresi spasial digunakan untuk melakukan pemodelan hubungan antara peubah respon dan prediktor dalam bentuk model regresi dengan mempertimbangkan efek spasial. Efek spasial antar lokasi dapat disebabkan oleh dependensi spasial dan heterogenitas spasial <span class="co">[</span><span class="ot">@anselin1988</span><span class="co">]</span>. Dependensi spasial adalah ketergantungan antara suatu lokasi dengan lokasi di sekitarnya sedangkan heterogenitas spasial adalah perbedaan pengaruh peubah prediktor terhadap respon di lokasi yang diamati. **Eigenvector Spasial Filtering (ESF)** adalah metode untuk mengatasi masalah dependensi spasial dengan menambahkan kombinasi linier dari vektor ciri matriks pembobot spasial pada spesifikasi model regresi (Chun &amp; Griffith, 2014). Eigenvector Spasial Filtering (ESF) dapat mengurangi kesalahan spesifikasi spasial, meningkatkan kesesuaian model, serta kenormalan dan homogenitas ragam sisaan. Metode lain yang dapat mengatasi masalah dependensi spasial adalah **Random Effect Eigenvector Spatial Filtering (RE-ESF)**.</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>Murakami dan Griffith (2015) memperluas Eigenvector Spatial Filtering (ESF) yang merupakan pendekatan efek tetap, ke pendekatan efek acak yaitu Random Effect Eigenvector Spatial Filtering (RE-ESF). Random Effect Eigenvector Spatial Filtering (RE-ESF) mempertimbangkan efek spasial sebagai variabel acak yang bervariasi di antara wilayah-wilayah yang diamati. Hughes dan Haran (2013) membahas kegunaan Random Effect Eigenvector Spatial Filtering (RE-ESF) untuk analisis dependensi spasial yang meminimumkan nilai ragam yang disebabkan oleh faktor acak antara peubah prediktor dan proses spasial laten.</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>Eigenvector Spatial Filtering (ESF) yang juga disebut koordinat utama matriks ketetanggaan (Dray et.al. 2006) atau pemetaan vektor ciri Moran didasarkan pada koefisien Moran (MC). Koefisien Moran untuk vektor peubah acak $y$ didefinisikan sebagai berikut:</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>MC<span class="co">[</span><span class="ot">y</span><span class="co">]</span> = \frac{n}{(1' W1)} \left( y' MWMy \right) / \left( y' My \right) </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1001}</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>dengan $W$ adalah matriks bobot spasial simetris berukuran $n \times n$ dengan diagonal nol, dan $M = (I-11'/n)$ adalah matriks pemusatan. Misalkan dekomposisi eigen matriks $MWM$ sebagai $E^* \Lambda^* E^{*'}$, dengan $E^* = [e_1, \ldots, e_n]$ adalah matriks vektor ciri. $\Lambda^* = \text{diag}(\lambda_1, \ldots, \lambda_n)$ adalah matriks diagonal yang elemennya adalah akar ciri $<span class="sc">\{</span>\lambda_1, \ldots, \lambda_N<span class="sc">\}</span>$. Nilai koefisien Moran untuk hasil vektor ciri ke-$l$ adalah:</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>MC<span class="co">[</span><span class="ot">e_l</span><span class="co">]</span> = \frac{n}{(1' W1)} \left( e_l' MWMye_l \right) / \left( e_l' Me_l \right) = \frac{n}{(1' W1)} \left( e_l' E^* \Lambda^* E^{*'} y e_l \right) / \left( e_l' Me_l \right) = \frac{n}{(1' W1)} \lambda_l</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1002}</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fixed Effect Eigenvector Spatial Filtering (ESF)</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>Kombinasi linier dari akar ciri masih dapat diinterpretasikan dalam istilah MC. Misalkan $E = <span class="co">[</span><span class="ot">e_1, \ldots, e_L</span><span class="co">]</span>$ adalah matriks yang terdiri dari vektor ciri $L (&lt; n)$ di $E^*$, dan $\gamma = <span class="co">[</span><span class="ot">\gamma_1, \ldots, \gamma_L</span><span class="co">]</span>'$ adalah vektor parameter. Model dasar dari ESF adalah:</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>y = X\beta + E\gamma + \varepsilon, \quad \varepsilon \sim N(0, \sigma^2 I) </span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1003}</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>dengan $y$ adalah vektor peubah respon berukuran $n \times 1$, $E$ adalah matriks berukuran $n \times L$ yang terdiri dari subset $L$ ($L &lt; n$) vektor ciri dari $E^*$, $\varepsilon$ adalah vektor galat berukuran $n \times 1$, $\beta$ adalah vektor parameter berukuran $K \times 1$, $\gamma = <span class="co">[</span><span class="ot">\gamma_1, \ldots, \gamma_l, \ldots, \gamma_L</span><span class="co">]</span>'$ adalah vektor parameter berukuran $L \times 1$, $\sigma^2$ adalah parameter ragam, dan $0$ adalah vektor nol berukuran $n \times 1$.</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>Pemilihan $L$ vektor ciri pada $E$ yang signifikan dilakukan menggunakan metode regresi bertatar. @eq-1003 identik dengan model regresi linier standar, sehingga linier standar, pemilihan vektor ciri yang signifikan dapat dilakukan dengan metode pemilihan bertatar dengan menggunakan metode kuadrat terkecil. Penduga parameter $\beta$ dan $\gamma$ sebagai berikut:</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix} \hat{\beta} <span class="sc">\\</span> \hat{\gamma} \end{bmatrix} = \left( X^T X \quad X^T E \quad E^T X \quad I \right)^{-1} </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1004}</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Effect Eigenvector Spatial Filtering (RE-ESF)</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>Berdasarkan Hughes dan Haran (2013), model linier RE-ESF yang didasarkan pada model dengan autoregresif prior bersyarat intrinsik dirumuskan sebagai berikut:</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>y = X\beta + E\gamma + \varepsilon, \quad \gamma \sim N(0, \sigma_{\gamma}^2 \Lambda), \quad \varepsilon \sim N(0, \sigma^2 I) </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1005}</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>dengan $\sigma_{\gamma}^2$ adalah parameter ragam dan $\Lambda$ adalah matriks diagonal berukuran $L \times L$ yang elemennya adalah $L$ pertama akar ciri dari $MWM$, $\gamma_1, \ldots, \gamma_L$, sesuai dengan $L$ vektor ciri di $E$. Persamaan di atas identik dengan model campuran linier (linear mixed model atau LMM). Model campuran linier merupakan perluasan dari model linear yaitu dengan menambahkan efek acak. Metode ini banyak digunakan dalam rancangan percobaan untuk data yang berkorelasi. Bentuk umum model linear campuran adalah</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>y = X\beta + Zu + \varepsilon </span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1006}</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>dengan $X$ adalah matriks desain dari efek tetap yang teramati, $\beta$ adalah vektor parameter pengaruh efek tetap yang tidak diketahui, $Z$ adalah matriks desain efek acak yang teramati, $u$ adalah vektor efek acak yang tidak diketahui, dan $\varepsilon$ vektor galat acak yang tidak diketahui.</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>Hughes dan Haran (2013) memperkenalkan vektor ciri ke dalam $E$ yang akar cirinya lebih besar dari nol. Penduga linear tak bias terbaik (best linear unbiased estimator atau BLUE) dari $\beta$ dan $\gamma$ diperoleh sebagai berikut (Henderson 1975),</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix} \hat{\beta} <span class="sc">\\</span> \hat{\gamma} \end{bmatrix} = \left( X^T X \quad X^T E \quad E^T X \quad I + \frac{\sigma^2}{\sigma_{\gamma}^2} \Lambda^{-1} \right)^{-1} \begin{bmatrix} X^T y <span class="sc">\\</span> E^T y \end{bmatrix} </span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1007}</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>dengan $\Lambda^{-1}$ adalah matriks diagonal berukuran $L \times L$ yang elemennya adalah $1/\lambda_1, \ldots, 1/\lambda_L$. Pada @eq-1007, diagonal ke-$l$ ($l = 1, \ldots, L$) dari $(\sigma^2/(\sigma_{\gamma}^2)) \Lambda^{-1}$, yang diberikan oleh $(\sigma^2/(\sigma_{\gamma}^2)) \gamma_l^{-1}$, menyusutkan koefisien ke-$l$ ($\gamma_l$) menuju nol. Penyusutan ini signifikan untuk vektor eigen yang berhubungan dengan akar ciri yang lebih kecil, $\gamma_l$. Penyusutan seperti itu yang berguna untuk menduga model sambil mempertahankan derajat kebebasan yang konstan (Hodges 2013), memungkinkan menduga model RE-ESF tanpa menerapkan pemilihan vektor ciri bertahap (stepwise eigenvector selection). Ragam dari pendugaan $\beta$ dan $\gamma$ diberikan sebagai berikut:</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>\text{Var}<span class="co">[</span><span class="ot">\hat{\beta}, \hat{\gamma}</span><span class="co">]</span> = \sigma^2 \left( X^T X \quad X^T E \quad E^T X \quad I + \frac{\sigma^2}{\sigma_{\gamma}^2} \Lambda^{-1} \right)^{-1} </span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1008}</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a><span class="fu">### Penduga Parameter Model</span></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>@eq-1007 dapat ditulis sebagai berikut:</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>y = X\beta + EV(\theta)u + \varepsilon, \quad u \sim N(0, \sigma^2 I), \quad \varepsilon \sim N(0, \sigma^2 I) </span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1009}</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>dengan $V(\theta)u = \gamma$ dengan $\theta = \left<span class="sc">\{</span> \left( \frac{\sigma_{\gamma}^2}{\sigma^2} \right), \alpha \right<span class="sc">\}</span>$, dan $V(\theta)$ adalah matriks diagonal berukuran $L \times L$ yang elemen ke-$(l, l)$ adalah $\left( \frac{\sigma_{\gamma}}{\sigma} \right) \lambda_l \sqrt{\alpha}$. Berdasarkan Bates (2010), @eq-1010 identik dengan model linear campuran yang pendugaannya menggunakan metode kemungkinan maksimum (maximum likelihood atau ML) dan kemungkinan maksimum terbatas (restricted maximum likelihood atau REML). Loglikelihood pada @eq-1011 dapat dituliskan sebagai berikut:</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a>\text{log} L(\beta, \theta, \sigma^2) = -\frac{n}{2} \text{log}(2\pi\sigma^2) - \text{log}(|V(\theta)|^2) - \frac{d(\theta)}{\sigma^2} </span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1010}</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>d(\theta) = \lVert y - X\beta + EV(\theta)u \rVert^2 + \lVert u \rVert^2 </span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1011}</span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a>Penduga linear tak bias terbaik dari $\beta$ dan $u$ diperoleh dengan memaksimumkan @eq-1012 sebagai berikut:</span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix} \hat{\beta} <span class="sc">\\</span> \hat{u} \end{bmatrix} = \left( X^T X \quad X^T EV(\theta) \quad V(\theta)E^T X \quad V(\theta)^2 + I \right)^{-1} \begin{bmatrix} X^T y <span class="sc">\\</span> V(\theta)E^T y \end{bmatrix}</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1012}</span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>dengan $V(\theta)^2$ adalah matriks diagonal berukuran $L \times L$ yang elemen ke-$(l, l)$ adalah $\left( \frac{\sigma_{\gamma}^2}{\sigma^2} \right) \gamma_l \alpha$. @eq-1011 identik dengan @eq-1007 dengan penambahan $\alpha$. $\theta$ dapat diduga dengan memaksimumkan @eq-1010. Penduga kemungkinan maksimum dari parameter ragam ($\theta$ dan $\sigma^2$) diketahui berbias (Bates 2010). Oleh karena itu, digunakan pendugaan REML yang memberikan pendugaan parameter ragam yang tidak bias. Residual log-likehood untuk parameter ragam diformulasikan sebagai berikut:</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>\text{log} L_R(\theta, \sigma^2) = \int \text{log} L(\beta, \theta, \sigma^2) d\beta </span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1013}</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>Dengan memaksimumkan @eq-1014, penduga tak bias diperoleh sebagai berikut:</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>\sigma^2 = \frac{\lVert y - X\beta + EV(\theta)u \rVert^2}{(n-K)} \quad (13) </span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1014}</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>Berdasarkan Bates (2010), $\theta$ diduga dengan memaksimumkan profil residual log-likelihood, $\text{log} L_R(\theta)$ yang diturunkan dengan langkah (a) mensubstitusikan @eq-1010 pada @eq-1012 dan menurunkan fungsi $\text{log} L_R(\theta, \sigma^2)$ dan (b) mensubstitusikan @eq-1013 pada $\text{log} L_R(\theta, \sigma^2)$ dan menurunkan fungsi $\text{log} L_R(\theta)$. Hasil fungsi profil residual log-likelihood diberikan sebagai berikut:</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>\text{log} L_R(\theta) = -\frac{1}{2} \text{log} \left| \begin{bmatrix} X^T X &amp; X^T EV(\theta) <span class="sc">\\</span> V(\theta) E^T X &amp; V(\theta)^2 + I \end{bmatrix} \right| - \frac{(n-K)}{2} \left( 1 + \text{log} \left( \frac{2\pi d(\theta)}{(n-K)} \right) \right) </span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1015}</span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>Maksimalisasi @eq-1016 membutuhkan penghitungan determinan pada suku pertama. Beban komputasi dapat diringankan dengan mengurangi jumlah vektor eigen di $E$. Ragam dari $\hat{\beta}$ dan $\hat{\gamma}$ yang diduga adalah sebagai berikut:</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>\text{Var}<span class="co">[</span><span class="ot">\hat{\beta}\hat{u}</span><span class="co">]</span> = \text{Var}<span class="co">[</span><span class="ot">\hat{\beta}V(\theta)\hat{u}</span><span class="co">]</span> = \sigma^2 \left(X'X \quad X'E \atop E'X \quad I + \frac{\sigma^2}{\sigma_{\gamma}^2}\Lambda^{-1} \right)^{-1} \quad \text{(15)}</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>$$ {#eq-1016}</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>dengan $V(\theta)^{-2}$ adalah matriks diagonal berukuran $L \times L$ yang elemen ke-$l$ adalah $\left(\frac{\sigma^2}{\sigma_{\gamma}^2}\right) \lambda_l(\alpha)^{-1}$.</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>Data yang digunakan pada penelitian ini adalah data empiris Stunting per Kabupaten/Kota di Indonesia tahun 2021 dari Badan Pusat Statistika yang terdiri dari 513 Kabupaten/Kota. Data tersebut terdiri dari peubah respon dan peubah penjelas. Peubah-peubah tersebut sebagai berikut: </span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>$$Y = \text{Stunting}$$</span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>$$X_1 = \text{Tingkat Kemiskinan}$$</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>$$X_2 = \text{Akses Layanan Kesehatan}$$</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>$$X_3 = \text{Gizi Ibu Hamil}$$</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>$$X_4 = \text{Akses Sanitasi}$$</span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>$$X_5 = \text{Akses Air Bersih}$$</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tahapan Analisis Data</span></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>Penelitian ini dilakukan dengan langkah-langkah sebagai berikut:</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Melakukan analisis eksplorasi data pada data stunting di Indonesia tahun 2021 untuk melihat gambaran umum setiap peubah yang diamati.</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Melakukan tahap pra-pemrosesan data dengan mengidentifikasi pencilan pada peubah respon dan menanganinya.</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Memodelkan data stunting menggunakan metode Regresi Linier, memeriksa asumsinya, dan mengevaluasi model.</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Memodelkan data stunting menggunakan metode Eigenvector Spatial Filtering (ESF), dengan rincian tahapan sebagai berikut:</span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>    a. Menguji data stunting dengan indeks Moran dan Lagrange-Multiplier</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>    b. Menghitung bobot spasial menggunakan pendekatan matriks invers jarak dan eksponensial.</span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>    c. Memodelkan data stunting menggunakan metode ESF efek tetap (fixed effects) untuk setiap unit spasial.</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>    d. Memodelkan data stunting menggunakan metode ESF efek acak (random effect) dengan asumsi peubah acak berasal dari sebaran normal.</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>    e. Memodelkan data stunting menggunakan metode ESF efek acak dengan pendekatan Varying Coefficient (Random Effect-ESF VC).</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>    f. Melakukan uji hipotesis untuk efek peubah penjelas terhadap peubah respon.</span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>    g. Mengevaluasi model.</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Membandingkan kinerja model Regresi Linier, Fixed Effect-ESF, Random Effect-ESF, dan Random Effect-ESF VC menggunakan nilai Koefisien Determinasi (R-Sqrd) dan Akaike Information Criterion (AIC).</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Menguji kelayakan dari model terbaik.</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tahapan Analisis Data dengan R</span></span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cache=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a><span class="in">library(spdep) # Untuk pemodelan dependensi spasial</span></span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a><span class="in">library(spatialreg) # Untuk pemodelan dependensi spasial</span></span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a><span class="in">library(stats) # Untuk operasi matematis</span></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a><span class="in">library(car) # Untuk menghitung VIF</span></span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a><span class="in">library(nortest) # Untuk uji kenormalan</span></span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a><span class="in">library(sf) # Untuk menginput peta</span></span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2) # Untuk visualisasi data</span></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr) # Untuk mengolah dataframe</span></span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr) # Untuk mengolah dataframe</span></span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse) # Struktur matriks</span></span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a><span class="in">library(lmtest) # Uji model linier</span></span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a><span class="in">library(spmoran) # ESF</span></span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a><span class="in">library(ape)</span></span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a><span class="in">library(fitdistrplus)</span></span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a><span class="in">library(readxl)</span></span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data dan Peta</span></span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a><span class="co">#Input Data</span></span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a>stunting <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/data_stunting_indo.xlsx"</span>)</span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a><span class="co">#Import peta SHP</span></span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>peta <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"data/shp/BATAS KABUPATEN KOTA DESEMBER 2019 DUKCAPIL.shp"</span>)</span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a><span class="fu">### Modifikasi Data</span></span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a><span class="co">#Menggabungkan Data ke file SHP</span></span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a><span class="co">#df = cbind(stunting,KAB_KOTA=shp.jabar$KAB_KOTA)</span></span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>dfix <span class="ot">=</span> <span class="fu">left_join</span>(peta, stunting, <span class="at">by =</span> <span class="st">"KAB_KOTA"</span>)</span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a>dfix <span class="ot">=</span> <span class="fu">na.omit</span>(dfix)</span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>longlat <span class="ot">=</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(dfix<span class="sc">$</span>geometry))</span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a><span class="co">#library("writexl")</span></span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a><span class="co">#write_xlsx(dfix,"datacek.xlsx")</span></span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot Spasial</span></span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a><span class="co">#Pemetaan Kasus Stunting</span></span>
<span id="cb12-220"><a href="#cb12-220" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dfix) <span class="sc">+</span></span>
<span id="cb12-221"><a href="#cb12-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Y)) <span class="sc">+</span></span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(longlat[, <span class="dv">1</span>], longlat[, <span class="dv">2</span>], <span class="at">label =</span> KAB_KOTA), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Stunting di Indonesia"</span>) <span class="sc">+</span></span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Stunting"</span>)</span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bobot Spasial</span></span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a><span class="co">#Bobot Spasial</span></span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(longlat, <span class="at">method =</span> <span class="st">"euclidean"</span>))</span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a><span class="co">#inverse weight matrix</span></span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a>w <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> D</span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a><span class="co"># inverse weight matrix - row-normalized</span></span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(w) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a>rtot <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(w, <span class="at">na.rm =</span> T)</span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a>w_std <span class="ot">&lt;-</span> w <span class="sc">/</span> rtot</span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a>cekrowsum <span class="ot">=</span> <span class="fu">rowSums</span>(w_std, <span class="at">na.rm =</span> T)</span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a>wmoran <span class="ot">=</span> <span class="fu">mat2listw</span>(w_std, <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uji Asumsi</span></span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a><span class="co">#Uji Moran Indeks (Autokorelasi)</span></span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(dfix<span class="sc">$</span>Y, wmoran)</span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a><span class="co"># Uji Breusch-Pagan (Heteroskesdasitas)</span></span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(<span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4 <span class="sc">+</span> X5, <span class="at">data =</span> dfix))</span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-257"><a href="#cb12-257" aria-hidden="true" tabindex="-1"></a><span class="co">#LM Test (Model Spsial)</span></span>
<span id="cb12-258"><a href="#cb12-258" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4 <span class="sc">+</span> X5, <span class="at">data =</span> dfix)</span>
<span id="cb12-259"><a href="#cb12-259" aria-hidden="true" tabindex="-1"></a>LM <span class="ot">&lt;-</span> <span class="fu">lm.LMtests</span>(model, wmoran, <span class="at">test =</span> <span class="fu">c</span>(<span class="st">'LMerr'</span>, <span class="st">'LMlag'</span>, <span class="st">'RLMerr'</span>, <span class="st">'RLMlag'</span>))</span>
<span id="cb12-260"><a href="#cb12-260" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LM)</span>
<span id="cb12-261"><a href="#cb12-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-262"><a href="#cb12-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-263"><a href="#cb12-263" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fixed ESF</span></span>
<span id="cb12-264"><a href="#cb12-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-267"><a href="#cb12-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-268"><a href="#cb12-268" aria-hidden="true" tabindex="-1"></a><span class="co">#ESF Fixed</span></span>
<span id="cb12-269"><a href="#cb12-269" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> dfix<span class="sc">$</span>Y</span>
<span id="cb12-270"><a href="#cb12-270" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(dfix<span class="sc">$</span>X1, dfix<span class="sc">$</span>X2, dfix<span class="sc">$</span>X3, dfix<span class="sc">$</span>X4, dfix<span class="sc">$</span>X5), <span class="fu">nrow</span>(dfix), <span class="dv">5</span>)</span>
<span id="cb12-271"><a href="#cb12-271" aria-hidden="true" tabindex="-1"></a>meig <span class="ot">&lt;-</span> <span class="fu">meigen</span>(<span class="at">cmat =</span> w)</span>
<span id="cb12-272"><a href="#cb12-272" aria-hidden="true" tabindex="-1"></a>esf <span class="ot">&lt;-</span> <span class="fu">esf</span>(<span class="at">y =</span> Y, <span class="at">x =</span> X, <span class="at">meig =</span> meig)</span>
<span id="cb12-273"><a href="#cb12-273" aria-hidden="true" tabindex="-1"></a>esf</span>
<span id="cb12-274"><a href="#cb12-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-275"><a href="#cb12-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-276"><a href="#cb12-276" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Effect-ESF</span></span>
<span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a><span class="co">#ESF Random</span></span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> dfix<span class="sc">$</span>Y</span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(dfix<span class="sc">$</span>X1, dfix<span class="sc">$</span>X2, dfix<span class="sc">$</span>X3, dfix<span class="sc">$</span>X4, dfix<span class="sc">$</span>X5), <span class="fu">nrow</span>(dfix), <span class="dv">5</span>)</span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a>meig <span class="ot">&lt;-</span> <span class="fu">meigen</span>(<span class="at">cmat =</span> w)</span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a>resf <span class="ot">&lt;-</span> <span class="fu">resf</span>(<span class="at">y =</span> Y, <span class="at">x =</span> X, <span class="at">meig =</span> meig)</span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a>resf</span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-288"><a href="#cb12-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-289"><a href="#cb12-289" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Effect ESF - VC</span></span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-293"><a href="#cb12-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a><span class="co">#ESF VC</span></span>
<span id="cb12-295"><a href="#cb12-295" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> dfix<span class="sc">$</span>Y</span>
<span id="cb12-296"><a href="#cb12-296" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(dfix<span class="sc">$</span>X1, dfix<span class="sc">$</span>X2, dfix<span class="sc">$</span>X3, dfix<span class="sc">$</span>X4, dfix<span class="sc">$</span>X5), <span class="fu">nrow</span>(dfix), <span class="dv">5</span>)</span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a>meig <span class="ot">&lt;-</span> <span class="fu">meigen</span>(<span class="at">coords =</span> longlat)</span>
<span id="cb12-298"><a href="#cb12-298" aria-hidden="true" tabindex="-1"></a>resf_vc <span class="ot">&lt;-</span> <span class="fu">resf_vc</span>(<span class="at">y =</span> Y,</span>
<span id="cb12-299"><a href="#cb12-299" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> X,</span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a>                   <span class="at">meig =</span> meig,</span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x_sel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-307"><a href="#cb12-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-308"><a href="#cb12-308" aria-hidden="true" tabindex="-1"></a>resf_vc</span>
<span id="cb12-309"><a href="#cb12-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-310"><a href="#cb12-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-311"><a href="#cb12-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-314"><a href="#cb12-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-315"><a href="#cb12-315" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resf_vc<span class="sc">$</span>b_vc)</span>
<span id="cb12-316"><a href="#cb12-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>