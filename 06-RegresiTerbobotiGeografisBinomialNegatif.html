<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Pemodelan Statistika pada Data Geospasial - 6&nbsp; Regresi Terboboti Geografis Binomial Negatif</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./part-3.html" rel="next">
<link href="./05-RegresiTerbobotiGeografisCampuran.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-2.html">Model Keragaman Spasial</a></li><li class="breadcrumb-item"><a href="./06-RegresiTerbobotiGeografisBinomialNegatif.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Binomial Negatif</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Pemodelan Statistika pada Data Geospasial</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Kata Pengantar</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pendahuluan</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Dependensi Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-SpasialAutoRegresifModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-SpasialDurbinModel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Spasial Durbin Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-SpasialAutoRegresifBinomialNegatif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Spasial Autoregresif Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Keragaman Spasial</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-RegresiTerbobotiGeografis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-RegresiTerbobotiGeografisCampuran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Campuran</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-RegresiTerbobotiGeografisBinomialNegatif.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Binomial Negatif</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mixed SAR-GWR</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-MetodeAnalisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Metode Analisis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-TahapanR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Tahapan Analisis dengan R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./part-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Spatial Filtering</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-ModelDependensiSpasial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Dependensi Spasial</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-ModelKeragamanSpasial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Keragaman Spasial</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ModelEpidemiologi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model Epidemiologi</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Lampiran</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Daftar isi</h2>
   
  <ul>
<li><a href="#deskripsi" id="toc-deskripsi" class="nav-link active" data-scroll-target="#deskripsi"><span class="header-section-number">6.1</span> Deskripsi</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">6.2</span> Data</a></li>
  <li><a href="#metode-analisis" id="toc-metode-analisis" class="nav-link" data-scroll-target="#metode-analisis"><span class="header-section-number">6.3</span> Metode Analisis</a></li>
  <li>
<a href="#tahapan-analisis-data-dengan-r" id="toc-tahapan-analisis-data-dengan-r" class="nav-link" data-scroll-target="#tahapan-analisis-data-dengan-r"><span class="header-section-number">6.4</span> Tahapan Analisis Data dengan R</a>
  <ul class="collapse">
<li><a href="#package" id="toc-package" class="nav-link" data-scroll-target="#package">Package</a></li>
  <li><a href="#input-data" id="toc-input-data" class="nav-link" data-scroll-target="#input-data">Input Data</a></li>
  <li><a href="#eksplorasi-data" id="toc-eksplorasi-data" class="nav-link" data-scroll-target="#eksplorasi-data">Eksplorasi Data</a></li>
  <li><a href="#uji-efek-spasial" id="toc-uji-efek-spasial" class="nav-link" data-scroll-target="#uji-efek-spasial">Uji efek spasial</a></li>
  <li><a href="#menduga-model-rtbng" id="toc-menduga-model-rtbng" class="nav-link" data-scroll-target="#menduga-model-rtbng">Menduga model RTBNG</a></li>
  <li><a href="#interpretasi" id="toc-interpretasi" class="nav-link" data-scroll-target="#interpretasi">Interpretasi</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./part-2.html">Model Keragaman Spasial</a></li><li class="breadcrumb-item"><a href="./06-RegresiTerbobotiGeografisBinomialNegatif.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Binomial Negatif</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Binomial Negatif</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="deskripsi" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="deskripsi">
<span class="header-section-number">6.1</span> Deskripsi</h2>
<p>Regresi Terboboti Geografis Binomial Negatif (RTGBN) merupakan pengembangan dari model regresi binomial negatif. Model RTGBN adalah salah satu metode yang cukup efektif menduga data yang memiliki ketergantungan spasial untuk data cacah yang memiliki overdispersi. Model ini akan menghasilkan pendugaan parameter lokal dengan masing-masing lokasi akan memiliki parameter yang berbeda [silva2014].</p>
<p>Model RTGBN dapat dirumuskan sebagai berikut:</p>
<p><span class="math inline">\(y_i \sim \text{BN}\left(\exp\left(\sum_j \beta_j(u_i,v_i) x_{ij} \theta_i(u_i,v_i)\right)\right) \quad (6.6.1)\)</span></p>
<p>dengan <span class="math inline">\(y_i\)</span> adalah nilai amatan respon ke-i, <span class="math inline">\(x_{ij}\)</span> adalah nilai amatan prediktor ke-j pada pengamatan, <span class="math inline">\((u_i, v_i)\)</span> adalah logitude dan latitude lokasi-i, <span class="math inline">\(\beta_j(u_i, v_i)\)</span> adalah parameter regresi prediktor ke-j untuk setiap lokasi-i, dan <span class="math inline">\(\theta_i(u_i, v_i)\)</span> adalah parameter dispersi setiap lokasi-<span class="math inline">\(i\)</span>.</p>
<p>Pendugaan model RTG-BN menggunakan metode kemungkinan maksimum. Langkah awal dari metode kemungkinan adalah membentuk fungsi kemungkinan sebagai berikut <span class="citation" data-cites="ricardo2013">(<a href="references.html#ref-ricardo2013" role="doc-biblioref">Ricardo A 2013</a>)</span>:</p>
<span class="math display">\[\begin{aligned}
L(\beta(u_i, v_i), \theta_i, i=1,2,\ldots,n) = \prod_{i=1}^{n} \left(\prod_{r=0}^{y_i-1} (r + \frac{1}{\theta_i})\right) \frac{1}{y_i!} \left(\frac{1}{1 + \theta_i \mu_i}\right)^{\frac{1}{\theta_i}} \left(\frac{\theta_i \mu_i}{1 + \theta_i \mu_i}\right)^{y_i}
\end{aligned}\]</span>
<p>Pengujian parameter model RTGBN terdiri dari uji serentak dan parsial. Uji signifikansi serentak menggunakan uji rasio kemungkinan maksimum (MLRT) dengan hipotesis sebagai berikut.</p>
<span class="math display">\[\begin{aligned}
H_0: &amp; \ \beta_1(u_i,v_i) = \beta_2(u_i,v_i) = \ldots = \beta_p(u_i,v_i) = 0 \\
H_1: &amp; \ \text{Minimal ada satu } \beta_j(u_i,v_i) \neq 0, \ j=1,2,\ldots ,p
\end{aligned}\]</span>
<p>dengan statistik ujinya yaitu:</p>
<p><span class="math inline">\(D(\hat{\beta}) = -2 \ln\left[\frac{L(\hat{\omega})}{L(\hat{\Omega})}\right] = 2\left[\ln(L(\hat{\Omega})) - \ln(L(\hat{\omega}))\right]\)</span></p>
<p>Keputusannya adalah tolak <span class="math inline">\(H_0\)</span> jika $D() &gt; ^2_{p,} $ dengan <span class="math inline">\(p\)</span> adalah banyaknya parameter. Tolak <span class="math inline">\(H_0\)</span> artinya minimal ada satu peubah yang berpengaruh signifikan terhadap model sehingga dilanjutkan dengan pengujian parsial.</p>
<p>Hipotesis yang digunakan untuk pengujian parameter secara parsial. Berikut hipotesis yang digunakan untuk pengujian parameter secara parsial:</p>
<span class="math display">\[\begin{aligned}
H_0: &amp; \ \beta_j(u_i,v_i) = 0 \\
H_1: &amp; \ \beta_j(u_i,v_i) \neq 0
\end{aligned}\]</span>
<p>dengan statistik ujinya dinyatakan dalam formula berikut:</p>
<p><span class="math inline">\(Z = \frac{\hat{\beta}_j(u_i,v_i)}{\text{se}(\hat{\beta}_j(u_i,v_i))} \sim \mathcal{N}(0,1)\)</span></p>
<p>dengan <span class="math inline">\(\hat{\beta}_j(u_i,v_i)\)</span> merupakan penduga parameter koefisien regresi prediktor ke-j pada lokasi ke-i dan <span class="math inline">\(\text{se}(\hat{\beta}_j)\)</span> adalah galat baku penduga parameter koefisien regresi prediktor ke-j pada lokasi ke-i. Keputusan adalah tolak <span class="math inline">\(H_0\)</span> jika <span class="math inline">\(|z_{\text{hit}}| &gt; z_{\alpha/2}\)</span></p>
</section><section id="data" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="data">
<span class="header-section-number">6.2</span> Data</h2>
<p>Ilustrasi untuk model RTG-BN merujuk hasil penelitian <span class="citation" data-cites="fadila2021">Fadila A (<a href="references.html#ref-fadila2021" role="doc-biblioref">2021</a>)</span> tentang Tuberkulosis (TB) di Jawa Timur. Data yang digunakan merupakan data sekunder yang yang diperoleh dari Statistik Kesehatan Provinsi Jawa Timur 2019 yang dikeluarkan oleh Badan Pusat Statistik Jawa Timur, Profil Kesehatan Jawa Timur tahun 2018 dan Profil Kesehatan Jawa Timur tahun 2019 yang dikeluarkan oleh dinas kesehatan Provinsi Jawa Timur. Data yang digunakan mencakup jumlah kasus tuberkulosis dan enam peubah lainnya yang diduga berpengaruh terhadap kasus tuberkulosis (<a href="#tbl-tbc" class="quarto-xref">Tabel&nbsp;<span>6.1</span></a>). Unit amatan adalah 38 kabupaten/kota yang berada di Provinsi Jawa Timur. Data dan peta ilustrasi RTG-BN tersedia pada tautan <a href="https://ipb.link/gwr-binomial-negatif">https://ipb.link/gwr-binomial-negatif</a>.</p>
<div id="tbl-tbc" class="striped hover quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabel&nbsp;6.1: Tabel Peubah dan Referensi
</figcaption><div aria-describedby="tbl-tbc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped table-hover table">
<colgroup>
<col style="width: 10%">
<col style="width: 61%">
<col style="width: 28%">
</colgroup>
<thead><tr class="header">
<th>Kode</th>
<th>Peubah</th>
<th>Referensi</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(Y\)</span></td>
<td>Angka Tuberkulosis per 100.000 penduduk</td>
<td>-</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X_1\)</span></td>
<td>Persentase rumah tangga dengan akses sanitasi layak &amp; Nisa’</td>
<td>Budiantara (2016)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X_2\)</span></td>
<td>Persentase tempat pengolahan makanan (TPM) sehat</td>
<td>Lestari et al.&nbsp;(2014)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X_3\)</span></td>
<td>Persentase rumah tangga ber-PHBS &amp; Nisa’</td>
<td>Budiantara (2016)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X_4\)</span></td>
<td>Persentase rumah sehat</td>
<td>Lestari et al.&nbsp;(2014)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X_5\)</span></td>
<td>Rata-rata konsumsi batang rokok per minggu</td>
<td>Tandang et al.&nbsp;(2018)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(X_6\)</span></td>
<td>Persentase pengobatan lengkap kasus Tuberkulosis</td>
<td>Sarani (2019)</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section><section id="metode-analisis" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="metode-analisis">
<span class="header-section-number">6.3</span> Metode Analisis</h2>
<p>Tahapan untuk menganalisis data jumlah kasus TB di Provinsi Jawa Timur tahun 2019 dengan pendekatan RTG-BN adalah sebagai berikut:</p>
<ol type="1">
<li><p>Melakukan eksplorasi data untuk mengetahui gambaran awal data jumlah kasus TB pada balita di Provinsi Jawa Timur tahun 2019.</p></li>
<li><p>Membuat peta sebaran dari setiap peubah respon dan prediktor yang digunakan.</p></li>
<li><p>Memeriksa adanya multikolinearitas antar prediktor dengan menggunakan Variance Inflation Factor (VIF), jika nilai <span class="math inline">\(VIF_i &gt; 10\)</span>, maka terdapat multikolinear <span class="citation" data-cites="kutner2005">(<a href="references.html#ref-kutner2005" role="doc-biblioref">Kutner MH 2005</a>)</span>:</p></li>
</ol>
<p><span class="math inline">\(VIF_i = \frac{1}{1 - R_i^2}\)</span></p>
<p>dengan <span class="math inline">\(R_i^2\)</span> adalah koefisien determinasi antara <span class="math inline">\(X_i\)</span> dengan prediktor lainnya. Prediktor yang memiliki nilai <span class="math inline">\(VIF_i &gt; 10\)</span> tidak diikutsertakan dalam penyusunan model.</p>
<ol start="4" type="1">
<li>Memeriksa overdispersi Regresi Poisson memiliki asumsi equidispersi, artinya nilai rataan dan ragam pada peubah <span class="math inline">\(Y\)</span> bernilai sama. Penyimpangan asumsi yang sering terjadi pada regresi Poisson yaitu overdispersi, yaitu nilai ragam lebih besar dari pada nilai rataan pada peubah <span class="math inline">\(Y\)</span>. Pengujian overdispersi menggunakan nilai devians dan Khi-kuadrat Pearson yang dibagi dengan derajat bebasnya. Hipotesis yang diuji sebagai berikut:</li>
</ol>
<p>[H_0: ] [H_1: ]</p>
<ul>
<li>Statistik Uji Devians:</li>
</ul>
<p><span class="math inline">\(\[D^2 = 2\sum_{i=1}^n \left( y_i \ln\left(\frac{y_i}{\hat{\mu}_i}\right) - (y_i - \hat{\mu}_i) \right)\]\)</span> <span class="math inline">\(\[\phi_1 = \frac{D^2}{db}\]\)</span></p>
<p>dengan <span class="math inline">\(db = n - k\)</span> dengan <span class="math inline">\(k\)</span> merupakan banyaknya parameter (termasuk konstanta) model regresi Poisson, <span class="math inline">\(n\)</span> merupakan banyaknya amatan, dan <span class="math inline">\(D^2\)</span> adalah nilai Devians.</p>
<ul>
<li>Khi-kuadrat Pearson:</li>
</ul>
<p><span class="math inline">\(\chi^2 = 2\sum_{i=1}^n \frac{(y_i - \mu_i)^2}{\text{var}(y_i)}\)</span> <span class="math inline">\(\phi_2 = \frac{\chi^2}{db}\)</span></p>
<p>dengan <span class="math inline">\(db = n - k\)</span> dengan <span class="math inline">\(k\)</span> merupakan banyaknya parameter termasuk konstanta, <span class="math inline">\(n\)</span> merupakan banyaknya pengamatan, dan <span class="math inline">\(\chi^2\)</span> adalah nilai Khi-kuadrat Pearson.</p>
<p>Jika <span class="math inline">\(\phi_1\)</span> atau <span class="math inline">\(\phi_2\)</span> bernilai lebih dari 1 maka terjadi overdispersi pada data. Jika tidak terdapat overdispersi maka model yang digunakan adalah model regresi Poisson, sedangkan jika terdapat overdispersi lebih cocok menggunakan model regresi binomial negatif.</p>
<ol start="5" type="1">
<li>
<p>Melakukan uji efek spasial yaitu:</p>
<ul>
<li>Uji dependensi spasial dengan uji LM dan Robust LM</li>
<li>Uji heterogenitas spasial menggunakan uji Breusch Pagan</li>
</ul>
</li>
<li><p>Menduga model regresi spasial sesuai hasil uji butir (2) dan (3). Memilih model terbaik dengan kriteria AIC.</p></li>
<li>
<p>Pemilihan model terbaik menggunakan Kriteria Informasi Akaike dengan rumus sebagai berikut:</p>
<p><span class="math inline">\(AIC = -2\log_e(L(\hat{\theta}|\text{data})) + 2K\)</span></p>
<p>dengan <span class="math inline">\(\log_e(L(\hat{\theta}|\text{data}))\)</span> adalah nilai maksimum pendugaan kemungkinan maksimum, <span class="math inline">\(\theta\)</span> adalah parameter yang tidak diketahui, <span class="math inline">\(K\)</span> adalah banyaknya parameter yang diestimasi, dan <span class="math inline">\(n\)</span> adalah banyaknya pengamatan.</p>
</li>
</ol></section><section id="tahapan-analisis-data-dengan-r" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="tahapan-analisis-data-dengan-r">
<span class="header-section-number">6.4</span> Tahapan Analisis Data dengan R</h2>
<p>Tahap awal dalam pemodelan menggunakan R Studio adalah melakukan input data dan install package sesuai kebutuhan dalam analisis. Package diperlukan adalah:</p>
<section id="package" class="level3"><h3 class="anchored" data-anchor-id="package">Package</h3>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span>         <span class="co"># Untuk menghitung nilai VIF</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/classInt/">classInt</a></span><span class="op">)</span>        <span class="co"># Untuk membuat selang nilai</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>         <span class="co"># Untuk visualisasi data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span>      <span class="co"># Untuk pengujian asumsi</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/">spdep</a></span><span class="op">)</span>       <span class="co"># Untuk dependensi spasial</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edzer/sp/">sp</a></span><span class="op">)</span>      <span class="co"># Untuk membentuk GWR model</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rsbivand/spgwr/">spgwr</a></span><span class="op">)</span>       <span class="co"># Untuk membentuk GWNBR</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">AER</span><span class="op">)</span>         <span class="co"># Untuk uji dispersi</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>        <span class="co"># Untuk mengoptimasi parameter binomial</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>       <span class="co"># Untuk meringkas data koefisien</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="input-data" class="level3"><h3 class="anchored" data-anchor-id="input-data">Input Data</h3>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Set Lokasi File</span></span>
<span><span class="co"># Input Data</span></span>
<span><span class="va">gabung</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">'data/gabung.RDS'</span><span class="op">)</span></span>
<span><span class="va">tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'data/tb_jatim.csv'</span><span class="op">)</span></span>
<span><span class="va">tb</span><span class="op">$</span><span class="va">KABUPATEN..KOTA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">toupper</a></span><span class="op">(</span><span class="va">tb</span><span class="op">$</span><span class="va">KABUPATEN..KOTA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Input peta SHP</span></span>
<span><span class="va">jatim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html">read_sf</a></span><span class="op">(</span><span class="st">"data/shp/TB Jatim.shp"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/s2.html">sf_use_s2</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Spherical geometry (s2) switched off</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Y'</span>, <span class="st">'X1'</span>, <span class="st">'X2'</span>, <span class="st">'X3'</span>, <span class="st">'X4'</span>, <span class="st">'X5'</span>, <span class="st">'X6'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">longlat</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html">st_coordinates</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html">st_centroid</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: st_centroid assumes attributes are constant over</span></span>
<span><span class="co">#&gt; geometries</span></span>
<span><span class="co">#&gt; Warning in st_centroid.sfc(st_geometry(x), of_largest_polygon =</span></span>
<span><span class="co">#&gt; of_largest_polygon): st_centroid does not give correct centroids</span></span>
<span><span class="co">#&gt; for longitude/latitude data</span></span>
<span></span>
<span><span class="va">jatim</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">jatim</span><span class="op">$</span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">$</span><span class="va">X1</span><span class="op">)</span></span>
<span><span class="va">jatim</span><span class="op">$</span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">$</span><span class="va">X2</span><span class="op">)</span></span>
<span><span class="va">jatim</span><span class="op">$</span><span class="va">X3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">$</span><span class="va">X3</span><span class="op">)</span></span>
<span><span class="va">jatim</span><span class="op">$</span><span class="va">X4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">$</span><span class="va">X4</span><span class="op">)</span></span>
<span><span class="va">jatim</span><span class="op">$</span><span class="va">X5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">$</span><span class="va">X5</span><span class="op">)</span></span>
<span><span class="va">jatim</span><span class="op">$</span><span class="va">X6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">$</span><span class="va">X6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 8 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY, XYZ</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: 111 ymin: -8.38 xmax: 112 ymax: -7.59</span></span>
<span><span class="co">#&gt; z_range:       zmin: 0 zmax: 0</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 9</span></span>
<span><span class="co">#&gt;   KABKOT          Y    X1    X2    X3    X4    X5    X6</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Pacitan        66  91.3  35    44    76.4  58    46.7</span></span>
<span><span class="co">#&gt; 2 Ponorogo      133  95.1  56.4  66.8  79.7  55.6  56.3</span></span>
<span><span class="co">#&gt; 3 Trenggalek     80 100    84.4  42.4  81.2  59.4  70.2</span></span>
<span><span class="co">#&gt; 4 Tulungagung   119  97.3  78    43    78.8  66.1  56.5</span></span>
<span><span class="co">#&gt; 5 Blitar         74  97.6  63.5  62    69.9  63.5  49.9</span></span>
<span><span class="co">#&gt; 6 Kediri        120  88.6  13.2  49.6  78.7  80.9  52.3</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: geometry &lt;MULTIPOLYGON [°]&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="eksplorasi-data" class="level3"><h3 class="anchored" data-anchor-id="eksplorasi-data">Eksplorasi Data</h3>
<ol type="a">
<li>Peta sebaran</li>
</ol>
<p>Berikut syntax yang dapat digunakan untuk membuat peta sebaran (<a href="#fig-plot-tb" class="quarto-xref">Gambar&nbsp;<span>6.1</span></a>):</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Menentukan batas kelas dari angka TB per 100000 penduduk</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/classInt/reference/classIntervals.html">classIntervals</a></span><span class="op">(</span><span class="va">gabung</span><span class="op">$</span><span class="va">y</span>, n <span class="op">=</span> <span class="fl">4</span>, style <span class="op">=</span> <span class="st">'kmeans'</span><span class="op">)</span></span>
<span><span class="co">#&gt; style: kmeans</span></span>
<span><span class="co">#&gt;   one of 497,640 possible partitions of this variable into 4 classes</span></span>
<span><span class="co">#&gt; [5.83,20.6) [20.6,35.1) [35.1,50.2) [50.2,79.8] </span></span>
<span><span class="co">#&gt;          28          52          49          22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Membuat peta</span></span>
<span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'#fbb4b9'</span>, <span class="st">'#f768a1'</span>, <span class="st">'#ae017e'</span>, <span class="st">'#551c53'</span><span class="op">)</span></span>
<span><span class="va">plot.tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_zm.html">st_zm</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">Y</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">65</span>, <span class="fl">104.5</span>, <span class="fl">153.5</span>, <span class="fl">225.5</span>,</span>
<span>         <span class="fl">401</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">0.1</span>, col <span class="op">=</span><span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span><span class="st">"TB"</span>, values <span class="op">=</span> <span class="va">cc</span>,</span>
<span>         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"66 - 104.5"</span>, <span class="st">"104.5 - 153.5"</span>,</span>
<span>         <span class="st">"153.5 - 225.5"</span>, <span class="st">"225.5 - 401"</span><span class="op">)</span>,</span>
<span>         guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">plot.tb</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plot-tb" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-plot-tb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="06-RegresiTerbobotiGeografisBinomialNegatif_files/figure-html/fig-plot-tb-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plot-tb-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Gambar&nbsp;6.1: Peta kasus TB
</figcaption></figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li>VIF</li>
</ol>
<p>VIF dihitung menggunakan syntax berikut ini:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#VIF</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">X5</span> <span class="op">+</span> <span class="va">X6</span>, </span>
<span>            data <span class="op">=</span> <span class="va">jatim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/vif.html">vif</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    [,1]</span></span>
<span><span class="co">#&gt; X1 1.53</span></span>
<span><span class="co">#&gt; X2 1.18</span></span>
<span><span class="co">#&gt; X3 1.25</span></span>
<span><span class="co">#&gt; X4 1.54</span></span>
<span><span class="co">#&gt; X5 1.46</span></span>
<span><span class="co">#&gt; X6 1.55</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Berdasarkan nilai VIF, seluruh peubah memiliki nilai VIF &lt; 10 sehingga dapat disimpulkan tidak terdapat multikolinearitas.</p>
</section><section id="uji-efek-spasial" class="level3"><h3 class="anchored" data-anchor-id="uji-efek-spasial">Uji efek spasial</h3>
<ol type="a">
<li>Indeks Moran</li>
</ol>
<p>Untuk mengetahui efek dependensi spasial pada model regresi dengan respon ln(Y) dengan 6 (enam) prediktor (X1 sampai X6) digunakan uji Lagrange multiplier dengan syntax sebagai berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Uji Lagrange Multiplier</span></span>
<span><span class="va">queenl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/poly2nb.html">poly2nb</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_zm.html">st_zm</a></span><span class="op">(</span><span class="va">jatim</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; although coordinates are longitude/latitude, st_intersects assumes</span></span>
<span><span class="co">#&gt; that they are planar</span></span>
<span><span class="va">queenl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html">nb2listw</a></span><span class="op">(</span><span class="va">queenl</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/lm.RStests.html">lm.LMtests</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">queenl</span>, zero.policy <span class="op">=</span> <span class="cn">T</span>,</span>
<span>        test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'LMlag'</span>, <span class="st">'LMerr'</span>, <span class="st">'RLMlag'</span>, <span class="st">'RLMerr'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Please update scripts to use lm.RStests in place of lm.LMtests</span></span>
<span><span class="co">#&gt;  Rao's score (a.k.a Lagrange multiplier) diagnostics for</span></span>
<span><span class="co">#&gt;  spatial dependence</span></span>
<span><span class="co">#&gt; data:  </span></span>
<span><span class="co">#&gt; model: lm(formula = log(Y) ~ X1 + X2 + X3 + X4 + X5 + X6,</span></span>
<span><span class="co">#&gt; data = jatim)</span></span>
<span><span class="co">#&gt; test weights: listw</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;          statistic parameter p.value</span></span>
<span><span class="co">#&gt; RSerr        0.764         1    0.38</span></span>
<span><span class="co">#&gt; RSlag        0.368         1    0.54</span></span>
<span><span class="co">#&gt; adjRSerr     0.756         1    0.38</span></span>
<span><span class="co">#&gt; adjRSlag     0.360         1    0.55</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pada output di atas terlihat semua uji LM dan RLM mempunyai p-value &gt; α=0.05, sehingga tidak terdapat dependensi spasial pada ln(Y) dan sisaan.</p>
<ol start="2" type="a">
<li>Uji Breusch-Pagan</li>
</ol>
<p>Efek keragaman spasial diuji dengan uji Breusch-Pagan dengan syntax berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Model log(Y)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  studentized Breusch-Pagan test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  model</span></span>
<span><span class="co">#&gt; BP = 15, df = 6, p-value = 0.02</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hasil uji Breusch-Pagan untuk data ini menghasilkan p-value &lt; α=0.05 yang berarti terdapat heterogenitas spasial.</p>
<ol start="3" type="a">
<li>Uji Overdispersi</li>
</ol>
<p>Untuk melakukan uji dispersi menggunakan syntax sebagai berikut:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Model Regresi Poisson</span></span>
<span><span class="va">poisson</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>,data<span class="op">=</span><span class="va">jatim</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#Nilai Deviance</span></span>
<span><span class="va">dv_df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html">deviance</a></span><span class="op">(</span><span class="va">poisson</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">poisson</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#Nilai Chi-Squares</span></span>
<span><span class="va">pr_df</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">poisson</span>,<span class="st">"pearson"</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">poisson</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#Overdispersi</span></span>
<span><span class="va">overdis</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span><span class="va">dv_df</span>,<span class="va">pr_df</span><span class="op">)</span></span>
<span><span class="va">overdis</span></span>
<span><span class="co">#&gt;   dv_df pr_df</span></span>
<span><span class="co">#&gt; 1  28.7  28.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Kedua nilai statistik uji overdispersi bernilai lebih besar dari satu, maka pada data TB terdapat overdispersi. Untuk menangani overdispersi pada data TB digunakan model regresi binomial negatif.</p>
</section><section id="menduga-model-rtbng" class="level3"><h3 class="anchored" data-anchor-id="menduga-model-rtbng">Menduga model RTBNG</h3>
<ol type="a">
<li>RTBNG Fixed Gaussian</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Menentukan bandwidth</span></span>
<span><span class="va">bdwt.gauss.fixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rsbivand.github.io/spgwr/reference/ggwr.sel.html">ggwr.sel</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>, data <span class="op">=</span> <span class="va">jatim</span>, coords<span class="op">=</span><span class="va">longlat</span>, adapt <span class="op">=</span> <span class="cn">F</span>, gweight <span class="op">=</span> <span class="va">gwr.Gauss</span><span class="op">)</span></span>
<span><span class="co">#&gt; Bandwidth: 1.35 CV score: 249084 </span></span>
<span><span class="co">#&gt; Bandwidth: 2.18 CV score: 243025 </span></span>
<span><span class="co">#&gt; Bandwidth: 2.7 CV score: 241754 </span></span>
<span><span class="co">#&gt; Bandwidth: 2.79 CV score: 241604 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.07 CV score: 241207 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.25 CV score: 241013 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.36 CV score: 240908 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.42 CV score: 240848 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.46 CV score: 240813 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.49 CV score: 240792 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.51 CV score: 240779 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.52 CV score: 240771 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.52 CV score: 240767 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240764 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240762 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240761 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240760 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240760 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240759 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240759 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240759 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240759 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240759 </span></span>
<span><span class="co">#&gt; Bandwidth: 3.53 CV score: 240759</span></span>
<span></span>
<span><span class="co">#Optimasi Parameter Theta Binomial Negatif</span></span>
<span><span class="va">aicvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">gwnbr.gauss.fixed</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu">spgwr</span><span class="fu">::</span><span class="fu"><a href="https://rsbivand.github.io/spgwr/reference/ggwr.html">ggwr</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span></span>
<span>                       <span class="op">+</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span> <span class="op">+</span> <span class="va">X5</span> <span class="op">+</span> <span class="va">X6</span>, data <span class="op">=</span> <span class="va">jatim</span>,</span>
<span>                       coords<span class="op">=</span><span class="va">longlat</span>, bandwidth <span class="op">=</span></span>
<span>                       <span class="va">bdwt.gauss.fixed</span>, gweight <span class="op">=</span></span>
<span>                       <span class="va">gwr.Gauss</span>, family <span class="op">=</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html">negative.binomial</a></span><span class="op">(</span>theta<span class="op">=</span> <span class="va">i</span>, link</span>
<span>                       <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span>, warning<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="va">w</span><span class="op">)</span></span>
<span>  <span class="va">aicvec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/is.html">is</a></span><span class="op">(</span><span class="va">gwnbr.gauss.fixed</span>, <span class="st">'warning'</span><span class="op">)</span>,</span>
<span>                      <span class="st">"not converge"</span>,</span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">gwnbr.gauss.fixed</span><span class="op">$</span><span class="va">lm</span><span class="op">$</span><span class="va">aic</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">aicvec</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]  482  434  453</span></span>
<span><span class="co">#&gt;  [2,]  457  435  455</span></span>
<span><span class="co">#&gt;  [3,]  446  436  457</span></span>
<span><span class="co">#&gt;  [4,]  440  438  460</span></span>
<span><span class="co">#&gt;  [5,]  436  440  462</span></span>
<span><span class="co">#&gt;  [6,]  434  442  465</span></span>
<span><span class="co">#&gt;  [7,]  432  444  467</span></span>
<span><span class="co">#&gt;  [8,]  432  446  470</span></span>
<span><span class="co">#&gt;  [9,]  432  448  472</span></span>
<span><span class="co">#&gt; [10,]  433  450  475</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="va">aicvec</span>, xlab <span class="op">=</span> <span class="st">'theta'</span>,  ylab <span class="op">=</span> <span class="st">'AIC'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="06-RegresiTerbobotiGeografisBinomialNegatif_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Dalam ilustrasi ini, dilakukan optimasi parameter theta pada sebaran binomial negatif yang digunakan. Berdasarkan pemodelan RTBNG dengan nilai theta 1 sampai 30 menghasilkan algoritma yang konvergen. Nilai AIC terkecil pada theta 8 senilai 431.98. Oleh karena itu, untuk pendekatan ini digunakan theta = 8.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Pendugaan GWR-BN</span></span>
<span><span class="va">gwnbr.gauss.fixed</span> <span class="op">&lt;-</span> <span class="fu">spgwr</span><span class="fu">::</span><span class="fu"><a href="https://rsbivand.github.io/spgwr/reference/ggwr.html">ggwr</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">jatim</span>, coords<span class="op">=</span><span class="va">longlat</span>,</span>
<span>                     bandwidth <span class="op">=</span> <span class="va">bdwt.gauss.fixed</span>,</span>
<span>                     gweight<span class="op">=</span><span class="va">gwr.Gauss</span>, family <span class="op">=</span></span>
<span>                     <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html">negative.binomial</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fl">8</span>, link <span class="op">=</span></span>
<span>                     <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gwnbr.gauss.fixed</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; spgwr::ggwr(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6, data = jatim, </span></span>
<span><span class="co">#&gt;     coords = longlat, bandwidth = bdwt.gauss.fixed, gweight = gwr.Gauss, </span></span>
<span><span class="co">#&gt;     family = negative.binomial(theta = 8, link = "log"))</span></span>
<span><span class="co">#&gt; Kernel function: gwr.Gauss </span></span>
<span><span class="co">#&gt; Fixed bandwidth: 3.53 </span></span>
<span><span class="co">#&gt; Summary of GWR coefficient estimates at data points:</span></span>
<span><span class="co">#&gt;                  Min.  1st Qu.   Median  3rd Qu.     Max. Global</span></span>
<span><span class="co">#&gt; X.Intercept.  3.74054  3.81568  3.86659  3.91702  4.03409   3.84</span></span>
<span><span class="co">#&gt; X1           -0.00912 -0.00904 -0.00897 -0.00893 -0.00871  -0.01</span></span>
<span><span class="co">#&gt; X2            0.00475  0.00490  0.00496  0.00501  0.00510   0.00</span></span>
<span><span class="co">#&gt; X3            0.00351  0.00362  0.00368  0.00375  0.00388   0.00</span></span>
<span><span class="co">#&gt; X4            0.00706  0.00736  0.00747  0.00756  0.00770   0.01</span></span>
<span><span class="co">#&gt; X5            0.00216  0.00296  0.00327  0.00358  0.00410   0.00</span></span>
<span><span class="co">#&gt; X6            0.01449  0.01508  0.01536  0.01563  0.01597   0.02</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>RTBNG Adaptive Gaussian</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Menentukan Bandwidth</span></span>
<span><span class="va">bdwt.gauss.adapt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rsbivand.github.io/spgwr/reference/ggwr.sel.html">ggwr.sel</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>, </span>
<span>              data <span class="op">=</span> <span class="va">jatim</span>,coords<span class="op">=</span><span class="va">longlat</span>, adapt <span class="op">=</span> <span class="cn">T</span>,</span>
<span>              gweight <span class="op">=</span> <span class="va">gwr.Gauss</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adaptive q: 0.382 CV score: 267378 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.618 CV score: 252270 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.764 CV score: 246676 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.854 CV score: 244198 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.91 CV score: 242435 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.944 CV score: 242099 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.947 CV score: 242087 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.961 CV score: 241737 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.976 CV score: 241385 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.985 CV score: 241118 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.991 CV score: 240978 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.994 CV score: 240899 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.996 CV score: 240853 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.998 CV score: 240825 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.999 CV score: 240808 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.999 CV score: 240798 </span></span>
<span><span class="co">#&gt; Adaptive q: 0.999 CV score: 240792 </span></span>
<span><span class="co">#&gt; Adaptive q: 1 CV score: 240788 </span></span>
<span><span class="co">#&gt; Adaptive q: 1 CV score: 240786 </span></span>
<span><span class="co">#&gt; Adaptive q: 1 CV score: 240784 </span></span>
<span><span class="co">#&gt; Adaptive q: 1 CV score: 240783 </span></span>
<span><span class="co">#&gt; Adaptive q: 1 CV score: 240783</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># Optimasi Parameter Theta Binomial Negatif</span></span>
<span><span class="va">aicvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">gwnbr.gauss.adapt</span> <span class="op">&lt;-</span> <span class="fu">spgwr</span><span class="fu">::</span><span class="fu"><a href="https://rsbivand.github.io/spgwr/reference/ggwr.html">ggwr</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="va">X5</span>,</span>
<span>                       data<span class="op">=</span><span class="va">jatim</span>,coords<span class="op">=</span><span class="va">longlat</span>, adapt <span class="op">=</span></span>
<span>                       <span class="va">bdwt.gauss.adapt</span>, gweight <span class="op">=</span></span>
<span>                       <span class="va">gwr.Gauss</span>, family <span class="op">=</span></span>
<span>                       <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html">negative.binomial</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">i</span>,</span>
<span>                       link<span class="op">=</span><span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">aicvec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">gwnbr.gauss.adapt</span><span class="op">$</span><span class="va">lm</span><span class="op">$</span><span class="va">aic</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">aicvec</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]  480  436  458</span></span>
<span><span class="co">#&gt;  [2,]  456  437  460</span></span>
<span><span class="co">#&gt;  [3,]  445  439  463</span></span>
<span><span class="co">#&gt;  [4,]  439  441  466</span></span>
<span><span class="co">#&gt;  [5,]  436  443  468</span></span>
<span><span class="co">#&gt;  [6,]  434  445  471</span></span>
<span><span class="co">#&gt;  [7,]  433  448  474</span></span>
<span><span class="co">#&gt;  [8,]  433  450  477</span></span>
<span><span class="co">#&gt;  [9,]  433  452  479</span></span>
<span><span class="co">#&gt; [10,]  434  455  482</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="va">aicvec</span>, xlab <span class="op">=</span> <span class="st">'theta'</span>,  ylab <span class="op">=</span> <span class="st">'AIC'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="06-RegresiTerbobotiGeografisBinomialNegatif_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Berdasarkan nilai AIC, nilai theta = 8 menghasilkan AIC terkecil sehingga pada ilustrasi ini akan digunakan model RTBNG dengan nilai theta = 8.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gwnbr.gauss.adapt</span> <span class="op">&lt;-</span> <span class="fu">spgwr</span><span class="fu">::</span><span class="fu"><a href="https://rsbivand.github.io/spgwr/reference/ggwr.html">ggwr</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span><span class="op">+</span><span class="va">X4</span><span class="op">+</span><span class="va">X5</span><span class="op">+</span><span class="va">X6</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">jatim</span>,coords<span class="op">=</span><span class="va">longlat</span>,</span>
<span>                     adapt<span class="op">=</span><span class="va">bdwt.gauss.adapt</span>,</span>
<span>                     gweight<span class="op">=</span><span class="va">gwr.Gauss</span>,</span>
<span>                     family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/negative.binomial.html">negative.binomial</a></span><span class="op">(</span>theta <span class="op">=</span></span>
<span>                     <span class="fl">8</span>, link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gwnbr.gauss.adapt</span>  </span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; spgwr::ggwr(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6, data = jatim, </span></span>
<span><span class="co">#&gt;     coords = longlat, gweight = gwr.Gauss, adapt = bdwt.gauss.adapt, </span></span>
<span><span class="co">#&gt;     family = negative.binomial(theta = 8, link = "log"))</span></span>
<span><span class="co">#&gt; Kernel function: gwr.Gauss </span></span>
<span><span class="co">#&gt; Adaptive quantile: 1 (about 37 of 38 data points)</span></span>
<span><span class="co">#&gt; Summary of GWR coefficient estimates at data points:</span></span>
<span><span class="co">#&gt;                  Min.  1st Qu.   Median  3rd Qu.     Max. Global</span></span>
<span><span class="co">#&gt; X.Intercept.  3.73400  3.79227  3.91392  4.04821  4.08655   3.84</span></span>
<span><span class="co">#&gt; X1           -0.00912 -0.00903 -0.00885 -0.00868 -0.00852  -0.01</span></span>
<span><span class="co">#&gt; X2            0.00471  0.00475  0.00491  0.00503  0.00510   0.00</span></span>
<span><span class="co">#&gt; X3            0.00320  0.00337  0.00347  0.00372  0.00389   0.00</span></span>
<span><span class="co">#&gt; X4            0.00700  0.00709  0.00742  0.00762  0.00771   0.01</span></span>
<span><span class="co">#&gt; X5            0.00164  0.00190  0.00274  0.00361  0.00414   0.00</span></span>
<span><span class="co">#&gt; X6            0.01425  0.01467  0.01541  0.01586  0.01607   0.02</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="a">
<li>Perbandingan nilai AIC</li>
</ol>
<p>Berikut syntax untuk memperlihatkan perbandingan AIC dari setiap model:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#AIC</span></span>
<span><span class="va">aicmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gwnbr.gauss.fixed</span><span class="op">$</span><span class="va">lm</span><span class="op">$</span><span class="va">aic</span>, <span class="va">gwnbr.gauss.adapt</span><span class="op">$</span><span class="va">lm</span><span class="op">$</span><span class="va">aic</span><span class="op">)</span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Fixed'</span>, <span class="st">'Adaptive'</span><span class="op">)</span></span>
<span><span class="va">aicdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">mod</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">aicmod</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">aicdf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Model'</span>, <span class="st">'AIC'</span><span class="op">)</span></span>
<span><span class="va">aicdf</span></span>
<span><span class="co">#&gt;      Model    AIC</span></span>
<span><span class="co">#&gt; 1    Fixed 431.98</span></span>
<span><span class="co">#&gt; 2 Adaptive 431.98</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Berdasarkan nilai AIC, model dengan bandwidth fixed gaussian memiliki nilai AIC yang sama dengan model dengan bandwidth adaptive gaussian sehingga model terbaik yang lebih sederhana untuk data ini adalah model dengan bandwidth fixed gaussian.</p>
</section><section id="interpretasi" class="level3"><h3 class="anchored" data-anchor-id="interpretasi">Interpretasi</h3>
<p>Interpretasi model RTBNG dapat dilakukan dengan mengelompokkan koefisien model berdasarkan metode clustering tertentu. Dalam ilustrasi ini, dilakukan pengelompokan koefisien menggunakan kmeans.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Koefisien model</span></span>
<span><span class="va">hasil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">gwnbr.gauss.fixed</span><span class="op">$</span><span class="va">SDF</span><span class="op">)</span></span>
<span><span class="va">hasil</span><span class="op">$</span><span class="va">KABKOT</span> <span class="op">&lt;-</span> <span class="va">jatim</span><span class="op">$</span><span class="va">KABKOT</span></span>
<span><span class="va">gabung_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://edzer.github.io/sp/reference/merge.html">merge</a></span><span class="op">(</span><span class="va">jatim</span>, <span class="va">hasil</span>, by<span class="op">=</span> <span class="st">'KABKOT'</span>, all<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#Standarisasi koefisien</span></span>
<span><span class="va">clustdt</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">gabung_new</span><span class="op">[</span>,<span class="fl">10</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#K-means clustering dengan 4 cluster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">kcluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">clustdt</span>, centers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">gabung_new</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="va">kcluster</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="co">#</span></span>
<span><span class="co">#Plot Cluster</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_zm.html">st_zm</a></span><span class="op">(</span><span class="va">gabung_new</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span><span class="st">"Cluster"</span>, palette <span class="op">=</span> <span class="st">'Set2'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="06-RegresiTerbobotiGeografisBinomialNegatif_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Nilai rataan dari setiap gerombol dapat diperoleh dengan menggunakan syntax berikut ini:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#ringkasan pusat gerombol</span></span>
<span><span class="va">gabungdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">gabung_new</span><span class="op">)</span></span>
<span><span class="va">gabungdf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">select</a></span><span class="op">(</span><span class="va">cluster</span>, <span class="va">X.Intercept.</span>, <span class="va">X1.y</span>, <span class="va">X2.y</span>, <span class="va">X3.y</span>, </span>
<span>           <span class="va">X4.y</span>, <span class="va">X5.y</span>, <span class="va">X6.y</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_each.html">summarise_each</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/funs.html">funs</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `summarise_each()` was deprecated in dplyr 0.7.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `across()` instead.</span></span>
<span><span class="co">#&gt; Warning: `funs()` was deprecated in dplyr 0.8.0.</span></span>
<span><span class="co">#&gt; ℹ Please use a list of either functions or lambdas:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # Simple named list: list(mean = mean, median = median)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # Auto named with `tibble::lst()`: tibble::lst(mean, median)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm =</span></span>
<span><span class="co">#&gt;   TRUE))</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 8</span></span>
<span><span class="co">#&gt;   cluster X.Intercept.     X1.y    X2.y    X3.y    X4.y    X5.y</span></span>
<span><span class="co">#&gt;     &lt;int&gt;        &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1       1         3.99 -0.00884 0.00481 0.00355 0.00719 0.00248</span></span>
<span><span class="co">#&gt; 2       2         3.84 -0.00901 0.00498 0.00372 0.00751 0.00342</span></span>
<span><span class="co">#&gt; 3       3         3.91 -0.00893 0.00491 0.00363 0.00737 0.00300</span></span>
<span><span class="co">#&gt; 4       4         3.77 -0.00907 0.00506 0.00382 0.00764 0.00387</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: X6.y &lt;dbl&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dari output terlihat urutan rataan koefisien X1 dari terkecil sampai terbesar berturut-turut pada gerombol 4, gerombol 2, gerombol 3, dan gerombol 1. Sebaliknya urutan koefisien untuk X2 sampai X6 dari terkecil sampai terbesar berturut-turut pada gerombol 4, gerombol 2, gerombol 3, dan gerombol 1.</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-fadila2021" class="csl-entry" role="listitem">
Fadila A, Alamudi A, Djuraidah A. 2021. <span>“Pemodelan Jumlah Penderita Tuberkulosis Di Jawa Timur Dengan Regresi Terboboti Geografis Binomial Negatif.”</span> <em>Skripsi</em>.
</div>
<div id="ref-kutner2005" class="csl-entry" role="listitem">
Kutner MH, Neter J, Nachtsheim CJ. 2005. <span>“Applied Linear Statistical Models.”</span>
</div>
<div id="ref-ricardo2013" class="csl-entry" role="listitem">
Ricardo A, Carvalho T. 2013. <em>Geographically Weighted Negative Binomial Regression-Incorporating Overdispersion</em>. New York: Springer Science.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./05-RegresiTerbobotiGeografisCampuran.html" class="pagination-link" aria-label="Regresi Terboboti Geografis Campuran">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Regresi Terboboti Geografis Campuran</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./part-3.html" class="pagination-link" aria-label="Mixed SAR-GWR">
        <span class="nav-page-text">Mixed SAR-GWR</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regresi Terboboti Geografis Binomial Negatif</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deskripsi</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>Regresi Terboboti Geografis Binomial Negatif (RTGBN) merupakan pengembangan dari model regresi binomial negatif. Model RTGBN adalah salah satu metode yang cukup efektif menduga data yang memiliki ketergantungan spasial untuk data cacah yang memiliki overdispersi. Model ini akan menghasilkan pendugaan parameter lokal dengan masing-masing lokasi akan memiliki parameter yang berbeda <span class="co">[</span><span class="ot">silva2014</span><span class="co">]</span>.</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>Model RTGBN dapat dirumuskan sebagai berikut:</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>$y_i \sim \text{BN}\left(\exp\left(\sum_j \beta_j(u_i,v_i) x_{ij} \theta_i(u_i,v_i)\right)\right) \quad (6.6.1)$</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>dengan $y_i$ adalah nilai amatan respon ke-i, $x_{ij}$ adalah nilai amatan prediktor ke-j pada pengamatan, $(u_i, v_i)$ adalah logitude dan latitude lokasi-i, $\beta_j(u_i, v_i)$ adalah parameter regresi prediktor ke-j untuk setiap lokasi-i, dan $\theta_i(u_i, v_i)$ adalah parameter dispersi setiap lokasi-$i$.</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>Pendugaan model RTG-BN menggunakan metode kemungkinan maksimum. Langkah awal dari metode kemungkinan adalah membentuk fungsi kemungkinan sebagai berikut <span class="co">[</span><span class="ot">@ricardo2013</span><span class="co">]</span>:</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>L(\beta(u_i, v_i), \theta_i, i=1,2,\ldots,n) = \prod_{i=1}^{n} \left(\prod_{r=0}^{y_i-1} (r + \frac{1}{\theta_i})\right) \frac{1}{y_i!} \left(\frac{1}{1 + \theta_i \mu_i}\right)^{\frac{1}{\theta_i}} \left(\frac{\theta_i \mu_i}{1 + \theta_i \mu_i}\right)^{y_i}</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>Pengujian parameter model RTGBN terdiri dari uji serentak dan parsial. Uji signifikansi serentak menggunakan uji rasio kemungkinan maksimum (MLRT) dengan hipotesis sebagai berikut.</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>H_0: &amp; \ \beta_1(u_i,v_i) = \beta_2(u_i,v_i) = \ldots = \beta_p(u_i,v_i) = 0 <span class="sc">\\</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>H_1: &amp; \ \text{Minimal ada satu } \beta_j(u_i,v_i) \neq 0, \ j=1,2,\ldots ,p</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>dengan statistik ujinya yaitu:</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>$D(\hat{\beta}) = -2 \ln\left<span class="co">[</span><span class="ot">\frac{L(\hat{\omega})}{L(\hat{\Omega})}\right</span><span class="co">]</span> = 2\left<span class="co">[</span><span class="ot">\ln(L(\hat{\Omega})) - \ln(L(\hat{\omega}))\right</span><span class="co">]</span>$</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>Keputusannya adalah tolak $H_0$ jika $D(\hat{\beta}) &gt; \chi^2_{p,\alpha} $ dengan $p$ adalah banyaknya parameter. Tolak $H_0$ artinya minimal ada satu peubah yang berpengaruh signifikan terhadap model sehingga dilanjutkan dengan pengujian parsial.</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>Hipotesis yang digunakan untuk pengujian parameter secara parsial. Berikut hipotesis yang digunakan untuk pengujian parameter secara parsial:</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>H_0: &amp; \ \beta_j(u_i,v_i) = 0 <span class="sc">\\</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>H_1: &amp; \ \beta_j(u_i,v_i) \neq 0</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>dengan statistik ujinya dinyatakan dalam formula berikut:</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>$Z = \frac{\hat{\beta}_j(u_i,v_i)}{\text{se}(\hat{\beta}_j(u_i,v_i))} \sim \mathcal{N}(0,1)$</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>dengan $\hat{\beta}_j(u_i,v_i)$ merupakan penduga parameter koefisien</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>regresi prediktor ke-j pada lokasi ke-i dan $\text{se}(\hat{\beta}_j)$</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>adalah galat baku penduga parameter koefisien regresi prediktor ke-j pada lokasi ke-i. Keputusan adalah tolak $H_0$ jika $|z_{\text{hit}}| &gt; z_{\alpha/2}$</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>Ilustrasi untuk model RTG-BN merujuk hasil penelitian @fadila2021 tentang Tuberkulosis (TB) di Jawa Timur. Data yang digunakan merupakan data sekunder yang yang diperoleh dari Statistik Kesehatan Provinsi Jawa Timur 2019 yang dikeluarkan oleh Badan Pusat Statistik Jawa Timur, Profil Kesehatan Jawa Timur tahun 2018 dan Profil Kesehatan Jawa Timur tahun 2019 yang dikeluarkan oleh dinas kesehatan Provinsi Jawa Timur. Data yang digunakan mencakup jumlah kasus tuberkulosis dan enam peubah lainnya yang diduga berpengaruh terhadap kasus tuberkulosis (@tbl-tbc). Unit amatan adalah 38 kabupaten/kota yang berada di Provinsi Jawa Timur. Data dan peta ilustrasi RTG-BN tersedia pada tautan <span class="co">[</span><span class="ot">https://ipb.link/gwr-binomial-negatif</span><span class="co">](https://ipb.link/gwr-binomial-negatif)</span>.</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>| Kode   | Peubah                                          | Referensi        |</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>|--------|-------------------------------------------------|-----------------------|</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>| $Y$    | Angka Tuberkulosis per 100.000 penduduk        | -                     |</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>| $X_1$  | Persentase rumah tangga dengan akses sanitasi layak &amp; Nisa’  | Budiantara (2016) |</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>| $X_2$  | Persentase tempat pengolahan makanan (TPM) sehat | Lestari et al. (2014) |</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>| $X_3$  | Persentase rumah tangga ber-PHBS &amp; Nisa’      | Budiantara (2016) |</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>| $X_4$  | Persentase rumah sehat                         | Lestari et al. (2014) |</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>| $X_5$  | Rata-rata konsumsi batang rokok per minggu | Tandang et al. (2018)      |</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>| $X_6$  | Persentase pengobatan lengkap kasus Tuberkulosis | Sarani (2019)   |</span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>: Tabel Peubah dan Referensi {#tbl-tbc .striped .hover}</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="fu">## Metode Analisis</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>Tahapan untuk menganalisis data jumlah kasus TB di Provinsi Jawa Timur tahun 2019 dengan pendekatan RTG-BN adalah sebagai berikut:</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Melakukan eksplorasi data untuk mengetahui gambaran awal data jumlah kasus TB pada balita di Provinsi Jawa Timur tahun 2019.</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Membuat peta sebaran dari setiap peubah respon dan prediktor yang digunakan.</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Memeriksa adanya multikolinearitas antar prediktor dengan menggunakan Variance Inflation Factor (VIF), jika nilai $VIF_i &gt; 10$, maka terdapat multikolinear <span class="co">[</span><span class="ot">@kutner2005</span><span class="co">]</span>:</span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>$VIF_i = \frac{1}{1 - R_i^2}$</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>dengan $R_i^2$ adalah koefisien determinasi antara $X_i$ dengan prediktor lainnya. Prediktor yang memiliki nilai $VIF_i &gt; 10$ tidak diikutsertakan dalam penyusunan model.</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Memeriksa overdispersi Regresi Poisson memiliki asumsi equidispersi, artinya nilai rataan dan ragam pada peubah $Y$ bernilai sama. Penyimpangan asumsi yang sering terjadi pada regresi Poisson yaitu overdispersi, yaitu nilai ragam lebih besar dari pada nilai rataan pada peubah $Y$. Pengujian overdispersi menggunakan nilai devians dan Khi-kuadrat Pearson yang dibagi dengan derajat bebasnya. Hipotesis yang diuji sebagai berikut:</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>H_0: \text{Model mengandung overdispersi}<span class="sc">\]</span></span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span>H_1: \text{Model tidak mengandung overdispersi}<span class="sc">\]</span></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Statistik Uji Devians:</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>   $<span class="sc">\[</span>D^2 = 2\sum_{i=1}^n \left( y_i \ln\left(\frac{y_i}{\hat{\mu}_i}\right) - (y_i - \hat{\mu}_i) \right)<span class="sc">\]</span>$</span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>   $<span class="sc">\[</span>\phi_1 = \frac{D^2}{db}<span class="sc">\]</span>$</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>   dengan $db = n - k$ dengan $k$ merupakan banyaknya parameter (termasuk konstanta) model regresi Poisson, $n$ merupakan banyaknya amatan, dan $D^2$ adalah nilai Devians.</span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Khi-kuadrat Pearson:</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>   $\chi^2 = 2\sum_{i=1}^n \frac{(y_i - \mu_i)^2}{\text{var}(y_i)}$</span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>   $\phi_2 = \frac{\chi^2}{db}$</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>   dengan $db = n - k$ dengan $k$ merupakan banyaknya parameter termasuk konstanta, $n$ merupakan banyaknya pengamatan, dan $\chi^2$ adalah nilai Khi-kuadrat Pearson.</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>   Jika $\phi_1$ atau $\phi_2$ bernilai lebih dari 1 maka terjadi overdispersi pada data. Jika tidak terdapat overdispersi maka model yang digunakan adalah model regresi Poisson, sedangkan jika terdapat overdispersi lebih cocok menggunakan model regresi binomial negatif.</span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Melakukan uji efek spasial yaitu:</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Uji dependensi spasial dengan uji LM dan Robust LM</span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Uji heterogenitas spasial menggunakan uji Breusch Pagan</span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Menduga model regresi spasial sesuai hasil uji butir (2) dan (3). Memilih model terbaik dengan kriteria AIC.</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Pemilihan model terbaik menggunakan Kriteria Informasi Akaike dengan rumus sebagai berikut:</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>    $AIC = -2\log_e(L(\hat{\theta}|\text{data})) + 2K$</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>    dengan $\log_e(L(\hat{\theta}|\text{data}))$ adalah nilai maksimum pendugaan kemungkinan maksimum, $\theta$ adalah parameter yang tidak diketahui, $K$ adalah banyaknya parameter yang diestimasi, dan $n$ adalah banyaknya pengamatan.</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tahapan Analisis Data dengan R</span></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>Tahap awal dalam pemodelan menggunakan R Studio adalah melakukan input data dan install package sesuai kebutuhan dalam analisis. Package diperlukan adalah:</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a><span class="fu">### Package</span></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cache=FALSE, message=FALSE, warning=FALSE}</span></span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a><span class="in">library(car)         # Untuk menghitung nilai VIF</span></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a><span class="in">library(classInt)        # Untuk membuat selang nilai</span></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)         # Untuk visualisasi data</span></span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a><span class="in">library(lmtest)      # Untuk pengujian asumsi</span></span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a><span class="in">library(spdep)       # Untuk dependensi spasial</span></span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a><span class="in">library(sp)      # Untuk membentuk GWR model</span></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="in">library(spgwr)       # Untuk membentuk GWNBR</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a><span class="in">library(AER)         # Untuk uji dispersi</span></span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a><span class="in">library(MASS)        # Untuk mengoptimasi parameter binomial</span></span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)       # Untuk meringkas data koefisien</span></span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a><span class="in">library(sf)</span></span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a><span class="fu">### Input Data</span></span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a><span class="co">#Set Lokasi File</span></span>
<span id="cb17-145"><a href="#cb17-145" aria-hidden="true" tabindex="-1"></a><span class="co"># Input Data</span></span>
<span id="cb17-146"><a href="#cb17-146" aria-hidden="true" tabindex="-1"></a>gabung <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">'data/gabung.RDS'</span>)</span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/tb_jatim.csv'</span>)</span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a>tb<span class="sc">$</span>KABUPATEN..KOTA <span class="ot">&lt;-</span> <span class="fu">toupper</span>(tb<span class="sc">$</span>KABUPATEN..KOTA)</span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a><span class="co">#Input peta SHP</span></span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a>jatim <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">"data/shp/TB Jatim.shp"</span>)</span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a><span class="fu">sf_use_s2</span>(<span class="cn">FALSE</span>)</span>
<span id="cb17-158"><a href="#cb17-158" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(jatim)[<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Y'</span>, <span class="st">'X1'</span>, <span class="st">'X2'</span>, <span class="st">'X3'</span>, <span class="st">'X4'</span>, <span class="st">'X5'</span>, <span class="st">'X6'</span>)</span>
<span id="cb17-159"><a href="#cb17-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a>longlat <span class="ot">=</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(jatim))</span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>jatim<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(jatim<span class="sc">$</span>Y)</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a>jatim<span class="sc">$</span>X1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(jatim<span class="sc">$</span>X1)</span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a>jatim<span class="sc">$</span>X2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(jatim<span class="sc">$</span>X2)</span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a>jatim<span class="sc">$</span>X3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(jatim<span class="sc">$</span>X3)</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a>jatim<span class="sc">$</span>X4 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(jatim<span class="sc">$</span>X4)</span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a>jatim<span class="sc">$</span>X5 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(jatim<span class="sc">$</span>X5)</span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>jatim<span class="sc">$</span>X6 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(jatim<span class="sc">$</span>X6)</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jatim)</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a><span class="fu">### Eksplorasi Data</span></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a>a.  Peta sebaran</span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>Berikut syntax yang dapat digunakan untuk membuat peta sebaran (@fig-plot-tb):</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a><span class="co">#Menentukan batas kelas dari angka TB per 100000 penduduk</span></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a><span class="fu">classIntervals</span>(gabung<span class="sc">$</span>y, <span class="at">n =</span> <span class="dv">4</span>, <span class="at">style =</span> <span class="st">'kmeans'</span>)</span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-plot-tb</span></span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Peta kasus TB"</span></span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a><span class="co">#Membuat peta</span></span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a>cc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#fbb4b9'</span>, <span class="st">'#f768a1'</span>, <span class="st">'#ae017e'</span>, <span class="st">'#551c53'</span>)</span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a>plot.tb <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span><span class="fu">st_zm</span>(jatim)) <span class="sc">+</span></span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">cut</span>(Y, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="fl">104.5</span>, <span class="fl">153.5</span>, <span class="fl">225.5</span>,</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a>         <span class="dv">401</span>))), <span class="at">lwd =</span> <span class="fl">0.1</span>, <span class="at">col =</span><span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a>         <span class="fu">scale_fill_manual</span>(<span class="st">"TB"</span>, <span class="at">values =</span> cc,</span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"66 - 104.5"</span>, <span class="st">"104.5 - 153.5"</span>,</span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a>         <span class="st">"153.5 - 225.5"</span>, <span class="st">"225.5 - 401"</span>),</span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a>         <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> T))<span class="sc">+</span></span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)</span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>plot.tb</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>b.  VIF</span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>VIF dihitung menggunakan syntax berikut ini:</span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a><span class="co">#VIF</span></span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y) <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4 <span class="sc">+</span> X5 <span class="sc">+</span> X6, </span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> jatim)</span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(<span class="fu">vif</span>(model))</span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>Berdasarkan nilai VIF, seluruh peubah memiliki nilai VIF &lt; 10 sehingga dapat disimpulkan tidak terdapat multikolinearitas.</span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uji efek spasial</span></span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a>a.  Indeks Moran</span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a>Untuk mengetahui efek dependensi spasial pada model regresi dengan respon ln(Y) dengan 6 (enam) prediktor (X1 sampai X6) digunakan uji Lagrange multiplier dengan syntax sebagai berikut:</span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a><span class="co">#Uji Lagrange Multiplier</span></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>queenl <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(<span class="fu">st_zm</span>(jatim))</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a>queenl <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(queenl)</span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm.LMtests</span>(model, queenl, <span class="at">zero.policy =</span> T,</span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>        <span class="at">test =</span> <span class="fu">c</span>(<span class="st">'LMlag'</span>, <span class="st">'LMerr'</span>, <span class="st">'RLMlag'</span>, <span class="st">'RLMerr'</span>)))</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a>Pada output di atas terlihat semua uji LM dan RLM mempunyai p-value &gt; α=0.05, sehingga tidak terdapat dependensi spasial pada ln(Y) dan sisaan. </span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>b.  Uji Breusch-Pagan</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>Efek keragaman spasial diuji dengan uji Breusch-Pagan dengan syntax berikut:</span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a><span class="co">#Model log(Y)</span></span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(model)</span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a>Hasil uji Breusch-Pagan untuk data ini menghasilkan p-value &lt; α=0.05 yang berarti terdapat heterogenitas spasial. </span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>c.  Uji Overdispersi</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>Untuk melakukan uji dispersi menggunakan syntax sebagai berikut:</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a><span class="co">#Model Regresi Poisson</span></span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a>poisson<span class="ot">&lt;-</span><span class="fu">glm</span>(Y<span class="sc">~</span>X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6,<span class="at">data=</span>jatim, <span class="at">family =</span> <span class="fu">poisson</span>())</span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a><span class="co">#Nilai Deviance</span></span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>dv_df<span class="ot">&lt;-</span><span class="fu">deviance</span>(poisson)<span class="sc">/</span><span class="fu">df.residual</span>(poisson)</span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a><span class="co">#Nilai Chi-Squares</span></span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a>pr_df<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">residuals</span>(poisson,<span class="st">"pearson"</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">df.residual</span>(poisson)</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a><span class="co">#Overdispersi</span></span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>overdis<span class="ot">&lt;-</span><span class="fu">cbind.data.frame</span>(dv_df,pr_df)</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a>overdis</span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a>Kedua nilai statistik uji overdispersi bernilai lebih besar dari satu, maka pada data TB terdapat overdispersi. Untuk menangani overdispersi pada data TB digunakan model regresi binomial negatif.</span>
<span id="cb17-272"><a href="#cb17-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-273"><a href="#cb17-273" aria-hidden="true" tabindex="-1"></a><span class="fu">### Menduga model RTBNG</span></span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>a.  RTBNG Fixed Gaussian</span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a><span class="co">#Menentukan bandwidth</span></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>bdwt.gauss.fixed <span class="ot">&lt;-</span> <span class="fu">ggwr.sel</span>(Y <span class="sc">~</span> X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6, <span class="at">data =</span> jatim, <span class="at">coords=</span>longlat, <span class="at">adapt =</span> F, <span class="at">gweight =</span> gwr.Gauss)</span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a><span class="co">#Optimasi Parameter Theta Binomial Negatif</span></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>aicvec <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>){</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>  gwnbr.gauss.fixed <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(spgwr<span class="sc">::</span><span class="fu">ggwr</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2</span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>                       <span class="sc">+</span> X3 <span class="sc">+</span> X4 <span class="sc">+</span> X5 <span class="sc">+</span> X6, <span class="at">data =</span> jatim,</span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>                       <span class="at">coords=</span>longlat, <span class="at">bandwidth =</span></span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>                       bdwt.gauss.fixed, <span class="at">gweight =</span></span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>                       gwr.Gauss, <span class="at">family =</span></span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">negative.binomial</span>(<span class="at">theta=</span> i, link</span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a>                       <span class="ot">=</span> <span class="st">"log"</span>)), <span class="at">warning=</span><span class="cf">function</span>(w) w)</span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>  aicvec[i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is</span>(gwnbr.gauss.fixed, <span class="st">'warning'</span>),</span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"not converge"</span>,</span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">round</span>(gwnbr.gauss.fixed<span class="sc">$</span>lm<span class="sc">$</span>aic,<span class="dv">2</span>))</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(aicvec, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, aicvec, <span class="at">xlab =</span> <span class="st">'theta'</span>,  <span class="at">ylab =</span> <span class="st">'AIC'</span>)</span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>Dalam ilustrasi ini, dilakukan optimasi parameter theta pada sebaran binomial negatif yang digunakan. Berdasarkan pemodelan RTBNG dengan nilai theta 1 sampai 30 menghasilkan algoritma yang konvergen. Nilai AIC terkecil pada theta 8 senilai 431.98. Oleh karena itu, untuk pendekatan ini digunakan theta = 8.</span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a><span class="co">#Pendugaan GWR-BN</span></span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>gwnbr.gauss.fixed <span class="ot">&lt;-</span> spgwr<span class="sc">::</span><span class="fu">ggwr</span>(Y <span class="sc">~</span> X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6,</span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> jatim, <span class="at">coords=</span>longlat,</span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bandwidth =</span> bdwt.gauss.fixed,</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a>                     <span class="at">gweight=</span>gwr.Gauss, <span class="at">family =</span></span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">negative.binomial</span>(<span class="at">theta =</span> <span class="dv">8</span>, <span class="at">link =</span></span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"log"</span>))</span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>gwnbr.gauss.fixed</span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>b.  RTBNG Adaptive Gaussian</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a><span class="co">#Menentukan Bandwidth</span></span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a>bdwt.gauss.adapt <span class="ot">&lt;-</span> <span class="fu">ggwr.sel</span>(Y <span class="sc">~</span> X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6, </span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> jatim,<span class="at">coords=</span>longlat, <span class="at">adapt =</span> T,</span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a>              <span class="at">gweight =</span> gwr.Gauss)</span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-327"><a href="#cb17-327" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimasi Parameter Theta Binomial Negatif</span></span>
<span id="cb17-328"><a href="#cb17-328" aria-hidden="true" tabindex="-1"></a>aicvec <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>){</span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a>  gwnbr.gauss.adapt <span class="ot">&lt;-</span> spgwr<span class="sc">::</span><span class="fu">ggwr</span>(Y <span class="sc">~</span> X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5,</span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data=</span>jatim,<span class="at">coords=</span>longlat, <span class="at">adapt =</span></span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>                       bdwt.gauss.adapt, <span class="at">gweight =</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>                       gwr.Gauss, <span class="at">family =</span></span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">negative.binomial</span>(<span class="at">theta =</span> i,</span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>                       <span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>  aicvec[i] <span class="ot">&lt;-</span> gwnbr.gauss.adapt<span class="sc">$</span>lm<span class="sc">$</span>aic</span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(aicvec, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, aicvec, <span class="at">xlab =</span> <span class="st">'theta'</span>,  <span class="at">ylab =</span> <span class="st">'AIC'</span>)</span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a>Berdasarkan nilai AIC, nilai theta = 8 menghasilkan AIC terkecil sehingga pada ilustrasi ini akan digunakan model RTBNG dengan nilai theta = 8.</span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>gwnbr.gauss.adapt <span class="ot">&lt;-</span> spgwr<span class="sc">::</span><span class="fu">ggwr</span>(Y <span class="sc">~</span> X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6,</span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> jatim,<span class="at">coords=</span>longlat,</span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a>                     <span class="at">adapt=</span>bdwt.gauss.adapt,</span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a>                     <span class="at">gweight=</span>gwr.Gauss,</span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">negative.binomial</span>(<span class="at">theta =</span></span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a>                     <span class="dv">8</span>, <span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a>gwnbr.gauss.adapt  </span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>c.  Perbandingan nilai AIC</span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a>Berikut syntax untuk memperlihatkan perbandingan AIC dari setiap model:</span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a><span class="co">#AIC</span></span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a>aicmod <span class="ot">&lt;-</span> <span class="fu">c</span>(gwnbr.gauss.fixed<span class="sc">$</span>lm<span class="sc">$</span>aic, gwnbr.gauss.adapt<span class="sc">$</span>lm<span class="sc">$</span>aic)</span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Fixed'</span>, <span class="st">'Adaptive'</span>)</span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>aicdf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(mod, <span class="fu">round</span>(aicmod,<span class="dv">2</span>)))</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(aicdf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Model'</span>, <span class="st">'AIC'</span>)</span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>aicdf</span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a>Berdasarkan nilai AIC, model dengan bandwidth fixed gaussian memiliki nilai AIC yang sama dengan model dengan bandwidth adaptive gaussian sehingga model terbaik yang lebih sederhana untuk data ini adalah model dengan bandwidth fixed gaussian. </span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretasi</span></span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a>Interpretasi model RTBNG dapat dilakukan dengan mengelompokkan koefisien model berdasarkan metode clustering tertentu. Dalam ilustrasi ini, dilakukan pengelompokan koefisien menggunakan kmeans. </span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a><span class="co">#Koefisien model</span></span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a>hasil <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gwnbr.gauss.fixed<span class="sc">$</span>SDF)</span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a>hasil<span class="sc">$</span>KABKOT <span class="ot">&lt;-</span> jatim<span class="sc">$</span>KABKOT</span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a>gabung_new <span class="ot">&lt;-</span> <span class="fu">merge</span>(jatim, hasil, <span class="at">by=</span> <span class="st">'KABKOT'</span>, <span class="at">all=</span>T)</span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-386"><a href="#cb17-386" aria-hidden="true" tabindex="-1"></a><span class="co">#Standarisasi koefisien</span></span>
<span id="cb17-387"><a href="#cb17-387" aria-hidden="true" tabindex="-1"></a>clustdt<span class="ot">&lt;-</span> <span class="fu">scale</span>(<span class="fu">as.data.frame</span>(gabung_new[,<span class="dv">10</span><span class="sc">:</span><span class="dv">16</span>])[,<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a><span class="co">#K-means clustering dengan 4 cluster</span></span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a>kcluster <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(clustdt, <span class="at">centers =</span> <span class="dv">4</span>)</span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a>gabung_new<span class="sc">$</span>cluster <span class="ot">&lt;-</span> kcluster<span class="sc">$</span>cluster</span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot Cluster</span></span>
<span id="cb17-395"><a href="#cb17-395" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">st_zm</span>(gabung_new)) <span class="sc">+</span></span>
<span id="cb17-396"><a href="#cb17-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(cluster)) <span class="sc">+</span></span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">size =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="st">"Cluster"</span>, <span class="at">palette =</span> <span class="st">'Set2'</span>)<span class="sc">+</span></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)</span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a>Nilai rataan dari setiap gerombol dapat diperoleh dengan menggunakan syntax berikut ini:</span>
<span id="cb17-404"><a href="#cb17-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a><span class="co">#ringkasan pusat gerombol</span></span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>gabungdf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gabung_new)</span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a>gabungdf <span class="sc">%&gt;%</span> <span class="fu">select</span>(cluster, X.Intercept., X1.y, X2.y, X3.y, </span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a>           X4.y, X5.y, X6.y) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span> <span class="fu">summarise_each</span>(<span class="fu">funs</span>(mean))</span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-414"><a href="#cb17-414" aria-hidden="true" tabindex="-1"></a>Dari output terlihat urutan rataan koefisien X1 dari terkecil sampai terbesar berturut-turut   pada gerombol 4, gerombol 2, gerombol 3, dan gerombol 1. Sebaliknya urutan koefisien untuk X2 sampai X6 dari terkecil sampai terbesar berturut-turut  pada gerombol 4, gerombol 2, gerombol 3, dan gerombol 1.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>